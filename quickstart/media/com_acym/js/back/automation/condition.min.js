jQuery(document).ready(function(t){function n(){o("classic"),o("user"),t(".acym__automation__add-condition").off("click").on("click",function(){let o=t(this).closest(".acym__automation__group__condition").find(".acym__automation__one__condition").length;if(0===o){let n=t("#acym__automation__and__example").clone().removeAttr("id");n.find(".acym__automation__and").remove(),t(this).parent().before(n.show())}else t(this).parent().before(t("#acym__automation__and__example").clone().removeAttr("id").show());let a=t(this).parent().prev();a.addClass("acym__automation__one__condition__"+t(this).attr("data-condition-type")),a.find(".acym__automation__and__example__"+t(this).attr("data-condition-type")+"__select").show().find("select").addClass("acym__select").select2({theme:"foundation",width:"100%"}),n()}),t(".acym__automation__choose__condition").off("click").on("click",function(){t("#acym__automation__type-condition__input").val(t(this).attr("data-condition")),t(".selected-condition").removeClass("selected-condition"),t(this).addClass("selected-condition");let n=t(".acym__automation__condition__container");n.hide(),n.find('[name^="type_condition"]').each(function(n){t(this).attr("name",t(this).attr("name").replace("type_condition",""))});let o=t("#acym__automation__conditions__type__"+t(this).attr("data-condition"));o.show(),o.find('[name^="[conditions]"]').each(function(n){t(this).attr("name","type_condition"+t(this).attr("name"))})}),t(".acym__automation__conditions__or").off("click").on("click",function(){let o=t("#acym__automation__conditions__count__or");o.val(parseInt(o.val())+1),t(this).before(t("#acym__automation__or__example").html());let a=t(this).prev();a.attr("data-condition-number",o.val()),n(),a.find("button[data-condition-type]").attr("data-condition-type",t(this).attr("data-condition-type")).click()}),t(".acym__automation__delete__one__condition").off("click").on("click",function(){t(this).parent().parent().remove()}),t(".acym__automation__delete__group__condition").off("click").on("click",function(){t(this).parent().parent().prev().remove(),t(this).parent().parent().remove()}),acym_helperDatePicker.setDatePickerGlobal(),acym_helperDatePicker.setRSDateChoice(),acym_helperSelect2.setAjaxSelect2(),t.setAutomationReload()}function o(o){let a=t("#acym__automation__condition__"+o+"__options");if(!a.length)return;let i=JSON.parse(a.val());t(".acym__automation__select__"+o+"__condition").off("change").on("change",function(){let o=t("#acym__automation__conditions__count__and");o.val(parseInt(o.val())+1),t(this).parent().parent().find(".acym__automation__inserted__condition").remove();let a=i[t(this).val()].replace(/__numor__/g,t(this).closest(".acym__automation__group__condition").attr("data-condition-number"));a=a.replace(/__numand__/g,o.val()),t(this).parent().after('<div data-and="'+o.val()+'" class="cell grid-x grid-margin-x grid-margin-y acym__automation__inserted__condition margin-top-1 margin-left-2">'+a+"</div>"),acym_helperSelect2.setSelect2(),acym_helperDatePicker.setDatePickerGlobal(),t(".switch-label").off("click").on("click",function(){let n=t('input[data-switch="'+t(this).attr("for")+'"]');n.attr("value",1-n.attr("value"))});let _=t(this).closest(".acym__automation__one__condition").find(".acym__automation__conditions__operator__dropdown"),e=t(this).closest(".acym__automation__one__condition").find(".acym__automation__conditions__fields__dropdown");_.on("change",function(){e.trigger("change")}),e.on("change",function(){let n=t(this).closest(".acym__automation__inserted__condition"),o=n.find('[data-condition-field="'+t(this).val()+'"]'),a=n.find(".acym__automation__conditions__fields__select"),i=n.find(".acym__automation__condition__regular-field");o.length>0&&("="===_.val()||"!="===_.val())?(i.attr("name",i.attr("name").replace("acym_condition","")).hide(),a.each(function(n){t(this).attr("name",t(this).attr("name").replace("acym_condition","")),t(this).closest(".acym__automation__one-field").hide()}),-1===o.attr("name").indexOf("acym_condition")&&o.attr("name","acym_condition"+o.attr("name")),o.closest(".acym__automation__one-field").show()):(-1===i.attr("name").indexOf("acym_condition")&&i.attr("name","acym_condition"+i.attr("name")),a.length>0&&a.each(function(){t(this).attr("name",t(this).attr("name").replace("acym_condition","")),t(this).closest(".acym__automation__one-field").hide()}),i.show())}).trigger("change"),t(document).foundation(),t(".reveal-overlay").appendTo("#acym_form"),n()})}n(),function(){let o=t("#conditions");if(!o.length)return;let a=JSON.parse(o.val()),i=a.type_condition,_=0;t.each(a,function(n,o){let a=0;if("type_condition"===n)return!0;0!==_&&t('.acym__automation__conditions__or[data-condition-type="'+i+'"]').click(),t.each(o,function(n,o){0!==a&&t('.acym__automation__group__condition[data-condition-number="'+_+'"]').find('.acym__automation__add-condition[data-condition-type="'+i+'"]').click(),t.each(o,function(n,o){let a=t('.acym__automation__group__condition[data-condition-number="'+_+'"]').find(".acym__automation__select__"+i+"__condition").last();a.val(n),a.trigger("change");let e=Object.keys(o);t.each(e,function(a){let i=e[a],c=o[e[a]],d=t('[name="acym_condition[conditions]['+_+"]["+t("#acym__automation__conditions__count__and").val()+"]["+n+"]["+i+']"]');t.setFieldValue(d,c),d.trigger("change")})}),a++}),_++}),n()}()});