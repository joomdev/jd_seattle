jQuery(document).on("acy_preview_loaded",()=>{let _=jQuery("#acym__stats_click__map__all-links__click");if(_.length<1)return;let t=JSON.parse(_.val());jQuery("#acym__wysid__preview__iframe__acym__wysid__email__preview").contents().find("body").prepend(jQuery("#acym__stats__add_style_export__click-map").html()),jQuery.each(t,(_,a)=>{if("allClick"===_)return;jQuery("#acym__wysid__preview__iframe__acym__wysid__email__preview").contents().find('[href="'+_+'"]').css({position:"relative",overflow:"initial",display:"inline-block"}).append('<span class="acym__stats__cliked__link__percentage overviewbubble" style="background-color: rgba('+a.color+', 0.8);"><span class="acym__tooltip" style="display:flex;justify-content:center;align-items:center;"><span class="acym__tooltip__text"> <span class="acym__tooltip__title">'+acym_helper.sprintf(ACYM_JS_TXT.ACYM_OF_CLICKS,'<span class="acym__color__light-blue">'+a.percentage+"%</span> ")+"</span>"+acym_helper.sprintf(ACYM_JS_TXT.ACYM_CLICKS_OUT_OF,"<b>"+a.numberClick+"</b>"," <b> "+t.allClick+"</b>")+"</span>"+a.percentage+"%</span></span>")}),acym_helperTooltip.setTooltip()}),jQuery(document).ready(function(_){function t(){_(".acym__stats__export__button").on("click",function(){setTimeout(function(){_("#formSubmit")[0].disabled=!1,_('[name="task"]').val("")},5)})}function a(){_(".acym__stats__export__global__charts").off("click").on("click",function(){let t=_(this),a=_("#acym__stats__export__global__charts__scope");t.attr("disabled","true"),e(a,t,"export_stats_global_")}),_(".acym__stats__export__click-map__charts").on("click",function(){let t=_(this),a=_("#acym__wysid__preview__iframe__acym__wysid__email__preview").contents().find("body");t.attr("disabled","true"),e(a,t,"export_stats_click_map_")})}function e(t,a,e){html2canvas(t[0]).then(t=>{let c=t.toDataURL("image/png"),n=document.createElement("a"),l=new Date;n.download=e+""+l.getFullYear()+"_"+l.getMonth()+"_"+l.getDay()+".jpeg",n.href=c,n.click(),a.removeAttr("disabled"),_('[name="task"]').val("")})}_("#mail_id").off("change").on("change",function(){_(".acym__stats__select__language").val(0),_("#formSubmit").click()}),function(){let t=_("#chart__line__start"),a=_("#chart__line__end"),e=t.attr("data-start"),c=a.attr("data-end");t.val(e),a.val(c),_(".acym__stats__chart__line__input__date").off("change").on("change",function(){let e=moment(t.val(),"YYYY-MM-DD HH:mm").unix(),c=moment(a.val(),"YYYY-MM-DD HH:mm").add(1,"hours").unix();!function(t,a){let e=ACYM_AJAX_URL+'&ctrl=stats&task=setDataForChartLine"&start='+t+"&end="+a+"&id="+_("#mail_id").val();_.post(e,function(t){"error"==t?acym_helperNotification.addNotification(ACYM_JS_TXT.ACYM_STATS_START_DATE_LOWER,"warning"):_("#acym__stats__chart__line__canvas").html(t)})}(e,c)})}(),_(".select2-container--sortBy").css({width:"auto","min-width":"140px"}),t(),_('[name="export_type"]').select2({theme:"sortBy",minimumResultsForSearch:1/0}).on("change",function(){let e=_('[data-task="exportGlobal"]');e.off("click"),"charts"===_(this).val()?(e.removeClass("acy_button_submit").addClass("acym__stats__export__global__charts"),a()):(e.addClass("acy_button_submit").removeClass("acym__stats__export__global__charts"),acym_helper.setSubmitButtonGlobal()),t()}),a(),_(".acym__stats__select__language").off("change").on("change",function(){_("#formSubmit").click()})});