(function(){var t=this;t.N2_=t.N2_||{r:[],d:[]},t.N2R=t.N2R||function(){t.N2_.r.push(arguments)},t.N2D=t.N2D||function(){t.N2_.d.push(arguments)}}).call(window),N2D("ContextMenu",function(t,e){function i(e,i){this.isActive=!1,this.$el=e.data("nextendcontextmenu",this),this.parameters=t.extend({selector:!1,onShow:function(){}},i),this.$menu=t('<div class="n2-context-menu"></div>').on("mousedown",function(){N2Classes.WindowManager.get().setMouseDownArea("context-menu")}).appendTo("body"),this.parameters.selector?this.$el.on("contextmenu",this.parameters.selector,t.proxy(this.onShowContextMenu,this)):this.$el.on("contextmenu",t.proxy(this.onShowContextMenu,this))}return i.prototype.onShowContextMenu=function(e){e.preventDefault(),this.clearItems(),this.parameters.onShow.call(this,e,this),this.hasItems&&(e.stopPropagation(),this.isActive=!0,this.$menu.css({left:e.pageX,top:e.pageY}),t("html").on("mouseleave.nextendcontextmenu, click.nextendcontextmenu",t.proxy(this.onHide,this))),this.$menu.toggleClass("n2-active",this.hasItems)},i.prototype.onHide=function(){t("html").off(".nextendcontextmenu"),this.$menu.removeClass("n2-active"),this.isActive=!1},i.prototype.clearItems=function(){this.isActive&&this.onHide(),this.hasItems=!1,this.$menu.html("")},i.prototype.addItem=function(e,i,s){this.hasItems=!0,this.$menu.append(t('<div><i class="n2-i '+i+'"></i><span>'+e+"</span></div>").on("click",s))},t.fn.nextendContextMenu=function(e){return this.each(function(){new i(t(this),e)})},i}),N2D("Zoom",function(t,e){function i(e){this.currentContainerWidth=0,this.devices={unknownUnknown:t("<div />")},this.responsives=[],this.add(e);var i=e.parameters.sliderWidthToDevice.desktopPortrait;this.container=e.containerElement.closest(".n2-ss-container-device,.n2-ss-canvas-slider-container").add(e.containerElement.closest(".n2-ss-slider-outer-container")),this.container.width(i),this.containerWidth=i,this.initZoom();var s=t("#n2-ss-devices .n2-tr"),r=e.parameters.deviceModes;this.devices.desktopPortrait=t('<div class="n2-td n2-panel-option" data-device="desktop" data-orientation="portrait"><i class="n2-i n2-it n2-i-v-desktop"></i></div>').prependTo(s),r.desktopLandscape?this.devices.desktopLandscape=t('<div class="n2-td n2-panel-option" data-device="desktop" data-orientation="landscape"><i class="n2-i n2-it n2-i-v-desktop-landscape"></i></div>').prependTo(s):this.devices.desktopLandscape=this.devices.desktopPortrait,r.tabletPortrait?this.devices.tabletPortrait=t('<div class="n2-td n2-panel-option" data-device="tablet" data-orientation="portrait"><i class="n2-i n2-it n2-i-v-tablet"></i></div>').prependTo(s):this.devices.tabletPortrait=this.devices.desktopPortrait,r.tabletLandscape?this.devices.tabletLandscape=t('<div class="n2-td n2-panel-option" data-device="tablet" data-orientation="landscape"><i class="n2-i n2-it n2-i-v-tablet-landscape"></i></div>').prependTo(s):this.devices.tabletLandscape=this.devices.desktopLandscape,r.mobilePortrait?this.devices.mobilePortrait=t('<div class="n2-td n2-panel-option" data-device="mobile" data-orientation="portrait"><i class="n2-i n2-it n2-i-v-mobile"></i></div>').prependTo(s):this.devices.mobilePortrait=this.devices.tabletPortrait,r.mobileLandscape?this.devices.mobileLandscape=t('<div class="n2-td n2-panel-option" data-device="mobile" data-orientation="landscape"><i class="n2-i n2-it n2-i-v-mobile-landscape"></i></div>').prependTo(s):this.devices.mobileLandscape=this.devices.tabletLandscape,this.deviceOptions=t("#n2-ss-devices .n2-panel-option"),this.deviceOptions.each(t.proxy(function(e,i){t(i).on({mousedown:t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"zoomDeviceClicked"),click:t.proxy(this.setDeviceMode,this)})},this)),e.sliderElement.on("SliderDeviceOrientation",t.proxy(this.onDeviceOrientationChange,this))}var s=null;return i.add=function(t){s=new i(t),i.add=function(t){s.add(t)}},i.prototype.add=function(t){this.responsives.push(t),this.setOrientation("portrait"),t.parameters.onResizeEnabled=0,t.parameters.forceFull=0,t._getDevice=t._getDeviceZoom},i.prototype.onDeviceOrientationChange=function(e,i){t("#n2-admin").removeClass("n2-ss-mode-"+i.lastDevice+i.lastOrientation).addClass("n2-ss-mode-"+i.device+i.orientation),this.devices[i.lastDevice+i.lastOrientation].removeClass("n2-active"),this.devices[i.device+i.orientation].addClass("n2-active")},i.prototype.initZoom=function(){var e=t("#n2-ss-slider-zoom");e.length>0&&("undefined"!=typeof e[0].slide&&(e[0].slide=null),this.zoom=e.removeAttr("slide").prop("slide",!1).nUISlider({step:1,value:1,min:0,max:102}),this.$handle=e.data("nUISlider").handle,this.responsives[0].sliderElement.one("SliderResize",t.proxy(function(t){var e=this.responsives[0].containerElement.width();this.setContainerWidth(t,e,!0)},this)),this.zoom.on({"slide.n2-ss-zoom":t.proxy(this.zoomChange,this),"slidechange.n2-ss-zoom":t.proxy(this.zoomChange,this)}))},i.prototype.zoomChange=function(t,i){if(t.originalEvent!==e){var s,r=i.value,n=1;50>r?n=nextend.smallestZoom/this.containerWidth+Math.max(r/50,0)*(1-nextend.smallestZoom/this.containerWidth):r>52&&(n=1+(r-52)/50),s=parseInt(n*this.containerWidth),this.setContainerWidth(t,s)}},i.prototype.setContainerWidth=function(e,i,s){if(this.currentContainerWidth!=i){this.currentContainerWidth=i,this.$handle.html(i+"px"),this.container.width(i);for(var r=0;r<this.responsives.length;r++)this.responsives[r].doResize(e);if(s){var n=i/this.containerWidth,o=50;1>n?o=(n-nextend.smallestZoom/this.containerWidth)/(1-nextend.smallestZoom/this.containerWidth)*50:n>1&&(o=50*(n-1)+52),this.zoom.nUISlider("option","value",o)}t(window).trigger("resize")}},i.prototype.setDeviceMode=function(e){var i=t(e.currentTarget);if((e.ctrlKey||e.metaKey)&&this.responsives[0].slider.editor.fragmentEditor){var s=i.data("orientation");this.responsives[0].slider.editor.fragmentEditor.copyOrResetMode(i.data("device")+s[0].toUpperCase()+s.substr(1))}else this.setOrientation(i.data("orientation")),this.setContainerWidth(e,this.getModeWidth(i.data("device")),!0)},i.prototype.getModeWidth=function(t){var e,i=this.responsives[0];e=i.orientationMode==N2Classes.SmartSliderResponsive.OrientationMode.ADMIN_PORTRAIT?N2Classes.SmartSliderResponsive.DeviceOrientation.PORTRAIT:N2Classes.SmartSliderResponsive.DeviceOrientation.LANDSCAPE;var s=i.parameters.sliderWidthToDevice[t+N2Classes.SmartSliderResponsive._DeviceOrientation[e]];if("mobile"==t)switch(N2Classes.SmartSliderResponsive._DeviceOrientation[e]){case"Portrait":s=Math.max(nextend.smallestZoom,320)}return s},i.prototype.setOrientation=function(t){if("portrait"==t)for(var e=0;e<this.responsives.length;e++)this.responsives[e].orientationMode=N2Classes.SmartSliderResponsive.OrientationMode.ADMIN_PORTRAIT;else for(var e=0;e<this.responsives.length;e++)this.responsives[e].orientationMode=N2Classes.SmartSliderResponsive.OrientationMode.ADMIN_LANDSCAPE},i}),N2D("CreateSlider",function(t,e){function i(e,i,s){this.addToGroupModal=null,this.groupID=e,this.ajaxUrl=i,this.shouldSkipLicenseModal=s,t(".n2-ss-create-slider").click(t.proxy(function(t){t.preventDefault(),t.stopImmediatePropagation(),this.showModal()},this)),this.notificationStack=new N2Classes.NotificationStackModal(t("body")),t(".n2-ss-add-sample-slider").click(t.proxy(function(t){t.preventDefault(),t.stopImmediatePropagation(),this.showDemoSliders()},this)),"createslider"===window.location.hash.substring(1)&&this.showModal()}return i.prototype.showModal=function(){if(!this.createSliderModal){var e=this,i=this.ajaxUrl,s=[];s.push({key:"default",name:n2_("Default"),image:"$ss$/admin/images/sliderpresets/default.png"}),s.push({key:"fullwidth",name:n2_("Full width"),image:"$ss$/admin/images/sliderpresets/fullwidth.png"}),s.push({key:"thumbnailhorizontal",name:n2_("Thumbnail - horizontal"),image:"$ss$/admin/images/sliderpresets/thumbnailhorizontal.png"});var r=[550,540];this.createSliderModal=new N2Classes.NextendModal({zero:{size:r,title:n2_("Create Slider"),back:!1,close:!0,content:'<form class="n2-form"></form>',controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green n2-uc n2-h4">'+n2_("Create")+"</a>"],fn:{show:function(){var r=this.controls.find(".n2-button-green"),n=this.content.find(".n2-form").on("submit",function(t){t.preventDefault(),r.trigger("click")});n.append(this.createInput(n2_("Slider name"),"createslidertitle","width: 240px;")),n.append(this.createInputUnit(n2_("Width"),"createsliderwidth","px","width: 30px;")),n.append(this.createInputUnit(n2_("Height"),"createsliderheight","px","width: 30px;")),new N2Classes.FormElementAutocompleteSimple("createsliderwidth",["1920","1200","1000","800","600","400"]),new N2Classes.FormElementAutocompleteSimple("createsliderheight",["800","600","500","400","300","200"]);var o=t("#createslidertitle").val(n2_("Slider")).focus(),a=t("#createsliderwidth").val(1200),l=t("#createsliderheight").val(500);a.parent().addClass("n2-form-element-autocomplete"),l.parent().addClass("n2-form-element-autocomplete"),this.createHeading(n2_("Preset")).appendTo(this.content);var h=120,d=this.createImageRadio(s).css({height:h,display:"flex",flexWrap:"wrap"}).appendTo(this.content),p=d.find("input");d.css("overflow","hidden"),this.createHeading(n2_("Import Sample Sliders")).appendTo(this.content),t('<div class="n2-ss-create-slider-free-sample" style="background-image: url(\''+nextend.imageHelper.fixed("$ss$/admin/images/free/sample1.png")+'\')"></div><div class="n2-ss-create-slider-free-sample" style="background-image: url(\''+nextend.imageHelper.fixed("$ss$/admin/images/free/sample2.png")+'\')"></div><div class="n2-ss-create-slider-free-sample" style="background-image: url(\''+nextend.imageHelper.fixed("$ss$/admin/images/free/sample3.png")+"')\"></div>").on("click",t.proxy(function(){this.hide(),e.showDemoSliders()},this)).appendTo(this.content),r.on("click",t.proxy(function(){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(i,{nextendaction:"create"}),data:{groupID:e.groupID,sliderTitle:o.val(),sliderSizeWidth:a.val(),sliderSizeHeight:l.val(),preset:p.val()},dataType:"json"}).done(t.proxy(function(t){N2Classes.AjaxHelper.startLoading()},this))},this))}}}})}this.createSliderModal.show()},i.prototype.showDemoSliders=function(){var e=this;t("body").css("overflow","hidden");var i=0,s=t('<iframe src="//smartslider3.com/demo-import/?pro='+i+"&version="+N2SS3VERSION+"&utm_campaign="+N2SS3C+"&utm_source=import-slider-frame&utm_medium=smartslider-"+N2PLATFORM+"-"+(i?"pro":"free")+'" frameborder="0"></iframe>').css({position:"fixed",zIndex:1e5,left:0,top:0,width:"100%",height:"100%"}).appendTo("body"),r=function(){t("body").css("overflow",""),s.remove(),window.removeEventListener("message",o,!1),e.notificationStack.popStack()},n=function(t){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(e.ajaxUrl,{nextendaction:"importDemo"}),data:{groupID:e.groupID,key:N2Classes.Base64.encode(t.replace(/^(http(s)?:)?\/\//,"//"))},dataType:"json"}).fail(function(){})},o=function(t){if("http://smartslider3.com"===t.origin||"https://smartslider3.com"===t.origin){var e=t.data;switch(e.key){case"importSlider":return void("function"==typeof nextend.joinCommunity?nextend.joinCommunity(function(){n(e.data.href)}):n(e.data.href));case"closeWindow":r()}}};this.notificationStack.enableStack(),N2Classes.Esc.add(t.proxy(function(){return r(),!0},this)),window.addEventListener("message",o,!1)},i}),N2D("ManageSliders",function(t,e){function i(e,i,s){this.groupID=e,this.ajaxUrl=i,this.sliders=[],this.sliderPanel=t("#n2-ss-slider-container"),this.orderBy="ordering"==this.sliderPanel.data("orderby"),this.slidersContainer=this.sliderPanel.find(".n2-ss-sliders-container");for(var r=this.slidersContainer.find(".n2-ss-box-slider"),n=0;n<r.length;n++)this.sliders.push(new N2Classes.Slider(this,r.eq(n)));this.changed(),this.initMenu(),this.initOrderable(),this.create=new N2Classes.CreateSlider(e,i,s),this.initBulk()}return i.prototype.changed=function(){t("html").attr("data-sliders",this.sliders.length)},i.prototype.initSliders=function(){for(var e=this.slidersContainer.find(".n2-ss-box-slider"),i=[],s=0;s<e.length;s++){var r=e.eq(s).data("slider");i.push(r)}this.sliders=i,this.changed(),t(window).triggerHandler("SmartSliderSidebarSlidersChanged")},i.prototype.initOrderable=function(){if(this.orderBy){var e={helper:"clone",items:"> .n2-ss-box-slider",stop:t.proxy(this.saveOrder,this),placeholder:"n2-box-sortable-placeholder",distance:10};this.slidersContainer.nUISortable(e)}},i.prototype.saveOrder=function(e,i){for(var s=this.slidersContainer.find(".n2-ss-box-slider"),r=[],n=[],o=[],a=0;a<s.length;a++){var l=s.eq(a).data("slider");r.push(l),n.push(l.getId())}for(var a=0;a<this.sliders.length;a++)o.push(this.sliders[a].getId());if(JSON.stringify(o)!=JSON.stringify(n)){t(window).triggerHandler("SmartSliderSidebarSlidersOrderChanged");var h={nextendcontroller:"sliders",nextendaction:"order"};N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,h),data:{groupID:this.groupID,sliderorder:n,isReversed:"DESC"==this.sliderPanel.data("orderbydirection")?1:0}}),this.sliders=r}},i.prototype.initMenu=function(){this.slider=null,this.menu=t("#n2-ss-slider-menu").detach().addClass("n2-inited"),this.menuActions={duplicate:this.menu.find(".n2-ss-duplicate").on("click",t.proxy(function(t){this.slider.duplicate(t)},this)),"delete":this.menu.find(".n2-ss-delete").on("click",t.proxy(function(t){this.slider["delete"](t)},this)),preview:this.menu.find(".n2-ss-preview").on("click",t.proxy(function(t){this.slider.preview(t)},this))},this.menu.find(".n2-button").on("click",t.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.menu.hasClass("n2-active")?this.menu.removeClass("n2-active").off("mouseleave"):this.menu.addClass("n2-active").on("mouseleave",function(){t(this).removeClass("n2-active")})},this))},i.prototype.showMenu=function(t){this.slider=t,this.menu.appendTo(t.box)},i.prototype.hideMenu=function(){this.menu.hasClass("n2-active")&&this.menu.removeClass("n2-active").off("mouseleave"),this.menu.detach()},i.prototype.deleteSliders=function(e,i){this.hideMenu();var s=i[0].box.find(".n2-box-placeholder-title a").text();i.length>1&&(s+=" and "+(i.length-1)+" more"),N2Classes.NextendModal.deleteModal("slider-delete",s,t.proxy(function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"delete"}),type:"POST",data:{sliders:e}}).done(t.proxy(function(){for(var t=0;t<i.length;t++)i[t].deleted();this.initSliders(),this.leaveBulk()},this))},this))},i.prototype.duplicateSliders=function(e,i){for(var s=0;s<this.sliders.length;s++)this.sliders[s].selected&&this.sliders[s].duplicate(t.Event("click",{currentTarget:null}))},i.prototype.exportSliders=function(e,i){window.location.href=N2Classes.AjaxHelper.makeFallbackUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"exportAll"})+"&"+t.param({sliders:e,currentGroupID:this.groupID})},i.prototype.initBulk=function(){this.selection=[],this.isBulkSelection=!1;var e=t(".n2-bulk-select").find("a");e.eq(0).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.select()})},this)),e.eq(1).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.deSelect()})},this));t(".n2-bulk-actions").find("a").on("click",t.proxy(function(e){switch(e.preventDefault(),t(e.currentTarget).data("action")){case"duplicate":this.bulkAction("duplicateSliders",!1);break;case"delete":this.bulkAction("deleteSliders",!1);break;case"export":this.bulkAction("exportSliders",!1);break;case"addToGroup":this.bulkAction("addToGroup",!0)}},this))},i.prototype.addSelection=function(t){0==this.selection.length&&this.enterBulk(),this.selection.push(t)},i.prototype.removeSelection=function(e){this.selection.splice(t.inArray(e,this.selection),1),0==this.selection.length&&this.leaveBulk()},i.prototype.bulkSelect=function(t){for(var e=0;e<this.sliders.length;e++)t(this.sliders[e])},i.prototype.bulkAction=function(t,e){var i=[],s=[];this.bulkSelect(function(t){!t.selected||e&&t.isGroup||(i.push(t),s.push(t.getId()))}),s.length?(this[t](s,i),this.leaveBulk()):e?N2Classes.Notification.notice("Please select one or more sliders for the action!"):N2Classes.Notification.notice("Please select one or more sliders or groups for the action!")},i.prototype.enterBulk=function(){this.isBulkSelection||(this.isBulkSelection=!0,this.orderBy&&this.slidersContainer.nUISortable("option","disabled",!0),t("#n2-admin").addClass("n2-ss-has-box-selection"))},i.prototype.leaveBulk=function(){if(this.isBulkSelection){this.orderBy&&this.slidersContainer.nUISortable("option","disabled",!1),t("#n2-admin").removeClass("n2-ss-has-box-selection");for(var e=0;e<this.sliders.length;e++)this.sliders[e].deSelect();this.selection=[],this.isBulkSelection=!1}},i}),N2D("Slider",function(t,e){function i(e,i){this.selected=!1,this.manager=e,this.box=i.data("slider",this).addClass("n2-clickable"),this.isGroup=this.box.hasClass("n2-ss-box-slider-group"),this.box.on("mouseenter",t.proxy(function(){this.manager.showMenu(this)},this)).on("mouseleave",t.proxy(function(){this.manager.hideMenu()},this)).on("click.n2-slider",t.proxy(this.goToEdit,this)),this.box.find(".n2-ss-box-select").on("click",t.proxy(function(t){t.stopPropagation(),t.preventDefault(),this.invertSelection()},this))}return i.prototype.getId=function(){return this.box.data("sliderid")},i.prototype.goToEdit=function(t,e){if("A"!==t.target.tagName){var i=this.box.data("editurl");"undefined"!=typeof e&&e?window.open(i,"_blank"):window.location=i}},i.prototype.preview=function(t){t.stopPropagation(),t.preventDefault(),window.open(N2Classes.AjaxHelper.makeFallbackUrl(this.box.data("editurl"),{nextendcontroller:"preview",nextendaction:"index"}),"_blank")},i.prototype.duplicate=function(e){e.stopPropagation(),e.preventDefault();var s=t.Deferred();return N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.box.data("editurl"),{nextendcontroller:"slider",nextendaction:"duplicate"})}).done(t.proxy(function(e){var r=t(e.data).insertAfter(this.box),n=new i(this.manager,r);this.manager.initSliders(),s.resolve(n)},this)),s},i.prototype["delete"]=function(t){t.stopPropagation(),t.preventDefault(),this.manager.deleteSliders([this.getId()],[this])},i.prototype.deleted=function(){this.box.remove()},i.prototype.invertSelection=function(t){t&&t.preventDefault(),this.selected?this.deSelect():this.select()},i.prototype.select=function(){this.selected||(this.selected=!0,this.box.addClass("n2-selected"),this.manager.addSelection(this))},i.prototype.deSelect=function(){this.selected&&(this.selected=!1,this.box.removeClass("n2-selected"),this.manager.removeSelection(this))},i}),N2D("FormElementAnimationManager",["FormElement"],function(t,e){function i(e,i){this.element=t("#"+e),this.managerIdentifier=i,this.element.parent().on("click",t.proxy(this.show,this)),this.element.siblings(".n2-form-element-clear").on("click",t.proxy(this.clear,this)),this.name=this.element.siblings("input"),this.updateName(this.element.val()),N2Classes.FormElement.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.show=function(e){e.preventDefault(),nextend[this.managerIdentifier].show(this.element.val(),t.proxy(this.save,this))},i.prototype.clear=function(t){t.preventDefault(),t.stopPropagation(),this.val("")},i.prototype.save=function(t,e){this.val(e)},i.prototype.val=function(t){this.element.val(t),this.updateName(t),this.triggerOutsideChange()},i.prototype.insideChange=function(t){this.element.val(t),this.updateName(t),this.triggerInsideChange()},i.prototype.updateName=function(t){t=""==t?n2_("Disabled"):t.split("||").length>1?n2_("Multiple animations"):n2_("Single animation"),this.name.val(t)},i}),N2D("FormElementBackground",["FormElement"],function(t,e){function i(e,i){this.value="",this.element=t("#"+e),this.$container=this.element.closest(".n2-form-tab"),this.panel=t("#"+e+"-panel"),this.setValue(i),this.options=this.panel.find(".n2-subform-image-option").on("click",t.proxy(this.selectOption,this)),this.active=this.getIndex(this.options.filter(".n2-active").get(0)),this.element.on("change",t.proxy(function(){this.insideChange(this.element.val())},this)),N2Classes.FormElement.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.selectOption=function(e){var i=this.getIndex(e.currentTarget);if(i!=this.active){this.options.eq(i).addClass("n2-active"),this.options.eq(this.active).removeClass("n2-active"),this.active=i;var s=t(e.currentTarget).data("value");this.insideChange(s)}},i.prototype.setValue=function(t){this.$container.removeClass("n2-ss-background-type-"+this.value),this.value=t,this.$container.addClass("n2-ss-background-type-"+this.value)},i.prototype.insideChange=function(t){this.setValue(t),this.element.val(t),this.options.removeClass("n2-active"),this.options.filter('[data-value="'+t+'"]').addClass("n2-active"),this.triggerInsideChange()},i.prototype.getIndex=function(e){return t.inArray(e,this.options)},i}),N2D("FormElementColumns",["FormElement"],function(t,e){function i(e){this.denominators={1:100,2:100,3:144,4:100,5:100,6:144},this.element=t("#"+e),N2Classes.FormElement.prototype.constructor.apply(this,arguments),this.$c=t("#"+e).parent(),this.$container=this.$c.find(".n2-ss-columns-element-container"),this.containerWidth=284,this.maxWidth=0,this.$container.nUISortable({axis:"x",items:".n2-ss-columns-element-column",helper:"clone_hide",start:t.proxy(function(t,e){this.$container.addClass("n2-sortable-currently-sorted"),e.placeholder.css({width:e.item.width(),visibility:"hidden"});var i=this.$container.find(".n2-ss-columns-element-column");e.item.data("index",i.index(e.item))},this),stop:t.proxy(function(t,e){var i=this.$container.find(".n2-ss-columns-element-column"),s=e.item.data("index"),r=i.index(e.item);s!=r&&(this.currentRow.moveCol(s,r),e.item.data("index",null)),this.makeResizable(),this.$container.removeClass("n2-sortable-currently-sorted")},this)}),this.$c.find(".n2-ss-columns-element-add-col").on({click:t.proxy(function(){this.currentRow.createCol()},this)})}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.getDenominator=function(t){return this.denominators[t]===e&&(this.denominators[t]=15*t),this.denominators[t]},i.prototype.setRow=function(t){this.currentRow=t,this.insideChange(t.getColumnsOrdered())},i.prototype.setValue=function(t){},i.prototype.insideChange=function(t){this.start(t)},i.prototype.activateColumn=function(t){var e=this.$container.find(".n2-ss-columns-element-column").index(t.currentTarget);this.currentRow.activateColumn(e,t)},i.prototype.start=function(e){this.percentages=[];for(var i=e.split("+"),s=0;s<i.length;s++)this.percentages.push(new Fraction(i[s]));this.refreshMaxWidth(),this.$container.empty();for(var s=0;s<this.percentages.length;s++)this.updateColumn(t('<div class="n2-ss-columns-element-column">').on("click",t.proxy(this.activateColumn,this)).appendTo(this.$container),this.percentages[s]);this.makeResizable()},i.prototype.refreshMaxWidth=function(){this.maxWidth=this.containerWidth-15*(this.percentages.length-1)},i.prototype.updateColumn=function(t,e){t.css("width",this.maxWidth*e.valueOf()+"px").html(Math.round(100*e.valueOf()*10)/10+"%")},i.prototype.makeResizable=function(){this.handles&&this.handles.remove(),this.$columns=this.$container.find(".n2-ss-columns-element-column"),t('<div class="n2-ss-columns-element-handle"><div class="n2-i n2-i-more"></div></div>').insertAfter(this.$columns.not(this.$columns.last())),this.handles=this.$container.find(".n2-ss-columns-element-handle").on("mousedown",t.proxy(this._resizeStart,this))},i.prototype._resizeStart=function(e){var i=this.handles.index(e.currentTarget),s=this.$container.offset().left+8;this.resizeContext={index:i,cLeft:s,$currentCol:this.$columns.eq(i),$nextCol:this.$columns.eq(i+1),startX:Math.max(0,Math.min(e.clientX-s,this.containerWidth))},this._resizeMove(e),t("html").off(".resizecol").on({"mousemove.resizecol":t.proxy(this._resizeMove,this),"mouseup.resizecol mouseleave.resizecol":t.proxy(this._resizeStop,this)})},i.prototype._resizeMove=function(e){e.preventDefault();var i=Math.max(0,Math.min(e.clientX-this.resizeContext.cLeft,this.containerWidth)),s=this.getDenominator(this.percentages.length),r=new Fraction(Math.round((i-this.resizeContext.startX)/(this.maxWidth/s)),s);r.compare(this.percentages[this.resizeContext.index].clone().mul(-1))<0&&(r=this.percentages[this.resizeContext.index].clone().mul(-1)),r.compare(this.percentages[this.resizeContext.index+1])>0&&(r=this.percentages[this.resizeContext.index+1].clone());var n=this.percentages[this.resizeContext.index].add(r),o=this.percentages[this.resizeContext.index+1].sub(r);this.updateColumn(this.resizeContext.$currentCol,n),this.updateColumn(this.resizeContext.$nextCol,o);var a=t.extend([],this.percentages);return a[this.resizeContext.index]=n,a[this.resizeContext.index+1]=o,this.onColumnWidthChange(a),[n,o]},i.prototype._resizeStop=function(e){var i=this._resizeMove(e);this.percentages[this.resizeContext.index]=i[0],this.percentages[this.resizeContext.index+1]=i[1],t("html").off(".resizecol"),delete this.resizeContext,this.currentRow.setRealColsWidth(this.percentages)},i.prototype.onColumnWidthChange=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].valueOf());this.currentRow.updateColumnWidth(e)},i}),function(t){"use strict";function e(t,e){return isNaN(t=parseInt(t,10))&&i(),t*e}function i(){throw"Invalid Param"}function s(t,e){return this instanceof s?(o(t,e),t=s.REDUCE?d(n.d,n.n):1,this.s=n.s,this.n=n.n/t,void(this.d=n.d/t)):new s(t,e)}var r=2e3,n={s:1,n:0,d:1},o=function(t,s){var r,o=0,a=1,l=1,h=0,d=0,p=0,c=1,u=1,y=0,g=1,f=1,m=1,v=1e7;if(void 0===t||null===t);else if(void 0!==s)o=t,a=s,l=o*a;else switch(typeof t){case"object":"d"in t&&"n"in t?(o=t.n,a=t.d,"s"in t&&(o*=t.s)):0 in t?(o=t[0],1 in t&&(a=t[1])):i(),l=o*a;break;case"number":if(0>t&&(l=t,t=-t),t%1===0)o=t;else if(t>0){for(t>=1&&(u=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)),t/=u);v>=g&&v>=m;){if(r=(y+f)/(g+m),t===r){v>=g+m?(o=y+f,a=g+m):m>g?(o=f,a=m):(o=y,a=g);break}t>r?(y+=f,g+=m):(f+=y,m+=g),g>v?(o=f,a=m):(o=y,a=g)}o*=u}else(isNaN(t)||isNaN(s))&&(a=o=NaN);break;case"string":if(g=t.match(/\d+|./g),"-"===g[y]?(l=-1,y++):"+"===g[y]&&y++,g.length===y+1?d=e(g[y++],l):"."===g[y+1]||"."===g[y]?("."!==g[y]&&(h=e(g[y++],l)),y++,(y+1===g.length||"("===g[y+1]&&")"===g[y+3]||"'"===g[y+1]&&"'"===g[y+3])&&(d=e(g[y],l),c=Math.pow(10,g[y].length),y++),("("===g[y]&&")"===g[y+2]||"'"===g[y]&&"'"===g[y+2])&&(p=e(g[y+1],l),u=Math.pow(10,g[y+1].length)-1,y+=3)):"/"===g[y+1]||":"===g[y+1]?(d=e(g[y],l),c=e(g[y+2],1),y+=3):"/"===g[y+3]&&" "===g[y+1]&&(h=e(g[y],l),d=e(g[y+2],l),c=e(g[y+4],1),y+=5),g.length<=y){a=c*u,l=o=p+a*h+u*d;break}default:i()}if(0===a)throw"DIV/0";n.s=0>l?-1:1,n.n=Math.abs(o),n.d=Math.abs(a)},a=function(t,e,i){for(var s=1;e>0;t=t*t%i,e>>=1)1&e&&(s=s*t%i);return s},l=function(t,e){for(;e%2===0;e/=2);for(;e%5===0;e/=5);if(1===e)return 0;for(var i=10%e,s=1;1!==i;s++)if(i=10*i%e,s>r)return 0;return s},h=function(t,e,i){for(var s=1,r=a(10,i,e),n=0;300>n;n++){if(s===r)return n;s=10*s%e,r=10*r%e}return 0},d=function(t,e){if(!t)return e;if(!e)return t;for(;;){if(t%=e,!t)return e;if(e%=t,!e)return t}};s.REDUCE=1,s.prototype={s:1,n:0,d:1,abs:function(){return new s(this.n,this.d)},neg:function(){return new s(-this.s*this.n,this.d)},add:function(t,e){return o(t,e),new s(this.s*this.n*n.d+n.s*this.d*n.n,this.d*n.d)},sub:function(t,e){return o(t,e),new s(this.s*this.n*n.d-n.s*this.d*n.n,this.d*n.d)},mul:function(t,e){return o(t,e),new s(this.s*n.s*this.n*n.n,this.d*n.d)},div:function(t,e){return o(t,e),new s(this.s*n.s*this.n*n.d,this.d*n.n)},clone:function(){return new s(this)},mod:function(t,e){return isNaN(this.n)||isNaN(this.d)?new s(NaN):void 0===t?new s(this.s*this.n%this.d,1):(o(t,e),0===n.n&&0===this.d&&s(0,0),new s(this.s*n.d*this.n%(n.n*this.d),n.d*this.d))},gcd:function(t,e){return o(t,e),new s(d(n.n,this.n),n.d*this.d/d(n.d,this.d))},lcm:function(t,e){return o(t,e),0===n.n&&0===this.n?new s:new s(n.n*this.n/d(n.n,this.n),d(n.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new s(NaN):new s(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new s(NaN):new s(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new s(NaN):new s(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return new s(this.s*this.d,this.n)},pow:function(t){return 0>t?new s(Math.pow(this.s*this.d,-t),Math.pow(this.n,-t)):new s(Math.pow(this.s*this.n,t),Math.pow(this.d,t))},equals:function(t,e){return o(t,e),this.s*this.n*n.d===n.s*n.n*this.d},compare:function(t,e){o(t,e);var i=this.s*this.n*n.d-n.s*n.n*this.d;return(i>0)-(0>i)},divisible:function(t,e){return o(t,e),!(!(n.n*this.d)||this.n*n.d%(n.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,i="",s=this.n,r=this.d;return this.s<0&&(i+="-"),1===r?i+=s:(t&&(e=Math.floor(s/r))>0&&(i+=e,i+=" ",s%=r),i+=s,i+="/",i+=r),i},toLatex:function(t){var e,i="",s=this.n,r=this.d;return this.s<0&&(i+="-"),1===r?i+=s:(t&&(e=Math.floor(s/r))>0&&(i+=e,s%=r),i+="\\frac{",i+=s,i+="}{",i+=r,i+="}"),i},toContinued:function(){var t,e=this.n,i=this.d,s=[];do s.push(Math.floor(e/i)),t=e%i,e=i,i=t;while(1!==e);return s},toString:function(){var t,e=this.n,i=this.d;if(isNaN(e)||isNaN(i))return"NaN";s.REDUCE||(t=d(e,i),e/=t,i/=t);for(var r=String(e).split(""),n=0,o=[~this.s?"":"-","",""],a="",p=l(e,i),c=h(e,i,p),u=-1,y=1,g=15+p+c+r.length,f=0;g>f;f++,n*=10){if(f<r.length?n+=Number(r[f]):(y=2,u++),p>0)if(u===c)o[y]+=a+"(",a="";else if(u===p+c){o[y]+=a+")";break}n>=i?(o[y]+=a+(n/i|0),a="",n%=i):y>1?a+="0":o[y]&&(o[y]+="0")}return o[0]+=o[1]||"0",o[2]?o[0]+"."+o[2]:o[0]}},t.Fraction=s}(window),N2D("FormElementSliderType",function(t,e){function i(e){this.element=t("#"+e),this.setAttribute(),this.element.on("nextendChange",t.proxy(this.setAttribute,this))}return i.prototype.setAttribute=function(){var e=this.element.val();t("#n2-admin").data("slider-type",e).attr("data-slider-type",e),"block"===this.element.val()&&t(".n2-fm-shadow").trigger("click")},i}),N2D("FormElementSliderWidgetArea",["FormElement"],function(t,e){function i(e){this.element=t("#"+e),this.area=t("#"+e+"_area"),this.areas=this.area.find(".n2-area"),this.areas.on("click",t.proxy(this.chooseArea,this)),N2Classes.FormElement.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.FormElement.prototype),i.prototype.constructor=i,i.prototype.chooseArea=function(e){var i=parseInt(t(e.target).data("area"));this.element.val(i),this.setSelected(i),this.triggerOutsideChange()},i.prototype.insideChange=function(t){t=parseInt(t),this.element.val(t),this.setSelected(t),this.triggerInsideChange()},i.prototype.setSelected=function(t){this.areas.removeClass("n2-active"),this.areas.eq(t-1).addClass("n2-active")},i}),N2D("FormElementWidgetPosition",function(t,e){function i(e){this.element=t("#"+e+"-mode"),this.container=this.element.closest(".n2-form-element-mixed"),this.tabs=this.container.find("> .n2-mixed-group"),this.element.on("nextendChange",t.proxy(this.onChange,this)),this.onChange()}return i.prototype.onChange=function(){var t=this.element.val();"advanced"===t?(this.tabs.eq(2).css("display",""),this.tabs.eq(1).css("display","none")):(this.tabs.eq(1).css("display",""),this.tabs.eq(2).css("display","none"))},i}),N2D("SmartSliderGeneratorRecords",function(t,e){function i(e){this.ajaxUrl=e,t("#generatorrecord-viewer").on("click",t.proxy(this.showRecords,this))}return i.prototype.showRecords=function(e){
e.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.ajaxUrl,data:t("#smartslider-form").serialize(),dataType:"json"}).done(function(t){var e=new N2Classes.NextendModal({zero:{size:[1300,700],title:"Records",content:t.data.html}},!0);e.content.css("overflow","auto")}).error(function(t){if(200==t.status){var e=new N2Classes.NextendModal({zero:{size:[1300,700],title:"Response",content:t.responseText}},!0);e.content.css("overflow","auto")}})},i}),N2D("QuickSlides",function(t,e){function i(e){var i=t("#n2-quick-slides-edit");i.length<1||(this.ajaxUrl=e,i.on("click",t.proxy(this.openEdit,this)))}return i.prototype.openEdit=function(e){e.preventDefault();var i=t("#n2-ss-slides .n2-box-slide"),s=this;this.modal=new N2Classes.NextendModal({zero:{fit:!0,fitX:!1,overflow:"auto",size:[1200,700],title:n2_("Quick Edit - Slides"),back:!1,close:!0,content:'<form class="n2-form"><table></table></form>',controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green n2-uc n2-h4">'+n2_("Save")+"</a>"],fn:{show:function(){var e=this.controls.find(".n2-button-green"),r=this.content.find(".n2-form").on("submit",function(t){t.preventDefault(),e.trigger("click")}),n=r.find("table");i.each(t.proxy(function(e,i){var r=t(i),o=t("<tr />").appendTo(n),a=r.data("slideid");o.append(t("<td />").append('<img src="'+r.data("image")+'" style="width:100px;"/>')),o.append(t("<td />").append(s.createInput(n2_("Name"),"title-"+a,r.data("title"),"width: 240px;"))),o.append(t("<td />").append(s.createTextarea(n2_("Description"),"description-"+a,r.data("description"),"width: 330px;height:24px;"))),o.append(t("<td />").append(s.createLink(n2_("Link"),"link-"+a,r.data("link"),"width: 180px;")));var l=r.data("href-target");"string"!=typeof l&&(l="_self"),o.append(t("<td />").append(s.createTarget(n2_("Target window"),"target-"+a,l,""))),new N2Classes.FormElementUrl("link-"+a,nextend.NextendElementUrlParams)},this)),e.on("click",t.proxy(function(e){var r={};i.each(t.proxy(function(e,i){var s=t(i),n=s.data("slideid"),o=t("#title-"+n).val(),a=t("#description-"+n).val(),l=t("#link-"+n).val(),h=t("#target-"+n).val();o==s.data("title")&&a==s.data("description")&&l==s.data("link")&&h==s.data("href-target")||(r[n]={name:o,description:a,link:l,hreftarget:h})},this)),jQuery.isEmptyObject(r)?this.hide(e):(this.hide(e),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(s.ajaxUrl),data:{changed:N2Classes.Base64.encode(JSON.stringify(r))},dataType:"json"}).done(t.proxy(function(e){var i=e.data;for(var s in i){var r=t('.n2-box-slide[data-slideid="'+s+'"]');r.find(".n2-box-placeholder a.n2-h4").html(i[s].title),r.attr("data-title",i[s].rawTitle),r.data("title",i[s].rawTitle),r.attr("data-description",i[s].rawDescription),r.data("description",i[s].rawDescription),r.attr("data-link",i[s].rawLink),r.data("link",i[s].rawLink),r.data("href-target",i[s].rawLinkHref)}},this)))},this))}}}}),this.modal.setCustomClass("n2-ss-quick-slides-edit-modal"),this.modal.show()},i.prototype.createInput=function(e,i,s){var r="";4==arguments.length&&(r=arguments[3]);var n=t('<div class="n2-form-element-mixed"><div class="n2-mixed-group"><div class="n2-mixed-label"><label for="'+i+'">'+e+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-text n2-border-radius"><input type="text" id="'+i+'" class="n2-h5" autocomplete="off" style="'+r+'"></div></div></div></div>');return n.find("input").val(s),n},i.prototype.createTextarea=function(e,i,s){var r="";4==arguments.length&&(r=arguments[3]);var n=t('<div class="n2-form-element-mixed"><div class="n2-mixed-group"><div class="n2-mixed-label"><label for="'+i+'">'+e+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-textarea n2-border-radius"><textarea id="'+i+'" class="n2-h5" autocomplete="off" style="resize:y;'+r+'"></textarea></div></div></div></div>');return n.find("textarea").val(s),n},i.prototype.createLink=function(e,i,s){var r="";4==arguments.length&&(r=arguments[3]);var n=t('<div class="n2-form-element-mixed"><div class="n2-mixed-group"><div class="n2-mixed-label"><label for="'+i+'">'+e+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-text n2-border-radius"><input type="text" id="'+i+'" class="n2-h5" autocomplete="off" style="'+r+'"><a href="#" class="n2-form-element-clear"><i class="n2-i n2-it n2-i-empty n2-i-grey-opacity"></i></a><a id="'+i+'_button" class="n2-form-element-button n2-h5 n2-uc" href="#">Link</a></div></div></div></div>');return n.find("input").val(s),n},i.prototype.createTarget=function(e,i,s){var r="";4==arguments.length&&(r=arguments[3]);var n=t('<div class="n2-form-element-mixed"><div class="n2-mixed-group"><div class="n2-mixed-label"><label for="'+i+'">'+e+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-list"><select id="'+i+'" autocomplete="off" style="'+r+'"><option value="_self">Self</option><option value="_blank">New</option><option value="_parent">Parent</option><option value="_top">Top</option></select></div></div></div></div>');return n.find("select").val(s),n},i}),N2D("Slide",function(t,e){function i(e,i){this.selected=!1,this.manager=e,this.box=i.data("slide",this).addClass("n2-clickable"),this.box.on("mouseenter",t.proxy(function(){this.manager.showMenu(this)},this)).on("mouseleave",t.proxy(function(){this.manager.hideMenu()},this)).on("click.n2-slide",t.proxy(this.goToEdit,this)),this.publishElement=this.box.find(".n2-slide-published").on("click",t.proxy(this.switchPublished,this)),this.box.find(".n2-ss-box-select").on("click",t.proxy(function(t){t.stopPropagation(),t.preventDefault(),this.invertSelection()},this))}return i.prototype.getId=function(){return this.box.data("slideid")},i.prototype.setFirst=function(e){e.stopPropagation(),e.preventDefault(),N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendaction:"first"}),type:"POST",data:{id:this.getId()}}).done(t.proxy(function(){this.manager.unsetFirst(),this.box.addClass("n2-slide-state-first")},this))},i.prototype.unsetFirst=function(){this.box.removeClass("n2-slide-state-first")},i.prototype.switchPublished=function(t){t.stopPropagation(),t.preventDefault(),this.isPublished()?this.manager.unPublishSlides([this.getId()],[this]):this.manager.publishSlides([this.getId()],[this])},i.prototype.isPublished=function(){return this.box.hasClass("n2-slide-state-published")},i.prototype.published=function(){this.box.addClass("n2-slide-state-published")},i.prototype.unPublished=function(){this.box.removeClass("n2-slide-state-published")},i.prototype.goToEdit=function(e,i){if(this.manager.isBulkSelection)this.invertSelection(),e.preventDefault();else if("A"!==e.target.tagName){var s=this.box.data("editurl");"undefined"!=typeof i&&i?window.open(s,"_blank"):s===location.href?t("#n2-admin").toggleClass("n2-ss-slides-outer-container-visible"):window.location=s}},i.prototype.duplicate=function(e){e.stopPropagation(),e.preventDefault();var s=t.Deferred();return N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.box.data("editurl"),{nextendaction:"duplicate"})}).done(t.proxy(function(e){var r=t(e.data).insertAfter(this.box),n=new i(this.manager,r);this.manager.initSlides(),s.resolve(n)},this)),s},i.prototype["delete"]=function(t){t.stopPropagation(),t.preventDefault(),this.manager.deleteSlides([this.getId()],[this])},i.prototype.deleted=function(){this.box.remove()},i.prototype.invertSelection=function(t){t&&t.preventDefault(),this.selected?this.deSelect():this.select()},i.prototype.select=function(){this.selected||(this.selected=!0,this.box.addClass("n2-selected"),this.manager.addSelection(this))},i.prototype.deSelect=function(){this.selected&&(this.selected=!1,this.box.removeClass("n2-selected"),this.manager.removeSelection(this))},i.prototype.publish=function(t){this.switchPublished(t)},i.prototype.unpublish=function(t){this.switchPublished(t)},i.prototype.generator=function(t){window.location=this.box.data("generator")},i.prototype.copy=function(e){this.manager.showSliderSelector(n2_("Copy slide to ..."),t.proxy(function(t){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.box.data("editurl"),{nextendaction:"copy",targetSliderID:t.sliderID})})},this))},i}),N2D("SlidesManager",function(t,e){function i(i,s,r,n,o,a){this.quickPostModal=null,this.quickVideoModal=null,this.parameters=r,this.slides=[],this.ajaxUrl=i,this.contentAjaxUrl=s,this.slidesPanel=t("#n2-ss-slides-container"),this.slidesContainer=this.slidesPanel.find(".n2-ss-slides-container"),this.initMenu(),this.initSlidesOrderable();for(var l=this.slidesContainer.find(".n2-box-slide"),h=0;h<l.length;h++)this.slides.push(new N2Classes.Slide(this,l.eq(h)));if(t("body").attr("data-slides",this.slides.length),t("#n2-ss-slides").find(".n2-ss-slides-create-action-box").on("mouseup",t.proxy(function(i){i.preventDefault();var s=0;if(i.which!==e&&(s=i.which),2>=s)switch(t(i.currentTarget).data("action")){case"image":this.addQuickImage(i);break;case"video":this.addQuickVideo(i);break;case"post":this.addQuickPost(i);break;case"empty":case"static":case"dynamic":2===s?window.open(t(i.currentTarget).data("href"),"_blank").focus():window.location=t(i.currentTarget).data("href");break;case"library":2===s?window.open(t(i.currentTarget).data("href"),"_blank").focus():window.location=t(i.currentTarget).data("href")}},this)),t(".n2-box-slide-dummy").on("click",t.proxy(this.addQuickImage,this)),this.initBulk(),!n){var d=[];this.slidesContainer.nUIFileUpload({url:o,pasteZone:!1,dataType:"json",paramName:"image",dropZone:t(".n2-ss-slides-outer-container"),add:t.proxy(function(t,e){e.formData={path:"/"+a},e.submit()},this),done:t.proxy(function(t,e){var i=e.result;i.data&&i.data.name?d.push({title:i.data.name.replace(/\.[^\/.]+$/,""),description:"",image:i.data.url}):N2Classes.AjaxHelper.notification(i)},this),fail:t.proxy(function(t,e){N2Classes.AjaxHelper.notification(e.jqXHR.responseJSON)},this),start:function(){N2Classes.AjaxHelper.startLoading()},stop:t.proxy(function(){d.length?this._addQuickImages(d):setTimeout(function(){N2Classes.AjaxHelper.stopLoading()},100),d=[]},this)});var p=null;this.slidesContainer.on("dragover",t.proxy(function(e){null!==p?(clearTimeout(p),p=null):this.slidesContainer.addClass("n2-drag-over"),p=setTimeout(t.proxy(function(){this.slidesContainer.removeClass("n2-drag-over"),p=null},this),400)},this))}}return i.prototype.changed=function(){},i.prototype.initSlidesOrderable=function(){this.slidesContainer.nUISortable({items:".n2-box-slide",stop:t.proxy(this.saveSlideOrder,this),placeholder:"n2-box-sortable-placeholder n2-box-sortable-placeholder-small",distance:10,helper:"clone"})},i.prototype.saveSlideOrder=function(e){for(var i=this.slidesContainer.find(".n2-box-slide"),s=[],r=[],n=[],o=0;o<i.length;o++){var a=i.eq(o).data("slide");s.push(a),r.push(a.getId())}for(var o=0;o<this.slides.length;o++)n.push(this.slides[o].getId());if(JSON.stringify(n)!=JSON.stringify(r)){t(window).triggerHandler("SmartSliderSidebarSlidesOrderChanged");var l={nextendcontroller:"slides",nextendaction:"order"};N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,l),data:{slideorder:r}}),this.slides=s,this.changed()}},i.prototype.initSlides=function(){for(var e=this.slidesContainer.find(".n2-box-slide"),i=[],s=0;s<e.length;s++){var r=e.eq(s).data("slide");i.push(r)}this.slides=i,this.changed(),t(window).triggerHandler("SmartSliderSidebarSlidesChanged"),t("body").attr("data-slides",this.slides.length)},i.prototype.unsetFirst=function(){for(var t=0;t<this.slides.length;t++)this.slides[t].unsetFirst();this.changed()},i.prototype.addQuickImage=function(e){e.preventDefault(),nextend.imageHelper.openMultipleLightbox(t.proxy(this._addQuickImages,this))},i.prototype.addBoxes=function(e){e.insertBefore(this.slidesContainer.find(".n2-clear")),e.addClass("n2-ss-box-just-added").each(t.proxy(function(e,i){new N2Classes.Slide(this,t(i))},this)),this.initSlides(),setTimeout(function(){e.removeClass("n2-ss-box-just-added")},200)},i.prototype._addQuickImages=function(e){for(var i=[],s=0;s<e.length;s++)e[s].image.match(/\.(mp4)/i)?N2Classes.Notification.error("MP4 videos are not supported in the Free version!"):i.push(e[s]);i.length&&N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"quickImages"}),data:{images:N2Classes.Base64.encode(JSON.stringify(i))}}).done(t.proxy(function(e){this.addBoxes(t(e.data))},this))},i.prototype.addQuickVideo=function(e){e.preventDefault();var i=this;this.quickVideoModal||(this.quickVideoModal=new N2Classes.NextendModal({zero:{size:[500,360],title:n2_("Add video"),back:!1,close:!0,content:'<form class="n2-form"></form>',controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green n2-uc n2-h4">'+n2_("Add video")+"</a>"],fn:{show:function(){var e=this.controls.find(".n2-button"),s=(this.content.find(".n2-form").on("submit",function(t){t.preventDefault(),e.trigger("click")}).append(this.createInput(n2_("Video url"),"n2-slide-video-url","width: 446px;")),this.content.find("#n2-slide-video-url").focus());this.content.append(this.createHeading(n2_("Examples"))),this.content.append(this.createTable([["YouTube","https://www.youtube.com/watch?v=lsq09izc1H4"],["Vimeo","https://vimeo.com/144598279"]],["",""])),e.on("click",t.proxy(t.proxy(function(e){e.preventDefault();var r=s.val(),n=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,o=r.match(n),a=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,l=r.match(a),h=r.match(/\.(mp4)/i);o?N2Classes.AjaxHelper.getJSON("https://www.googleapis.com/youtube/v3/videos?id="+encodeURI(o[2])+"&part=snippet&key=AIzaSyC3AolfvPAPlJs-2FgyPJdEEKS6nbPHdSM").done(t.proxy(function(t){if(t.items.length){var e=t.items[0].snippet,s=t.items[0].snippet.thumbnails,n=s.maxres||s.standard||s.high||s.medium||s["default"];i._addQuickVideo(this,{type:"youtube",title:e.title,description:e.description,image:n.url,video:r})}},this)).fail(function(t){N2Classes.Notification.error(t.error.errors[0].message)}):l?N2Classes.AjaxHelper.getJSON("https://vimeo.com/api/v2/video/"+l[3]+".json").done(t.proxy(function(t){i._addQuickVideo(this,{type:"vimeo",title:t[0].title,description:t[0].description,video:l[3],image:t[0].thumbnail_large})},this)).fail(function(t){N2Classes.Notification.error("Video not found or private."),i._addQuickVideo(this,{type:"vimeo",title:"",description:"",video:l[3],image:""})}):h?N2Classes.Notification.error(n2_("This video url is not supported!")):N2Classes.Notification.error(n2_("This video url is not supported!"))},this)))}}}})),this.quickVideoModal.show()},i.prototype._addQuickVideo=function(e,i){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"quickVideo"}),data:{video:N2Classes.Base64.encode(encodeURIComponent(JSON.stringify(i)))}}).done(t.proxy(function(e){this.addBoxes(t(e.data)),this.initSlides()},this)),e&&e.hide()},i.prototype.addQuickPost=function(e){if(e.preventDefault(),!this.quickPostModal){var i=this,s={},r=t.proxy(function(t){return"undefined"==typeof s[t]&&(s[t]=N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.contentAjaxUrl),data:{keyword:t},dataType:"json"})),s[t]},this);this.quickPostModal=new N2Classes.NextendModal({zero:{size:[600,430],title:n2_("Add post"),back:!1,close:!0,content:'<div class="n2-form"></div>',fn:{show:function(){this.content.find(".n2-form").append(this.createInput(n2_("Keyword"),"n2-ss-keyword","width:546px;"));var e=t("#n2-ss-keyword"),s=this.createHeading("").appendTo(this.content),n=this.createResult().appendTo(this.content),o="";e.on("keyup",t.proxy(function(){o=e.val(),r(o).done(t.proxy(function(r){if(e.val()==o){""==o?s.html(n2_("No search term specified. Showing recent items.")):s.html(n2_printf(n2_('Showing items match for "%s"'),o));for(var a=r.data,l=[],h=this,d=0;d<a.length;d++)l.push([a[d].title,a[d].info,t('<div class="n2-button n2-button-normal n2-button-xs n2-button-green n2-radius-s n2-uc n2-h5">'+n2_("Select")+"</div>").on("click",{post:a[d]},function(t){i._addQuickPost(h,t.data.post)})]);n.html(""),this.createTable(l,["width:100%;","",""]).appendTo(this.createTableWrap().appendTo(n))}},this))},this)).trigger("keyup").focus()}}}})}this.quickPostModal.show()},i.prototype._addQuickPost=function(e,i){i.image||(i.image=""),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"quickPost"}),data:{post:i}}).done(t.proxy(function(e){this.addBoxes(t(e.data)),this.initSlides()},this)),e.hide()},i.prototype.initBulk=function(){this.selection=[],this.isBulkSelection=!1;var e=t(".n2-bulk-select").find("a");e.eq(0).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.select()})},this)),e.eq(1).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.deSelect()})},this)),e.eq(2).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.box.hasClass("n2-slide-state-published")?t.select():t.deSelect()})},this)),e.eq(3).on("click",t.proxy(function(t){t.preventDefault(),this.bulkSelect(function(t){t.box.hasClass("n2-slide-state-published")?t.deSelect():t.select()})},this)),t(".n2-bulk-actions a").on("click",t.proxy(function(e){var i=t(e.currentTarget).data("action");i&&(e.preventDefault(),this.bulkAction(i))},this))},i.prototype.addSelection=function(t){0==this.selection.length&&this.enterBulk(),this.selection.push(t)},i.prototype.removeSelection=function(e){this.selection.splice(t.inArray(e,this.selection),1),0==this.selection.length&&this.leaveBulk()},i.prototype.bulkSelect=function(t){for(var e=0;e<this.slides.length;e++)t(this.slides[e])},i.prototype.bulkAction=function(t){var e=[],i=[];this.bulkSelect(function(t){t.selected&&(e.push(t),i.push(t.getId()))}),i.length?this[t](i,e):N2Classes.Notification.notice("Please select one or more slides for the action!")},i.prototype.enterBulk=function(){this.isBulkSelection||(this.isBulkSelection=!0,this.slidesContainer.nUISortable("option","disabled",!0),t("#n2-admin").addClass("n2-ss-has-box-selection"))},i.prototype.leaveBulk=function(){if(this.isBulkSelection){this.slidesContainer.nUISortable("option","disabled",!1),t("#n2-admin").removeClass("n2-ss-has-box-selection");for(var e=0;e<this.slides.length;e++)this.slides[e].deSelect();this.selection=[],this.isBulkSelection=!1}},i.prototype.deleteSlides=function(e,i){this.hideMenu();var s=i[0].box.find(".n2-box-placeholder-title a").text();i.length>1&&(s+=" and "+(i.length-1)+" more"),N2Classes.NextendModal.deleteModal("slide-delete",s,t.proxy(function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"delete"}),type:"POST",data:{slides:e}}).done(t.proxy(function(){for(var t=0;t<i.length;t++)i[t].deleted();this.initSlides(),this.leaveBulk()},this))},this))},i.prototype.duplicateSlides=function(e,i){for(var s=0;s<this.slides.length;s++)this.slides[s].selected&&this.slides[s].duplicate(t.Event("click",{currentTarget:null}))},i.prototype.copySlides=function(e,i){this.showSliderSelector(n2_("Copy slide to ..."),t.proxy(function(t){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"copySlides",targetSliderID:t.sliderID}),type:"POST",data:{slides:e}})},this))},i.prototype.publishSlides=function(e,i){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"publish"}),type:"POST",data:{slides:e}}).done(t.proxy(function(){for(var t=0;t<i.length;t++)i[t].published();this.changed()},this))},i.prototype.unPublishSlides=function(e,i){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"unpublish"}),type:"POST",data:{slides:e}}).done(t.proxy(function(){for(var t=0;t<i.length;t++)i[t].unPublished();this.changed()},this))},i.prototype.initMenu=function(){this.slide=null,this.menu=t("#n2-ss-slide-menu").detach().addClass("n2-inited"),this.menu.find("li").on("click",t.proxy(function(e){e.stopPropagation();var i=t(e.currentTarget).data("action");i&&"function"==typeof this.slide[i]&&this.slide[i](e),this.menu.removeClass("n2-active").off("mouseleave")},this)),this.menu.find(".n2-button").on("click",t.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.menu.hasClass("n2-active")?this.menu.removeClass("n2-active").off("mouseleave"):this.menu.addClass("n2-active").on("mouseleave",function(){t(this).removeClass("n2-active")})},this))},i.prototype.showMenu=function(t){this.slide=t,this.menu.appendTo(t.box)},i.prototype.hideMenu=function(){this.menu.detach()},i.prototype.showSliderSelector=function(e,i){var s=N2Classes.AjaxHelper.makeFallbackUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"choose"});this.sliderSelectorModal=new N2Classes.NextendModal({zero:{size:[970,600],title:e,back:!1,close:!0,content:"",fn:{show:function(){var e=t('<iframe src="'+s+'" width="970" height="540" style="margin: 0 -20px 0 -20px;"></iframe>').appendTo(this.content),r=window.addEventListener?"addEventListener":"attachEvent";window[r]("attachEvent"==r?"onmessage":"message",t.proxy(function(t){if(t.source==(e[0].contentWindow||e[0].contentDocument)){var s=t[t.message?"message":"data"];try{s=JSON.parse(s),s.action&&"ss3embed"===s.action&&i(s)}catch(r){}this.hide()}},this),!1)},destroy:function(){this.destroy()}}}},!0)},i}),N2D("SmartSliderSlideBackgroundAdmin",["SmartSliderSlideBackground"],function(t,e){function i(t,e,i){this.types={color:"SmartSliderAdminSlideBackgroundColor",image:"SmartSliderAdminSlideBackgroundImage",video:"SmartSliderAdminSlideBackgroundVideo"},this.allowVisualLoad=!0,this.slider=t.slider,this.editor=nextend.currentEditor,N2Classes.SmartSliderSlideBackground.prototype.constructor.call(this,t,e,i)}return i.prototype=Object.create(N2Classes.SmartSliderSlideBackground.prototype),i.prototype.constructor=i,i.prototype.setVisualLoad=function(t){this.allowVisualLoad=t},i.prototype.setType=function(t){"color"===t?(this.elements.color||this.createColorElement(!0),this.elements.image&&(this.elements.image.kill(),this.elements.image=!1)):"image"===t&&(this.elements.color||this.createColorElement(!0),this.elements.image||this.createImageElement())},i.prototype.setMode=function(t){"default"===t&&(t=this.slider.editor.options.slideBackgroundMode),this.element.attr("data-mode",t),this.elements.image&&this.elements.image.updateMode(t,this.mode),this.mode=t},i.prototype.setFocus=function(t,e){this.elements.image&&this.elements.image.updateFocus(t,e)},i.prototype.setImageOpacity=function(t){this.elements.image&&this.elements.image.updateOpacity(t)},i.prototype.setBlur=function(t){this.elements.image&&this.elements.image.updateBlur(t)},i.prototype.createColorElement=function(e){e=e||!1,this.elements.color=new N2Classes[this.types.color](this,t('<div class="n2-ss-slide-background-color"></div>').appendTo(this.$wrapElement)),e&&this.elements.color.update(this.editor.settings.getBackgroundColor(),this.editor.settings.getBackgroundGradient(),this.editor.settings.getBackgroundColorEnd(),this.editor.settings.getBackgroundColorOverlay())},i.prototype.updateColor=function(t,e,i,s){this.elements.color||this.createColorElement(),this.elements.color.update(t,e,i,s)},i.prototype.createImageElement=function(){var e=this.editor.settings,i=e.getBackgroundImage();if(""!==i){var s=nextend.imageHelper.fixed(i),r=t('<div class="n2-ss-slide-background-image"/>').css({opacity:e.getBackgroundImageOpacity()/100,backgroundPosition:e.getBackgroundFocusX()+"% "+e.getBackgroundFocusY()+"%"}).attr({"data-hash":md5(i),"data-desktop":s,"data-blur":e.getBackgroundImageBlur()}).appendTo(this.$wrapElement);this.elements.image=new N2Classes[this.types.image](this.slide,this.manager,this,r),this.elements.image.preLoadAdmin(i)}},i.prototype.setImage=function(t){this.elements.image?this.elements.image.setDesktopSrc(t):""!==t&&(null===t.toLowerCase().match(/\.(png|jpg|jpeg|gif|webp|svg)$/)?N2Classes.Notification.error("The background image format is not correct! The supported image formats are: png, jpg, jpeg, gif, webp, svg."):"image"===this.editor.settings.getType()&&this.createImageElement(t))},i}),N2D("EditorAbstract",function(t,e){function i(e,i,r){s(),this.readyDeferred=t.Deferred(),this.sliderElementID=e,this.slideContentElementID=i,this.readyDeferred.done(t.proxy(function(){N2D("SSEditor",t.proxy(function(){return this},this))},this)),this.options=t.extend({slideAsFile:0,isUploadDisabled:!0,uploadUrl:"",uploadDir:""},r),nextend.currentEditor=this,this.frontend=null,this.generator=null,this.fragmentEditor=null,this.$editedElement=null,this.editedInstance=null,N2R("documentReady",t.proxy(function(t){"undefined"!=typeof nextend.fontsDeferred?nextend.fontsDeferred.done(t.proxy(this.startEditor,this)):this.startEditor()},this))}function s(){var t=r();t&&10>t&&alert(window.ss2lang.The_editor_was_tested_under_Internet_Explorer_10_Firefox_and_Chrome_Please_use_one_of_the_tested_browser)}function r(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("msie")?parseInt(t.split("msie")[1]):!1}return i.prototype.startEditor=function(){},i.prototype.ready=function(t){this.readyDeferred.done(t)},i.prototype.getSelf=function(){return this},i.prototype.getAvailableDeviceModes=function(){return{desktopPortrait:1,desktopLandscape:0,tabletPortrait:1,tabletLandscape:1,mobilePortrait:1,mobileLandscape:1}},i.prototype.getGeneratorVariables=function(){return this.$editedElement.data("variables")},i.prototype.getMainContainerElement=function(){return this.$editedElement.find(".n2-ss-layers-container").addBack().last()},i}),N2D("EditorSlide",["EditorAbstract"],function(t,e){function i(e,i,s){N2Classes.EditorAbstract.prototype.constructor.call(this,e,i,t.extend({isAddSample:!1,sampleSlidesUrl:"",slideBackgroundMode:"fill"},s))}return i.prototype=Object.create(N2Classes.EditorAbstract.prototype),i.prototype.constructor=i,i.prototype.startEditor=function(){this.$slideContentElement=t("#"+this.slideContentElementID),this.slideStartValue=this.$slideContentElement.val(),N2R("#"+this.sliderElementID,t.proxy(function(t,e){this.frontend=e,this.frontend.editor=this,nextend.pre="div#"+this.frontend.elementID+" ",this.frontend.visible(t.proxy(this.sliderStarted,this))},this))},i.prototype.sliderStarted=function(){t("body").addClass("n2-ss-slider-visible"),this.scrollbar=new N2Classes.HorizontalScrollBar(t("#n2-ss-slide-canvas-container")),this.frontend.sliderElement.on("SliderResize",t.proxy(function(){this.scrollbar.update()},this)),this.$editedElement=this.frontend.sliderElement.find(".n2-ss-currently-edited-slide"),this.editedInstance=this.$editedElement.data("slide");var e=this.$editedElement.hasClass("n2-ss-static-slide");this.generator=new N2Classes.Generator(this),this.generator.registerFields(["#slidetitle","#sldedescription","#slidethumbnail","#slidebackgroundImage","#slidebackgroundAlt","#slidebackgroundTitle","#slidebackgroundVideoMp4","#slidebackgroundColor","#slidebackgroundColorEnd","#slidehref","#layergenerator-visible","#layergroup-generator-visible"]),this.generator.registerGlobalField("slide","name","#slidetitle"),this.generator.registerGlobalField("slide","description","#slidedescription"),this.getMainContainerElement().on("updateSize",t.proxy(this.updateSize,this)),this.settings=new N2Classes.SlideSettings(this,e);var i={};e?i.snapSelector=".n2-ss-static-slide .n2-ss-layer.nui-resizable:not(.n2-ss-layer-locked):not(.n2-ss-layer-parent):not(.n2-ss-layer-selected):visible, .n2-ruler-user-guide":i.snapSelector=".n2-ss-slide.n2-ss-slide-active .n2-ss-layer.nui-resizable:not(.n2-ss-layer-locked):not(.n2-ss-layer-parent):not(.n2-ss-layer-selected):visible, .n2-ruler-user-guide",this.fragmentEditor=new N2Classes.FragmentEditor(this,this.getFrontendSlide().$element,i,this.options),this.getFrontendElement().on({SliderResize:t.proxy(this.fragmentEditor.onResize,this.fragmentEditor),SliderDeviceOrientation:t.proxy(this.fragmentEditor.onChangeDeviceOrientation,this.fragmentEditor)}),this.readyDeferred.resolve(),t("#smartslider-form").on({checkChanged:t.proxy(this.prepareFormForCheck,this),submit:t.proxy(this.onSlideSubmit,this)}),this.options.isAddSample&&this.startSampleSlides()},i.prototype.prepareFormForCheck=function(){var t=JSON.stringify(this.fragmentEditor.getData()),e=JSON.stringify(JSON.parse(N2Classes.Base64.decode(this.slideStartValue)));this.$slideContentElement.val(e==t?this.slideStartValue:N2Classes.Base64.encode(t))},i.prototype.onSlideSubmit=function(i){if(!nextend.isPreview)if(this.prepareForm(),i.preventDefault(),nextend.askToSave=!1,this.options.slideAsFile&&typeof window.FormData!==e&&"undefined"!=typeof window.File){var s=new FormData,r=t("#smartslider-form").serializeArray();t.each(r,function(t,e){if("slide[slide]"==e.name)try{s.append("slide",new Blob([e.value]),"slide.txt")}catch(i){try{s.append("slide",new Blob([e.value]))}catch(i){try{s.append("slide",new File([e.value],"slide.txt"))}catch(i){N2Classes.Notification.notice('Your browser does not support File api, please disable "Send slide as file" option in the global settings.')}}}else s.append(e.name,e.value)}),N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(window.location.href),type:"POST",data:s,contentType:!1,processData:!1}).done(t.proxy(this.afterSave,this))}else N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(window.location.href),data:t("#smartslider-form").serialize(),dataType:"json"}).done(t.proxy(this.afterSave,this))},i.prototype.afterSave=function(){nextend.askToSave=!0,t("#smartslider-form").trigger("saved"),t(".n2-ss-edit-slide-top-details .n2-h1").text(t("#slidetitle").val())},i.prototype.prepareForm=function(){this.fragmentEditor.canvasSettings.ruler&&t("#slideguides").val(N2Classes.Base64.encode(JSON.stringify(this.fragmentEditor.canvasSettings.ruler.toArray()))),this.$slideContentElement.val(N2Classes.Base64.encode(nextend.UnicodeToHTMLEntity(JSON.stringify(this.fragmentEditor.getData()))))},i.prototype.getLayout=function(){for(var e=t("#smartslider-form").serializeArray(),i={},s=0;s<e.length;s++){var r=e[s].name.match(/slide\[(.*?)\]/);r&&(i[r[1]]=e[s].value)}return delete i.generator,delete i.published,delete i.publishdates,delete i["record-start"],delete i["record-slides"],delete i.slide,i.slide=this.fragmentEditor.getData(),i},i.prototype.loadLayout=function(e,i,s){var r=e.slide;if(delete e.slide,s?this.fragmentEditor.importLayers(r,!0):this.fragmentEditor.importLayers(r,!1),i)for(var n in e)t("#slide"+n).val(e[n]).trigger("change");e.slide=r},i.prototype.copy=function(){var e={data:this.settings.getBackgroundData(),layers:this.fragmentEditor.getData()};t.jStorage.set("copiedSlide",JSON.stringify(e))},i.prototype.paste=function(){var e=t.jStorage.get("copiedSlide");e&&(e=JSON.parse(e),this.settings.setData(e.data),this.fragmentEditor.mainContainer.replaceLayers(e.layers))},i.prototype.hasClipboard=function(){var e=t.jStorage.get("copiedSlide");return!!e},i.prototype.startSampleSlides=function(){var i=this,s=window.addEventListener?"addEventListener":"attachEvent",r=t('<iframe src="'+this.options.sampleSlidesUrl+'"></iframe>').prependTo(".n2-ss-sample-slides-container"),n=r[0];t("html, body").scrollTop(r.offset().top-t("#wpadminbar").height());var o=t(".n2-ss-sample-slide-settings"),a=t("#slidebackground-type"),l=t("#slidebackgroundImage"),h=t("#n2-ss-sample-slide-setting-background-image").on("click",function(){l.parent().find(".n2-form-element-button").trigger("click")}),d=function(){var t=l.val();""===t?(o.removeClass("n2-ss-has-image"),h.css("background-image","url("+nextend.imageHelper.fixed("$system$/images/placeholder/image.png")+")"),"color"!==a.val()&&a.val("color").trigger("change")):(o.addClass("n2-ss-has-image"),"image"!==a.val()&&a.val("image").trigger("change"),
h.css("background-image","url("+nextend.imageHelper.fixed(t)+")"))};h.find(".n2-i-close").on("click",function(t){t.stopPropagation(),l.parent().find(".n2-form-element-clear").trigger("click")}),l.on("nextendChange",d),d();var p=t("#slidebackgroundImageOpacity"),c=t("#n2-ss-sample-slide-setting-opacity-slider").removeAttr("slide").prop("slide",!1).nUISlider({min:0,max:100,step:1,slide:function(t,e){p.data("field").insideChange(e.value)}}),u=function(t){c.nUISlider("option","value",p.val())};p.on("nextendChange",u),u();var y=t("#slidebackgroundImageBlur"),g=t("#n2-ss-sample-slide-setting-blur-slider").removeAttr("slide").prop("slide",!1).nUISlider({min:0,max:40,step:1,slide:function(t,e){y.data("field").insideChange(e.value)}}),f=function(t){g.nUISlider("option","value",y.val())};y.on("nextendChange",f),f();var m=t("#slidebackgroundColor"),v=t("#n2-ss-sample-slide-setting-color").n2spectrum({showAlpha:1,preferredFormat:"hex8",showInput:!1,showButtons:!1,move:function(){var t=v.n2spectrum("get").toHexString8();v.val(t),m.data("field").insideChange(t)},showSelectionPalette:!0,showPalette:!0,maxSelectionSize:6,localStorageKey:"color",palette:[["000000","55aa39","357cbd","bb4a28","8757b2","000000CC"],["81898d","5cba3c","4594e1","d85935","9e74c2","00000080"],["ced3d5","27ae60","01add3","e79d19","e264af","FFFFFFCC"],["ffffff","2ecc71","00c1c4","ecc31f","ec87c0","FFFFFF80"]]}),b=function(t){var e=m.val();e!==v.val()&&v.n2spectrum("set",e)};m.on("nextendChange",b),b();var C=t("#slidebackgroundGradient"),x=function(){"off"===C.val()?o.removeClass("n2-ss-has-gradient"):o.addClass("n2-ss-has-gradient")};C.on("nextendChange",x),x();var w=t("#slidebackgroundColorEnd"),S=t("#n2-ss-sample-slide-setting-gradient").n2spectrum({showAlpha:1,preferredFormat:"hex8",showInput:!1,showButtons:!1,move:function(){var t=S.n2spectrum("get").toHexString8();w.data("field").insideChange(t)},showSelectionPalette:!0,showPalette:!0,maxSelectionSize:6,localStorageKey:"color",palette:[["000000","55aa39","357cbd","bb4a28","8757b2","000000CC"],["81898d","5cba3c","4594e1","d85935","9e74c2","00000080"],["ced3d5","27ae60","01add3","e79d19","e264af","FFFFFFCC"],["ffffff","2ecc71","00c1c4","ecc31f","ec87c0","FFFFFF80"]]}),P=function(t){S.n2spectrum("set",w.val())};w.on("outsideChange",P),P(),window[s]("attachEvent"==s?"onmessage":"message",function(t){if(t.source==(n.contentWindow||n.contentDocument)){var s=t[t.message?"message":"data"];if(s.key)switch(s.key){case"sampleSlide":var r=JSON.parse(s.data);i.settings.setData(r.data,!0),i.fragmentEditor.mainContainer.replaceLayers(r.layers),"content"!=i.fragmentEditor.currentEditorMode&&i.fragmentEditor.mainContent!=e&&i.fragmentEditor.updateEditorMode("content");break;case"ready":(n.contentWindow||n.contentDocument).postMessage({key:"ackReady"},"*"),i.options.isAddSample&&((n.contentWindow||n.contentDocument).postMessage({key:"create"},"*"),i.options.isAddSample=!1)}}},!1)},i.prototype.getAvailableDeviceModes=function(){return this.frontend.responsive.parameters.deviceModes},i.prototype.getSlideBackground=function(){return this.$editedElement.data("slideBackground")},i.prototype.getFrontendElement=function(){return this.frontend.sliderElement},i.prototype.getFrontendSlide=function(){return this.editedInstance},i.prototype.getHorizontalRatio=function(){return this.frontend.responsive.lastRatios.slideW},i.prototype.getVerticalRatio=function(){return this.frontend.responsive.lastRatios.slideH},i.prototype.updateSize=function(){return this.frontend.responsive.doVerticalResize()},i.prototype.getDeviceMode=function(){return this.frontend.responsive.getNormalizedModeString()},i}),N2D("Generator",["EditorAbstract"],function(t,e){"use strict";function i(e){this.editor=e,this._refreshTimeout=null,this.modal=!1,this.group=0,this.editor.generator=this;var i=this.editor.getGeneratorVariables();if(i){this.variables=i;for(var s in this.variables)!isNaN(parseFloat(s))&&isFinite(s)&&(this.group=Math.max(this.group,parseInt(s)+1));this.fill=this.generatorFill,this.group>0&&(this.registerField=this.generatorRegisterField,this.button=t('<a href="#" class="n2-button n2-button-normal n2-button-xs n2-radius-s n2-button-blue n2-h5 n2-uc" style="position:absolute;right: -2px;top: -18px;">Variable</a>').on("click",t.proxy(function(t){t.preventDefault(),this.showModal()},this)),t("body").addClass("n2-ss-dynamic-slide"))}else this.variables=null}return i.prototype.isDynamicSlide=function(){return this.group>0},i.prototype.splitTokens=function(t){for(var e=[],i="",s=0,r=0;r<t.length;r++){var n=t[r];","===n&&0===s?(e.push(i),i=""):(i+=n,"("===n?s++:")"===n&&s--)}return i.length&&e.push(i),e},i.prototype.fill=function(t){return t},i.prototype.generatorFill=function(e){return e.replace(/{((([a-z]+)\(([^}]+)\))|([a-zA-Z0-9][a-zA-Z0-9_\/]*))}/g,t.proxy(this.parseFunction,this))},i.prototype.parseFunction=function(t,e,i,s,r,n){if("undefined"==typeof n){for(var o=this.splitTokens(r),a=0;a<o.length;a++)o[a]=this.parseVariable(o[a]);return"function"==typeof this[s]?this[s].apply(this,o):t}return this.parseVariable(n)},i.prototype.parseVariable=function(t){var e=t.match(/^("|')(.*)("|')$/);if(e)return e[2];var i=t.match(/((([a-z]+)\(([^}]+)\)))/);if(i)return this.parseFunction.apply(this,i);var s=t.match(/([a-zA-Z][0-9a-zA-Z_]*)(\/([0-9a-z]+))?/);if(s){var r=s[3];if("undefined"==typeof r)r=0;else{var n=parseInt(r);isNaN(n)||(r=Math.max(r,1)-1)}return"undefined"!=typeof this.variables[r]&&"undefined"!=typeof this.variables[r][s[1]]?this.variables[r][s[1]]:""}return t},i.prototype.fallback=function(t,e){return""==t?e:t},i.prototype.cleanhtml=function(t){return this.stripTags(t,"<p><a><b><br /><br/><i>")},i.prototype.stripTags=function(t,e){e=(((e||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var i=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,s=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return t.replace(s,"").replace(i,function(t,i){return e.indexOf("<"+i.toLowerCase()+">")>-1?t:""})},i.prototype.removehtml=function(e){return t("<div>"+e+"</div>").text()},i.prototype.splitbychars=function(t,e,i){return t.substr(e,i)},i.prototype.splitbywords=function(t,e,i){var s=t,r=s.length,n=Math.max(0,0==e?0:s.indexOf(" ",e)),o=Math.max(0,i>r?r:s.indexOf(" ",i));return 0==o&&r>=i&&(o=r),s.substr(n,o)},i.prototype.findimage=function(t,e){var i=t,s=/(<img.*?src=[\'"](.*?)[\'"][^>]*>)|(background(-image)??\s*?:.*?url\((["|\']?)?(.+?)(["|\']?)?\))/gi,r=[],n=null;for(e="undefined"!=typeof e?parseInt(e)-1:0;n=s.exec(i);)"undefined"!=typeof n[2]?r.push(n[2]):"undefined"!=typeof n[6]&&r.push(n[6]);return r.length?r.length>e?r[e]:r[r.length-1]:""},i.prototype.findlink=function(t,e){var i=t,s=/href=["\']?([^"\'>]+)["\']?/gi,r=[],n=null;for(e="undefined"!=typeof e?parseInt(e)-1:0;n=s.exec(i);)"undefined"!=typeof n[1]&&r.push(n[1]);return r.length?r.length>e?r[e]:r[r.length-1]:""},i.prototype.removevarlink=function(t){var e=String(t),i=/<a href=\"(.*?)\">(.*?)<\/a>/g;return e.replace(i,"")},i.prototype.removelinebreaks=function(t){var e=String(t),i=/\r?\n|\r/g;return e.replace(i,"")},i.prototype.registerFields=function(t){for(var e=0;e<t.length;e++)this.registerField(t[e])},i.prototype.registerGlobalField=function(e,i,s){null!==this.variables&&(s=t(s).on("nextendChange",t.proxy(function(){this.variables[e][i]=s.val(),this.refresh()},this)))},i.prototype.registerField=function(t){},i.prototype.generatorRegisterField=function(e){e=t(e);var i=e.parent();i.on({mouseenter:t.proxy(function(){this.activeField=e,this.button.prependTo(i)},this)})},i.prototype.getModal=function(){var e=this;if(!this.modal){var i={key:"",group:1,filter:"no",split:"no",splitStart:0,splitLength:300,findImage:0,findImageIndex:1,findLink:0,findLinkIndex:1,removeVarLink:0,removelinebreaks:0},s=function(){var t=i.key+"/"+i.group;return i.findImage&&(t="findimage("+t+","+Math.max(1,i.findImageIndex)+")"),i.findLink&&(t="findlink("+t+","+Math.max(1,i.findLinkIndex)+")"),i.removeVarLink&&(t="removevarlink("+t+")"),i.removelinebreaks&&(t="removelinebreaks("+t+")"),"no"!=i.filter&&(t=i.filter+"("+t+")"),"no"!=i.split&&i.splitStart>=0&&i.splitLength>0&&(t=i.split+"("+t+","+i.splitStart+","+i.splitLength+")"),"{"+t+"}"},r=t('<div class="n2-generator-result-container" />'),n=function(){r.html(t("<div/>").text(e.fill(s())).html())},o=e.group,a=null,l=null,h=t('<div class="n2-generator-insert-variable"/>'),d=N2Classes.NextendModal.prototype.createHeading(n2_("Choose the group")).appendTo(h),p=t('<div class="n2-group-container" />').appendTo(h);h.append(N2Classes.NextendModal.prototype.createHeading(n2_("Choose the variable")));var c=t('<div class="n2-variable-container webkit-scroll-fix" />').appendTo(h),u=t('<div class="n2-generator-functions-container n2-form-element-mixed" />').appendTo(t('<div class="n2-form" />').appendTo(h));h.append(N2Classes.NextendModal.prototype.createHeading(n2_("Result"))),r.appendTo(h),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Filter")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-list"><select autocomplete="off" name="filter" id="n2-generator-function-filter"><option selected="selected" value="no">'+n2_("No")+'</option><option value="cleanhtml">'+n2_("Clean HTML")+'</option><option value="removehtml">'+n2_("Remove HTML")+"</option></select></div></div></div>").appendTo(u);var y=u.find("#n2-generator-function-filter");y.on("change",t.proxy(function(){i.filter=y.val(),n()},this)),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Split by chars")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-list"><select autocomplete="off" name="split" id="n2-generator-function-split"><option selected="selected" value="no">'+n2_("No")+'</option><option value="splitbychars">'+n2_("Strict")+'</option><option value="splitbywords">'+n2_("Respect words")+'</option></select></div><div class="n2-form-element-text n2-text-has-unit n2-border-radius"><div class="n2-text-sub-label n2-h5 n2-uc">'+n2_("Start")+'</div><input type="text" autocomplete="off" style="width: 22px;" class="n2-h5" value="0" id="n2-generator-function-split-start"></div><div class="n2-form-element-text n2-text-has-unit n2-border-radius"><div class="n2-text-sub-label n2-h5 n2-uc">'+n2_("Length")+'</div><input type="text" autocomplete="off" style="width: 22px;" class="n2-h5" value="300" id="n2-generator-function-split-length"></div></div></div>').appendTo(u);var g=u.find("#n2-generator-function-split");g.on("change",t.proxy(function(){i.split=g.val(),n()},this));var f=u.find("#n2-generator-function-split-start");f.on("change",t.proxy(function(){i.splitStart=parseInt(f.val()),n()},this));var m=u.find("#n2-generator-function-split-length");m.on("change",t.proxy(function(){i.splitLength=parseInt(m.val()),n()},this)),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Find image")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-onoff"><div class="n2-onoff-slider"><div class="n2-onoff-yes"><i class="n2-i n2-i-tick"></i></div><div class="n2-onoff-round"></div><div class="n2-onoff-no"><i class="n2-i n2-i-close"></i></div></div><input type="hidden" autocomplete="off" value="0" id="n2-generator-function-findimage"></div><div class="n2-form-element-text n2-text-has-unit n2-border-radius"><div class="n2-text-sub-label n2-h5 n2-uc">'+n2_("Index")+'</div><input type="text" autocomplete="off" style="width: 22px;" class="n2-h5" value="1" id="n2-generator-function-findimage-index"></div></div></div>').appendTo(u);var v=u.find("#n2-generator-function-findimage");v.on("nextendChange",t.proxy(function(){i.findImage=parseInt(v.val()),n()},this));var b=u.find("#n2-generator-function-findimage-index");b.on("change",t.proxy(function(){i.findImageIndex=parseInt(b.val()),n()},this)),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Find link")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-onoff"><div class="n2-onoff-slider"><div class="n2-onoff-yes"><i class="n2-i n2-i-tick"></i></div><div class="n2-onoff-round"></div><div class="n2-onoff-no"><i class="n2-i n2-i-close"></i></div></div><input type="hidden" autocomplete="off" value="0" id="n2-generator-function-findlink"></div><div class="n2-form-element-text n2-text-has-unit n2-border-radius"><div class="n2-text-sub-label n2-h5 n2-uc">'+n2_("Index")+'</div><input type="text" autocomplete="off" style="width: 22px;" class="n2-h5" value="1" id="n2-generator-function-findlink-index"></div></div></div>').appendTo(u);var C=u.find("#n2-generator-function-findlink");C.on("nextendChange",t.proxy(function(){i.findLink=parseInt(C.val()),n()},this));var x=u.find("#n2-generator-function-findlink-index");x.on("change",t.proxy(function(){i.findLinkIndex=parseInt(x.val()),n()},this)),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Remove links")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-onoff"><div class="n2-onoff-slider"><div class="n2-onoff-yes"><i class="n2-i n2-i-tick"></i></div><div class="n2-onoff-round"></div><div class="n2-onoff-no"><i class="n2-i n2-i-close"></i></div></div><input type="hidden" autocomplete="off" value="0" id="n2-generator-function-removevarlink"></div></div></div>').appendTo(u);var w=u.find("#n2-generator-function-removevarlink");w.on("nextendChange",t.proxy(function(){i.removeVarLink=parseInt(w.val()),n()},this));var S=u.find("#n2-generator-function-removevarlink-index");S.on("change",t.proxy(function(){i.removeVarLinkIndex=parseInt(S.val()),n()},this)),t('<div class="n2-mixed-group"><div class="n2-mixed-label"><label>'+n2_("Remove line breaks")+'</label></div><div class="n2-mixed-element"><div class="n2-form-element-onoff"><div class="n2-onoff-slider"><div class="n2-onoff-yes"><i class="n2-i n2-i-tick"></i></div><div class="n2-onoff-round"></div><div class="n2-onoff-no"><i class="n2-i n2-i-close"></i></div></div><input type="hidden" autocomplete="off" value="0" id="n2-generator-function-removelinebreaks"></div></div></div>').appendTo(u);var P=u.find("#n2-generator-function-removelinebreaks");P.on("nextendChange",t.proxy(function(){i.removelinebreaks=parseInt(P.val()),n()},this));var k=u.find("#n2-generator-function-removelinebreaks-index");k.on("change",t.proxy(function(){i.removelinebreaksIndex=parseInt(k.val()),n()},this));for(var N in this.variables[0])t('<a href="#" class="n2-button n2-button-normal n2-button-s n2-button-grey n2-radius-s">'+N+"</a>").on("click",t.proxy(function(e,s){s.preventDefault(),a.removeClass("n2-active"),t(s.currentTarget).addClass("n2-active"),i.key=e,n()},this,N)).appendTo(c);a=c.find("a"),a.eq(0).trigger("click"),1==o&&(d.css("display","none"),p.css("display","none"));for(var L=0;o>L;L++)t('<a href="#" class="n2-button n2-button-normal n2-button-s n2-button-grey n2-radius-s">'+(L+1)+"</a>").on("click",t.proxy(function(e,s){s.preventDefault(),l.removeClass("n2-active"),t(s.currentTarget).addClass("n2-active"),i.group=e+1,n()},this,L)).appendTo(p);l=p.find("a"),l.eq(0).trigger("click");var _=!1;this.modal=new N2Classes.NextendModal({zero:{size:[1e3,o>1?670:600],title:n2_("Insert variable"),back:!1,close:!0,content:h,controls:['<a href="#" class="n2-button n2-button-normal n2-button-l n2-radius-s n2-button-green">'+n2_("Insert")+"</a>"],fn:{show:function(){_||(new N2Classes.FormElementOnoff("n2-generator-function-findimage"),new N2Classes.FormElementOnoff("n2-generator-function-findlink"),new N2Classes.FormElementOnoff("n2-generator-function-removevarlink"),new N2Classes.FormElementOnoff("n2-generator-function-removelinebreaks"),_=!0),this.controls.find(".n2-button").on("click",t.proxy(function(t){t.preventDefault(),e.insert(s()),this.hide(t)},this))}}}},!1),this.modal.setCustomClass("n2-ss-generator-modal")}return this.modal},i.prototype.showModal=function(){this.getModal().show()},i.prototype.insert=function(t){this.activeField.val(t).trigger("change")},i.prototype.refresh=function(){this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null),this._refreshTimeout=setTimeout(t.proxy(this._refresh,this),100)},i.prototype._refresh=function(){for(var t=this.editor.fragmentEditor.mainContainer.container.getAllLayers(),e=0;e<t.length;e++)"layer"==t[e].type&&t[e].item.reRender()},i}),N2D("Historical",function(t,e){"use strict";function i(t){for(var e in i.prototype)t.prototype[e]=i.prototype[e]}return i.prototype.setSelf=function(t){t===e&&console.error(t),this.self!==e&&this.self!==this&&this.self.setSelf(t),this.self=t,this.onSelfChange()},i.prototype.getSelf=function(){return this.self===e?this.self=this:this.self!==this&&(this.self=this.self.getSelf()),this.self},i.prototype.onSelfChange=function(){},i}),N2D("History",function(t,e){"use strict";function i(){this.historyStates=50,this.enabled=0!==this.historyStates,this.historyActionInProgress=!1,this.historyAddAllowed=!0,this.isBatched=!1,this.currentBatch=this,this.index=-1,this.stackedOff=[],this.tasks=[],this.preventUndoRedo=!1,this.undoBTN=t("#n2-ss-undo").on({click:t.proxy(this.undo,this),mousedown:function(t){N2Classes.WindowManager.get().setMouseDownArea("undo",t)}}),this.redoBTN=t("#n2-ss-redo").on({click:t.proxy(this.redo,this),mousedown:function(t){N2Classes.WindowManager.get().setMouseDownArea("redo",t)}}),this.updateUI()}function s(t){this.parent=t,this.tasks=[]}function r(t){switch(t){case"skipForwardUndos":this.undo=function(){return!1}}}function n(t,e,i,s){this.that=t,this.undoAction=e,this.redoAction=i,this.context=s||[]}function o(){n.prototype.constructor.apply(this,arguments)}return i.get=function(){var t=new i;return i.get=function(){return t},t},i.prototype.updateUI=function(){0===this.index||0===this.tasks.length?this.undoBTN.removeClass("n2-active"):this.undoBTN.addClass("n2-active"),-1==this.index||this.index>=this.tasks.length?this.redoBTN.removeClass("n2-active"):this.redoBTN.addClass("n2-active")},i.prototype.throttleUndoRedo=function(){return this.preventUndoRedo?!0:(this.preventUndoRedo=!0,setTimeout(t.proxy(function(){this.preventUndoRedo=!1},this),100),!1)},i.prototype.isEnabled=function(){return this.enabled&&this.historyAddAllowed},i.prototype.startBatch=function(){if(this.isEnabled()){var t=new s(this.currentBatch);return this.currentBatch._add(t),this.currentBatch=t,t}return!1},i.prototype.endBatch=function(){this.isEnabled()&&(this.currentBatch.parent==e,this.currentBatch=this.currentBatch.parent)},i.prototype.addControl=function(t){return this.currentBatch._add(new r(t))},i.prototype.addSimple=function(t,e,i,s){return this.isEnabled()?this.currentBatch._add(new n(t,e,i,s)):!1},i.prototype.addValue=function(t,e,i){if(this.isEnabled()){if(this.isBatched||this.currentBatch!==this)for(var s=this.getCurrentBatchStack(),r=0;r<s.length;r++)if(s[r].isEqual(t,e,i))return s.push(s.splice(r,1)[0]),s[s.length-1];return this.currentBatch._add(new o(t,e,e,i))}return!1},i.prototype.getCurrentBatchStack=function(){return this.currentBatch!==this?this.currentBatch.tasks:this.tasks[this.tasks.length-1]},i.prototype._add=function(e){return-1!=this.index&&this.tasks.splice(this.index,this.tasks.length),this.index=-1,this.isBatched?this.tasks[this.tasks.length-1].push(e):(this.tasks.push([e]),this.isBatched=!0,setTimeout(t.proxy(function(){this.isBatched=!1},this),100)),this.tasks.length>this.historyStates&&this.tasks.unshift(),this.updateUI(),e},i.prototype.off=function(){this.historyAddAllowed=!1,this.stackedOff.push(1)},i.prototype.on=function(){this.stackedOff.pop(),0==this.stackedOff.length&&(this.historyAddAllowed=!0)},i.prototype.undo=function(t){if(t&&t.preventDefault(),this.throttleUndoRedo())return!1;if(this.historyActionInProgress=!0,this.off(),-1==this.index?this.index=this.tasks.length-1:this.index--,this.index>=0)for(var e=this.tasks[this.index],i=e.length-1;i>=0&&e[i].undo();i--);else this.index=0;return this.on(),this.historyActionInProgress=!1,this.updateUI(),!0},i.prototype.redo=function(t){if(t&&t.preventDefault(),this.throttleUndoRedo())return!1;if(this.historyActionInProgress=!0,this.off(),-1!=this.index&&this.index<this.tasks.length){var e=this.tasks[this.index];this.index++;for(var i=0;i<e.length&&e[i].redo();i++);}return this.on(),this.historyActionInProgress=!1,this.updateUI(),!0},i.prototype.actionInProgress=function(){return this.historyActionInProgress},s.prototype._add=function(t){return this.tasks.push(t),t},s.prototype.undo=function(){for(var t=0;t<this.tasks.length&&this.tasks[t].undo();t++);return!0},s.prototype.redo=function(){for(var t=0;t<this.tasks.length&&this.tasks[t].redo();t++);return!0},s.prototype.isEqual=function(){return!1},r.prototype.undo=function(){return!0},r.prototype.redo=function(){return!0},r.prototype.isEqual=function(){return!1},n.prototype.undo=function(){return this.undoAction.apply(this.that.getSelf(),this.context),!0},n.prototype.redo=function(){return this.redoAction.apply(this.that.getSelf(),this.context),!0},n.prototype.isEqual=function(){return!1},o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.prototype.setValues=function(t,e){this.undoValue=t,this.redoValue=e},o.prototype.undo=function(){return this.context.unshift(this.undoValue),this.undoAction.apply(this.that.getSelf(),this.context),this.context.shift(),!0},o.prototype.redo=function(){return this.context.unshift(this.redoValue),this.redoAction.apply(this.that.getSelf(),this.context),this.context.shift(),!0},o.prototype.isEqual=function(t,e,i){if(t===this.that&&e==this.undoAction){for(var s=0;s<i.length;s++)if(i[s]!=this.context[s])return!1;return this.setValues=function(t,e){this.redoValue=e},!0}return!1},i}),N2D("InlineField",function(t,e){function i(){this.$input=t('<input type="text" name="name" />').on({mouseup:function(t){t.stopPropagation()},keyup:t.proxy(function(t){27==t.keyCode&&this.cancel()},this),blur:t.proxy(this.save,this)}),this.$form=t('<form class="n2-inline-form"></form>').append(this.$input).on("submit",t.proxy(this.save,this))}return i.prototype.injectNode=function(t,e){this.$input.val(e),t.append(this.$form),this.$input.focus()},i.prototype.save=function(t){t.preventDefault(),this.$input.trigger("valueChanged",[this.$input.val()]),this.$input.off("blur"),this.destroy()},i.prototype.cancel=function(){this.$input.trigger("cancel"),this.destroy()},i.prototype.destroy=function(){this.$input.off("blur"),this.$form.remove()},i}),N2D("SlideSettings",function(t,e){"use strict";function i(e,i){this.editor=e,this.isStatic=i;var s=t("#smartslider-form").find('input[id][name^="slide"], textarea[id][name^="slide"]'),r={};if(s.each(t.proxy(function(e,i){var s=t(i),n=s.attr("name").match(/slide\[(.*)\]/)[1];r[n]=s.on("nextendChange",t.proxy(this.onChange,this,n))},this)),this.fields=r,this.slideBackground=this.editor.getSlideBackground(),!i){var n=t("#slidethumbnail").on("change, nextendChange",function(){var e=n.val();""===e&&(e="$system$/images/placeholder/image.png"),t(".n2-ss-edit-slide-top-thumbnail img").attr("src",nextend.imageHelper.fixed(e))}),o=null,a=this.fields.backgroundImage.val(),l=t.proxy(function(t){""===t||"$system$/images/placeholder/image.png"===t||""!==n.val()&&n.val()!==a||(n.val(t).trigger("change"),o&&(o.off(".slidethumbnail"),o=null))},this);this.fields.backgroundImage.on("nextendChange.slidethumbnail",t.proxy(function(){var t=this.fields.backgroundImage.val();l(t),a=t},this)),""===n.val()&&(o=t("#item_imageimage").on("nextendChange.slidethumbnail",t.proxy(function(){l(o.val())},this)))}this.createHistory()}i.prototype.createHistory=function(){this.values={},t("#smartslider-form").find('input[id][name^="slide"], textarea[id][name^="slide"]').not("#slideslide").each(t.proxy(function(e,i){var s=t(i),r=s.data("field"),n=s.attr("id");this.values[n]=s.val(),s.on("nextendChange",t.proxy(function(){var t=s.val(),e=N2Classes.History.get().addValue(this,this.historyUpdateSlideValue,[r]);e&&e.setValues(this.values[n],t),this.values[n]=t},this))},this))},i.prototype.getSelf=function(){return this},i.prototype.historyUpdateSlideValue=function(t,e){e.insideChange(t)},i.prototype.getAllData=function(){var t={};for(var e in this.fields)t[e]=this.fields[e].val();return t};var s=["thumbnail","background-type","backgroundColor","backgroundGradient","backgroundColorEnd","backgroundColorOverlay","backgroundImage","backgroundImageOpacity","backgroundImageBlur","backgroundFocusX","backgroundFocusY","backgroundMode"];return i.prototype.getBackgroundData=function(){for(var t={},e=0;e<s.length;e++)t[s[e]]=this.fields[s[e]].val();return t},i.prototype.setData=function(t,e){e&&this.slideBackground.setVisualLoad(!1);for(var i in t)this.fields[i].val(t[i]).trigger("change");e&&this.slideBackground.setVisualLoad(!1)},i.prototype.onChange=function(t,e){t=t.replace(/-/g,"_"),"function"==typeof this["sync_"+t]&&this["sync_"+t].call(this)},i.prototype.sync_backgroundColor=i.prototype.sync_backgroundGradient=i.prototype.sync_backgroundColorEnd=i.prototype.sync_backgroundColorOverlay=function(){this.updateBackgroundColor()},i.prototype.updateBackgroundColor=function(){var t,e=this.getBackgroundColor(),i=this.getBackgroundGradient();"off"!==i&&(t=this.getBackgroundColorEnd()),this.slideBackground.updateColor(e,i,t,this.getBackgroundColorOverlay())},i.prototype.sync_backgroundImage=function(){this.slideBackground.setImage(this.getBackgroundImage())},i.prototype.sync_background_type=function(){this.slideBackground.setType(this.fields["background-type"].val())},i.prototype.getType=function(){return this.fields["background-type"].val()},i.prototype.sync_backgroundMode=function(){this.slideBackground.setMode(this.fields.backgroundMode.val())},i.prototype.sync_backgroundFocusY=i.prototype.sync_backgroundFocusX=function(){this.slideBackground.setFocus(this.getBackgroundFocusX(),this.getBackgroundFocusY())},i.prototype.sync_backgroundImageOpacity=function(){this.slideBackground.setImageOpacity(this.getBackgroundImageOpacity())},i.prototype.getBackgroundImageOpacity=function(){return this.fields.backgroundImageOpacity.val()},i.prototype.sync_backgroundImageBlur=function(){this.slideBackground.setBlur(this.getBackgroundImageBlur())},i.prototype.getBackgroundColor=function(){return this.editor.generator.fill(this.fields.backgroundColor.val())},i.prototype.getBackgroundGradient=function(){return this.fields.backgroundGradient.val()},i.prototype.getBackgroundColorEnd=function(){return this.editor.generator.fill(this.fields.backgroundColorEnd.val())},i.prototype.getBackgroundColorOverlay=function(){return!!+this.fields.backgroundColorOverlay.val()},i.prototype.getBackgroundImage=function(){return this.editor.generator.fill(this.fields.backgroundImage.val())},i.prototype.getBackgroundImageBlur=function(){return this.fields.backgroundImageBlur.val()},i.prototype.getBackgroundFocusX=function(){return this.fields.backgroundFocusX.val()},i.prototype.getBackgroundFocusY=function(){return this.fields.backgroundFocusY.val()},i}),N2D("FormElementStyleMode",function(t,e){function i(e){this.$element=t("#"+e).on("nextendChange",t.proxy(function(){""==this.$element.val()?this.$reset.css("visibility","hidden"):this.$reset.css("visibility","")},this)),this.$container=this.$element.parent(),this.$reset=this.$container.find(".n2-form-element-style-mode-reset").on("click",t.proxy(function(){this.$element.triggerHandler("n2resetmode")},this))}return i}),N2D("SmartSliderAdminSlideBackgroundColor",["SmartSliderSlideBackgroundColor"],function(t,e){function i(t,e){N2Classes.SmartSliderSlideBackgroundColor.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.SmartSliderSlideBackgroundColor.prototype),i.prototype.constructor=i,i.prototype.update=function(t,e,i,s){t=this.fixColor(t),this.$el.css({background:""}),this.$el.attr("data-overlay",s?1:0),"off"!==e?this.updateGradient(t,e,i):this.updateColor(t)},i.prototype.updateColor=function(t){"00"!==t.substr(6,8)&&this.$el.css("background","#"+t.substr(0,6)).css("background",N2Color.hex2rgbaCSS(t))},i.prototype.updateGradient=function(t,e,i){switch(this.$el.css({background:""}),i=this.fixColor(i),e){case"horizontal":this.$el.css("background","linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)");break;case"vertical":this.$el.css("background","linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)");break;case"diagonal1":this.$el.css("background","linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)");break;case"diagonal2":this.$el.css("background","linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)")}},i.prototype.fixColor=function(t){return t.length&&"#"===t.charAt(0)&&(t=t.substring(1),6===t.length&&(t+="ff")),t},i}),N2D("SmartSliderAdminSlideBackgroundImage",["SmartSliderSlideBackgroundImage"],function(t,e){function i(t,e,i,s){this.hash=s.data("hash"),N2Classes.SmartSliderSlideBackgroundImage.prototype.constructor.apply(this,arguments),this.loadAllowed=!0,this.listenImageManager()}return i.prototype=Object.create(N2Classes.SmartSliderSlideBackgroundImage.prototype),i.prototype.constructor=i,i.prototype.listenImageManager=function(){""!==this.hash&&t(window).on(this.hash,t.proxy(this.onImageManagerChanged,this))},i.prototype.notListenImageManager=function(){""!==this.hash&&t(window).off(this.hash,null,t.proxy(this.onImageManagerChanged,this))},i.prototype.onImageManagerChanged=function(t,e){this.tabletSrc=e.tablet.image,this.mobileSrc=e.mobile.image,this.updateBackgroundToDevice(this.manager.device)},i.prototype.preLoadAdmin=function(e){this.preLoad(),""!==e&&this.background.allowVisualLoad&&(this.notListenImageManager(),this.deferred.done(t.proxy(function(){t.when(nextend.imageManager.getVisual(e)).done(t.proxy(function(t){this.onImageManagerChanged(null,t.value),this.listenImageManager()},this))},this)))},i.prototype.setDesktopSrc=function(e){if(this.notListenImageManager(),this.desktopSrc=e,this.hash=md5(e),""!==e&&this.background.allowVisualLoad){var i=new Image;i.addEventListener("load",t.proxy(function(){t.when(nextend.imageManager.getVisual(e)).done(t.proxy(function(t){this.onImageManagerChanged(null,t.value),this.listenImageManager()},this))},this),!1),i.src=nextend.imageHelper.fixed(e)}else this.tabletSrc="",this.mobileSrc="",this.setSrc(nextend.imageHelper.fixed(e))},i.prototype.setSrc=function(t){N2Classes.SmartSliderSlideBackgroundImage.prototype.setSrc.call(this,nextend.imageHelper.fixed(t))},i.prototype.startFixed=function(){},i.prototype.updateMode=function(t,e){if("blurfit"===t&&1===this.$background.length){this.$background=this.$background.add(this.$background.clone().insertAfter(this.$background));var i=7;this.$background.first().css({margin:"-"+2*i+"px",padding:2*i+"px"}).css(window.n2FilterProperty,"blur("+i+"px)")}"blurfit"===e&&"blurfit"!==t&&(this.$background.eq(1).remove(),this.$background=this.$background.eq(0),this.updateBlur(this.blur))},i.prototype.updateFocus=function(t,e){this.$background.css("background-position",t+"% "+e+"%")},i.prototype.updateOpacity=function(t){this.$background.css("opacity",t/100)},i.prototype.updateBlur=function(t){window.n2FilterProperty&&(t>0?this.$background.last().css({margin:"-"+2*t+"px",padding:2*t+"px"}).css(window.n2FilterProperty,"blur("+t+"px)"):this.$background.last().css({margin:"",padding:""}).css(window.n2FilterProperty,"")),this.blur=t},i.prototype.kill=function(){this.notListenImageManager(),this.$background.remove()},i}),N2D("LayerContainer",function(t,e){"use strict";function i(t,e,i,s,r){this.component=t,this.$ul=e.data("container",this),this.allowedPlacementMode=i,this.childrenSelector=s,this.allowedChildren=r,this.layerContainerElement=t.layer}return i.prototype.setLayerContainerElement=function(t){this.layerContainerElement=t},i.prototype.startWithExistingNodes=function(t){for(var e=this.layerContainerElement.find(this.childrenSelector),i=0;i<e.length;i++)this._loadNode(e.eq(i),t);this.component.onChildCountChange()},
i.prototype.isChildAllowed=function(e){return-1!==t.inArray(e,this.allowedChildren)},i.prototype._loadNode=function(t,i){var s=t.data("sstype");if(this.isChildAllowed(s)){var r=t.data("lastplacement"),n={};if(r!==e&&r!=this.allowedPlacementMode)switch(r){case"absolute":n=N2Classes.PlacementAbsolute.cleanLayer(t);break;case"normal":n=N2Classes.PlacementNormal.cleanLayer(t)}var o;switch(s){case"layer":o=new N2Classes.Layer(this.component.fragmentEditor,this.component);var a=o.itemEditor.getItemClass(t.find(".n2-ss-item").data("item"));a&&N2Classes[a].needSize&&n.desktopportraitheight!==e&&t.data("desktopportraitheight",n.desktopportraitheight);break;case"content":o=new N2Classes.Content(this.component.fragmentEditor,this.component);break;case"row":o=new N2Classes.Row(this.component.fragmentEditor,this.component);break;case"col":o=new N2Classes.Col(this.component.fragmentEditor,this.component);break;case"group":}if(o)return o.load(t,i),i||o.sync(),o}else console.error(s+" is not allowed in "+this.component.label);return!1},i.prototype.getLayerCount=function(){return this.layerContainerElement.find(this.childrenSelector).length},i.prototype.getLayerIndex=function(t){return this.layerContainerElement.find(this.childrenSelector).index(t)},i.prototype.getSortedLayers=function(){var i=[];return this.layerContainerElement.find(this.childrenSelector).each(function(s,r){var n=t(r).data("layerObject");n!==e&&i.push(n)}),i},i.prototype.append=function(t){t.appendTo(this.layerContainerElement);var e=this._loadNode(t,!1);return this.component.onChildCountChange(),e},i.prototype.insertAt=function(t,e){var i=this.getSortedLayers();e>=i.length?t.appendTo(this.layerContainerElement):t.insertBefore(i[e].layer);var s=this._loadNode(t,!1);return this.component.onChildCountChange(),s},i.prototype.insert=function(t){t.getRootElement().appendTo(this.layerContainerElement)},i.prototype.insertLayerAt=function(e,i){var s=this.getSortedLayers(),r=e.group,n=t.inArray(e,s);n>-1&&i>n&&i++,i>=s.length?e.getRootElement().appendTo(this.layerContainerElement):e.getRootElement().insertBefore(s[i].getRootElement()),this.syncLayerRow(e),r!==this.component&&r.onChildCountChange()},i.prototype.syncLayerRow=function(t){var i,s="absolute"===this.allowedPlacementMode;i=s?t.getRootElement().prevAll(".n2-ss-layer, .n2-ss-layer-group").first().data("layerObject"):t.getRootElement().nextAll(".n2-ss-layer, .n2-ss-layer-group").first().data("layerObject"),i!==e?t.layerRow.insertBefore(i.layerRow):this.$ul.append(t.layerRow),t.animations&&t.animations.syncRow(i,s)},i.prototype.getChildLayersRecursive=function(t){for(var e=this.getSortedLayers(),i=[],s=0;s<e.length;s++)t?i.push(e[s].layer[0]):i.push(e[s]),e[s].container&&i.push.apply(i,e[s].container.getChildLayersRecursive(t));return i},i.prototype.moveLayerToGroup=function(t,e){this.moveLayersToGroup([t],[e])},i.prototype.moveLayersToGroup=function(e,i){i=i||[];for(var s=[],r=0;r<e.length;r++){var n=e[r],o=n.group,a=n.getIndex();"undefined"!=typeof i[r]?this.insertLayerAt(n,i[r]):this.insert(n),n.changeGroup(a,this.component),this!=o&&-1==t.inArray(o,s)&&s.push(o)}for(var r=0;r<s.length;r++)s[r].update()},i.prototype.activateFirst=function(){var t=this.getSortedLayers();t.length>0&&t[t.length-1].activate()},i.prototype.resetModes=function(t){for(var i=this.getSortedLayers(),s=0;s<i.length;s++)i[s].resetMode(t),i[s].container!=e&&i[s].container.resetModes(t)},i.prototype.copyModes=function(t,i){for(var s=this.getSortedLayers(),r=0;r<s.length;r++)s[r].copyMode(t,i),s[r].container!=e&&s[r].container.copyModes(t,i)},i.prototype.changeEditorModes=function(t){for(var i=this.getSortedLayers(),s=0;s<i.length;s++)i[s].changeEditorMode(t),i[s].container!=e&&i[s].container.changeEditorModes(t)},i.prototype.renderModeProperties=function(){for(var t=this.getSortedLayers(),i=0;i<t.length;i++)t[i].renderModeProperties(),t[i].container!=e&&t[i].container.renderModeProperties()},i.prototype.getAllLayers=function(t){t=t||[];for(var i=this.getSortedLayers(),s=0;s<i.length;s++)t.push(i[s]),i[s].container!=e&&i[s].container.getAllLayers(t);return t},i.prototype.getData=function(e){e=t.extend({layersIncluded:!0,itemsIncluded:!0},e);var i=[],s=this.getSortedLayers();if("absolute"==this.allowedPlacementMode)for(var r=s.length-1;r>=0;r--)i.push(s[r].getData(e));else for(var r=0;r<s.length;r++)i.push(s[r].getData(e));return i},i.prototype.getHTML=function(t){for(var e=this.getSortedLayers(),i=[],s=0;s<e.length;s++)i.push(e[s].getHTML(t));return i},i.prototype.getDroppables=function(t){for(var e=[],i=this.getSortedLayers(),s=0;s<i.length;s++)if(i[s]!=t){var r=i[s].getDroppable();"object"==typeof r&&e.push(r),"hidden"!=r&&i[s].container&&e.push.apply(e,i[s].container.getDroppables(t))}return e},i.prototype.getLLDroppables=function(t){var e=[],i=this.component.getLLDroppable(t);i&&e.push(i);for(var s=this.getSortedLayers(),r=0;r<s.length;r++)s[r].container&&s[r]!=t&&e.push.apply(e,s[r].container.getLLDroppables(t));return e},i}),N2D("LayerDataStorage",function(t,e){"use strict";function i(){this.isDeviceProp={},this.propertyScope={},this.property={},this.deviceProperty={desktopPortrait:{},desktopLandscape:{},tabletPortrait:{},tabletLandscape:{},mobilePortrait:{},mobileLandscape:{}},this.advancedProperties={}}return i.prototype.getMode=function(){return this.fragmentEditor.getMode()},i.prototype.getProperties=function(){var t={};for(var i in this.property)if(this.advancedProperties[i]!==e){if(i==this.advancedProperties[i].getName()){var s=this.property[i],r=this.advancedProperties[i].getBaseName();this.property[i]===e&&(s=this.property[r]),t[r]=s}}else t[i]=this.property[i];return t},i.prototype.getRawProperty=function(t){if(this.isDeviceProp[t]){var i=this.getMode(),s=this.deviceProperty[i];return s[t]!==e?s[t]:e}return this.property[t]},i.prototype.getProperty=function(t){if(this.isDeviceProp[t]){var e=this.getMode(),i=this.deviceProperty[e],s=this.deviceProperty.desktopPortrait;if("undefined"!=typeof i[t])return i[t];if("undefined"!=typeof s[t])return s[t]}return this.property[t]},i.prototype.historyStore=function(t,e,i){if(!this.isDeleteStarted){var s=this.getMode();this.isDeviceProp[e]&&i!=s?(this.deviceProperty[i][e]=t,this.render(e)):(this.store(e,t,!0,"history"),this.$.trigger("propertyChanged",[e,this.getProperty(e)]))}},i.prototype.store=function(t,e,i,s){var r,n,o=this.getMode();this.isDeviceProp[t]?(r=this.deviceProperty[o][t],n=this.getProperty(t)):n=r=this.property[t];var a=N2Classes.History.get().addValue(this,this.historyStore,[t,o]);a&&a.setValues(r,e),this.property[t]=e,this.isDeviceProp[t]&&(this.deviceProperty[o][t]=e),i&&this.render(t,n,s)},i.prototype.render=function(t,e,i){this.propertyScope[t]["_sync"+t](e,i)},i.prototype.isDimensionPropertyAccepted=function(t){return(t+"").match(/[0-9]+%/)||"auto"==t},i.prototype.changeEditorMode=function(t){var e=parseInt(this.property[t]);e?this._show():this._hide(),this.layer.triggerHandler("LayerShowChange",[t,e]),this.renderModeProperties(!1)},i.prototype.renderModeProperties=function(t){for(var e in this.isDeviceProp)this.isDeviceProp[e]&&(this.property[e]=this.getProperty(e),this.$.trigger("propertyChanged",[e,this.property[e]]))},i.prototype.historyResetMode=function(e,i){this.deviceProperty[i]=t.extend({},e),i==this.fragmentEditor.getMode()&&this.renderModeProperties(!0)},i.prototype.resetMode=function(e){if("desktopPortrait"!=e){var i,s=N2Classes.History.get().addValue(this,this.historyResetMode,[e]);s&&s.setValues(t.extend({},this.deviceProperty[e]),{});for(var r in this.deviceProperty[e])this.deviceProperty[e][r]=i;e==this.fragmentEditor.getMode()&&this.renderModeProperties(!0)}},i.prototype.copyMode=function(e,i){if(e!=i){var s=this.deviceProperty[i];this.deviceProperty[i]=t.extend({},this.deviceProperty[i],this.deviceProperty[e]);var r=N2Classes.History.get().addValue(this,this.historyResetMode,[i]);r&&r.setValues(s,this.deviceProperty[i])}},i.prototype._getDefault=function(t,i){return this.originalProperties[t]!==e?this.originalProperties[t]:i},i.prototype.createProperty=function(t,i,s,r){this.isDeviceProp[t]=!1,this.propertyScope[t]=r||this,s?(this.property[t]=s.data(t.toLowerCase()),this.property[t]===e&&(this.property[t]=this._getDefault(t,i))):this.property[t]=this._getDefault(t,i)},i.prototype.createAdvancedProperty=function(t,e,i){var s=t.getNames();for(var r in s)this.advancedProperties[r]=t,this.createProperty(r,s[r],e,i)},i.prototype.syncAdvancedField=function(t){var i=this.advancedProperties[t].getName(),s=this.property[i];this.property[i]===e&&(s=this.property[t]),this.fragmentEditor.layerOptions.updateField(t,s)},i.prototype.createDeviceProperty=function(t,i,s,r){var n,o;if(this.isDeviceProp[t]=!0,this.propertyScope[t]=r||this,s){for(n in this.deviceProperty)this.deviceProperty[n][t]=s.data(n.toLowerCase()+t.toLowerCase()),""===this.deviceProperty[n][t]&&(this.deviceProperty[n][t]=e);for(n in this.deviceProperty)this.deviceProperty[n][t]!==e&&""!==this.deviceProperty[n][t]||(o=this._getDefault(n.toLowerCase()+t.toLowerCase()),o!==e&&(this.deviceProperty[n][t]=o));for(n in i)this.deviceProperty[n][t]!==e&&""!==this.deviceProperty[n][t]||(this.deviceProperty[n][t]=i[n])}else{for(n in i)this.deviceProperty[n][t]=i[n];for(n in this.deviceProperty)o=this._getDefault(n.toLowerCase()+t.toLowerCase()),o!==e&&(this.deviceProperty[n][t]=o)}this.property[t]=this.deviceProperty.desktopPortrait[t]},i.prototype.removeProperty=function(t){if(delete this.property[t],this.layer.removeData(t.toLowerCase()).removeAttr("data-"+t.toLowerCase()),this.isDeviceProp[t])for(var e in this.deviceProperty)delete this.deviceProperty[e][t],this.layer.removeData(e.toLowerCase()+t.toLowerCase()).removeAttr("data-"+e.toLowerCase()+t.toLowerCase());delete this.isDeviceProp[t],delete this.propertyScope[t]},i.prototype.removeProperties=function(t){for(var e=0;e<t.length;e++)this.removeProperty(t[e])},i.prototype.getPropertiesData=function(t){for(var i={},s=0;s<t.length;s++){var r=t[s];if(this.property[r]!==e&&(i[r]=this.property[r]),this.isDeviceProp[r])for(var n in this.deviceProperty)this.deviceProperty[n][r]!==e&&(i[n.toLowerCase()+r]=this.deviceProperty[n][r])}return i},i.prototype.setProperty=function(t,i,s){this.advancedProperties[t]!==e&&(t=this.advancedProperties[t].getName()),this.propertyScope[t]!==e?"function"==typeof this.propertyScope[t]["setProperty"+t]?this.propertyScope[t]["setProperty"+t](t,i,s):this._setProperty(t,i,s):"function"==typeof this["setProperty"+t]&&this["setProperty"+t](t,i,s)},i.prototype._setProperty=function(t,e,i){this.store(t,e,!0,i),"manager"!=i&&this.$.trigger("propertyChanged",[t,this.getProperty(t)])},i.prototype.onSyncFields=function(){},i.prototype.resetStyleMode=function(t){for(var e in this.advancedProperties)this.advancedProperties[e].resetMode(t)},i}),N2D("FragmentEditor",function(t,e){"use strict";function i(e,i,s,r){this.mode="desktopPortrait",this.editor=e,this.$editedElement=i,this.configuration=s,this.ready=t.Deferred(),this.shouldPreventActivationBubble=!1,this.$=t(this),e.fragmentEditor=this,this.$highlight=t('<div class="n2-ss-layer-highlight n2-ss-layer-highlight-n" /><div class="n2-ss-layer-highlight n2-ss-layer-highlight-e" /><div class="n2-ss-layer-highlight n2-ss-layer-highlight-s" /><div class="n2-ss-layer-highlight n2-ss-layer-highlight-w" />'),this.initSelectMode(),this.layerWindow=new N2Classes.LayerWindow(this),this.layerOptions=new N2Classes.ComponentSettings(this),this.ui=new N2Classes.CanvasUserInterface(this),this.mainContainer=new N2Classes.MainContainer(this),this.itemEditor=new N2Classes.ItemManager(this,r),this.mainContainer.lateInit(),this._initDeviceModeChange(),this.canvasSettings=new N2Classes.CanvasSettings(this),this.layerOptions.startFeatures(),this.hotkeys(),this.addContextMenu(),this.mainContainer.refreshHasLayers();var n=t("#n2-ss-editor-mode .n2-radio-option"),o=t.proxy(function(t){switch(this.updateEditorMode(t),t){case"content":n.eq(0).addClass("n2-active"),n.eq(1).removeClass("n2-active");break;case"canvas":n.eq(0).removeClass("n2-active"),n.eq(1).addClass("n2-active")}},this);if(this.mainContent&&this.mainContent.container.getLayerCount())o("content");else{var a=this.mainContainer.container.getSortedLayers();if(this.mainContent&&a.length>1||!this.mainContent&&a.length>0)o("canvas");else{var l=t.jStorage.get("editormode");l||(l="content",t.jStorage.set("editormode",l)),o(l)}}n.on("click",t.proxy(function(e){n.removeClass("n2-active");var i=t(e.currentTarget),s=i.data("mode");i.addClass("n2-active"),s!=this.currentEditorMode&&(this.updateEditorMode(s),t.jStorage.set("editormode",s))},this)),this.isMultiDrag=!1}var s={16:0,38:0,40:0,37:0,39:0},r={97:"left",98:"center",99:"right",100:"left",101:"center",102:"right",103:"left",104:"center",105:"right"},n={97:"bottom",98:"bottom",99:"bottom",100:"middle",101:"middle",102:"middle",103:"top",104:"top",105:"top"},o={OFF:0,ON:1,GROUP:2};return i.prototype.updateEditorMode=function(e){this.currentEditorMode=e,t("body").attr("data-editormode",this.currentEditorMode)},i.prototype.getMode=function(){return this.mode},i.prototype.getResponsiveRatioHorizontal=function(){return this.editor.getHorizontalRatio()},i.prototype.getResponsiveRatioVertical=function(){return this.editor.getVerticalRatio()},i.prototype.setMainContent=function(t){this.mainContent=t},i.prototype.isGroup=function(t){return!1},i.prototype.isRow=function(t){return t instanceof N2Classes.Row},i.prototype.isCol=function(t){return t instanceof N2Classes.Col},i.prototype.isLayer=function(t){return t instanceof N2Classes.Layer},i.prototype.isContent=function(t){return t instanceof N2Classes.Content},i.prototype._initDeviceModeChange=function(){var e=t("#layerresettodesktop").on("click",t.proxy(this.__onResetToDesktopClick,this));this.resetToDesktopTRElement=e.closest("tr"),this.resetToDesktopGlobalElement=t("#n2-ss-layer-reset-to-desktop").on("click",t.proxy(function(){"block"==this.resetToDesktopTRElement.css("display")&&e.trigger("click")},this));var i=t("#n2-ss-layer-show-on"),s={},r=this.editor.getAvailableDeviceModes();for(var n in r)r[n]&&(s[n]=t('<div class="n2-radio-option"><i class="n2-i n2-it n2-i-'+n+'"></i></div>').on("click",t.proxy(function(t){this.layerOptions.currentForm[t].data("field").onoff.trigger("click")},this,n)).appendTo(i));i.children().first().addClass("n2-first"),i.children().last().addClass("n2-last"),this.globalShowOnDeviceCB=function(t){"undefined"!=typeof s[t]&&s[t].toggleClass("n2-active",1==this.layerOptions.currentForm[t].val())},this.layerOptions.forms.global.desktopPortrait.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"desktopPortrait")),this.layerOptions.forms.global.desktopLandscape.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"desktopLandscape")),this.layerOptions.forms.global.tabletPortrait.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"tabletPortrait")),this.layerOptions.forms.global.tabletLandscape.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"tabletLandscape")),this.layerOptions.forms.global.mobilePortrait.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"mobilePortrait")),this.layerOptions.forms.global.mobileLandscape.on("nextendChange",t.proxy(this.globalShowOnDeviceCB,this,"mobileLandscape")),t("#layershow").data("field").setAvailableDevices(r),this.refreshMode(),this.ready.resolve()},i.prototype.refreshMode=function(){this.mode=this.editor.getDeviceMode(),this.resetToDesktopTRElement.css("display","desktopPortrait"==this.mode?"none":""),this.resetToDesktopGlobalElement.css("display","desktopPortrait"==this.mode?"none":""),this.mainContainer.container.changeEditorModes(this.mode)},i.prototype.onChangeDeviceOrientation=function(){this.refreshMode()},i.prototype.onResize=function(t){this.mainContainer.onResize(t),this.canvasSettings.ruler&&this.canvasSettings.ruler.onResize()},i.prototype.__onResetToDesktopClick=function(){if(this.mainContainer.getSelectedLayer()){var t=this.getMode();this.mainContainer.getSelectedLayer().resetMode(t)}},i.prototype.copyOrResetMode=function(t){var e=this.getMode();"desktopPortrait"==e?"desktopPortrait"!=t&&this.mainContainer.container.resetModes(t):t==e?this.mainContainer.container.resetModes(t):this.mainContainer.container.copyModes(e,t)},i.prototype.getSnap=function(){return this.canvasSettings.get("n2-ss-snap-to-enabled")?t(this.configuration.snapSelector):!1},i.prototype.getHTML=function(){for(var e=t("<div></div>"),i=this.mainContainer.container.getAllLayers(),s=0;s<i.length;s++)e.append(i[s].getHTML(!0));return e.html()},i.prototype.getData=function(){return this.mainContainer.container.getData()},i.prototype.importLayers=function(e,i){var s=(this.mainContainer,t.extend(!0,[],e));i&&this.mainContainer.deleteLayers(),this._idTranslation={};for(var r=this.dataToLayers(s),n=0;n<r.length;n++)this.mainContainer.container.append(r[n]);if(this.refreshMode(),!this.mainContainer.getSelectedLayer()){var s=this.mainContainer.container.getSortedLayers();s.length>0&&s[0].activate()}},i.prototype.loadComponentWithNode=function(t,e,i,s){var r=t.container.append(e);return s&&this.refreshMode(),r},i.prototype.insertComponentWithNode=function(t,e,i,s,r){var n=t.container.insertAt(e,i);return r&&this.refreshMode(),n},i.prototype.fixActiveLayer=function(){var t=this.mainContainer.getSelectedLayer();(0==t||t.isDeleted)&&this.resetActiveLayer()},i.prototype.resetActiveLayer=function(){var t=this.mainContainer.container.getSortedLayers();t.length?t[t.length-1].activate():this.changeActiveLayer(null)},i.prototype.changeActiveLayer=function(e,i){var s=this.mainContainer.getSelectedLayer();s&&!s.isDeleted&&(s.$.off("propertyChanged.editor").off(".active"),s.deActivate()),this.mainContainer.activeLayer=e,i||this.exitSelectMode(),e&&(this.layerOptions.changeActiveComponent(e,e.type,e.placement.getType(),e.getProperties()),e.$.on({"propertyChanged.editor":t.proxy(this.layerOptions.onUpdateField,this.layerOptions),"placementChanged.active":t.proxy(function(t,i,s){this.layerOptions.changeActiveComponentPlacement(i,e.property)},this)})),this.$.trigger("activeLayerChanged")},i.prototype.highlight=function(t){this.$highlight.appendTo(t.layer)},i.prototype.deHighlight=function(t){this.$highlight.detach()},i.prototype["delete"]=function(){this.mainContainer.getSelectedLayer()&&this.doActionOnActiveLayer("delete")},i.prototype.duplicate=function(){this.mainContainer.getSelectedLayer()&&this.doActionOnActiveLayer("duplicate",[this.selectMode!=o.ON,!1])},i.prototype.copy=function(i){var s;if(i==e)if(1==this.selectMode)s=this.selectedLayers;else{var r=this.mainContainer.getSelectedLayer();r&&(s=this.isCol(r)||this.isContent(r)?r.container.getSortedLayers():[r])}else s=this.isCol(i)||this.isContent(i)?i.container.getSortedLayers():[i];var n=this.mainContainer.getLayerData(s);n.length&&t.jStorage.set("ss3layersclipboard",JSON.stringify(n))},i.prototype.paste=function(i){var s=t.jStorage.get("ss3layersclipboard");if(s){var r=JSON.parse(s);if(r.length){var n;n=i!==e&&i?this.isCol(i)||this.isContent(i)?i:i.group:this.mainContainer.getActiveGroup(),this.mainContainer.addLayers(r,n)}}},i.prototype.hasLayersOnClipboard=function(){return!!t.jStorage.get("ss3layersclipboard")},i.prototype.addContextMenu=function(){this.$editedElement.nextendContextMenu({onShow:t.proxy(function(e,i){var s=t(e.target),r=s.closest(".n2-ss-layer"),n=r.data("layerObject");n||(n=this.mainContainer.getSelectedLayer()),n&&(this.isCol(n)||this.isContent(n)?i.addItem("Copy child layers","n2-i-copy",t.proxy(function(){this.copy(n)},this)):i.addItem("Copy layer","n2-i-copy",t.proxy(function(){this.selectMode==o.ON?this.copy():this.copy(n)},this))),this.hasLayersOnClipboard()&&i.addItem("Paste layer(s)","n2-i-paste",t.proxy(function(){this.paste(n)},this)),i.addItem("Copy slide","n2-i-copy",t.proxy(function(){this.editor.copy()},this)),this.editor.hasClipboard()&&i.addItem("Paste slide","n2-i-paste",t.proxy(function(){this.editor.paste()},this))},this)})},i.prototype.initSelectMode=function(){this.selectMode=o.OFF,this.selectedLayers=[],t(".n2-ss-layer-list-top-bar .n2-button").on("mousedown",t.proxy(function(e){switch(e.preventDefault(),t(e.currentTarget).data("action")){case"delete":this["delete"]();break;case"duplicate":this.duplicate();break;case"group":this.createGroupFromSelected();break;case"cancel":this.exitSelectMode()}},this))},i.prototype.startSelection=function(t){t?(this.selectMode==o.ON&&this.exitSelectMode(),this.changeSelectMode(o.GROUP)):this.changeSelectMode(o.ON)},i.prototype.changeSelectMode=function(e){var i=this.selectMode;i!=e&&(i==o.ON?t("#n2-admin").removeClass("n2-ss-select-layer-mode-on"):i==o.GROUP&&t("#n2-admin").removeClass("n2-ss-select-layer-mode-group"),this.selectMode=e,i==o.GROUP&&e==o.ON&&this.selectedLayers[0].activate(null,null,!0),e==o.OFF?t("#n2-admin").removeClass("n2-ss-select-layer-mode"):(t("#n2-admin").addClass("n2-ss-select-layer-mode"),e==o.ON?t("#n2-admin").addClass("n2-ss-select-layer-mode-on"):e==o.GROUP&&t("#n2-admin").addClass("n2-ss-select-layer-mode-group")),this.selectMode==o.OFF?t("body").off(".n2-ss-selection"):t("body").on("mousedown.n2-ss-selection",t.proxy(function(t){3!=t.which&&"main"==N2Classes.WindowManager.get().getCurrentWindow()&&N2Classes.WindowManager.get().mouseDownArea===!1&&this.exitSelectMode()},this)))},i.prototype.endSelection=function(t){t&&this.selectMode==o.GROUP&&this.exitSelectMode()},i.prototype.selectLayer=function(t,e){if("layer"!=t.type)return!0;if(this.selectMode!=o.ON){var i=this.mainContainer.getSelectedLayer();if("layer"!=i.type)return t.activate(null),!0;this.startSelection(!1),e&&this.selectedLayers.push(i)}return this._selectLayer(t),!0},i.prototype._selectLayer=function(e){var i=t.inArray(e,this.selectedLayers);if(-1!=i){if(this.selectMode==o.ON&&this.selectedLayers.length<=1)return this.exitSelectMode(),!1;var s=this.selectedLayers[i];if(this.selectedLayers.splice(i,1),e.layerRow.removeClass("n2-selected"),e.layer.removeClass("n2-ss-layer-selected"),this.selectMode==o.ON&&this.selectedLayers.length<=1)return this.selectedLayers[0].activate(),this.exitSelectMode(),!1;s===this.mainContainer.getSelectedLayer()&&this.selectedLayers[0].activate(!1,null,!0)}else{for(var r=this.selectedLayers.length,n=0;n<this.selectedLayers.length;n++)if(e.layer.add(this.selectedLayers[n].layer).index(this.selectedLayers[n].layer)>0){r=n;break}this.selectedLayers.splice(r,0,e)}for(var n=0;n<this.selectedLayers.length;n++)this.selectedLayers[n].layerRow.addClass("n2-selected"),this.selectedLayers[n].layer.addClass("n2-ss-layer-selected")},i.prototype.addSelection=function(t,e){e||this.changeSelectMode(o.ON);for(var i=0;i<t.length;i++)this._selectLayer(t[i],!1)},i.prototype.exitSelectMode=function(){if(this.selectMode){for(var e=0;e<this.selectedLayers.length;e++)this.selectedLayers[e]!=this.mainContainer.getSelectedLayer()&&this.selectedLayers[e].layerRow.removeClass("n2-active"),this.selectedLayers[e].layerRow.removeClass("n2-selected"),this.selectedLayers[e].layer.removeClass("n2-ss-layer-selected");t("#n2-admin").removeClass("n2-ss-select-layer-mode"),this.selectedLayers=[],this.changeSelectMode(o.OFF)}},i.prototype.doActionOnActiveLayer=function(e,i){if(this.selectMode==o.ON)for(var s=t.extend([],this.selectedLayers),r=0;r<s.length;r++)s[r][e].apply(s[r],i);else{var n=this.mainContainer.getSelectedLayer();n&&n[e].apply(n,i)}},i.prototype.canvasDragStart=function(t,e){if(this.selectMode&&"canvas"==this.currentEditorMode&&"absolute"==e.mode){for(var i=!1,s=0;s<this.selectedLayers.length;s++){var r=this.selectedLayers[s],n=r.layer;if(n[0]!=e.layer.layer[0]){var o=n.css("display");"none"==o&&n.css("display",""),r._originalPosition=n.position(),"none"==o&&n.css("display","none")}else i=!0}i||this.exitSelectMode(),this.isMultiDrag=!0}},i.prototype.canvasDragMove=function(t,e){if(this.isMultiDrag===!0)for(var i={left:e.position.left+e.canvasOffset.left-e.originalOffset.left,top:e.position.top+e.canvasOffset.top-e.originalOffset.top},s=0;s<this.selectedLayers.length;s++){var r=this.selectedLayers[s];if(!this.isGroup(r)){var n=r.layer;n[0]!=e.layer.layer[0]&&(n.css({left:r._originalPosition.left+i.left,top:r._originalPosition.top+i.top,bottom:"auto",right:"auto"}),r.placement.doAction("triggerLayerResized"))}}},i.prototype.canvasDragStop=function(t,e){if(this.isMultiDrag===!0){for(var i=0;i<this.selectedLayers.length;i++){var s=this.selectedLayers[i];if(!this.isGroup(s)){var r=s.layer;if(r[0]!=e.layer.layer[0]){var n=r.css("display");"none"==n&&r.css("display","block");var o=parseInt(s.layer.css("left")),a=parseInt(s.layer.css("top"));s.placement.current.setPosition(o,a),s.placement.doAction("triggerLayerResized"),"none"==n&&r.css("display","none")}}}return this.isMultiDrag=!1,!0}return!1},i.prototype.historyDeleteGroup=function(t){t.getSelf()["delete"]()},i.prototype.historyCreateGroup=function(t){var e=new N2Classes.Group(this,this.mainContainer,{},null);e.create(),t.setSelf(e)},i.prototype.createGroupFromSelected=function(){var t;switch(this.selectMode){case o.ON:t=new N2Classes.Group(this,this.mainContainer,{},null),t.create(),N2Classes.History.get().addSimple(this,this.historyDeleteGroup,this.historyCreateGroup,[t]),t.addLayers(this.selectedLayers),this.exitSelectMode(),t.activate();break;case o.OFF:var e=this.mainContainer.getSelectedLayer();e.group instanceof N2Classes.Group?e.group.activate():e instanceof N2Classes.Content||e instanceof N2Classes.Col||(t=new N2Classes.Group(this,this.mainContainer,{},null),t.create(),N2Classes.History.get().addSimple(this,this.historyDeleteGroup,this.historyCreateGroup,[t]),t.addLayers([e]),t.activate());break;case o.GROUP:}},i.prototype.createRow=function(t){var e=new N2Classes.Row(this,t,{});return e.create(),e.hightlightStructure(),{layer:e}},i.prototype.createCol=function(t){var e=t,i=null;if(this.isCol(e))i=e.group.createCol();else if(this.isRow(e))i=e.createCol();else{if(!this.isCol(e.group))return this.createRow(t);i=e.group.group.createCol()}return i.activate(null),{layer:i}},i.prototype.preventActivationBubbling=function(){return this.shouldPreventActivationBubble?!1:(this.shouldPreventActivationBubble=!0,!0)},i.prototype.allowActivation=function(){this.shouldPreventActivationBubble=!1},i.prototype.hotkeys=function(){t(window).on({keydown:t.proxy(function(e){var i=!1;if("TEXTAREA"!=e.target.tagName&&"INPUT"!=e.target.tagName&&!i){var o=this.mainContainer.getSelectedLayer(),a=e.keyCode;if(a>=49&&57>=a){var l=e.originalEvent.location||e.originalEvent.keyLocation||0;3==l&&(a+=48)}if(o)if(46==a||8==a)this["delete"](),e.preventDefault();else if(35==a)this.duplicate(),e.preventDefault();else if(16==a)s[a]=1;else if(38==a){if(!s[a]){var h=t.proxy(function(){this.doActionOnActiveLayer("moveY",[-1*(s[16]?10:1)])},this);h(),s[a]=setInterval(h,100)}e.preventDefault()}else if(40==a){if(!s[a]){var h=t.proxy(function(){this.doActionOnActiveLayer("moveY",[s[16]?10:1])},this);h(),s[a]=setInterval(h,100)}e.preventDefault()}else if(37==a){if(!s[a]){var h=t.proxy(function(){this.doActionOnActiveLayer("moveX",[-1*(s[16]?10:1)])},this);h(),s[a]=setInterval(h,100)}e.preventDefault()}else if(39==a){if(!s[a]){var h=t.proxy(function(){this.doActionOnActiveLayer("moveX",[s[16]?10:1])},this);h(),s[a]=setInterval(h,100)}e.preventDefault()}else if(a>=97&&105>=a){var d=r[a],p=n[a],c=!1;this.layerOptions.forms.placement.absolute.align.val()==d&&this.layerOptions.forms.placement.absolute.valign.val()==p&&(c=!0),this.layerOptions.layerFeatures.horizontalAlign(d,c),this.layerOptions.layerFeatures.verticalAlign(p,c)}else if(65==a){e.preventDefault();var u=this.mainContainer.getSelectedLayer();u&&"absolute"==u.placement.getType()&&u.placement.current.fit()}(e.ctrlKey||e.metaKey)&&(90==a?e.shiftKey?N2Classes.History.get().redo()&&e.preventDefault():N2Classes.History.get().undo()&&e.preventDefault():71==a?(this.createGroupFromSelected(),e.preventDefault()):68==a?(e.preventDefault(),this.editor.copy()):70==a?(e.preventDefault(),this.editor.paste()):67==a?this.copy():86==a&&this.paste())}},this),keyup:t.proxy(function(t){"undefined"!=typeof s[t.keyCode]&&s[t.keyCode]&&(clearInterval(s[t.keyCode]),s[t.keyCode]=0)},this)})},i.prototype.getSelf=function(){return this},i}),N2D("CanvasUserInterface",function(t,e){"use strict";function i(e){this.fragmentEditor=e,this.isShown=!t.jStorage.get("ssLayersShown",!1),this.tlHeight=t.jStorage.get("ssLayersHeight")||200,this.$container=t("#n2-ss-layers"),this.fixScroll(),this.switchLayerList(),this.topBar=t(".n2-ss-layer-list-top-bar").on("mousedown",t.proxy(this.resizeStart,this)),this.topBar.find(".n2-ss-layer-list-opener").on("click",t.proxy(function(t){t.preventDefault(),this.switchLayerList()},this)),t(".n2-ss-slide-show-layers").on("click",t.proxy(function(t){t.preventDefault(),this.switchLayerList()},this)),this.onResize(),t(window).on("resize",t.proxy(this.onResize,this))}return i.prototype.onResize=function(){var t=this.$container.height();this.paneLeft.height(t-48),this.paneRight.height(t-48)},i.prototype.onActivateLayer=function(t){var e=this.paneLeft.scrollTop(),i=0,s=t;do i+=s.layerRow.get(0).offsetTop,s=s.group;while(s!==this.fragmentEditor.mainContainer);(e>i||i>e+this.paneLeft.height()-32)&&(this.paneLeft.scrollTop(i),this.paneRight.scrollTop(i))},i.prototype.fixScroll=function(){this.paneLeft=t(".n2-ss-layers-sidebar-rows"),this.paneRight=t(".n2-ss-timeline-content-layers-container");var e=t.proxy(function(t){var e=this.paneLeft.scrollTop();t.originalEvent.deltaY>0?e+=32:e-=32,e=32*Math.round(e/32),this.paneLeft.scrollTop(e),this.paneRight.scrollTop(e),t.preventDefault()},this);this.paneLeft.on("wheel",e),this.paneLeft.on("scroll",t.proxy(function(t){var e=this.paneLeft.scrollTop();this.paneRight.scrollTop(e),t.preventDefault()},this)),this.paneRight.on("wheel",e)},i.prototype.resizeStart=function(e){this.isShown&&(e.target==this.topBar[0]||t(e.target).hasClass("n2-h2"))&&(e.preventDefault(),this.startY=e.clientY,this.height=this.$container.height(),t("body").on({"mousemove.n2-ss-tl-resize":t.proxy(this.resizeMove,this),"mouseup.n2-ss-tl-resize":t.proxy(this.resizeStop,this),"mouseleave.n2-ss-tl-resize":t.proxy(this.resizeStop,this)}))},i.prototype.resizeMove=function(t){t.preventDefault(),this.setTLHeight(this._calculateDesiredHeight(t))},i.prototype.resizeStop=function(e){e.preventDefault(),t("body").off(".n2-ss-tl-resize");var i=this._calculateDesiredHeight(e);this.setTLHeight(i),this.tlHeight=i,t.jStorage.set("ssLayersHeight",i),t("#n2-admin").triggerHandler("resize")},i.prototype._calculateDesiredHeight=function(t){var e=this.startY-t.clientY+this.height-48;return this.__calculateDesiredHeight(e)},i.prototype.__calculateDesiredHeight=function(t){return 32*Math.round(Math.min(Math.max(32,t),(window.innerHeight||document.documentElement.clientHeight)/2)/32)+48},i.prototype.switchLayerList=function(){this.isShown=!this.isShown,this.$container.toggleClass("n2-active",this.isShown),this.isShown?this.setTLHeight(this.tlHeight):this.setTLHeight(48),t.jStorage.set("ssLayersShown",this.isShown)},i.prototype.setTLHeight=function(t){t=Math.max(48,t),this.$container.height(t),t=this.$container.height(),this.paneLeft.height(t-48),this.paneRight.height(t-48),nextend.triggerResize()},i.prototype.activateAdd=function(t,e){this.$add.css({left:t,top:e}).appendTo(this.$container)},i}),N2D("LayerFeatures",function(t,e){"use strict";function i(t,e){this.fields=t,this.fragmentEditor=e,this.initParentLinker(),this.initAlign(),this.initEvents()}var s={left:0,center:1,right:2,top:0,middle:1,bottom:2};return i.prototype.initParentLinker=function(){var e=this.fields.parentid.data("field");t("#n2-ss-layer-parent-linker").on({click:function(t){e.click(t)}})},i.prototype.initAlign=function(){this.layerDefault={align:null,valign:null};var e=t("#n2-ss-layer-horizontal-align .n2-radio-option"),i=t("#n2-ss-layer-vertical-align .n2-radio-option");e.add(i).on("click",t.proxy(function(s){if(s.ctrlKey||s.metaKey){var r=t(s.currentTarget),n=r.hasClass("n2-sub-active"),o=r.data("align");
switch(o){case"left":case"center":case"right":e.removeClass("n2-sub-active"),n?(t.jStorage.set("ss-item-horizontal-align",null),this.layerDefault.align=null):(t.jStorage.set("ss-item-horizontal-align",o),this.layerDefault.align=o,r.addClass("n2-sub-active"));break;case"top":case"middle":case"bottom":i.removeClass("n2-sub-active"),n?(t.jStorage.set("ss-item-vertical-align",null),this.layerDefault.valign=null):(t.jStorage.set("ss-item-vertical-align",o),this.layerDefault.valign=o,r.addClass("n2-sub-active"))}}else if(this.fragmentEditor.mainContainer.getSelectedLayer()){var o=t(s.currentTarget).data("align");switch(o){case"left":case"center":case"right":this.horizontalAlign(o,!0);break;case"top":case"middle":case"bottom":this.verticalAlign(o,!0)}}},this)),this.fields.align.on("nextendChange",t.proxy(function(){switch(e.removeClass("n2-active"),this.fields.align.val()){case"left":e.eq(0).addClass("n2-active");break;case"center":e.eq(1).addClass("n2-active");break;case"right":e.eq(2).addClass("n2-active")}},this)),this.fields.valign.on("nextendChange",t.proxy(function(){switch(i.removeClass("n2-active"),this.fields.valign.val()){case"top":i.eq(0).addClass("n2-active");break;case"middle":i.eq(1).addClass("n2-active");break;case"bottom":i.eq(2).addClass("n2-active")}},this));var r=t.jStorage.get("ss-item-horizontal-align",null),n=t.jStorage.get("ss-item-vertical-align",null);null!=r&&(e.eq(s[r]).addClass("n2-sub-active"),this.layerDefault.align=r),null!=n&&(i.eq(s[n]).addClass("n2-sub-active"),this.layerDefault.valign=n)},i.prototype.horizontalAlign=function(t,e){this.fields.align.val()!=t?this.fields.align.data("field").options.eq(s[t]).trigger("click"):e&&this.fields.left.val(0).trigger("change")},i.prototype.verticalAlign=function(t,e){this.fields.valign.val()!=t?this.fields.valign.data("field").options.eq(s[t]).trigger("click"):e&&this.fields.top.val(0).trigger("change")},i.prototype.initEvents=function(){var e=t("#n2-tab-events"),i=e.find(".n2-h3"),s=i.html(),r=t('<div class="n2-editor-header n2-h2 n2-uc"><span>'+s+"</span></div>");i.replaceWith(r)},i}),N2D("LayerWindow",function(t,e){"use strict";function i(e){this.isMinimized=!1,this.detachedPosition={left:t.jStorage.get("ssPanelLeft")||200,top:t.jStorage.get("ssPanelTop")||100,height:t.jStorage.get("ssPanelHeight")||400},this.hasBreadcrumb=!1,this.lastHeight=this.detachedPosition.height,this.admin=t("#n2-admin"),this.sidebar=t("#n2-ss-layer-window").on("mousedown",t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"sidebarClicked")),this.title=this.sidebar.find(".n2-ss-layer-window-title-inner"),this.fragmentEditor=e,this.viewPanes={layerEdit:t("#n2-tabbed-slide-editor-settings > .n2-tabs").addClass("n2-scrollable")};for(var i in this.viewPanes)this.viewPanes[i].on("wheel",function(e){var i=e.originalEvent.deltaY<0,s=function(){return e.stopPropagation(),e.preventDefault(),e.returnValue=!1,!1};return!i&&this.scrollHeight<=t(this).innerHeight()+this.scrollTop+1?s():i&&0>=this.scrollTop-1?s():void 0});this.panelHeading=t("#n2-tabbed-slide-editor-settings").find(".n2-sidebar-tab-switcher .n2-td");var s=this.sidebar.find(".n2-ss-layer-window-title-nav-left");t('<a href="#"><i class="n2-i n2-i-minimize n2-i-grey-opacity"></i></a>').on("click",t.proxy(function(t){t.preventDefault(),this.toggleMinimize()},this)).appendTo(s);var r=this.sidebar.find(".n2-ss-layer-window-title-nav-right");t('<a href="#"><i class="n2-i n2-i-closewindow n2-i-grey-opacity"></i></a>').on("click",t.proxy(function(t){t.preventDefault(),this.hide()},this)).appendTo(r),nextend.tooltip.add(r),this.$breadcrumb=t('<div class="n2-ss-layer-window-breadcrumb"></div>').insertAfter("#n2-tabbed-slide-editor-settings > .n2-sidebar-tab-switcher");var n=t("#n2-ss-add-sidebar");t(".n2-ss-add-layer-button").on("click",function(e){e.preventDefault(),t("#n2-ss-layers-switcher > .n2-labels .n2-td").eq(0).trigger("click"),n.toggleClass("n2-active")}),t(".n2-ss-core-item").on("click",function(t){n.removeClass("n2-active")});var o=t("#wpadminbar, .navbar-fixed-top").height()+t(".n2-top-bar").height();this.$verticalBarInner=t(".n2-ss-add-sidebar-inner").each(function(){var e=t(this);e.fixTo(e.parent(),{top:o})}),this.$resizeInnerContainer=t("#n2-ss-layers-switcher_0, #n2-ss-layers-switcher_1"),this.extraHeightToRemove=60,this.$resizeInnerContainer.length||(this.extraHeightToRemove=0,this.$resizeInnerContainer=this.$verticalBarInner),this.$resizeInnerContainer.css("overflow","auto"),this.detach(),t("#n2-admin").on("resize",t.proxy(this.resizeVerticalBar,this)),t(window).on("resize",t.proxy(this.onResize,this)),t(".n2-ss-slide-duplicate-layer").on("click",t.proxy(function(t){t.preventDefault(),this.duplicate()},this.fragmentEditor)),t(".n2-ss-slide-delete-layer").on("click",t.proxy(function(t){t.preventDefault(),this["delete"]()},this.fragmentEditor)),t("body").on("mousedown",t.proxy(function(t){"main"==N2Classes.WindowManager.get().getCurrentWindow()&&N2Classes.WindowManager.get().mouseDownArea===!1&&this.hide()},this));var a=t('<div id="n2-ss-devicespecific-settings"></div>'),l=this.fragmentEditor.editor.getAvailableDeviceModes();for(var i in l)if(l[i]){var h=i.replace(/([A-Z])/g," $1").split(" "),d=h[0],p=h[1].toLowerCase();a.append('<i class="n2-i n2-it n2-i-mini-'+d+"-"+p+'" data-device="'+d+'" data-orientation="'+p+'"></i>')}var c={mouseenter:t.proxy(function(t){a.appendTo(t.currentTarget)},this),mouseleave:t.proxy(function(t){a.detach()},this)};this.sidebar.find("[data-devicespecific] label").prepend('<span class="n2-i n2-i-mini-desktop-portrait"></span>'),this.sidebar.find("[data-devicespecific] label").on(c),a.find(".n2-i").on({click:t.proxy(function(e){e.preventDefault();var i=t(e.currentTarget);t("#n2-ss-devices").find('[data-device="'+i.data("device")+'"][data-orientation="'+i.data("orientation")+'"]').trigger("click")},this)})}return i.prototype.toggleMinimize=function(){this.isMinimized=!this.isMinimized,this.sidebar.toggleClass("n2-ss-layer-window-minized",this.isMinimized),this.isMinimized||this.onResize()},i.prototype.magnetize=function(){if(!this.autoPosition){this.autoPosition=1,t.jStorage.set("ssPanelAutoPosition",1),this.magnet.css("display","none");var e=this.fragmentEditor.mainContainer.getSelectedLayer();e&&e.positionSidebar()}},i.prototype.show=function(e,i){this.setTitle(e),t("body").addClass("n2-ss-layer-edit-visible")},i.prototype._show=function(){t("body").addClass("n2-ss-layer-edit-visible")},i.prototype.hide=function(){t("body").removeClass("n2-ss-layer-edit-visible")},i.prototype.isVisible=function(){return t("body").hasClass("n2-ss-layer-edit-visible")},i.prototype.hideWithDeferred=function(e){t("body").hasClass("n2-ss-layer-edit-visible")&&(this.hide(),e.done(t.proxy(this._show,this)))},i.prototype.setTitle=function(t){this.title.html(t.getName()),this.updateGroupTitle(t)},i.prototype.updateGroupTitle=function(e){var i;for(this.$breadcrumb.html(""),i=0;5>i&&(t('<span class="n2-window-title-structure-nav"><span>'+e.label+'</span><span class="n2-i n2-it n2-i-mini-arrow-thin"></span></span>').on({mouseenter:t.proxy(function(){this.fragmentEditor.highlight(this)},e),mouseleave:t.proxy(function(){this.fragmentEditor.deHighlight(this)},e),click:t.proxy(function(t){this.fragmentEditor.deHighlight(this),this.activate(t)},e)}).prependTo(this.$breadcrumb),e.group&&e.group!==this.fragmentEditor.mainContainer);i++)e=e.group;this.hasBreadcrumb=i>0,this.$breadcrumb.toggleClass("n2-has-breadcrumb",this.hasBreadcrumb),this.onResize()},i.prototype.getLayerEditExcludedHeight=function(){return 85+(this.hasBreadcrumb?23:0)},i.prototype.resizeVerticalBar=function(){this.$resizeInnerContainer.height((window.innerHeight||document.documentElement.clientHeight)-(t("#n2-ss-layers").is(":visible")&&t("#n2-ss-layers").hasClass("n2-active")?t("#n2-ss-layers").height():0)-t("#wpadminbar, .navbar-fixed-top").height()-t(".n2-top-bar").height()-this.extraHeightToRemove)},i.prototype.onResize=function(){this.sidebar.css("display","block"),this.resizeVerticalBar();var t=window.innerHeight||document.documentElement.clientHeight,e=this.sidebar.height()-this.getLayerEditExcludedHeight();this.viewPanes.layerEdit.height(e);var i={},s=window.innerWidth||document.documentElement.clientWidth,r=this.sidebar[0].getBoundingClientRect();r.left<0?i.left=0:r.left+r.width>s&&(i.left=Math.max(0,s-r.width)),r.height>t-r.top&&(i.top=t-r.top-r.height+r.top,i.top<0&&(this.lastHeight=i.height=r.height+i.top,i.top=0)),this.sidebar.css(i),this.sidebar.css("display","")},i.prototype.detach=function(){this.sidebar.css(this.detachedPosition),this.sidebar.appendTo(this.admin),this.admin.addClass("n2-sidebar-hidden"),t(window).off(".n2-ss-panel"),this.sidebar.removeClass("n2-sidebar-fixed"),this.sidebar.nUIDraggable({distance:5,handle:".n2-ss-layer-window-title",containment:"window",stop:t.proxy(function(e,i){this.sidebar.css("height",this.lastHeight);var s=this.sidebar[0].getBoundingClientRect();this.detachedPosition.left=s.left,this.detachedPosition.top=s.top,t.jStorage.set("ssPanelLeft",s.left),t.jStorage.set("ssPanelTop",s.top)},this),scroll:!1}).nUIResizable({distance:5,handles:"s",stop:t.proxy(function(e,i){this.lastHeight=this.detachedPosition.height=this.sidebar.height(),t.jStorage.set("ssPanelHeight",this.detachedPosition.height)},this),create:t.proxy(function(e,i){t(e.target).find(".nui-resizable-handle").addClass("n2-ss-layer-window-resizer")},this)}),this.onResize(),nextend.triggerResize()},i.prototype.switchTab=function(t){this.panelHeading.filter('[data-tab="'+t+'"]').trigger("click")},i}),N2D("PositionDisplay",function(t,e){"use strict";function i(){this.currentSource="",t(window).ready(t.proxy(this._ready,this))}return i.prototype._ready=function(){this.$body=t("body"),this.$el=t('<div class="n2 n2-ss-position-display"/>').appendTo("body")},i.prototype.show=function(t){""==this.currentSource&&(this.currentSource=t,this.$el.addClass("n2-active"),this.$body.addClass("n2-position-display-active"))},i.prototype.update=function(t,e,i){this.currentSource==e&&this.$el.html(i).css({left:t.pageX+10,top:t.pageY+10})},i.prototype.hide=function(t){this.currentSource!=t&&t!==e||(this.$body.removeClass("n2-position-display-active"),this.$el.removeClass("n2-active"),this.currentSource="")},i.get=function(){var t=new i;return i.get=function(){return t},t},i}),N2D("Ruler",function(t,e){"use strict";function i(e,i){this.editor=e,this.showGuides=1,this.guides=[],this.container=t('<div class="n2-ruler-container" />').appendTo("#n2-ss-slide-canvas-container-inner .n2-ss-slider-outer-container"),this.scale=10,this.vertical=t('<div class="n2-ruler n2-ruler-vertical n2-unselectable"></div>').appendTo(".n2-ss-slider-real-container"),this.horizontal=t('<div class="n2-ruler n2-ruler-horizontal n2-unselectable"></div>').appendTo(this.container),this.verticalSpans=t(),this.horizontalSpans=t(),this.onResize(),t(window).on("resize",t.proxy(this.onResize,this)),this.horizontal.on("mousedown",t.proxy(function(t){this.showGuides&&new r(this,this.horizontal,t)},this)),this.vertical.on("mousedown",t.proxy(function(t){this.showGuides&&new n(this,this.vertical,t)},this));try{i=t.extend({vertical:[],horizontal:[]},JSON.parse(N2Classes.Base64.decode(i)));for(var s=0;s<i.horizontal.length;s++){var o=new r(this,this.horizontal);o.setPosition(i.horizontal[s])}for(var s=0;s<i.vertical.length;s++){var o=new n(this,this.vertical);o.setPosition(i.vertical[s])}}catch(a){}this.measureToolVertical(),this.measureToolHorizontal()}function s(e,i,s){this.ruler=e,this.container=i,this.position=0,this.guide=t('<div class="n2-ruler-guide n2-ruler-user-guide"><div class="n2-ruler-guide-border"></div><div class="n2-ruler-guide-handle"></div></div>').appendTo(i).on("mousedown",t.proxy(function(t){t.preventDefault(),t.stopPropagation(),e.editor.fragmentEditor.canvasSettings.settings["n2-ss-lock-guides"]||this["delete"]()},this)),this.ruler.addGuide(this),s&&this.create(s)}function r(){s.prototype.constructor.apply(this,arguments)}function n(){s.prototype.constructor.apply(this,arguments)}return i.prototype.addGuide=function(t){this.guides.push(t)},i.prototype.removeGuide=function(e){this.guides.splice(t.inArray(e,this.guides),1)},i.prototype.clearGuides=function(){for(var t=this.guides.length-1;t>=0;t--)this.guides[t]["delete"]()},i.prototype.onResize=function(){var e=t(".n2-ss-slider-outer-container"),i=e.width(),s=e.height();this.container.css({width:i+40,height:s+40});for(var r=this.horizontalSpans.length-3;r<i/this.scale;r++){var n=t("<span />").appendTo(this.horizontal);r%10==0?n.addClass("n2-ss-ruler-mark-large").append("<span>"+r/10*100+"</span>"):r%2==0&&n.addClass("n2-ss-ruler-mark-medium"),this.horizontalSpans=this.horizontalSpans.add(n)}for(var r=this.verticalSpans.length-3;r<s/this.scale;r++){var n=t("<span />").appendTo(this.vertical);r%10==0?n.addClass("n2-ss-ruler-mark-large").append("<span>"+r/10*100+"</span>"):r%2==0&&n.addClass("n2-ss-ruler-mark-medium"),this.verticalSpans=this.verticalSpans.add(n)}},i.prototype.toArray=function(){for(var t={horizontal:[],vertical:[]},e=0;e<this.guides.length;e++)this.guides[e]instanceof r?t.horizontal.push(this.guides[e].position):this.guides[e]instanceof n&&t.vertical.push(this.guides[e].position);return t},i.prototype.measureToolVertical=function(){var e=t('<div class="n2-ruler-guide" style="z-index:1;"><div class="n2-ruler-guide-border" style="border-color: #f00;"></div></div>').css("display","none").appendTo(this.vertical),i=!1,s=t.proxy(function(){i||(i=!0,e.css("display",""),N2Classes.PositionDisplay.get().show("Guide"))},this),r=t.proxy(function(){i&&(i=!1,e.css("display","none"),N2Classes.PositionDisplay.get().hide("Guide"))},this);this.vertical.on({mouseenter:t.proxy(function(i){if(this.showGuides){var n=0,o=Math.round(this.vertical.offset().top);s(),this.vertical.on("mousemove.n2-ruler-measure-tool",t.proxy(function(i){if(t(i.target).hasClass("n2-ruler-guide-border")&&t(i.target).parent()[0]!=e[0])r();else if(s(),n!=i.pageY){var a=i.pageY-o;e.css("top",a),N2Classes.PositionDisplay.get().update(i,"Guide",a-40+"px"),n=i.pageY}},this))}},this),mouseleave:t.proxy(function(){this.vertical.off(".n2-ruler-measure-tool"),r()},this)})},i.prototype.measureToolHorizontal=function(){var e=t('<div class="n2-ruler-guide" style="z-index:1;"><div class="n2-ruler-guide-border" style="border-color: #f00;"></div></div>').css("display","none").appendTo(this.horizontal),i=!1,s=t.proxy(function(){i||(i=!0,e.css("display",""),N2Classes.PositionDisplay.get().show("Guide"))},this),r=t.proxy(function(){i&&(i=!1,e.css("display","none"),N2Classes.PositionDisplay.get().hide("Guide"))},this);this.horizontal.on({mouseenter:t.proxy(function(i){if(this.showGuides){var n=0,o=Math.round(this.horizontal.offset().left);s(),this.horizontal.on("mousemove.n2-ruler-measure-tool",t.proxy(function(i){if(t(i.target).hasClass("n2-ruler-guide-border")&&t(i.target).parent()[0]!=e[0])r();else if(s(),n!=i.pageX){var a=Math.max(i.pageX-o,40);e.css("left",a),N2Classes.PositionDisplay.get().update(i,"Guide",a-40+"px"),n=i.pageX}},this))}},this),mouseleave:t.proxy(function(){this.horizontal.off(".n2-ruler-measure-tool"),r()},this)})},s.prototype._position=function(t,e){return Math.max(0,t)},s.prototype.setPosition=function(t){this.position=t,this.refresh()},s.prototype.refresh=function(){this.positionRender(this.position)},s.prototype["delete"]=function(){this.ruler.removeGuide(this),this.guide.remove()},r.prototype=Object.create(s.prototype),r.prototype.constructor=r,r.prototype.create=function(t){var e=Math.round(this.container.offset().left)+40;this.position=this._position(t.pageX-e,t),this.positionRender(this.position)},r.prototype.rawPositionRender=function(t){this.guide.css("left",Math.max(0,t)+40)},r.prototype.positionRender=function(t){this.guide.css("left",Math.max(0,t)+40)},n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.create=function(t){var e=Math.round(this.container.offset().top)+40;this.position=this._position(t.pageY-e,t),this.positionRender(this.position)},n.prototype.rawPositionRender=function(t){this.guide.css("top",Math.max(0,t)+40)},n.prototype.positionRender=function(t){this.guide.css("top",Math.max(0,t)+40)},i}),N2D("CanvasSettings",function(t,e){"use strict";function i(e){this.fragmentEditor=e,this.settings={};var i=t("#n2-ss-slide-canvas-settings").on("mouseleave",t.proxy(function(){i.removeClass("n2-active")},this));i.find("> a").on("click",function(t){t.preventDefault(),i.toggleClass("n2-active")}),this.$settingsPanel=i.find(".n2-ss-settings-panel-inner"),this.snapTo(),this.roundTo(),this.colorScheme(),this.fragmentEditor.editor.options.isAddSample||this.startRuler()}return i.prototype._addSettings=function(e,i,s,r){this.settings[e]=parseInt(t.jStorage.get(e,s));var n=t('<a href="#">'+i+'<span class="n2-setting-tick"><i class="n2-i n2-it n2-i-tick2"></i></span></a>').on("click",t.proxy(function(i){i.preventDefault(),this.settings[e]=1==this.settings[e]?0:1,t.jStorage.set(e,this.settings[e]),n.toggleClass("n2-setting-enabled",1==this.settings[e]),r(this.settings[e],!1)},this)).appendTo(this.$settingsPanel);n.toggleClass("n2-setting-enabled",1==this.settings[e]),r(this.settings[e],!0)},i.prototype._addAction=function(e,i){t('<a href="#" class="n2-panel-action">'+e+"</a>").on("click",t.proxy(function(t){t.preventDefault(),i()},this)).appendTo(this.$settingsPanel)},i.prototype.get=function(t){return this.settings[t]},i.prototype.snapTo=function(){this._addSettings("n2-ss-snap-to-enabled",n2_("Smart Snap"),1,t.proxy(function(t){for(var e=this.mainContainer.container.getSortedLayers(),i=0;i<e.length;i++)e[i].placement.doAction("snap")},this.fragmentEditor))},i.prototype.roundTo=function(){this._addSettings("n2-ss-round-to-enabled",n2_("Round to 5px"),1,function(t){1==t?nextend.roundTo=5:nextend.roundTo=1})},i.prototype.colorScheme=function(){var e=t("#n2-ss-slide-canvas-container");this._addSettings("n2-ss-theme-dark",n2_("Dark Mode"),0,function(t){e.toggleClass("n2-ss-theme-dark",1==t)})},i.prototype.startRuler=function(){this.ruler=new N2Classes.Ruler(this.fragmentEditor.editor,t("#slideguides").val());var e=t("#n2-ss-slide-canvas-container");this._addSettings("n2-ss-ruler-enabled",n2_("Ruler"),1,t.proxy(function(t){e.toggleClass("n2-ss-has-ruler",1==t),nextend.triggerResize()},this)),this._addSettings("n2-ss-show-guides",n2_("Show Guides"),1,t.proxy(function(t){this.ruler.showGuides=t,e.toggleClass("n2-ss-show-guides",1==t)},this)),this._addSettings("n2-ss-lock-guides",n2_("Lock Guides"),0,t.proxy(function(t){e.toggleClass("n2-ss-lock-guides",1==t)},this)),this._addAction(n2_("Clear Guides"),t.proxy(function(){this.ruler.clearGuides()},this))},i}),N2D("nUICanvasItem",["nUIMouse"],function(t,e){"use strict";function i(e,i){this.element=t(e),this.widgetName=this.widgetName||"nUICanvasItem",this.widgetEventPrefix="canvasItem",this.options=t.extend({canvasUIManager:null,layer:!1,$layer:null,distance:2,onCreate:function(){}},this.options,i),N2Classes.nUIMouse.prototype.constructor.apply(this,arguments),this.create()}return i.prototype=Object.create(N2Classes.nUIMouse.prototype),i.prototype.constructor=i,i.prototype.create=function(){"function"==typeof this.options.$layer&&(this.options.$layer=this.options.$layer.call(this,this)),this._mouseInit()},i.prototype._mouseCapture=function(t,e){return this.options.canvasUIManager._mouseCapture(this.options,t,e)},i.prototype._mouseStart=function(t,e,i){return this._trigger("start"),this.options.canvasUIManager._mouseStart(this.options,t,e,i)},i.prototype._mouseDrag=function(t){return this.options.canvasUIManager._mouseDrag(this.options,t)},i.prototype._mouseStop=function(t,e){return this.options.canvasUIManager._mouseStop(this.options,t,e)},i.prototype._destroy=function(){return this._mouseDestroy(),this},N2Classes.nUIWidgetBase.register("nUICanvasItem"),i}),N2D("nUICanvas",["nUIWidgetBase"],function(t,e){"use strict";function i(e,i){this.element=t(e),this.widgetName=this.widgetName||"nUICanvas",this.widgetEventPrefix="canvas",this.options=t.extend({mainContainer:null,display:!1},this.options,i),N2Classes.nUIWidgetBase.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.nUIWidgetBase.prototype),i.prototype.constructor=i,i.plugins={},i.prototype._mouseCapture=function(e,i,s){return 0==t(i.target).closest(".nui-resizable-handle, .nui-normal-sizing-handle, .nui-spacing-handle").length},i.prototype._mouseStart=function(e,i,s,r){t("body").addClass("n2-ss-move-layer"),this.dragDeferred=t.Deferred(),this.options.mainContainer.fragmentEditor.layerWindow.hideWithDeferred(this.dragDeferred),this.context={placeholder:t('<div class="n2-ss-layer-placeholder" />'),mouse:{offset:{left:i.pageX,top:i.pageY}},canvas:{offset:this.options.mainContainer.layer.offset(),size:{width:this.options.mainContainer.layer.outerWidth(),height:this.options.mainContainer.layer.outerHeight()}},$layer:e.$layer};var n={position:"absolute",right:"auto",bottom:"auto"};e.layer?(this.startMode=e.layer.placement.getType(),this.context.layer={offset:e.$layer.offset()},this.context.originalIndex=e.layer.getIndex(),"normal"==this.startMode&&(n.width=e.$layer.width(),e.$layer.appendTo(this.options.mainContainer.layer))):(this.startMode="create",this.context.layer={offset:{left:0,top:0}},e.$layer.appendTo("body")),e.$layer.addClass("n2-canvas-item-drag").css(n),this._cacheMargins(e.$layer),this.context.size={width:e.$layer.outerWidth(),height:e.$layer.outerHeight()},this.context.droppables=this.options.mainContainer.getDroppables(e.layer),this._cacheContainers(),this._trigger("start",i,{layer:e.layer,mode:this.startMode}),this._mouseDrag(e,i)},i.prototype._mouseDrag=function(t,e){var i;i="create"==this.startMode?{top:e.pageY-this.context.canvas.offset.top-20,left:e.pageX-this.context.canvas.offset.left-20}:{top:this.context.layer.offset.top-this.context.canvas.offset.top+e.pageY-this.context.mouse.offset.top,left:this.context.layer.offset.left-this.context.canvas.offset.left+e.pageX-this.context.mouse.offset.left};var s=this._findInnerContainer(e);if(s===!1&&"create"!=this.startMode&&(s=this.context.droppables[0]),s)if("normal"==s.placement){"undefined"==typeof s.layers&&(s.layers=this._cacheContainerLayers(s));var r=this._findNormalIndex(e,s);r>0?(this.context.placeholder.css("order",s.layers[r-1].layer.layer.css("order")),this.context.placeholder.insertAfter(s.layers[r-1].layer.layer)):(this.context.placeholder.css("order",0),this.context.placeholder.prependTo(s.$container)),this.context.targetIndex=r}else this.context.placeholder.detach();else this.context.placeholder.detach();this.context.targetContainer=s,this._trigger("drag",e,{layer:t.layer,originalOffset:this.context.layer.offset,position:i,canvasOffset:this.context.canvas.offset,offset:{left:i.left+this.context.canvas.offset.left,top:i.top+this.context.canvas.offset.top}}),"create"==this.startMode&&(i.left+=this.context.canvas.offset.left,i.top+=this.context.canvas.offset.top),t.$layer.css(i),this._displayPosition(e,i)},i.prototype._mouseStop=function(i,s,r){this.context.placeholder.remove();var n=this.context.targetIndex,o=this.context.targetContainer;if(i.$layer.removeClass("n2-canvas-item-drag"),"create"==this.startMode)o&&i.onCreate.call(this,s,i,o,n),i.$layer.detach();else if(o===e&&(o=this.options.mainContainer.layer),"absolute"==this.startMode&&"absolute"==o.placement){var a=parseInt(i.$layer.css("left")),l=parseInt(i.$layer.css("top"));i.$layer.css({position:"",right:"",bottom:""}),i.layer.placement.current.setPosition(a,l)}else if("absolute"==o.placement){var a=parseInt(i.$layer.css("left")),l=parseInt(i.$layer.css("top"));i.$layer.css({position:"",right:"",bottom:""});var h=i.$layer.width(),d=i.$layer.height();i.layer.group.onChildCountChange();for(var p=i.layer;p&&(!p.placement||"absolute"!==p.placement.getType());)p=p.group;N2Classes.History.get().startBatch(),i.layer.changeGroup(this.context.originalIndex,this.options.mainContainer),N2Classes.History.get().addControl("skipForwardUndos"),"layer"==i.layer.type&&i.layer.item&&(i.layer.item.needSize||(d="auto",h++));var c=p?p.getProperty("align"):"center",u=p?p.getProperty("valign"):"middle";i.layer.placement.current._setPosition(c,u,a,l,h,d,!0),N2Classes.History.get().endBatch()}else if("normal"==o.placement)switch(i.$layer.css({position:"relative",width:"",left:"",top:""}),o.layer.type){case"content":case"col":n>0?i.$layer.insertAfter(o.layers[n-1].layer.layer):i.$layer.prependTo(o.$container),i.layer.onCanvasUpdate(this.context.originalIndex,o.layer,n);break;case"row":var y=o.layer.createCol();o.layer.moveCol(y.getIndex(),n),i.$layer.prependTo(y.$content),i.layer.onCanvasUpdate(this.context.originalIndex,y,0)}delete this.context,this.options.display&&this.options.display.hide(),this._trigger("stop",s,{layer:i.layer}),this.dragDeferred.resolve(),t("body").removeClass("n2-ss-move-layer")},i.prototype.cancel=function(t){},i.prototype._cacheContainers=function(){for(var t=0;t<this.context.droppables.length;t++){var e=this.context.droppables[t];e.offset=e.$container.offset(),e.size={width:e.$container.outerWidth(),height:e.$container.outerHeight()},e.offset.right=e.offset.left+e.size.width,e.offset.bottom=e.offset.top+e.size.height}},i.prototype._findInnerContainer=function(t){for(var e=this.context.droppables.length-1;e>=0;e--){var i=this.context.droppables[e];if(i.offset.left<=t.pageX&&i.offset.right>=t.pageX&&i.offset.top<=t.pageY&&i.offset.bottom>=t.pageY)return i}return!1},i.prototype._cacheContainerLayers=function(t){for(var e=[],i=t.layer.container.getSortedLayers(),s=0;s<i.length;s++){var r={layer:i[s]};r.offset=r.layer.layer.offset(),r.size={width:r.layer.layer.outerWidth(),height:r.layer.layer.outerHeight()},r.offset.right=r.offset.left+r.size.width/2,r.offset.bottom=r.offset.top+r.size.height/2,e.push(r)}return e},i.prototype._findNormalIndex=function(t,e){var i=-1;switch(e.axis){case"y":for(var s=0;s<e.layers.length;s++){var r=e.layers[s];if(t.pageY<=r.offset.bottom){i=s;break}}break;case"x":for(var s=0;s<e.layers.length;s++){var r=e.layers[s];if(t.pageX<=r.offset.right){i=s;break}}}return-1===i&&(i=e.layers.length),i},i.prototype._displayPosition=function(t,e){this.options.display&&(this.context.targetContainer&&"absolute"==this.context.targetContainer.placement?(this.options.display.hidden&&this.options.display.show(),"create"==this.startMode&&(e.left-=this.context.canvas.offset.left,e.top-=this.context.canvas.offset.top),this.options.display.update(t,e)):this.options.display.hidden&&this.options.display.hide())},i.prototype._trigger=function(t,e,i){return i=i||{},this.callPlugin(t,[e,i]),N2Classes.nUIWidgetBase.prototype._trigger.apply(this,arguments)},i.prototype._cacheMargins=function(t){this.margins={left:parseInt(t.css("marginLeft"),10)||0,top:parseInt(t.css("marginTop"),10)||0,right:parseInt(t.css("marginRight"),10)||0,bottom:parseInt(t.css("marginBottom"),10)||0}},N2Classes.nUIWidgetBase.register("nUICanvas"),N2Classes.nUIWidgetBase.addPlugin(i,"smartguides",{start:function(e,i){var s=t(this).data("nUICanvas"),r=s.options;if("create"!=s.startMode&&(s.gridH=t('<div class="n2-grid n2-grid-h"></div>').appendTo(r.mainContainer.layer),s.gridV=t('<div class="n2-grid n2-grid-v"></div>').appendTo(r.mainContainer.layer),s.elements=[],"function"==typeof r.smartguides)){var n=t(r.smartguides(s.context)).not(s.context.$layer);n&&n.length&&n.each(function(){var e=t(this),i=e.offset();this!=s.element[0]&&s.elements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:Math.round(i.top),left:Math.round(i.left),backgroundColor:""})});var o=r.mainContainer.layer.offset();s.elements.push({width:r.mainContainer.layer.width(),height:r.mainContainer.layer.height(),top:Math.round(o.top),left:Math.round(o.left),backgroundColor:"#ff4aff"})}},stop:function(e,i){var s=t(this).data("nUICanvas");"create"!=s.startMode&&(s.gridH.remove(),s.gridV.remove())},drag:function(e,i){var s=!1,r=!1,n=t(this).data("nUICanvas"),o=n.options,a=o.tolerance,l=o.tolerance;if("create"!=n.startMode&&(n.gridH.css({display:"none"}),n.gridV.css({display:"none"}),n.context.targetContainer&&"absolute"==n.context.targetContainer.placement)){var h=n.elements[n.elements.length-1],d=function(t){n.gridV.css({left:Math.min(t,h.width-1),display:"block"})},p=function(t){n.gridH.css({top:Math.min(t,h.height-1),display:"block"})},c=e.ctrlKey||e.metaKey,u=e.altKey;if(c&&u)return;c?s=!0:u&&(r=!0);var y=i.offset.left,g=y+n.context.size.width,f=i.offset.top,m=f+n.context.size.height,v=(y+g)/2,b=(f+m)/2;if(!s)for(var C=n.elements.length-1;C>=0&&0!=a;C--){var x,w=n.elements[C].left,S=w+n.elements[C].width,P=(w+S)/2,k=!0;(x=Math.abs(w-g))<a?(i.position.left=w-n.context.size.width-n.context.canvas.offset.left-n.margins.left,d(i.position.left+n.context.size.width)):(x=Math.abs(w-y))<a?(i.position.left=w-n.context.canvas.offset.left-n.margins.left,d(i.position.left)):(x=Math.abs(S-y))<a?(i.position.left=S-n.context.canvas.offset.left-n.margins.left,d(i.position.left)):(x=Math.abs(S-g))<a?(i.position.left=S-n.context.size.width-n.context.canvas.offset.left-n.margins.left,d(i.position.left+n.context.size.width)):(x=Math.abs(P-g))<a?(i.position.left=P-n.context.size.width-n.context.canvas.offset.left-n.margins.left,d(i.position.left+n.context.size.width)):(x=Math.abs(P-y))<a?(i.position.left=P-n.context.canvas.offset.left-n.margins.left,d(i.position.left)):(x=Math.abs(P-v))<a?(i.position.left=P-n.context.size.width/2-n.context.canvas.offset.left-n.margins.left,d(i.position.left+n.context.size.width/2)):k=!1,k&&(s=n.elements[C],a=Math.min(x,a))}if(!r)for(var C=n.elements.length-1;C>=0&&0!=l;C--){var x,N=n.elements[C].top,L=N+n.elements[C].height,_=(N+L)/2,I=!0;(x=Math.abs(N-m))<l?(i.position.top=N-n.context.size.height-n.context.canvas.offset.top-n.margins.top,p(i.position.top+n.context.size.height)):(x=Math.abs(N-f))<l?(i.position.top=N-n.context.canvas.offset.top-n.margins.top,p(i.position.top)):(x=Math.abs(L-f))<l?(i.position.top=L-n.context.canvas.offset.top-n.margins.top,p(i.position.top)):(x=Math.abs(L-m))<l?(i.position.top=L-n.context.size.height-n.context.canvas.offset.top-n.margins.top,p(i.position.top+n.context.size.height)):(x=Math.abs(_-m))<l?(i.position.top=_-n.context.size.height-n.context.canvas.offset.top-n.margins.top,p(i.position.top+n.context.size.height)):(x=Math.abs(_-f))<l?(i.position.top=_-n.context.canvas.offset.top-n.margins.top,p(i.position.top)):(x=Math.abs(_-b))<l?(i.position.top=_-n.context.size.height/2-n.context.canvas.offset.top-n.margins.top,p(i.position.top+n.context.size.height/2)):I=!1,I&&(r=n.elements[C],l=Math.min(x,l))}s&&s!==!0&&n.gridV.css("backgroundColor",s.backgroundColor),r&&r!==!0&&n.gridH.css("backgroundColor",r.backgroundColor)}}}),i}),N2D("nUIColumns",["nUIMouse"],function(t,e){"use strict";function i(e,i){this.active=0,this.created=!1,this.invalidated=!1,this.element=t(e),this.widgetName=this.widgetName||"nUIColumns",this.widgetEventPrefix="columns",this.options=t.extend({columns:"1",gutter:0,denominators:{1:100,2:100,3:144,4:100,5:100,6:144},drag:null,start:null,stop:null},this.options,i),N2Classes.nUIMouse.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.nUIMouse.prototype),i.prototype.constructor=i,i.prototype.create=function(){this.created||(this.created=!0,this._setupHandles(),t(window).on("resize",t.proxy(this._resize,this)),this._mouseInit())},i.prototype._destroy=function(){return this._mouseDestroy(),this.element.removeData("uiNextendColumns").off(".columns").find("> .ui-column-width-handle").remove(),this},i.prototype.getDenominator=function(t){return this.options.denominators[t]===e&&(this.options.denominators[t]=15*t),this.options.denominators[t]},i.prototype._setupHandles=function(){var e,i,s=this.options;this.fractions=[];for(var r=s.columns.split("+"),e=0;e<r.length;e++)this.fractions.push(new Fraction(r[e]));this.currentDenominator=this.getDenominator(this.fractions.length);var n=0;for(e=0;e<this.fractions.length-1;e++)i=t("<div class='ui-column-width-handle'>"),
n+=100*this.fractions[e].valueOf(),i.data("i",e).data("percent",n).appendTo(this.element).on("mousedown",t.proxy(this._mouseDown,this));this.handles=this.element.find("> .ui-column-width-handle"),this.handles.addClass("n2-unselectable"),this._resize()},i.prototype._resize=function(){if(this.active){this.paddingLeft=parseInt(this.element.css("paddingLeft")),this.paddingRight=parseInt(this.element.css("paddingRight"));var t=this.element.width();this.outerWidth=t+this.paddingLeft+this.paddingRight,this.innerWidth=t-this.handles.length*this.options.gutter;for(var e=0;e<this.handles.length;e++){var i=this.handles.eq(e).data("percent");this._updateResizer(e,i)}}else this.invalidated=!0},i.prototype._updateResizer=function(t,e){this.handles.eq(t).css({left:e+"%",marginLeft:-2+this.paddingLeft+(t+.5)*this.options.gutter+(this.innerWidth-this.outerWidth)*e/100})},i.prototype._removeHandles=function(){this.handles.remove()},i.prototype.setOption=function(t,e){switch(N2Classes.nUIWidgetBase.prototype.setOption.apply(this,arguments),t){case"active":this.active=e,this.active&&(this.create(),this.invalidated&&this._resize());break;case"columns":this.created&&(this._removeHandles(),this._setupHandles());break;case"gutter":this._resize()}},i.prototype._mouseCapture=function(t){var e,i,s=!1;for(e=0;e<this.handles.length;e++)i=this.handles[e],i===t.target&&(s=!0);return!this.options.disabled&&s},i.prototype._mouseStart=function(e){var i=t(e.target).data("i"),s=this.element.offset().left+10,r=this.element.width()-20;this.resizeContext={index:i,cLeft:s,containerWidth:r,startX:Math.max(0,Math.min(e.clientX-s,r))},this.currentFractions=[],this.currentPercent=[];for(var n=0;n<this.fractions.length;n++)this.currentFractions.push(this.fractions[n].clone()),this.currentPercent.push(this.fractions[n].valueOf());return this.resizing=!0,t("body").css("cursor","ew-resize"),this.element.addClass("ui-column-width-resizing"),this._trigger("start",e,this.ui()),!0},i.prototype._mouseDrag=function(t){var e=Math.max(0,Math.min(t.clientX-this.resizeContext.cLeft,this.resizeContext.containerWidth)),i=new Fraction(Math.round((e-this.resizeContext.startX)/(this.resizeContext.containerWidth/this.currentDenominator)),this.currentDenominator);i.compare(this.fractions[this.resizeContext.index].clone().mul(-1))<0&&(i=this.fractions[this.resizeContext.index].clone().mul(-1)),i.compare(this.fractions[this.resizeContext.index+1])>0&&(i=this.fractions[this.resizeContext.index+1].clone()),this.currentFractions[this.resizeContext.index]=this.fractions[this.resizeContext.index].add(i),this.currentFractions[this.resizeContext.index+1]=this.fractions[this.resizeContext.index+1].sub(i);var s=0;this.currentPercent=[];for(var r=0;r<this.currentFractions.length;r++){var n=this.currentFractions[r].valueOf();this.currentPercent.push(n),s+=100*n,this._updateResizer(r,s)}this._trigger("colwidth",t,this.ui())},i.prototype._mouseStop=function(e){return this.resizing=!1,t("body").css("cursor","auto"),this._trigger("stop",e,this.ui()),this.fractions=this.currentFractions,nextend.preventMouseUp(),!1},i.prototype.ui=function(){return{element:this.element,originalFractions:this.fractions,currentFractions:this.currentFractions,currentPercent:this.currentPercent,index:this.resizeContext.index}},N2Classes.nUIWidgetBase.register("nUIColumns"),i}),N2D("nUILayerListItem",["nUIMouse"],function(t,e){"use strict";function i(e,i){this.element=t(e),this.widgetName=this.widgetName||"nUILayerListItem",this.widgetEventPrefix="layerListItem",this.options=t.extend({UIManager:null,layer:!1,$layer:null,distance:2},this.options,i),N2Classes.nUIMouse.prototype.constructor.apply(this,arguments),this.create()}return i.prototype=Object.create(N2Classes.nUIMouse.prototype),i.prototype.constructor=i,i.prototype.create=function(){this._mouseInit()},i.prototype._mouseCapture=function(t,e){return this.options.UIManager._mouseCapture(this.options,t,e)},i.prototype._mouseStart=function(t,e,i){return this._trigger("start"),this.options.UIManager._mouseStart(this.options,t,e,i)},i.prototype._mouseDrag=function(t){return this.options.UIManager._mouseDrag(this.options,t)},i.prototype._mouseStop=function(t,e){return this.options.UIManager._mouseStop(this.options,t,e)},i.prototype._destroy=function(){return this._mouseDestroy(),this},N2Classes.nUIWidgetBase.register("nUILayerListItem"),i}),N2D("nUILayerList",["nUIWidgetBase"],function(t,e){"use strict";function i(e,i){this.element=t(e),this.widgetName=this.widgetName||"nUILayerList",this.widgetEventPrefix="layerList",this.options=t.extend({$fixed:null,$scrolled:null},this.options,i),N2Classes.nUIWidgetBase.prototype.constructor.apply(this,arguments),this.create()}return i.prototype=Object.create(N2Classes.nUIWidgetBase.prototype),i.prototype.constructor=i,i.prototype.create=function(){this.scrollTimeout=null},i.prototype._mouseCapture=function(t,e,i){return!0},i.prototype._mouseStart=function(e,i,s,r){this.scrolledTop=this.options.$scrolled.offset().top,this.scrolledHeight=this.options.$scrolled.height(),this.scrolledScroll=this.options.$scrolled.scrollTop(),this.scrolledMaxHeight=this.options.$scrolled[0].scrollHeight-this.scrolledHeight,t("body").addClass("n2-ss-layer-list-move-layer"),this.context={placeholder:t('<div class="nextend-sortable-placeholder"><div></div></div>'),mouse:{y:i.pageY,topModifier:e.$item.offset().top-i.pageY},$item:e.$item,$clone:e.$item.clone()},this.context.$clone.addClass("n2-ss-ll-dragging").appendTo(this.options.$scrolled.find("> ul")),this.context.droppables=this.options.mainContainer.getLLDroppables(e.layer),this._cacheContainers(),this._trigger("start",i),this._mouseDrag(e,i)},i.prototype._scrollUp=function(){this.scrolledTop>0&&null===this.scrollTimeout&&(this.scrollTimeout=setInterval(t.proxy(function(){this.scrolledScroll-=30,this.options.$scrolled.scrollTop(this.scrolledScroll)},this),100),this.scrolledScroll-=30,this.options.$scrolled.scrollTop(this.scrolledScroll))},i.prototype._scrollDown=function(){null===this.scrollTimeout&&(this.scrollTimeout=setInterval(t.proxy(function(){this.scrolledScroll+=30,this.options.$scrolled.scrollTop(Math.min(this.scrolledScroll,this.scrolledMaxHeight))},this),100),this.scrolledScroll+=30,this.options.$scrolled.scrollTop(Math.min(this.scrolledScroll,this.scrolledMaxHeight)))},i.prototype._mouseDrag=function(t,e){this.scrolledTop=this.options.$scrolled.offset().top,this.scrolledHeight>60&&(e.pageY<this.scrolledTop+30?this._scrollUp():e.pageY>this.scrolledTop+this.scrolledHeight-30?this._scrollDown():(clearInterval(this.scrollTimeout),this.scrollTimeout=null)),this.scrolledScroll=this.options.$scrolled.scrollTop();var i=e.pageY-this.scrolledTop+this.scrolledScroll,s=this._findInnerContainer(i);s===!1&&(s=this.context.droppables[0]),"undefined"==typeof s.layers&&(s.layers=this._cacheContainerLayers(s));var r=this._findNormalIndex(i,s);r>0?this.context.placeholder.insertAfter(s.layers[r-1].layer.layerRow):this.context.placeholder.prependTo(s.$container),this.context.targetIndex=r,this.context.targetContainer&&this.context.targetContainer!=s&&this.context.targetContainer.layer.layerRow.removeClass("n2-ss-ll-dragging-parent"),this.context.targetContainer=s,this.context.targetContainer.layer.layerRow.addClass("n2-ss-ll-dragging-parent"),this.context.$clone.css({top:i+this.context.mouse.topModifier})},i.prototype._mouseStop=function(e,i,s){null!==this.scrollTimeout&&(clearInterval(this.scrollTimeout),this.scrollTimeout=null),this.context.placeholder.remove(),this.context.$clone.remove(),this.context.targetContainer.layer.layerRow.removeClass("n2-ss-ll-dragging-parent");var r=this.context.targetIndex,n=this.context.targetContainer,o=e.layer.getIndex(),a=-1;if(0===this.context.targetContainer.layers.length)a=0;else{var l=!1,h=!1;this.context.targetContainer.layers[r]&&(l=this.context.targetContainer.layers[r].layer),this.context.targetContainer.layers[r-1]&&(h=this.context.targetContainer.layers[r-1].layer),l===e.layer||h===e.layer?a=-1:"absolute"===n.layer.container.allowedPlacementMode?l?a=l.getIndex()+1:h&&(a=h.getIndex()):h?a=h.getIndex()+1:l&&(a=l.getIndex())}a>=0&&(a>o&&a--,"col"===e.layer.type?n.layer.moveCol(o,a):(n.layer.container.insertLayerAt(e.layer,a),e.layer.onCanvasUpdate(o,n.layer,a))),delete this.context,this._trigger("stop",i),t("body").removeClass("n2-ss-layer-list-move-layer")},i.prototype.cancel=function(t){},i.prototype._cacheContainers=function(){for(var t=0;t<this.context.droppables.length;t++){var e=this.context.droppables[t];e.top=e.$container.offset().top-this.scrolledTop+this.scrolledScroll-15,e.height=e.$container.outerHeight(),e.bottom=e.top+e.height+15}},i.prototype._findInnerContainer=function(t){for(var e=this.context.droppables.length-1;e>=0;e--){var i=this.context.droppables[e];if(i.top<=t&&i.bottom>=t)return i}return!1},i.prototype._cacheContainerLayers=function(t){for(var e=[],i=t.layer.container.getSortedLayers(),s=0;s<i.length;s++){var r={layer:i[s]};r.top=r.layer.layerRow.offset().top-this.scrolledTop+this.scrolledScroll,r.height=r.layer.layerRow.outerHeight(),r.bottom=r.top+r.height/2,r.index=s,e.push(r)}return"absolute"==t.layer.container.allowedPlacementMode&&e.reverse(),e},i.prototype._findNormalIndex=function(t,e){for(var i=0;i<e.layers.length;i++){var s=e.layers[i];if(t<=s.bottom)return i}return e.layers.length},N2Classes.nUIWidgetBase.register("nUILayerList"),i}),N2D("PlacementAbsolute",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="absolute",this.transferredProperties={},N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments),this.doThrottledTheResize=this.doTheResize,this._triggerLayerResizedThrottled=NextendThrottle(this._triggerLayerResized,30),this.parentIsVisible=!0,this.children=[]}var s=function(){var t=0;return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){var i,s=(new Date).getTime();return i=Math.max(0,16-(s-t)),t=s+i,setTimeout(function(){e(s+i)},i)}}(),r={raf:!1,ratios:null,isThrottled:!1,layers:[]},n=function(){r.raf===!1&&(r.raf=!0,s(function(){for(var t=0;t<r.layers.length;t++)r.layers[t].isDeleted||r.layers[t].doTheResize(r.ratios,!0,r.isThrottled);r={raf:!1,ratios:null,isThrottled:!1,layers:[]}}))};return i.prototype=Object.create(N2Classes.PlacementAbstract.prototype),i.prototype.constructor=i,i.prototype.start=function(){this.$layer=this.layer.layer,this.$layerRow=this.layer.layerRow},i.prototype.preActivation=function(t){if("normal"==t.type){var e=this.layer.getProperty("height");e>0&&(this.transferredProperties.height=e)}},i.prototype.activated=function(e){var i=this.$layer.data("parentid");if(i){var s=t("#"+i);s.length>0?this.activatedAfterParentReady(e):setTimeout(t.proxy(function(){this.activatedAfterParentReady(e)},this),300)}else this._activated(e)},i.prototype.activatedAfterParentReady=function(e){var i=this.$layer.data("parentid");if(i){var s=t("#"+i);if(s.length>0){var r=s.data("layerObject");r?r.readyDeferred.done(t.proxy(this._activated,this,e)):s.on("layerStarted",t.proxy(function(i,s){s.readyDeferred.done(t.proxy(this._activated,this,e))},this))}else this.$layer.data("parentid",""),this._activated(e)}else this._activated(e)},i.prototype._activated=function(e){this.loadProperties(t.extend(e,this.transferredProperties)),this.transferredProperties={},this.$layer.css("zIndex",""),this.___makeLayerAlign(),this.___makeLayerResizeable()},i.cleanLayer=function(t){var e=["desktopPortrait","desktopLandscape","tabletPortrait","tabletLandscape","mobilePortrait","mobileLandscape"];t.removeAttr("data-align").removeAttr("data-valign").css({left:"",top:"",right:"",bottom:"",width:"",height:"","text-align":""});for(var i=["parentid","responsiveposition","responsivesize","parentalign","parentvalign","align","valign","left","top","width","height"],s={},r=0;r<i.length;r++){var n=i[r].toLowerCase();s[n]=t.data(n),t.removeAttr(n),t.removeData(n);for(var o=0;o<e.length;o++){var a=e[o].toLowerCase();s[a+n]=t.data(a+n),t.removeAttr(a+n),t.removeData(a+n)}}return s},i.prototype.deActivated=function(t){var e=this.layer.getProperty("parentid");e&&""!=e&&(this.$layer.removeAttr("data-parentid"),this.unSubscribeParent()),this.$layer.removeAttr("data-align").removeAttr("data-valign").css({left:"",top:"",right:"",bottom:"",width:"",height:"","text-align":""}),this.alignMarker.remove(),this.$layer.nUIResizable("destroy"),this.$layer.off(".n2-ss-absolute"),this.$layer.triggerHandler("LayerUnavailable");var i=["parentid","responsiveposition","responsivesize","parentalign","parentvalign","align","valign","left","top","width","height"],s=this.layer.getPropertiesData(i);return this.layer.removeProperties(i),this.chainParent.remove(),s},i.prototype.loadProperties=function(e){this.layer.createProperty("parentid",null,this.layer.layer,this),this.layer.createProperty("responsiveposition",1,this.layer.layer,this),this.layer.createProperty("responsivesize",1,this.layer.layer,this),this.layer.createDeviceProperty("parentalign",{desktopPortrait:"center"},this.layer.layer,this),this.layer.createDeviceProperty("parentvalign",{desktopPortrait:"middle"},this.layer.layer,this),this.layer.createDeviceProperty("align",{desktopPortrait:e.align||"center"},this.layer.layer,this),this.layer.createDeviceProperty("valign",{desktopPortrait:e.valign||"middle"},this.layer.layer,this),this.layer.createDeviceProperty("left",{desktopPortrait:e.left||0},this.layer.layer,this),this.layer.createDeviceProperty("top",{desktopPortrait:e.top||0},this.layer.layer,this),this.layer.createDeviceProperty("width",{desktopPortrait:e.width||"auto"},this.layer.layer,this),this.layer.createDeviceProperty("height",{desktopPortrait:e.height||"auto"},this.layer.layer,this);var i=this.layer.layer;this.subscribeParentCallbacks={},this.layer.getProperty("parentid")&&this.subscribeParent(),i.attr({"data-align":this.layer.getProperty("align"),"data-valign":this.layer.getProperty("valign")});var s=null;this.chainParent=t('<div class="n2-ss-layer-chain-parent n2-button n2-button-icon n2-button-xs n2-radius-s n2-button-blue"><i class="n2-i n2-i-layerunlink"></i></div>').on({click:t.proxy(this.unlink,this),mouseenter:t.proxy(function(){s=t("#"+this.layer.getProperty("parentid")).addClass("n2-highlight")},this),mouseleave:t.proxy(function(){s&&(s.removeClass("n2-highlight"),s=null)},this)}).appendTo(this.$layer)},i.prototype.triggerLayerResized=function(t,e){t?this._triggerLayerResized(t,e):this._triggerLayerResizedThrottled(!0,e)},i.prototype._triggerLayerResized=function(t,e){this.layer.isDeleted||this.$layer.triggerHandler("LayerResized",[e||{slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.fragmentEditor.getResponsiveRatioVertical()},t||!1])},i.prototype.___makeLayerAlign=function(){this.alignMarker=t('<div class="n2-ss-layer-cc" />').appendTo(this.$layer)},i.prototype.___makeLayerResizeable=function(){this._resizableJustClick=!1,this.$layer.nUIResizable({handles:"n, e, s, w, ne, se, sw, nw",_containment:this.fragmentEditor.mainContainer.layer,start:t.proxy(this.____makeLayerResizeableStart,this),resize:t.proxy(this.____makeLayerResizeableResize,this),stop:t.proxy(this.____makeLayerResizeableStop,this),create:t.proxy(function(){this.$layer.find(".nui-resizable-handle, .n2-ss-layer-cc").on({mousedown:t.proxy(function(t){this._resizableJustClick=[t.clientX,t.clientY]},this),mouseup:t.proxy(function(e){if(this._resizableJustClick&&Math.abs(Math.sqrt(Math.pow(this._resizableJustClick[0]-e.clientX,2)+Math.pow(this._resizableJustClick[1]-e.clientY,2)))<1){var i=t(e.currentTarget),s=this.fragmentEditor.layerOptions.layerFeatures;i.hasClass("nui-resizable-nw")?(s.horizontalAlign("left",!1),s.verticalAlign("top",!1)):i.hasClass("nui-resizable-w")?(s.horizontalAlign("left",!1),s.verticalAlign("middle",!1)):i.hasClass("nui-resizable-sw")?(s.horizontalAlign("left",!1),s.verticalAlign("bottom",!1)):i.hasClass("nui-resizable-n")?(s.horizontalAlign("center",!1),s.verticalAlign("top",!1)):i.hasClass("n2-ss-layer-cc")?(s.horizontalAlign("center",!1),s.verticalAlign("middle",!1)):i.hasClass("nui-resizable-s")?(s.horizontalAlign("center",!1),s.verticalAlign("bottom",!1)):i.hasClass("nui-resizable-ne")?(s.horizontalAlign("right",!1),s.verticalAlign("top",!1)):i.hasClass("nui-resizable-e")?(s.horizontalAlign("right",!1),s.verticalAlign("middle",!1)):i.hasClass("nui-resizable-se")&&(s.horizontalAlign("right",!1),s.verticalAlign("bottom",!1))}this._resizableJustClick=!1},this)})},this),smartguides:t.proxy(function(){return this.$layer.triggerHandler("LayerParent"),this.fragmentEditor.getSnap()},this),tolerance:5}).on({"mousedown.n2-ss-absolute":t.proxy(function(t){!this.layer.status!=N2Classes.ComponentAbstract.STATUS.LOCKED&&(N2Classes.PositionDisplay.get().show("Canvas"),N2Classes.PositionDisplay.get().update(t,"Canvas","W: "+parseInt(this.$layer.width())+"px<br />H: "+parseInt(this.$layer.height())+"px")),document.activeElement&&document.activeElement.blur()},this),"mouseup.n2-ss-absolute":t.proxy(function(t){N2Classes.PositionDisplay.get().hide("Canvas")},this)})},i.prototype.____makeLayerResizeableStart=function(e,i){this.preventActivation=!0,this.resizableDeferred=t.Deferred(),this.fragmentEditor.layerWindow.hideWithDeferred(this.resizableDeferred),t("body").addClass("n2-ss-resize-layer"),this._resizableJustClick&&(this._resizableJustClick=!1),this.____makeLayerResizeableResize(e,i),N2Classes.PositionDisplay.get().show("Canvas")},i.prototype.____makeLayerResizeableResize=function(t,e){N2Classes.PositionDisplay.get().update(t,"Canvas","W: "+e.size.width+"px<br />H: "+e.size.height+"px"),this.triggerLayerResized()},i.prototype.____makeLayerResizeableStop=function(e,i){t("body").removeClass("n2-ss-resize-layer"),this.resizableDeferred.resolve();var s=!1;if("n"==i.axis||"s"==i.axis||i.originalSize.width==i.size.width){var r=this.layer.getProperty("width");this.layer.isDimensionPropertyAccepted(r)&&(s=!0,this._syncwidth())}var n=!1;if("e"==i.axis||"w"==i.axis||i.originalSize.height==i.size.height){var r=this.layer.getProperty("height");this.layer.isDimensionPropertyAccepted(r)&&(n=!0,this._syncheight())}var o=this.fragmentEditor.getResponsiveRatioHorizontal(),a=this.fragmentEditor.getResponsiveRatioVertical();parseInt(this.layer.getProperty("responsivesize"))||(o=a=1);var l=null;s||(l=Math.round(i.size.width*(1/o)));var h=null;n||(h=Math.round(i.size.height*(1/a))),this._setPosition(null,null,i.position.left,i.position.top,l,h,!0),this.triggerLayerResized(),this.$layer.triggerHandler("LayerUnParent"),N2Classes.PositionDisplay.get().hide("Canvas"),setTimeout(t.proxy(function(){this.preventActivation=!1},this),80)},i.prototype._setPosition=function(t,e,i,s,r,n,o){var a=this.layer.getMode();null===t&&(t=this.layer.getProperty("align")),null===e&&(e=this.layer.getProperty("valign")),null===i?i=this.layer.getProperty("left"):o&&(i=this.calculatePositionLeft(t,i)),null===s?s=this.layer.getProperty("top"):o&&(s=this.calculatePositionTop(e,s)),null===r&&(r=this.layer.getProperty("width")),null===n&&(n=this.layer.getProperty("height"));var l=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStorePosition",a]);l&&l.setValues({align:this.layer.getRawProperty("align"),valign:this.layer.getRawProperty("valign"),left:this.layer.getRawProperty("left"),top:this.layer.getRawProperty("top"),width:this.layer.getRawProperty("width"),height:this.layer.getRawProperty("height")},{align:t,valign:e,left:i,top:s,width:r,height:n}),N2Classes.History.get().off(),this.layer.store("width",r,!0,"layer"),this.layer.$.trigger("propertyChanged",["width",r]),this.layer.store("height",n,!0,"layer"),this.layer.$.trigger("propertyChanged",["height",n]),this.layer.store("align",t,!0,"layer"),this.layer.$.trigger("propertyChanged",["align",t]),this.layer.store("valign",e,!0,"layer"),this.layer.$.trigger("propertyChanged",["valign",e]),this.layer.store("left",i,!0,"layer"),this.layer.$.trigger("propertyChanged",["left",i]),this.layer.store("top",s,!0,"layer"),this.layer.$.trigger("propertyChanged",["top",s]),N2Classes.History.get().on()},i.prototype.historyStorePosition=function(t,e){this.layer.historyStore(t.align,"align",e),this.layer.historyStore(t.valign,"valign",e),this.layer.historyStore(t.width,"width",e),this.layer.historyStore(t.height,"height",e),this.layer.historyStore(t.left,"left",e),this.layer.historyStore(t.top,"top",e),this.triggerLayerResized()},i.prototype.calculatePositionLeft=function(t,e){var i=this.fragmentEditor.getResponsiveRatioHorizontal();parseInt(this.layer.getProperty("responsiveposition"))||(i=1);var s=this.parent,r={left:0,leftMultiplier:1};if(s&&s.is(":visible")){var n=s.position();switch(this.layer.getProperty("parentalign")){case"right":r.left=n.left+s.width();break;case"center":r.left=n.left+s.width()/2;break;default:r.left=n.left}}else switch(s=this.$layer.parent(),t){case"center":r.left+=s.width()/2;break;case"right":r.left+=s.width()}var e;switch(t){case"left":e=-Math.round((r.left-e)*(1/i));break;case"center":e=-Math.round((r.left-e-this.$layer.width()/2)*(1/i));break;case"right":e=-Math.round((r.left-e-this.$layer.width())*(1/i))}return e},i.prototype.calculatePositionTop=function(t,e){var i=this.fragmentEditor.getResponsiveRatioVertical();parseInt(this.layer.getProperty("responsiveposition"))||(i=1);var s=this.parent,r={top:0,topMultiplier:1};if(s&&s.is(":visible")){var n=s.position();switch(this.layer.getProperty("parentvalign")){case"bottom":r.top=n.top+s.height();break;case"middle":r.top=n.top+s.height()/2;break;default:r.top=n.top}}else switch(s=this.$layer.parent(),t){case"middle":r.top+=s.height()/2;break;case"bottom":r.top+=s.height()}var e;switch(t){case"top":e=-Math.round((r.top-e)*(1/i));break;case"middle":e=-Math.round((r.top-e-this.$layer.height()/2)*(1/i));break;case"bottom":e=-Math.round((r.top-e-this.$layer.height())*(1/i))}return e},i.prototype.moveX=function(t){this._setPosition(null,null,this.layer.getProperty("left")+t,null,null,null,!1)},i.prototype.moveY=function(t){this._setPosition(null,null,null,this.layer.getProperty("top")+t,null,null,!1)},i.prototype.setPositionLeft=function(t){t=this.calculatePositionLeft(this.layer.getProperty("align"),t),this.layer.store("left",t,!0),this.layer.$.trigger("propertyChanged",["left",t])},i.prototype.setPositionTop=function(t){t=this.calculatePositionTop(this.layer.getProperty("valign"),t),this.layer.store("top",t,!0),this.layer.$.trigger("propertyChanged",["top",t])},i.prototype.setPosition=function(t,e){this.setPositionLeft(t),this.setPositionTop(e)},i.prototype.setDeviceBasedAlign=function(){var t=this.layer.getMode();"undefined"==typeof this.layer.deviceProperty[t].align&&this.layer.setProperty("align",this.layer.getProperty("align"),"layer"),"undefined"==typeof this.layer.deviceProperty[t].valign&&this.layer.setProperty("valign",this.layer.getProperty("valign"),"layer")},i.prototype.setPropertyresponsiveposition=i.prototype.setPropertyresponsivesize=function(t,e,i){this.layer._setProperty(t,parseInt(e),i)},i.prototype.setPropertywidth=i.prototype.setPropertyheight=function(e,i,s){var r=i;this.layer.isDimensionPropertyAccepted(i)||(r=~~i,r!=i&&this.layer.$.trigger("propertyChanged",[e,r])),setTimeout(t.proxy(function(){this.onResize(!1)},this),50),this.layer._setProperty(e,r,s)},i.prototype.setPropertyleft=i.prototype.setPropertytop=function(t,e,i){var s=~~e;s!=e&&this.layer.$.trigger("propertyChanged",[t,s]),this.layer._setProperty(t,s,i)},i.prototype.render=function(t){this["_sync"+t]()},i.prototype.renderWithModifier=function(t,e,i){try{"width"!=t&&"height"!=t||!this.layer.isDimensionPropertyAccepted(e)?this["_sync"+t](Math.round(e*i)):this["_sync"+t](e)}catch(s){console.error("_sync"+t)}},i.prototype.onResize=function(t){this.resize({slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.fragmentEditor.getResponsiveRatioVertical()},t)},i.prototype.resize=function(t,e){this.parent&&!e||this.addToResizeCollection(this,t,!1)},i.prototype.addToResizeCollection=function(t,e,i){r.ratios=e,r.isThrottled=i;for(var s=0;s<r.layers.length;s++)if(r.layers[s]==this){r.layers.splice(s,1);break}r.layers.push(t),n(),this.triggerLayerResized(i,e)},i.prototype._syncresponsiveposition=function(){this.onResize(!1)},i.prototype._syncwidth=function(){var t=this.layer.getProperty("width");if(!this.layer.isDimensionPropertyAccepted(t)){if(parseInt(this.layer.getProperty("responsivesize"))){var e=this.fragmentEditor.getResponsiveRatioHorizontal();t*=e}t+="px"}this.$layer.css("width",t)},i.prototype._syncheight=function(){var t=this.layer.getProperty("height");if(!this.layer.isDimensionPropertyAccepted(t)){if(parseInt(this.layer.getProperty("responsivesize"))){var e=this.fragmentEditor.getResponsiveRatioVertical();t*=e}t+="px"}this.$layer.css("height",t)},i.prototype._syncparentalign=function(){var t=this.layer.getProperty("parentalign");this.$layer.data("parentalign",t);var e=this.getParent();e&&e.placement.current.onResize(!1)},i.prototype._syncparentvalign=function(){var t=this.layer.getProperty("parentvalign");this.$layer.data("parentvalign",t);var e=this.getParent();e&&e.placement.current.onResize(!1)},i.prototype._syncleft=function(){var t=this.layer.getProperty("left");if(parseInt(this.layer.getProperty("responsiveposition"))){var e=this.fragmentEditor.getResponsiveRatioHorizontal();t*=e}if(this.parent&&this.parentIsVisible){var i=this.parent.position(),s=this.layer.getProperty("align"),r=this.layer.getProperty("parentalign"),n=0;switch(r){case"right":n=i.left+this.parent.width();break;case"center":n=i.left+this.parent.width()/2;break;default:n=i.left}switch(s){case"right":this.$layer.css({left:"auto",right:this.$layer.parent().width()-n-t+"px"});break;case"center":this.$layer.css({left:n+t-this.$layer.width()/2+"px",right:"auto"});break;default:this.$layer.css({left:n+t+"px",right:"auto"})}}else switch(this.layer.getProperty("align")){case"right":this.$layer.css({left:"auto",right:-t+"px"});break;case"center":this.$layer.css({left:this.$layer.parent().width()/2+t-this.$layer.width()/2+"px",right:"auto"});break;default:this.$layer.css({left:t+"px",right:"auto"})}this.triggerLayerResized()},i.prototype._synctop=function(){var t=this.layer.getProperty("top");if(parseInt(this.layer.getProperty("responsiveposition"))){var e=this.fragmentEditor.getResponsiveRatioVertical();t*=e}if(this.parent&&this.parentIsVisible){var i=this.parent.position(),s=this.layer.getProperty("valign"),r=this.layer.getProperty("parentvalign"),n=0;switch(r){case"bottom":n=i.top+this.parent.height();break;case"middle":n=i.top+this.parent.height()/2;break;default:n=i.top}switch(s){case"bottom":this.$layer.css({top:"auto",bottom:this.$layer.parent().height()-n-t+"px"});break;case"middle":this.$layer.css({top:n+t-this.$layer.height()/2+"px",bottom:"auto"});break;default:this.$layer.css({top:n+t+"px",bottom:"auto"})}}else switch(this.layer.getProperty("valign")){case"bottom":this.$layer.css({top:"auto",bottom:-t+"px"});break;case"middle":this.$layer.css({top:this.$layer.parent().height()/2+t-this.$layer.height()/2+"px",bottom:"auto"});break;default:this.$layer.css({top:t+"px",bottom:"auto"})}this.triggerLayerResized()},i.prototype._syncresponsivesize=function(){this.onResize(!1)},i.prototype.historyStoreDoubleProp=function(t,e,i,s){var r=this.layer.getMode();e==r?(this.layer._setProperty(i,t.value,"history"),this.layer._setProperty(s,t.value2,"history")):(this.layer.deviceProperty[e][i]=t.value,this.layer.deviceProperty[e][s]=t.value2,this.layer.$.trigger("propertyChanged",[i,this.layer.getProperty(i)]),this.layer.$.trigger("propertyChanged",[s,this.layer.getProperty(s)]),this.layer.render(i,null,"history"),this.layer.render(s,null,"history"))},i.prototype.setPropertyalign=function(t,e,i){var s=this.layer.getProperty(t),r=this.layer.getRawProperty("left");N2Classes.History.get().off(),this.layer._setProperty(t,e,i),N2Classes.History.get().on();var n=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStoreDoubleProp",this.layer.getMode(),"align","left"]);n&&n.setValues({value:s,value2:r},{value:e,value2:this.layer.getRawProperty("left")})},i.prototype.setPropertyvalign=function(t,e,i){var s=this.layer.getProperty(t),r=this.layer.getRawProperty("top");N2Classes.History.get().off(),this.layer._setProperty(t,e,i),N2Classes.History.get().on();var n=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStoreDoubleProp",this.layer.getMode(),"valign","top"]);n&&n.setValues({value:s,value2:r},{value:e,value2:this.layer.getRawProperty("top")})},i.prototype._syncalign=function(t,e){var i=this.layer.getProperty("align");this.$layer.attr("data-align",i),"history"!==e&&i!=t&&this.setPositionLeft(this.$layer.position().left)},i.prototype._syncvalign=function(t,e){var i=this.layer.getProperty("valign");this.$layer.attr("data-valign",i),"history"!==e&&i!=t&&this.setPositionTop(this.$layer.position().top)},i.prototype.fit=function(){var t=this.$layer.get(0);this.$layer.position();if(t.scrollWidth>0&&t.scrollHeight>0){var e=!1;if(this.layer.item&&(e=this.layer.item.fitLayer()),!e){this.layer.setProperty("width","auto","layer"),this.layer.setProperty("height","auto","layer");var i=this.$layer.width();Math.abs(this.fragmentEditor.mainContainer.layer.width()-this.$layer.position().left-i)<2&&this.layer.setProperty("width",i,"layer")}}},i.prototype.hide=function(t){this.layer.store(t?t:this.layer.getMode(),0,!0)},i.prototype.show=function(t){this.layer.store(t?t:this.layer.getMode(),1,!0)},i.prototype.changeStatus=function(t,e){t==N2Classes.ComponentAbstract.STATUS.LOCKED&&this.layer.nUIResizable("enable"),e==N2Classes.ComponentAbstract.STATUS.LOCKED&&this.$layer.nUIResizable("disable")},i.prototype.getParent=function(){return t("#"+this.layer.getProperty("parentid")).data("layerObject")},i.prototype.subscribeParent=function(){var e=this,i=t("#"+this.layer.property.parentid);this.parent&&!i.is(this.parent)&&(this.parent.off(this.subscribeParentCallbacks),this.parent=!1),this.parent||(this.subscribeParentCallbacks={LayerResized:function(){e.resizeParent.apply(e,arguments)},LayerParent:function(){e.$layer.addClass("n2-ss-layer-parent"),e.$layer.triggerHandler("LayerParent")},LayerUnParent:function(){e.$layer.removeClass("n2-ss-layer-parent"),e.$layer.triggerHandler("LayerUnParent")},LayerDeleted:function(t){e.layer.setProperty("parentid","","layer")},LayerUnavailable:function(t){e.layer.setProperty("parentid","","layer"),e.layer.setProperty("left",0,"layer"),e.layer.setProperty("top",0,"layer")},LayerShowChange:function(t,i,s){e.layer.getMode()==i&&(e.parentIsVisible=s)},"n2-ss-activate":function(){e.$layerRow.addClass("n2-parent-active")},"n2-ss-deactivate":function(){e.$layerRow.removeClass("n2-parent-active")},LayerGetDataWithChildren:function(t,i,s){e.layer.getDataWithChildren(i,s)}},this.parent=i.on(this.subscribeParentCallbacks),this.parent.data("layerObject").placement.current.addChild(this),this.$layer.addClass("n2-ss-layer-has-parent"))},i.prototype.unSubscribeParent=function(t){if(this.$layerRow.removeClass("n2-parent-active"),this.$layer.removeClass("n2-ss-layer-has-parent"),this.parent&&(this.parent.off(this.subscribeParentCallbacks),this.parent=!1,this.subscribeParentCallbacks={},"delete"!=t)){var e=this.$layer.position();this._setPosition(null,null,e.left,e.top,null,null,!0)}},i.prototype.addChild=function(t){this.children.push(t)},i.prototype.removeChild=function(e){this.children.splice(t.inArray(e,this.children),1)},i.prototype.unlink=function(t){t&&t.preventDefault(),this.layer.setProperty("parentid","","layer")},i.prototype.parentPicked=function(t,e,i,s,r){this.layer.setProperty("parentid","","layer"),this.layer.setProperty("align",s,"layer"),this.layer.setProperty("valign",r,"layer"),this.layer.setProperty("parentalign",e,"layer"),this.layer.setProperty("parentvalign",i,"layer"),this.layer.setProperty("parentid",t.requestID(),"layer");var n;for(var o in this.layer.deviceProperty)"desktopPortrait"!=o&&(this.layer.deviceProperty[o].left=n,
this.layer.deviceProperty[o].top=n,this.layer.deviceProperty[o].valign=n,this.layer.deviceProperty[o].align=n)},i.prototype._syncparentid=function(){var e=this.layer.getProperty("parentid");e&&""!=e?N2Classes.History.get().actionInProgress()?setTimeout(t.proxy(this._linkToParentID,this,e,!0),100):this._linkToParentID(e,!1):(this.$layer.removeAttr("data-parentid"),this.unSubscribeParent())},i.prototype._linkToParentID=function(e,i){if(0===t("#"+e).length)this.layer.setProperty("parentid","","layer");else if(this.$layer.attr("data-parentid",e).addClass("n2-ss-layer-has-parent"),this.subscribeParent(),i)N2Classes.History.get().off(),this._setPosition(null,null,null,null,null,null,!0),N2Classes.History.get().on();else{var s=this.$layer.position();this._setPosition(null,null,s.left,s.top,null,null,!0)}},i.prototype.snap=function(){this.$layer.nextendResizable("option","smartguides",t.proxy(function(){return this.$layer.triggerHandler("LayerParent"),this.fragmentEditor.getSnap()},this))},i.prototype._renderModeProperties=function(t){this.$layer.attr("data-align",this.layer.property.align),this.$layer.attr("data-valign",this.layer.property.valign),t&&this.onResize(!0)},i.prototype.doLinearResize=function(t){this.doThrottledTheResize(t,!0)},i.prototype.doTheResize=function(t,e,i){this.render("width"),this.render("height"),this.render("left"),this.render("top"),e||this.triggerLayerResized(i,t)},i.prototype.resizeParent=function(t,e,i){this.addToResizeCollection(this,e,i)},i.prototype.updatePosition=function(){var t=this.parent;if("center"==this.layer.getProperty("align")){var e=0;e=t?t.position().left+t.width()/2:this.$layer.parent().width()/2;var i=this.fragmentEditor.getResponsiveRatioHorizontal();parseInt(this.layer.getProperty("responsiveposition"))||(i=1),this.$layer.css("left",e-this.$layer.width()/2+this.layer.getProperty("left")*i)}if("middle"==this.layer.getProperty("valign")){var s=0;s=t?t.position().top+t.height()/2:this.$layer.parent().height()/2;var i=this.fragmentEditor.getResponsiveRatioVertical();parseInt(this.layer.getProperty("responsiveposition"))||(i=1),this.$layer.css("top",s-this.$layer.height()/2+this.layer.getProperty("top")*i)}this.triggerLayerResized()},i.prototype.getIndex=function(){var t=parseInt(this.$layer.css("zIndex"));return isNaN(t)&&(t=0),t},i.prototype.renderIndex=function(t){},i.prototype.sync=function(){this._syncalign(null,"history"),this._syncvalign(null,"history"),this._syncwidth(),this._syncheight(),this._synctop(),this._syncleft(),this._syncparentid()},i.prototype["delete"]=function(){var t=this.layer.getProperty("parentid");t&&this.unSubscribeParent("delete")},i.prototype.isParentOrChild=function(){return this.parent||this.children.length>0},i}),N2D("PlacementContent",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="content",N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.PlacementAbstract.prototype),i.prototype.constructor=i,i}),N2D("PlacementDefault",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="default",N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.PlacementAbstract.prototype),i.prototype.constructor=i,i.prototype.start=function(){this.$layer=this.layer.layer},i.prototype.activated=function(t){this.startUISizing()},i.prototype.deActivated=function(t){this.$layer.nUINormalSizing("destroy")},i.prototype.startUISizing=function(){var e=!1;this.layer.item&&this.layer.item.needSize&&(e=!0),this.$layer.nUINormalSizing({start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("NormalSizing"),"maxwidth"===e&&this.layer.layer.attr("data-has-maxwidth","1")},this),resizeMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().update(t,"NormalSizing","Max-width: "+(0==e.value?"none":e.value+"px"))},this),stopMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().hide("NormalSizing"),this.layer.setProperty("maxwidth",e.value)},this)})},i}),N2D("PlacementNormal",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="normal",this.transferredProperties={},N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.PlacementAbstract.prototype),i.prototype.constructor=i,i.prototype.start=function(){this.$layer=this.layer.layer},i.prototype.preActivation=function(t){if("absolute"==t.type&&this.layer.item&&this.layer.item.needSize){var e=this.layer.getProperty("height");e.match&&e.match(/[0-9]+%$/)?this.transferredProperties.height=Math.max(100,parseInt(this.$layer.parent().height()*parseInt(e)/100)):e>0&&(this.transferredProperties.height=e)}},i.prototype.activated=function(e){this.loadProperties(t.extend(e,this.transferredProperties)),this.transferredProperties={},this.layer.$.on("baseSizeUpdated.placementnormal",t.proxy(this._syncmargin,this)),this.layer.$.on("baseSizeUpdated.placementnormal",t.proxy(this._syncheight,this)),this.startUISpacing(),this.startUISizing(),this.$layer.on({mousedown:t.proxy(function(t){t.stopPropagation()})})},i.prototype.loadProperties=function(t){this.layer.createDeviceProperty("margin",{desktopPortrait:"0|*|0|*|0|*|0|*|px+"},this.layer.layer,this),this.layer.createDeviceProperty("height",{desktopPortrait:t.height||0},this.layer.layer,this),this.layer.createDeviceProperty("maxwidth",{desktopPortrait:0},this.layer.layer,this),this.layer.createDeviceProperty("selfalign",{desktopPortrait:"inherit"},this.layer.layer,this)},i.cleanLayer=function(t){var e=["desktopPortrait","desktopLandscape","tabletPortrait","tabletLandscape","mobilePortrait","mobileLandscape"];t.attr("data-has-maxwidth","0").removeAttr("data-cssselfalign").css({position:"",margin:"",height:"",maxWidth:""});for(var i=["margin","height","maxwidth","selfalign"],s={},r=0;r<i.length;r++){var n=i[r].toLowerCase();s[n]=t.data(n),t.removeAttr(n),t.removeData(n);for(var o=0;o<e.length;o++){var a=e[o].toLowerCase();s[n]=t.data(a+n),t.removeAttr(a+n),t.removeData(a+n)}}return s},i.prototype.deActivated=function(t){this.layer.$.off(".placementnormal"),this.$layer.nUISpacing("destroy"),this.$layer.nUINormalSizing("destroy"),this.layer.layer.attr("data-has-maxwidth","0"),this.layer.layer.removeAttr("data-cssselfalign");var e=["margin","height","maxwidth","selfalign"],i=this.layer.getPropertiesData(e);return this.layer.removeProperties(e),this.layer.layer.css({position:"",margin:"",height:"",maxWidth:""}),i},i.prototype._renderModeProperties=function(t){this._syncmargin(),this._syncheight(),this._syncmaxwidth(),this._syncselfalign()},i.prototype._syncmargin=function(){var t=this.layer.getProperty("margin").split("|*|"),e=t.pop(),i=this.layer.baseSize;if("px+"==e&&i>0){e="em";for(var s=0;s<t.length;s++)t[s]=parseInt(t[s])/i}var t=t.join(e+" ")+e;this.layer.layer.css("margin",t),this.layer.update(),this.$layer.nUISpacing("option","current",t)},i.prototype.startUISpacing=function(){this.$layer.nUISpacing({mode:"margin",sync:{n:"margin-top",e:"margin-right",s:"margin-bottom",w:"margin-left"},handles:"n, s, e, w",start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("Spacing")},this),spacing:t.proxy(function(t,e){var i="";for(var s in e.changed)i+="Margin "+s+": "+e.changed[s]+"px<br>";N2Classes.PositionDisplay.get().update(t,"Spacing",i)},this),stop:t.proxy(this.onSpacingStop,this)})},i.prototype.onSpacingStop=function(e,i){N2Classes.PositionDisplay.get().hide("Spacing");var s=this.layer.getProperty("margin").split("|*|"),r=1,n=1;"px+"==s[s.length-1]&&Math.abs(parseFloat(this.$layer.css("fontSize"))-this.layer.baseSize)>1&&(r=this.fragmentEditor.getResponsiveRatioHorizontal(),n=this.fragmentEditor.getResponsiveRatioVertical());for(var o in i.changed){var a=i.changed[o];switch(o){case"top":s[0]=Math.round(a/n);break;case"right":s[1]=Math.round(a/r);break;case"bottom":s[2]=Math.round(a/n);break;case"left":s[3]=Math.round(a/r)}}this.layer.setProperty("margin",s.join("|*|")),t("#layernormal-margin").data("field").insideChange(s.join("|*|"))},i.prototype.startUISizing=function(){var e=!1;this.layer.item&&this.layer.item.needSize&&(e=!0),this.$layer.nUINormalSizing({height:e,syncWidth:!0,start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("NormalSizing"),"maxwidth"===e&&this.layer.layer.attr("data-has-maxwidth","1")},this),resizeMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().update(t,"NormalSizing","Max-width: "+(0==e.value?"none":e.value+"px"))},this),stopMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().hide("NormalSizing"),this.layer.setProperty("maxwidth",e.value)},this),resizeHeight:t.proxy(function(t,e){N2Classes.PositionDisplay.get().update(t,"NormalSizing","Height: "+e.value+"px")},this),stopHeight:t.proxy(function(t,e){N2Classes.PositionDisplay.get().hide("NormalSizing");var i=1;parseInt(this.$layer.css("fontSize"))!=this.layer.baseSize&&(i=this.fragmentEditor.getResponsiveRatioHorizontal());var s=Math.round(s/i);this.layer.setProperty("height",e.value)},this)})},i.prototype._syncheight=function(){var t=parseInt(this.layer.getProperty("height"));if(t>0){var e="px",i=this.layer.baseSize;i>0&&(e="em",t=parseInt(t)/i),this.layer.layer.css("height",t+e)}else this.layer.layer.css("height","");this.layer.update()},i.prototype._syncmaxwidth=function(){var t=parseInt(this.layer.getProperty("maxwidth"));0>=t||isNaN(t)?this.layer.layer.css("maxWidth","").attr("data-has-maxwidth","0"):this.layer.layer.css("maxWidth",t+"px").attr("data-has-maxwidth","1"),this.layer.update()},i.prototype._syncselfalign=function(){this.layer.layer.attr("data-cssselfalign",this.layer.getProperty("selfalign"))},i.prototype.sync=function(){this._syncmargin(),this._syncheight(),this._syncmaxwidth()},i}),N2D("Placement",function(t,e){"use strict";function i(t){this.layer=t,this.fragmentEditor=t.fragmentEditor,this.modes={},this.current=null,this.isTransferHandled=!1,this.updatePositionThrottled=NextendDeBounce(this.updatePosition,200)}return i.prototype.allow=function(t){switch(t){case"absolute":this.modes.absolute=new N2Classes.PlacementAbsolute(this,this.layer,this.fragmentEditor);break;case"normal":this.modes.normal=new N2Classes.PlacementNormal(this,this.layer,this.fragmentEditor);break;case"group":this.modes.absolute=new N2Classes.PlacementGroup(this,this.layer,this.fragmentEditor);break;case"content":this.modes.absolute=new N2Classes.PlacementContent(this,this.layer,this.fragmentEditor);break;case"default":this.modes["default"]=new N2Classes.PlacementDefault(this,this.layer,this.fragmentEditor)}},i.prototype.start=function(){for(var t in this.modes)this.modes[t].start()},i.prototype.setMode=function(t,e){var i=!1;if(e=e||{},"undefined"==typeof this.modes[t])throw new Exception("Layer placement("+t+") not allowed for the container",this.layer);if(this.current!=this.modes[t]){var s;this.current&&(this.modes[t].preActivation(this.current),s=this.current.type,i=this.current.deActivated(this.modes[t])),this.current=this.modes[t],this.layer.layer.attr("data-pm",this.current.type),this.current.activated(e),this.layer.$.triggerHandler("placementChanged",[this.current.type,s])}return i},i.prototype.doAction=function(t){try{return this.current[t].apply(this.current,Array.prototype.slice.call(arguments,1))}catch(e){}},i.prototype.getType=function(){return this.current.type},i.prototype.onResize=function(t){"function"==typeof this.current.onResize&&this.current.onResize(t)},i.prototype.updatePosition=function(){this.current.updatePosition()},i.prototype.getIndex=function(){return this.current.getIndex()},i.prototype.renderIndex=function(t){return this.current.renderIndex(t)},i.prototype.doLinearResize=function(t){this.current.doLinearResize(t)},i.prototype.sync=function(){this.current.sync()},i.prototype.renderModeProperties=function(t){var e=this.layer.getProperty("fontsize");this.layer.adjustFontSize(this.layer.getProperty("adaptivefont"),e,!1),this.current._renderModeProperties(t)},i.prototype["delete"]=function(){this.current["delete"]()},i}),N2D("PlacementAbstract",["Placement"],function(t,e){"use strict";function i(t,e,i){this.placement=t,this.layer=e,this.fragmentEditor=i}return i.prototype.start=function(){},i.prototype.preActivation=function(t){},i.prototype.activated=function(){},i.prototype.deActivated=function(t){return!1},i.prototype.updatePosition=function(){this.layer.group.update()},i.prototype._renderModeProperties=function(t){},i.prototype._hide=function(){},i.prototype._show=function(){},i.prototype.snap=function(){return!1},i.prototype.getIndex=function(){return this.layer.layer.index()},i.prototype.renderIndex=function(t){},i.prototype.doLinearResize=function(t){},i.prototype.sync=function(){},i.prototype["delete"]=function(){},i.prototype.triggerLayerResized=function(t,e){},i.prototype.changeStatus=function(t,e){},i}),N2D("Item",function(t,e){"use strict";function i(i,s,r){this.type===e&&(this.type=i.data("item")),this.needSize=this.constructor.needSize,this.fragmentEditor=r.fragmentEditor,this.generator=this.fragmentEditor.editor.generator,this.self=this,this.$item=i,this.layer=s,this.itemEditor=r,this.fonts=[],this.styles=[],this.needFill=[],this.values=this.$item.data("itemvalues"),"object"!=typeof this.values&&(this.values=t.parseJSON(this.values)),this.pre="div#"+this.fragmentEditor.editor.frontend.elementID+" ",this.defaultValues=r.getItemForm(this.type).values,this.added(),this.$item.data("item",this),this.$item.appendTo(this.layer.getContent()),this.layer.item=this,0===this.$item.children().length&&this.layer.readyDeferred.done(t.proxy(this.reRender,this)),t("<div/>").addClass("n2-ss-item-overlay").css("zIndex",89).appendTo(this.$item),this.$item.find("a").on("click",function(t){t.preventDefault()}),t(window).trigger("ItemCreated")}return i.needSize=!1,N2Classes.Historical(i),i.prototype.changeValue=function(e,i){this==this.itemEditor.activeItem?t("#item_"+this.type+e).data("field").insideChange(i):this.values[e]=i},i.prototype.activate=function(t,e,i){this.itemEditor.setActiveItem(this,e,i)&&(nextend.basicCSS.activate("ss3item"+this.type,this.values,{font:this.fonts,style:this.styles}),this.itemEditor.lastValues[this.type]=this.values)},i.prototype.deActivate=function(){nextend.basicCSS.deActivate()},i.prototype.render=function(e,i){this.layer.layer.triggerHandler("itemRender"),this.$item.html(""),this.parseAll(e),this._render(e),this.itemEditor.lastValues[this.type]=this.values=i,t("<div/>").addClass("n2-ss-item-overlay").css("zIndex",89).appendTo(this.$item);var s=this.getName(e);s=s===!1||""==s||"Layer"==s?this.type:s.replace(/[<>]/gi,""),this.layer.rename(s,!1),this.layer.update(),this.$item.find("a").on("click",function(t){t.preventDefault()})},i.prototype._render=function(t){},i.prototype.reRender=function(e){this.values=t.extend({},this.getDefault(),this.values,e),this.render(t.extend({},this.values),this.values)},i.prototype["delete"]=function(){this.$item.trigger("mouseleave"),this.$item.remove(),this.itemEditor.activeItem==this&&(this.itemEditor.activeItem=null)},i.prototype.getHTML=function(e){var i="";return i=e?"["+this.type+' values="'+N2Classes.Base64.encode(JSON.stringify(this.values))+'"]':t('<div class="n2-ss-item n2-ss-item-'+this.type+'"></div>').attr("data-item",this.type).attr("data-itemvalues",JSON.stringify(this.values))},i.prototype.getData=function(){return{type:this.type,values:this.values}},i.prototype.getDefault=function(){return{}},i.prototype.added=function(){},i.prototype.addedFont=function(e,i){var s=t("#item_"+this.type+i);s.length&&(this.fonts.push({mode:e,name:i,field:s.data("field"),def:this.defaultValues[i]}),t.when(nextend.fontManager.addVisualUsage(e,this.values[i],this.pre)).done(t.proxy(function(t){t||this.changeValue(i,"")},this)))},i.prototype.addedStyle=function(e,i){var s=t("#item_"+this.type+i);s.length&&(this.styles.push({mode:e,name:i,field:s.data("field"),def:this.defaultValues[i]}),t.when(nextend.styleManager.addVisualUsage(e,this.values[i],this.pre)).done(t.proxy(function(t){t||this.changeValue(i,"")},this)))},i.prototype.parseAll=function(t){for(var e=0;e<this.fonts.length;e++)t[this.fonts[e].name+"class"]=nextend.fontManager.getClass(t[this.fonts[e].name],this.fonts[e].mode)+" ";for(var e=0;e<this.styles.length;e++)t[this.styles[e].name+"class"]=nextend.styleManager.getClass(t[this.styles[e].name],this.styles[e].mode)+" ";for(var e=0;e<this.needFill.length;e++)"undefined"!=typeof t[this.needFill[e]]&&(t[this.needFill[e]]=this.generator.fill(t[this.needFill[e]]+""))},i.prototype.getName=function(t){return"Layer"},i.prototype.resizeLayerToImage=function(e){var i=this.layer,s=t("<img/>").attr("src",e).on("load",t.proxy(function(){var t=s[0].width,e=s[0].height;if(t>0&&e>0){var r=this.fragmentEditor.editor.getMainContainerElement(),n=r.width(),o=r.height();t>n&&(e=e*n/t,t=n),e>o&&(t=t*o/e),N2Classes.History.get().off(),i.setProperty("width",t),i.setProperty("height","auto"),N2Classes.History.get().on()}},this))},i.prototype.fitLayer=function(t){return!1},i}),N2D("ItemManager",function(t,e){"use strict";function i(e,i){if(this.suppressChange=!1,this.activeItemOriginalData=null,this.fragmentEditor=e,this.lastValues={},this.startItems(),this.forms={},this.activeForm=!1,!i.isUploadDisabled){var s=t("#n2-ss-slide-canvas-container-inner");s.nUIFileUpload({url:i.uploadUrl,pasteZone:!1,dropZone:s,dataType:"json",paramName:"image",add:function(t,e){e.formData={path:"/"+i.uploadDir},e.submit()},done:t.proxy(function(t,e){var i=e.result;if(i.data&&i.data.name){var s=this.createLayerItem(!1,{item:"image"});s.reRender({image:i.data.url}),s.activate(null,null,!0)}else N2Classes.AjaxHelper.notification(i)},this),fail:function(t,e){N2Classes.AjaxHelper.notification(e.jqXHR.responseJSON)},start:function(){N2Classes.AjaxHelper.startLoading()},stop:function(){setTimeout(function(){N2Classes.AjaxHelper.stopLoading()},100)}})}}return i.prototype.setActiveItem=function(e,i,s){if(e!=this.activeItem||s){this.activeItemOriginalData=null;var r=e.type;this.activeForm&&this.activeForm.form.css("display","none"),this.activeItem&&this.activeItem.deActivate(),this.activeForm=this.getItemForm(r);var n=t.extend({},this.activeForm.values,e.values);this.activeItem=e,this.suppressChange=!0;for(var o in n){var a=t("#item_"+r+o).data("field");a&&a.insideChange(n[o])}return this.suppressChange=!1,this.activeForm.form.css("display","block"),this.focusFirst(i),!0}return!1},i.prototype.focusFirst=function(t){var e=this.activeForm.fields.eq(0).data("field");this.fragmentEditor.editor.generator.isDynamicSlide()&&e.connectedField&&e.connectedField instanceof N2Classes.FormElementImage||e.focus("undefined"!=typeof t&&t)},i.prototype.startItems=function(){t(".n2-ss-core-item").nUICanvasItem({canvasUIManager:this.fragmentEditor.mainContainer.canvasUIManager,distance:5,$layer:function(){return this.element.clone()},onCreate:t.proxy(function(t,e,i,s){switch(i.layer.type){case"content":case"col":N2Classes.History.get().startBatch();var r=this.createLayerItem(i.layer,e.$layer.data(),"click");N2Classes.History.get().addControl("skipForwardUndos"),i.layer.container.insertLayerAt(r.layer,s),r.layer.changeGroup(!1,i.layer),N2Classes.History.get().endBatch();break;case"row":var n=i.layer.createCol();i.layer.moveCol(n.getIndex(),s),N2Classes.History.get().startBatch();var r=this.createLayerItem(n,e.$layer.data(),"click");N2Classes.History.get().addControl("skipForwardUndos"),n.container.insertLayerAt(r.layer,0),r.layer.changeGroup(!1,n),N2Classes.History.get().endBatch();break;default:var o=this.fragmentEditor.mainContainer.layer.offset(),r=this.createLayerItem(this.fragmentEditor.mainContainer,e.$layer.data(),"click");r.layer.placement.current.setPosition(t.pageX-o.left-20,t.pageY-o.top-20)}},this),start:function(){t("#n2-ss-add-sidebar").removeClass("n2-active")}}).on("click",t.proxy(function(e){this.createLayerItem(this.fragmentEditor.mainContainer.getActiveGroup(),t(e.currentTarget).data(),"click")},this)),t("[data-itemshortcut]").on({click:t.proxy(function(e){e.preventDefault(),t('.n2-ss-core-item[data-item="'+t(e.currentTarget).data("itemshortcut")+'"]').trigger("click")},this),mousedown:t.proxy(function(e){t('.n2-ss-core-item[data-item="'+t(e.currentTarget).data("itemshortcut")+'"]').trigger(e)},this)}),t("[data-structureshortcut]").on({click:t.proxy(function(e){e.preventDefault(),t(".n2-ss-add-layer-button").trigger("click"),t("#n2-ss-layers-switcher > .n2-labels .n2-td").eq(1).trigger("click")},this),mousedown:t.proxy(function(e){t('.n2-ss-core-item[data-sstype="'+t(e.currentTarget).data("structureshortcut")+'"]').trigger(e)},this)})},i.prototype.createLayerItem=function(e,i,s,r){e=e||this.fragmentEditor.mainContainer.getActiveGroup();var n=i.item;if("structure"===n){var o=new N2Classes.Row(this.fragmentEditor,e,{});return o.create(i.sstype),o.hightlightStructure(),{layer:o}}var a=this.getItemForm(n),l={};switch(n){case"image":"absolute"===e.container.allowedPlacementMode?l.size="100%|*|auto":l.size="auto|*|auto"}var h=t("<div></div>").attr("data-item",n).data("itemvalues",t.extend(!0,{},a.values,this.getLastValues(n),l)).addClass("n2-ss-item n2-ss-item-"+n),o=this._createLayer(h,e,t.extend(t(".n2-ss-core-item-"+n).data("layerproperties"),r));return s&&"click"==s?setTimeout(function(){o.layer.trigger("mousedown",["create"]).trigger("mouseup",["create"]).trigger("click",["create"])},500):o.activate(),this.fragmentEditor.layerWindow.switchTab("item"),N2Classes.History.get().addSimple(this,this.historyDelete,this.historyCreate,[e,o,i]),o.item},i.prototype.getLastValues=function(t){return this.lastValues[t]!==e?this.lastValues[t]:{}},i.prototype.getItemClass=function(t){var e="Item"+N2Classes.StringHelper.capitalize(t);return"undefined"==typeof N2Classes[e]?"Item":e},i.prototype._createLayer=function(t,e,i){var s=this.fragmentEditor.layerOptions.layerFeatures.layerDefault;for(var r in s)null!==s[r]&&(i[r]=s[r]);var n=new N2Classes.Layer(this.fragmentEditor,e,i);return n.create(function(e){return e._createLayer().append(t)}),n},i.prototype.getItemForm=function(i){if(this.forms[i]===e){var s=t("#smartslider-slide-toolbox-item-type-"+i),r={form:s,values:s.data("itemvalues"),fields:s.find('[name^="item_'+i+'"]'),fieldNameRegexp:new RegExp("item_"+i+"\\[(.*?)\\]","")};r.fields.on({nextendChange:t.proxy(this.updateCurrentItem,this),keydown:t.proxy(this.updateCurrentItemDeBounced,this)}),this.forms[i]=r}return this.forms[i]},i.prototype.updateCurrentItem=function(e){if(!this.suppressChange){null===this.activeItemOriginalData&&(this.activeItemOriginalData=t.extend({},this.activeItem.values));var i={},s={};if(this.activeForm.fields.each(t.proxy(function(e,r){var r=t(r),n=r.attr("name").match(this.activeForm.fieldNameRegexp)[1];s[n]=i[n]=r.val()},this)),e&&"nextendChange"==e.type){var r=N2Classes.History.get().addValue(this,this.historyUpdateCurrentItem,[this.activeItem]);r&&r.setValues(this.activeItemOriginalData,t.extend({},s)),this.activeItemOriginalData=null}this.activeItem.render(t.extend({},this.activeItem.getDefault(),i),s)}},i.prototype.historyUpdateCurrentItem=function(e,i){var s=i.getSelf();s.reRender(t.extend(!0,{},e)),s.values=e,this.activeItem==s&&s.activate(null,null,!0)},i.prototype.updateCurrentItemDeBounced=NextendDeBounce(function(t){this.updateCurrentItem(t)},100),i.prototype.historyDelete=function(t,e){e.getSelf()["delete"]()},i.prototype.historyCreate=function(t,e,i){var s=this.createLayerItem(t.getSelf(),i);e.setSelf(s.layer)},i.prototype.historyCreateStructure=function(t,e,i){var s=this.createLayerItem(t.getSelf(),i);e.setSelf(s.layer)},i.prototype.getSelf=function(){return this},i}),N2D("PluginActivatable",function(t,e){"use strict";function i(){this.isActive=!1,this.preventActivation=!1}return i.prototype.activate=function(t,e,i){return this.preventActivation?!1:(document.activeElement&&document.activeElement.blur(),t&&(t.ctrlKey||t.metaKey)&&this.fragmentEditor.mainContainer.getSelectedLayer()?!this.select():t&&3==t.which&&this.fragmentEditor.selectMode?!1:(i||this.fragmentEditor.exitSelectMode(),t&&this.positionSidebar(),this.fragmentEditor.mainContainer.getSelectedLayer()!==this&&(this.layerRow.addClass("n2-active"),this.layer.addClass("n2-active"),this.layer.triggerHandler("n2-ss-activate"),this.fragmentEditor.changeActiveLayer(this,i),nextend.activeLayer=this.layer,this.fragmentEditor.ui.onActivateLayer(this)),this.isActive=!0,!0))},i.prototype.deActivate=function(){this.isActive=!1,this.layer===e&&console.error(),this.layer.removeClass("n2-active"),this.layerRow.removeClass("n2-active"),this.layer.triggerHandler("n2-ss-deactivate")},i}),N2D("PluginEditableName",function(t,e){"use strict";function i(){}var s=300,r=null;return i.prototype.addProperties=function(t){this.createProperty("name",this.label,t),this.createProperty("nameSynced",1,t)},i.prototype.makeNameEditable=function(){this.layerTitleSpan.on({mouseup:t.proxy(function(e){r?(clearTimeout(r),r=null,this.editName()):(this.activate(e),r=setTimeout(t.proxy(function(){r=null},this),s))},this)})},i.prototype.editName=function(){var e=new N2Classes.InlineField;e.$input.on({valueChanged:t.proxy(function(t,e){this.rename(e,!0),this.layerTitleSpan.css("display","inline")},this),cancel:t.proxy(function(){this.layerTitleSpan.css("display","inline")},this)}),this.layerTitleSpan.css("display","none"),e.injectNode(this.layerTitle,this.property.name)},i.prototype.rename=function(t,e){if(this.property.nameSynced||e){if(e&&(this.property.nameSynced=0),""==t){if(e)return this.property.nameSynced=1,this.item.reRender(),!1;t="Layer #"+(this.group.getLayerCount()+1)}t=t.substr(0,35),this.property.name!=t&&(this.property.name=t,this.layerTitleSpan.html(t),this.$.trigger("layerRenamed",t))}},i}),N2D("PluginShowOn",function(t,e){"use strict";function i(){}return i.prototype.addProperties=function(t){this.showsOnCurrent=!0,this.createProperty("generatorvisible","",t),this.createProperty("desktopPortrait",1,t),this.createProperty("desktopLandscape",1,t),this.createProperty("tabletPortrait",1,t),this.createProperty("tabletLandscape",1,t),this.createProperty("mobilePortrait",1,t),this.createProperty("mobileLandscape",1,t)},i.prototype._hide=function(){this.layer.css("display","none"),this.showsOnCurrent=!1,this.update()},i.prototype._show=function(){parseInt(this.property[this.fragmentEditor.getMode()])&&(this.layer.css("display",""),this.showsOnCurrent=!0),this.update()},i.prototype._syncdesktopPortrait=function(){var t=this.getProperty("desktopPortrait");this.__syncShowOnDevice("desktopPortrait",t)},i.prototype._syncdesktopLandscape=function(){var t=this.getProperty("desktopLandscape");this.__syncShowOnDevice("desktopLandscape",t)},i.prototype._synctabletPortrait=function(){var t=this.getProperty("tabletPortrait");this.__syncShowOnDevice("tabletPortrait",t)},i.prototype._synctabletLandscape=function(){var t=this.getProperty("tabletLandscape");this.__syncShowOnDevice("tabletLandscape",t)},i.prototype._syncmobilePortrait=function(){var t=this.getProperty("mobilePortrait");this.__syncShowOnDevice("mobilePortrait",t)},i.prototype._syncmobileLandscape=function(){var t=this.getProperty("mobileLandscape");this.__syncShowOnDevice("mobileLandscape",t)},i.prototype.__syncShowOnDevice=function(t,e){if(this.getMode()==t){var e=parseInt(e);e?this._show():this._hide(),this.layer.triggerHandler("LayerShowChange",[t,e]),this.placement.doAction("triggerLayerResized")}},i}),N2D("Col",["ContentAbstract"],function(t,e){"use strict";function i(t,e,i){this.label="Col",this.type="col",this.innerContainer="> .n2-ss-layer-col",this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],N2Classes.ContentAbstract.prototype.constructor.call(this,t,e,i),this.placement.allow("default")}return i.prototype=Object.create(N2Classes.ContentAbstract.prototype),i.prototype.constructor=i,i.prototype._createLayer=function(){return t('<div class="n2-ss-layer"><div class="n2-ss-layer-content n2-ss-layer-col"></div></div>').attr("data-sstype",this.type)},i.prototype.addProperties=function(t){N2Classes.ContentAbstract.prototype.addProperties.call(this,t),this.createProperty("colwidth","1",t),this.createProperty("href","",t),this.createProperty("href-target","_self",t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderradius",0,{"-hover":e},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("boxshadow","0|*|0|*|0|*|0|*|00000080",{"-hover":e},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderwidth","1|*|1|*|1|*|1",{"-hover":e},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderstyle","none",{"-hover":e},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bordercolor","ffffffff",{"-hover":e},this,"stylemode"),t),this.createDeviceProperty("order",{desktopPortrait:0},t)},i.prototype.create=function(){N2Classes.ContentAbstract.prototype.create.call(this),this._syncorder(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this._onReady()},i.prototype.load=function(t,i){N2Classes.ContentAbstract.prototype.load.call(this,t,i),this._syncorder(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this._onReady();var s=t.data("rowcolumns")+"";if(s!=e&&"resolved"==this.group.readyDeferred.state()){for(var r=s.split("+"),n=0;n<r.length;n++)r[n]=new Fraction(r[n]);this.group.setColsWidth(r)}},i.prototype.createRow=function(){this.$content=this.layer.find(".n2-ss-layer-content:first"),this.container=new N2Classes.LayerContainer(this,t('<ul class="n2-list n2-h4 n2-list-orderable" />'),"normal","> .n2-ss-layer",["row","layer"]),this.container.setLayerContainerElement(this.$content),this.addClassElement(this.layer),this.addClassElement(this.$content,"-inner");var e=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Delete layer")+'"><i class="n2-i n2-i-delete n2-i-grey-opacity"></i></div>').on("click",t.proxy(this["delete"],this)),i=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Duplicate layer")+'"><i class="n2-i n2-i-duplicate n2-i-grey-opacity"></i></div>').on("click",t.proxy(function(){this.duplicate(!0,!1)},this));this._createLayerListRow([t('<div class="n2-actions"></div>').append(i).append(e)]).addClass("n2-ss-layer-content-row"),this.openerElement=t('<a href="#" class="n2-ss-layer-icon n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-col"></i></a>').insertBefore(this.layerTitleSpan).on("click",t.proxy(this.switchOpened,this)),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(t.proxy(this._syncopened,this))},i.prototype._start=function(t){N2Classes.ContentAbstract.prototype._start.call(this,t),t&&this.highlight(2e3)},i.prototype.getRealOrder=function(){var t=this.getProperty("order");return 0==t?10:t},i.prototype._syncorder=function(){var t=this.getProperty("order");0==t?this.layer.css("order",""):this.layer.css("order",2*t),this.group.refreshUI()},i.prototype._synccolwidth=function(){this.widthPercentage=100*new Fraction(this.getProperty("colwidth")).valueOf(),this.group.refreshUI()},i.prototype.getWidthPercentage=function(){return this.widthPercentage},i.prototype._synchref=i.prototype["_synchref-target"]=function(){},i.prototype._syncborderradius=i.prototype["_syncborderradius-hover"]=function(){var t=this.getProperty("borderradius");t>0&&this.addLocalStyle("normal","borderradius","border-radius:"+t+"px;");var e=this.getProperty("borderradius-hover");e&&e!=t&&this.addLocalStyle("hover","borderradius","border-radius:"+e+"px;")},i.prototype._syncborderwidth=i.prototype._syncbordercolor=i.prototype._syncborderstyle=i.prototype["_syncborderstyle-hover"]=i.prototype["_syncbordercolor-hover"]=i.prototype["_syncborderwidth-hover"]=function(){
this._syncborder()},i.prototype._syncborder=function(){var t=this.getProperty("borderstyle"),i=this.getProperty("bordercolor"),s=this.getProperty("borderwidth");this.addLocalStyle("normal","border",this.getBorderCSS(t,i,s));var r="",n=!1,o=this.getProperty("borderstyle-hover"),a=this.getProperty("bordercolor-hover"),l=this.getProperty("borderwidth-hover");o!==e&&o!=t&&(n=!0),a!==e&&a!=i&&(n=!0),l!==e&&l!=s&&(n=!0),n&&(o===e&&(o=t),a===e&&(a=i),l===e&&(l=s),r=this.getBorderCSS(o,a,l)),this.addLocalStyle("hover","border",r),this.update()},i.prototype.getBorderCSS=function(t,e,i){var s="";if("none"!=t){s+="border-color:"+N2Color.hex2rgbaCSS(e)+";",s+="border-style:"+t+";",i=i.split("|*|");var r="px";s+="border-width:"+i.join(r+" ")+r+";"}return s},i.prototype._syncboxshadow=i.prototype["_syncboxshadow-hover"]=function(){var t=this.getProperty("boxshadow");this.addLocalStyle("normal","boxshadow",this.getBoxShadowCSS(t.split("|*|")));var i="",s=this.getProperty("boxshadow-hover");s!==e&&s!=t&&(i=this.getBoxShadowCSS(s.split("|*|"))),this.addLocalStyle("hover","boxshadow",i)},i.prototype.getBoxShadowCSS=function(t){return 0==t[0]&&0==t[1]&&0==t[2]&&0==t[3]||0==N2Color.hex2alpha(t[4])?"":"box-shadow:"+t[0]+"px "+t[1]+"px "+t[2]+"px "+t[3]+"px "+N2Color.hex2rgbaCSS(t[4])+";"},i.prototype["delete"]=function(){this.group.container.getLayerCount()>1?this._delete():this.group["delete"]()},i.prototype.getHTML=function(t){var e=N2Classes.ComponentAbstract.prototype.getHTML.call(this,t);return e.attr("data-rowcolumns",this.group.getColumns()),e},i.prototype.renderModeProperties=function(t){this._syncorder(),N2Classes.ContentAbstract.prototype.renderModeProperties.call(this,t)},i.prototype.update=function(){this.group._syncwrapafter(),N2Classes.ComponentAbstract.prototype.update.call(this)},i.prototype.setPropertystylemode=function(){N2Classes.ContentAbstract.prototype.setPropertystylemode.apply(this,arguments),this.syncAdvancedField("borderradius"),this.syncAdvancedField("boxshadow"),this.syncAdvancedField("borderwidth"),this.syncAdvancedField("borderstyle"),this.syncAdvancedField("bordercolor")},i.prototype.getOrderedIndex=function(){return this.group.getOrderedColumns().indexOf(this)},i});var dependencies=["Historical","LayerDataStorage","PluginEditableName"];N2D("ComponentAbstract",dependencies,function(t,e){"use strict";function i(e,r,n){this.wraps={},this.counter=s++,window.layers[this.counter]=this,this.self=this,this.originalProperties=n||{},N2Classes.LayerDataStorage.prototype.constructor.call(this),this.readyDeferred=t.Deferred(),this.readyDeferred.done(t.proxy(this.onReady,this)),this.isDeleteStarted=!1,this.isDeleted=!1,this._lastClasses=!1,this.$=t(this),this.proxyRefreshBaseSize=t.proxy(this.refreshBaseSize,this),this.proxyRefreshTextAlign=t.proxy(this.refreshTextAlign,this),this.status=i.STATUS.UNDEFINED,this.fragmentEditor=e,this.group=r,this.classElements=[],this.localStyleSyncThrottled=NextendThrottle(this.localStyleSync,50),N2Classes.PluginActivatable.prototype.constructor.call(this),this.placement=new N2Classes.Placement(this),this.readyDeferred.done(t.proxy(this.addUILabels,this))}var s=0;window.layers=[],i.STATUS={UNDEFINED:0,NORMAL:1,LOCKED:2,HIDDEN:3},i.STATUS_INV={0:"UNDEFINED",1:"NORMAL",2:"LOCKED",3:"HIDDEN"};for(var r in N2Classes.PluginActivatable.prototype)i.prototype[r]=N2Classes.PluginActivatable.prototype[r];for(var r in N2Classes.LayerDataStorage.prototype)i.prototype[r]=N2Classes.LayerDataStorage.prototype[r];for(var r in N2Classes.PluginEditableName.prototype)i.prototype[r]=N2Classes.PluginEditableName.prototype[r];for(var r in N2Classes.PluginShowOn.prototype)i.prototype[r]=N2Classes.PluginShowOn.prototype[r];return N2Classes.Historical(i),i.prototype.onSelfChange=function(){},i.prototype.addUILabels=function(){this.markTimer=null,this.uiLabel=t('<div class="n2-ss-layer-ui-label-container"><div class="n2-ss-layer-ui-label n2-ss-layer-ui-label-self">'+this.getUILabel()+"</div></div>").appendTo(this.layer),nextend.tooltip.addElement(t('<div class="n2-ss-layer-ui-label n2-ss-layer-ui-label-up n2-ss-layer-ui-label-action"><i class="n2-i n2-i-uplevel"/></div>').on({mousedown:function(t){t.stopPropagation()},click:t.proxy(function(t){this.up(t)},this)}).appendTo(this.uiLabel),"Select parent"),t('<div class="n2-ss-layer-ui-label n2-ss-layer-ui-label-action"><i class="n2-i n2-i-mini-duplicate"/></div>').on({mousedown:function(t){t.stopPropagation()},click:t.proxy(function(){this.duplicate()},this)}).appendTo(this.uiLabel),t('<div class="n2-ss-layer-ui-label n2-ss-layer-ui-label-action"><i class="n2-i n2-i-mini-trash"/></div>').on({mousedown:function(t){t.stopPropagation()},click:t.proxy(function(){this["delete"]()},this)}).appendTo(this.uiLabel)},i.prototype.getUILabel=function(){return this.label},i.prototype.up=function(t){t.stopImmediatePropagation(),this.group.activate(t)},i.prototype.addProperties=function(t){this.createProperty("id",null,t,this),this.createProperty("uniqueclass",null,t,this),this.createProperty("class","",t),this.createProperty("crop","visible",t),this.createProperty("rotation",0,t),this.createProperty("parallax",0,t),this.createProperty("adaptivefont",0,t),this.createDeviceProperty("fontsize",{desktopPortrait:100},t),N2Classes.PluginShowOn.prototype.addProperties.call(this,t),N2Classes.PluginEditableName.prototype.addProperties.call(this,t)},i.prototype.getRootElement=function(){return this.layer},i.prototype.create=function(t,e){e=e||!1,e||this.addProperties(!1),"function"==typeof t?this.layer=t.call(null,this):this.layer=this._createLayer(),this.layer.addClass("n2-ss-layer-under-creation"),e&&this.addProperties(this.layer),this.layer.data("layerObject",this),this.layer.triggerHandler("layerStarted",[this]),this.group.container.insert(this),this.group.onChildCountChange(),this.$.triggerHandler("create"),this._start(!0)},i.prototype.load=function(t,e){this.addProperties(t),this.layer=t.data("layerObject",this),this.layer.triggerHandler("layerStarted",[this]),this.$.triggerHandler("load"),this._start(!1);var s=t.data("status");null!==s&&"undefined"!=typeof s?this.changeStatus(s):this.changeStatus(i.STATUS.NORMAL),e||this.regenerateUniqueClass()},i.prototype._start=function(e){this.createRow();var i=this.layer.find("> .n2-ss-layer-mask");i.length&&(this.wraps.mask=i),this._synccrop(),this._syncrotation(),this.placement.start(),this.placement.setMode(this.group.container.allowedPlacementMode,this.originalProperties),this.setGroup(this.group),this.fragmentEditor.$.triggerHandler("layerCreated",this),e&&(this.refreshBaseSize(),this.$.triggerHandler("created")),setTimeout(t.proxy(function(){this.isDeleted||(this.placement.onResize(!0),this.layer.css("visibility",""),this.layer.removeClass("n2-ss-layer-under-creation"))},this),300)},i.prototype._onReady=function(){this.originalProperties={},this.readyDeferred.resolve(),this.layer.on({mouseover:t.proxy(this.markOver,this),mouseout:t.proxy(this.markOut,this)})},i.prototype.isReady=function(){return"resolved"==this.readyDeferred.state()},i.prototype.getName=function(){return this.property.name},i.prototype.setGroup=function(t){this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group.$.off("textAlignUpdated.sslayer"+this.counter),this.group=t,this.placement.setMode(t.container.allowedPlacementMode),t.container.syncLayerRow(this),this.isReady()&&this.refreshBaseSize(),this.group.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),this.group.$.on("textAlignUpdated.sslayer"+this.counter,this.proxyRefreshTextAlign)},i.prototype.changeGroup=function(t,e){var i=this.group;i.$.off("baseSizeUpdated.sslayer"+this.counter),i.$.off("textAlignUpdated.sslayer"+this.counter),this.group=e;var s=this.placement.setMode(e.container.allowedPlacementMode);e.container.syncLayerRow(this),this.refreshBaseSize(),e.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),e.$.on("textAlignUpdated.sslayer"+this.counter,this.proxyRefreshTextAlign),this.userGroupChange(i,t,s,e,this.getIndex()),i.update()},i.prototype.userGroupChange=function(t,e,i,s,r){if(t==s)this.userIndexChange(e,r);else{var n=N2Classes.History.get().addValue(this,this.historyUserGroupChange,[]);n&&n.setValues({historyGroup:t,index:e,placementData:i},{historyGroup:s,index:r})}},i.prototype.historyUserGroupChange=function(t){var e=this.group,i=t.historyGroup.getSelf(),s=t.index;i.container.insertLayerAt(this,s),this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group.$.off("refreshTextAlign.sslayer"+this.counter),this.group=i,t.placementData&&this.layer.data(t.placementData),this.placement.setMode(i.container.allowedPlacementMode),i.container.syncLayerRow(this),this.refreshBaseSize(),this.group.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),this.group.$.on("refreshTextAlign.sslayer"+this.counter,this.proxyRefreshBaseSize),i.onChildCountChange(),t.placementData&&this.placement.sync(),e.update()},i.prototype.userIndexChange=function(t,e){var i=N2Classes.History.get().addValue(this,this.historyUserIndexChange);i&&i.setValues(t,e),this.group.container.insertLayerAt(this,e)},i.prototype.historyUserIndexChange=function(t){this.group.container.insertLayerAt(this,t)},i.prototype._createLayerListRow=function(e){return this.layerRow=t('<li class="n2-ss-layerlist-row"></li>').data("layer",this).on({mousedown:t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"layerRowClicked")}).appendTo(this.group.container.$ul),this.layerTitleSpan=t('<span class="n2-ucf">'+this.property.name+"</span>"),this.makeNameEditable(),this.layerTitle=t('<div class="n2-ss-layer-title"></div>').on({mouseenter:t.proxy(function(){this.fragmentEditor.highlight(this)},this),mouseleave:t.proxy(function(){this.fragmentEditor.deHighlight(this)},this)}).append(this.layerTitleSpan).append(e).appendTo(this.layerRow).on({mouseup:t.proxy(function(t){nextend.shouldPreventMouseUp||"DIV"!==t.target.tagName||this.activate(t)},this)}),nextend.tooltip.add(this.layerRow),this.layerRow.nUILayerListItem({UIManager:this.fragmentEditor.mainContainer.layerListUIManager,layer:this,$item:this.layerRow}),this.layerRow},i.prototype.select=function(t){return this.fragmentEditor.selectLayer(this,!0)},i.prototype.update=function(){this.readyDeferred.done(t.proxy(this.placement.updatePositionThrottled,this.placement))},i.prototype.updateThrottled=function(){this.placement.updatePositionThrottled()},i.prototype.positionSidebar=function(){this.fragmentEditor.layerWindow.show(this,this.layer)},i.prototype.showEditor=function(){this.fragmentEditor.layerWindow._show()},i.prototype.highlight=function(e){e=e||2e3,this.isHighlighted&&(clearTimeout(this.isHighlighted),this.isHighlighted=!1),this.layer.addClass("n2-highlight"),this.isHighlighted=setTimeout(t.proxy(function(){this.layer.removeClass("n2-highlight")},this),e)},i.prototype.setPropertydesktopPortrait=i.prototype.setPropertydesktopLandscape=i.prototype.setPropertytabletPortrait=i.prototype.setPropertytabletLandscape=i.prototype.setPropertymobilePortrait=i.prototype.setPropertymobileLandscape=function(t,e,i){this._setProperty(t,parseInt(e),i)},i.prototype.getHTML=function(t){var i=this._createLayer();for(var s in this.property)"width"!=s&&"height"!=s&&"left"!=s&&"top"!=s&&i.attr("data-"+s.toLowerCase(),this.property[s]);for(var s in this.deviceProperty)for(var r in this.deviceProperty[s])i.attr("data-"+s.toLowerCase()+r,this.deviceProperty[s][r]);for(var s in this.deviceProperty.desktop)i.css(s,this.deviceProperty.desktop[s]+"px");if(this.container!==e){var n=i;this.innerContainer!==e&&(n=i.find(this.innerContainer)),n.append(this.container.getHTML(t))}var o=this.getProperty("id");return o&&""!=o&&i.attr("id",o),this.status>N2Classes.ComponentAbstract.STATUS.NORMAL&&i.attr("data-status",this.status),i},i.prototype.duplicate=function(e){var i=this.getHTML(!1);if("absolute"===this.placement.getType()){var s=i.attr("id");s&&(s=t.fn.uid(),i.attr("id",s),i.attr("data-id",s)),i.attr("data-parentid")?(i.data("desktopportraittop",0),i.data("desktopportraitleft",0)):(i.data("desktopportraittop",i.data("desktopportraittop")+40),i.data("desktopportraitleft",i.data("desktopportraitleft")+40)),i.attr("data-parentid","")}var r=this.fragmentEditor.insertComponentWithNode(this.group,i,this.getIndex()+1,!1,!0);return this.layerRow.trigger("mouseleave"),e&&r.activate(),N2Classes.History.get().addSimple(this,this.historyDeleteDuplicated,this.historyDuplicate,[r,r.container?r.container.getAllLayers():!1]),r},i.prototype.historyDeleteDuplicated=function(t){t.getSelf()["delete"]()},i.prototype.historyDuplicate=function(t,e){var i=this.duplicate(!1,!1);if(t.setSelf(i),e)for(var s=i.container.getAllLayers(),r=0;r<s.length;r++)e[r].setSelf(s[r])},i.prototype.historyDelete=function(){this["delete"]()},i.prototype.historyRestore=function(t,e,i,s){var r=this.fragmentEditor.insertComponentWithNode(this.group.getSelf(),t.clone(),i,!1,!0);if(this.setSelf(r),s)for(var n=r.container.getAllLayers(),o=0;o<n.length;o++)s[o].setSelf(n[o])},i.prototype["delete"]=function(){N2Classes.PositionDisplay.get().hide(),nextend.tooltip.onLeave(),this._delete()},i.prototype._delete=function(){if(this.isDeleteStarted=!0,this.fragmentEditor.mainContainer.getSelectedLayer()==this&&this.fragmentEditor.layerWindow.hide(),this.isHighlighted&&(clearTimeout(this.isHighlighted),this.isHighlighted=!1),N2Classes.History.get().startBatch(),N2Classes.History.get().addSimple(this,this.historyRestore,this.historyDelete,[this.getHTML(!1),this.group,this.getIndex(),this.container?this.container.getAllLayers():!1]),this.deActivate(),this.container!=e){N2Classes.History.get().off();for(var t=this.container.getSortedLayers(),i=0;i<t.length;i++)t[i]._delete();N2Classes.History.get().on()}N2Classes.History.get().endBatch(),this.item!=e&&this.item["delete"](),this.placement["delete"](),this.layer.trigger("mouseup"),this.isDeleted=!0,this.fragmentEditor.mainContainer.layerDeleted(this),this.layer.triggerHandler("LayerDeleted"),this.getRootElement().remove(),this.layerRow.remove(),this.group.update(),this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group.$.off("refreshTextAlign.sslayer"+this.counter),this.$.trigger("layerDeleted"),this.markTimer&&clearTimeout(this.markTimer),delete this.layer,delete this.itemEditor,this.group.onChildCountChange()},i.prototype.getData=function(e){var i={type:this.type,lastplacement:this.placement.getType()};this.status>N2Classes.ComponentAbstract.STATUS.NORMAL&&(i.status=this.status);var s=t.extend({},this.property);for(var r in this.deviceProperty)for(var n in this.deviceProperty[r]){delete s[n];var o=this.deviceProperty[r][n];if("undefined"!=typeof o){switch(n){case"width":case"height":this.isDimensionPropertyAccepted(o)||(o=parseFloat(o));break;case"fontsize":case"left":case"top":case"gutter":case"wrap":o=parseFloat(o)}i[r.toLowerCase()+n]=o}}for(var a in s)i[a.toLowerCase()]=s[a];return i},i.prototype.onChildCountChange=function(){},i.prototype.getDataWithChildren=function(e,i){return-1==t.inArray(this,i)&&(i.push(this),e.push(this.getData({layersIncluded:!0,itemsIncluded:!0})),this.layer.triggerHandler("LayerGetDataWithChildren",[e,i])),e},i.prototype.markOver=function(t){this.layer.addClass("n2-ss-mouse-over"),t.stopPropagation(),this.group.markEnter(),this.markTimer&&clearTimeout(this.markTimer),this.layer.addClass("n2-ss-mouse-over-delayed"),this.uiLabel.removeClass("invisible")},i.prototype.markOut=function(e){this.layer.removeClass("n2-ss-mouse-over"),e&&e.stopPropagation(),this.group.markLeave(),this.markTimer&&clearTimeout(this.markTimer),this.isActive||this.uiLabel.addClass("invisible"),this.markTimer=setTimeout(t.proxy(function(){this.layer.removeClass("n2-ss-mouse-over-delayed"),this.uiLabel.removeClass("invisible"),this.markTimer=null},this),10)},i.prototype.markEnter=function(t){this.layer.addClass("n2-ss-mouse-hover"),this.group.markEnter()},i.prototype.markLeave=function(t){this.layer.removeClass("n2-ss-mouse-hover"),this.group.markLeave()},i.prototype.formSetname=function(t,e){},i.prototype.formSetnameSynced=function(t,e){},i.prototype.formSetdesktopPortrait=function(t,e){t.currentForm.desktopPortrait.data("field").insideChange(e)},i.prototype.formSetdesktopLandscape=function(t,e){t.currentForm.desktopLandscape.data("field").insideChange(e)},i.prototype.formSettabletPortrait=function(t,e){t.currentForm.tabletPortrait.data("field").insideChange(e)},i.prototype.formSettabletLandscape=function(t,e){t.currentForm.tabletLandscape.data("field").insideChange(e)},i.prototype.formSetmobilePortrait=function(t,e){t.currentForm.mobilePortrait.data("field").insideChange(e)},i.prototype.formSetmobileLandscape=function(t,e){t.currentForm.mobileLandscape.data("field").insideChange(e)},i.prototype.sync=function(){if(this._syncid(),this.container)for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e].sync();this.placement.sync()},i.prototype._syncid=function(){var t=this.getProperty("id");t&&""!=t?this.layer.attr("id",t):this.layer.removeAttr("id")},i.prototype.requestID=function(){var e=this.getProperty("id");return e||(e=t.fn.uid(),this.setProperty("id",e,"layer")),e},i.prototype.requestUniqueClass=function(){var e=this.getProperty("uniqueclass");return e||(e=t.fn.generateUniqueClass("n-uc-"),this.setProperty("uniqueclass",e,"layer")),e},i.prototype.regenerateUniqueClass=function(){this.getProperty("uniqueclass")&&this.setProperty("uniqueclass",t.fn.generateUniqueClass("n-uc-"),"layer")},i.prototype._syncuniqueclass=function(){for(var t=this.getProperty("uniqueclass"),e=0;e<this.classElements.length;e++)this.classElements[e].$el.removeClass(function(t,e){return(e.match(/n-uc-[a-z0-9\-]+/gi)||[]).join(" ")}).addClass(t+this.classElements[e].postfix)},i.prototype._syncfontsize=function(){this.adjustFontSize(this.getProperty("adaptivefont"),this.getProperty("fontsize"),!0)},i.prototype._syncadaptivefont=function(){this.adjustFontSize(this.getProperty("adaptivefont"),this.getProperty("fontsize"),!0)},i.prototype.adjustFontSize=function(t,e,i){e=parseInt(e),parseInt(t)?this.layer.css("font-size",16*e/100+"px"):100!=e?this.layer.css("font-size",e+"%"):this.layer.css("font-size",""),this.refreshBaseSize(),i&&this.update()},i.prototype.refreshBaseSize=function(){var t=this.getFontSize();this.isAdaptiveFont()?this.baseSize=16*t/100:this.baseSize=this.group.baseSize*t/100,this.$.triggerHandler("baseSizeUpdated")},i.prototype.refreshTextAlign=function(){this.$.triggerHandler("textAlignUpdated")},i.prototype.getFontSize=function(){return parseInt(this.getProperty("fontsize"))},i.prototype.isAdaptiveFont=function(){return parseInt(this.getProperty("adaptivefont"))},i.prototype._synccrop=function(){var t=this.getProperty("crop");"auto"==t&&(t="hidden"),"mask"==t?(t="hidden",this.addWrap("mask","<div class='n2-ss-layer-mask'></div>")):(this.removeWrap("mask"),this.layer.data("animatableselector",null)),this.layer.css("overflow",t)},i.prototype._syncrotation=function(){var t=parseFloat(this.getProperty("rotation"));if(t/360!=0){var e=this.addWrap("rotation","<div class='n2-ss-layer-rotation'></div>");NextendTween.set(e[0],{rotationZ:t})}else this.removeWrap("rotation")},i.prototype.addWrap=function(i,s){if(this.wraps[i]===e){var r=t(s);switch(this.wraps[i]=r,i){case"mask":r.appendTo(this.layer),this.wraps.rotation!==e?r.append(this.wraps.rotation):r.append(this.getContents()),this.layer.data("animatableselector",".n2-ss-layer-mask:first");break;case"rotation":this.wraps.mask!==e?r.appendTo(this.wraps.mask):r.appendTo(this.layer),r.append(this.getContents())}}return this.wraps[i]},i.prototype.removeWrap=function(t){if(this.wraps[t]!==e){switch(t){case"mask":this.wraps.rotation!==e?this.layer.append(this.wraps.rotation):this.layer.append(this.getContents());break;case"rotation":this.wraps.mask!==e?this.wraps.mask.append(this.getContents()):this.layer.append(this.getContents())}this.wraps[t].remove(),delete this.wraps[t]}},i.prototype.getContents=function(){return!1},i.prototype._syncclass=function(){this._lastClasses!==!1&&this.layer.removeClass(this._lastClasses);var t=this.fragmentEditor.editor.generator.fill(this.getProperty("class"));t&&""!=t?(this.layer.addClass(t),this._lastClasses=t):this._lastClasses=!1},i.prototype._syncparallax=function(){},i.prototype._syncgeneratorvisible=function(){},i.prototype._syncmouseenter=i.prototype._syncclick=i.prototype._syncmouseleave=i.prototype._syncplay=i.prototype._syncpause=i.prototype._syncstop=function(){},i.prototype.renderModeProperties=function(t){N2Classes.LayerDataStorage.prototype.renderModeProperties.call(this),this.placement.renderModeProperties(t)},i.prototype.getIndex=function(){return this.group.container.getLayerIndex(this.layer)},i.prototype.toString=function(){return this.type+" #"+this.counter},i.prototype.historyStoreOnPlacement=function(){var t=Array.prototype.slice.call(arguments);t.splice(1,1),this.placement.current[arguments[1]].apply(this.placement.current,t)},i.prototype.getDroppable=function(){return!1},i.prototype.onCanvasUpdate=function(t,e,i){if(this.group===e)t!=i&&this.userIndexChange(t,i);else{var s;if(this.fragmentEditor.isCol(this.group))for(s=this;s&&(!s.placement||"absolute"!==s.placement.getType());)s=s.group;this.changeGroup(t,e),e.onChildCountChange();for(var r=this;r&&(!r.placement||"absolute"!==r.placement.getType());)r=r.group;s&&s!=r&&s.placement.updatePosition(),r&&r.placement.updatePosition()}},i.prototype.setStatusNormal=function(){this.changeStatus(i.STATUS.NORMAL)},i.prototype.changeStatus=function(t){var e=this.status;switch(t==this.status&&(t=i.STATUS.NORMAL),this.status){case i.STATUS.HIDDEN:this.getRootElement().removeAttr("data-visibility"),this.layerRow.removeClass("n2-ss-layer-status-hidden");break;case i.STATUS.LOCKED:this.layer.removeClass("n2-ss-layer-locked"),this.layerRow.removeClass("n2-ss-layer-status-locked")}switch(this.status=t,this.status){case i.STATUS.HIDDEN:this.getRootElement().attr("data-visibility","hidden"),this.layerRow.addClass("n2-ss-layer-status-hidden");break;case i.STATUS.LOCKED:this.layer.addClass("n2-ss-layer-locked"),this.layerRow.addClass("n2-ss-layer-status-locked")}this.placement.current.changeStatus(e,this.status)},i.prototype.moveX=function(t){"absolute"==this.placement.getType()&&this.placement.current.moveX(t)},i.prototype.moveY=function(t){"absolute"==this.placement.getType()&&this.placement.current.moveY(t)},i.prototype.localStyleSync=function(){if(this.localStyle!==e){var i=[],s="";this.$localStyle!==e&&(this.$localStyle.remove(),delete this.$localStyle);for(var r=0;r<this.localStyle.length;r++){var n="@rule"+this.localStyle[r].selector,o="";if(i.push(n),1!==Object.keys(this.localStyle[r].css).length||this.localStyle[r].css.transition===e){for(var a in this.localStyle[r].css)o+=this.localStyle[r].css[a];""!=o&&(s+=n+"{"+o+"}")}}var l=this.getProperty("uniqueclass");if(l)for(var r=0;r<i.length;r++)nextend.css.deleteRule(i[r].replace(/@rule/g,window.nextend.pre+"."+l));""!=s&&(l||(l=this.requestUniqueClass()),this.$localStyle=t("<style>"+s.replace(/@rule/g,window.nextend.pre+"."+l)+"</style>").appendTo("head"))}},i.prototype.addLocalStyle=function(t,i,s){for(var r=0;r<this.localStyle.length;r++)if(this.localStyle[r].group===t){""===s?this.localStyle[r].css[i]!==e&&delete this.localStyle[r].css[i]:this.localStyle[r].css[i]=s,this.localStyleSyncThrottled();break}},i.prototype.addClassElement=function(t,e){arguments.length<2&&(e=""),this.classElements.push({$el:t,postfix:e})},i.prototype.setState=function(t,e){},i}),N2D("Content",["ContentAbstract"],function(t,e){"use strict";function i(e,i,s){this.label=n2_("Content"),this.type="content",this.innerContainer="> .n2-ss-layer-content",this._defaults=t.extend({verticalalign:"center"},this._defaults),this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],N2Classes.ContentAbstract.prototype.constructor.call(this,e,i,s),this.placement.allow("content"),e.setMainContent(this)}return i.prototype=Object.create(N2Classes.ContentAbstract.prototype),i.prototype.constructor=i,i.prototype.addUILabels=function(){this.markTimer=null,this.uiLabel=t('<div class="n2-ss-layer-ui-label-container"><div class="n2-ss-layer-ui-label n2-ss-layer-ui-label-self">'+this.getUILabel()+"</div></div>").appendTo(this.layer)},i.prototype.addProperties=function(t){N2Classes.ContentAbstract.prototype.addProperties.call(this,t),this.createDeviceProperty("selfalign",{desktopPortrait:"inherit"},t)},i.prototype.getRootElement=function(){return this.layer},i.prototype.getBackgroundElement=function(){return this.layer},i.prototype._createLayer=function(){return t('<div class="n2-ss-layer n2-ss-content-empty"><div class="n2-ss-section-main-content n2-ss-layer-content"></div></div>').attr("data-sstype",this.type)},i.prototype.createRow=function(){this.$content=this.layer.find(".n2-ss-layer-content:first"),this.addClassElement(this.layer),this.addClassElement(this.$content,"-inner");var e=t('<div class="n2-ss-layer-status"></div>'),i=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Delete layer")+'"><i class="n2-i n2-i-delete n2-i-grey-opacity"></i></div>').on("click",t.proxy(this["delete"],this));this.container=new N2Classes.LayerContainer(this,t('<ul class="n2-list n2-h4 n2-list-orderable" />'),"normal","> .n2-ss-layer",["row","layer"]),this.container.setLayerContainerElement(this.$content),t('<a href="#" class="n2-ss-sc-hide n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-eye"></i></a>').appendTo(e).on("click",t.proxy(function(t){t.preventDefault(),this.status==N2Classes.ComponentAbstract.STATUS.HIDDEN?this.setStatusNormal():this.changeStatus(N2Classes.ComponentAbstract.STATUS.HIDDEN)},this)),this._createLayerListRow([t('<div class="n2-actions-left"></div>').append(e),t('<div class="n2-actions"></div>').append(i)]).addClass("n2-ss-layer-content-row"),this.openerElement=t('<a href="#" class="n2-ss-layer-icon n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-col"></i></a>').insertBefore(this.layerTitleSpan).on("click",t.proxy(this.switchOpened,this)),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(t.proxy(this._syncopened,this))},i.prototype.create=function(){this.originalProperties.adaptivefont=1,N2Classes.ContentAbstract.prototype.create.call(this),this._syncselfalign(),this._onReady()},i.prototype.load=function(t,e){N2Classes.ContentAbstract.prototype.load.call(this,t,e),this._syncselfalign(),this._onReady()},i.prototype._onReady=function(){N2Classes.ContentAbstract.prototype._onReady.call(this),this.startUISizing()},i.prototype.startUISizing=function(){this.layer.nUINormalSizing({start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("NormalSizing"),"maxwidth"===e&&this.layer.attr("data-has-maxwidth","1")},this),resizeMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().update(t,"NormalSizing","Max-width: "+(0==e.value?"none":e.value+"px"))},this),stopMaxWidth:t.proxy(function(t,e){N2Classes.PositionDisplay.get().hide("NormalSizing"),this.setProperty("maxwidth",e.value)},this)})},i.prototype["delete"]=function(){for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e]["delete"]()},i.prototype.remove=function(){this._delete()},i.prototype.update=function(){this.fragmentEditor.editor.getMainContainerElement().triggerHandler("updateSize")},i.prototype.onChildCountChange=function(){var t=this.container.getSortedLayers();this.layer.toggleClass("n2-ss-content-empty",0==t.length)},i.prototype.renderModeProperties=function(t){N2Classes.ContentAbstract.prototype.renderModeProperties.call(this,t),this._syncselfalign()},i.prototype._syncselfalign=function(){this.layer.attr("data-cssselfalign",this.getProperty("selfalign"))},i.prototype.duplicate=function(t){console.error("Content can not be duplicated!")},i}),N2D("ContentAbstract",["LayerContainer","ComponentAbstract"],function(t,e){"use strict";function i(e,i,s){this._defaults=t.extend({verticalalign:"flex-start"},this._defaults),this._syncbgThrottled=NextendThrottle(this._syncbgThrottled,50),this.stylemode="",N2Classes.ComponentAbstract.prototype.constructor.call(this,e,i,s)}return i.prototype=Object.create(N2Classes.ComponentAbstract.prototype),i.prototype.constructor=i,i.prototype.addProperties=function(i){this.createProperty("opened",1,i,this),N2Classes.ComponentAbstract.prototype.addProperties.call(this,i),this.createProperty("bgimage","",i),this.createProperty("bgimagex",50,i),this.createProperty("bgimagey",50,i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolor","00000000",{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradient","off",{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradientend","00000000",{"-hover":e},this,"stylemode"),i),this.createProperty("verticalalign",this._defaults.verticalalign,i),this.createDeviceProperty("maxwidth",{desktopPortrait:0},i),this.createDeviceProperty("inneralign",{desktopPortrait:"inherit"},i),this.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10|*|px+"},i),this.$.on("baseSizeUpdated.contentAbstract",t.proxy(this._syncpadding,this))},i.prototype.getBackgroundElement=function(){return this.$content},i.prototype.getPaddingElement=function(){return this.$content},i.prototype.create=function(){N2Classes.ComponentAbstract.prototype.create.call(this),this.initUI(),this._syncverticalalign(),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign(),this._syncbgThrottled()},i.prototype.load=function(t,e){N2Classes.ComponentAbstract.prototype.load.call(this,t,e),this.initUI(),this._syncverticalalign(),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign(),this._syncbgThrottled(),this.container.startWithExistingNodes(e)},i.prototype.initUI=function(){this.layer.on({mousedown:t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"layerClicked"),click:t.proxy(function(t){!nextend.shouldPreventMouseUp&&this.fragmentEditor.preventActivationBubbling()&&this.activate(t)},this),dblclick:t.proxy(function(e){e.stopPropagation(),t('[data-tab="layer"]').trigger("click")},this)}),this.getPaddingElement().nUISpacing({handles:"n, s, e, w",start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("Spacing")},this),spacing:t.proxy(function(t,e){var i="";for(var s in e.changed)i+="Padding "+s+": "+e.changed[s]+"px<br>";N2Classes.PositionDisplay.get().update(t,"Spacing",i)},this),stop:t.proxy(this.onSpacingStop,this)})},i.prototype.onSpacingStop=function(e,i){N2Classes.PositionDisplay.get().hide("Spacing");var s=this.getPadding().split("|*|"),r=1,n=1;"px+"==s[s.length-1]&&Math.abs(parseFloat(this.layer.css("fontSize"))-this.baseSize)>1&&(r=this.fragmentEditor.getResponsiveRatioHorizontal(),n=this.fragmentEditor.getResponsiveRatioVertical());for(var o in i.changed){var a=i.changed[o];switch(o){case"top":s[0]=Math.round(a/n);break;case"right":s[1]=Math.round(a/r);break;case"bottom":s[2]=Math.round(a/n);break;case"left":s[3]=Math.round(a/r)}}this.setProperty("padding",s.join("|*|")),t("#layercol-padding").data("field").insideChange(s.join("|*|"))},i.prototype.switchOpened=function(t){t.preventDefault(),this.getProperty("opened")?this.setProperty("opened",0):this.setProperty("opened",1)},i.prototype._syncopened=function(){this.getProperty("opened")?(this.openerElement.removeClass("n2-closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened")):(this.openerElement.addClass("n2-closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},i.prototype.getPadding=function(){return this.getProperty("padding")},i.prototype._syncpadding=function(){var t=this.getPadding().split("|*|"),e=t.pop(),i=this.baseSize;if("px+"==e&&i>0){e="em";for(var s=0;s<t.length;s++)t[s]=parseInt(t[s])/i;
}var r=t.join(e+" ")+e;this.getPaddingElement().css("padding",r),this.update(),this.getPaddingElement().nUISpacing("option","current",r)},i.prototype._syncmaxwidth=function(){var t=parseInt(this.getProperty("maxwidth"));0>=t||isNaN(t)?this.layer.css("maxWidth","").attr("data-has-maxwidth","0"):this.layer.css("maxWidth",t+"px").attr("data-has-maxwidth","1"),this.update()},i.prototype.getInnerAlign=function(){return this.getProperty("inneralign")},i.prototype._syncinneralign=function(){this.layer.attr("data-csstextalign",this.getInnerAlign()),this.refreshTextAlign()},i.prototype.getVerticalAlign=function(){return this.getProperty("verticalalign")},i.prototype._syncverticalalign=function(){this.$content.attr("data-verticalalign",this.getVerticalAlign())},i.prototype._syncbgimage=i.prototype._syncbgimagex=i.prototype._syncbgimagey=i.prototype._syncbgcolor=i.prototype._syncbgcolorgradient=i.prototype._syncbgcolorgradientend=i.prototype["_syncbgcolor-hover"]=i.prototype["_syncbgcolorgradient-hover"]=i.prototype["_syncbgcolorgradientend-hover"]=function(){this._syncbgThrottled()},i.prototype._syncbgThrottled=function(){var t="",i=this.fragmentEditor.editor.generator.fill(this.getProperty("bgimage")),s="";if(""!=i){var r=parseInt(this.getProperty("bgimagex"));isFinite(r)||(r=50);var n=parseInt(this.getProperty("bgimagey"));isFinite(n)||(n=50),t+='URL("'+nextend.imageHelper.fixed(i)+'") '+r+"% "+n+"% / cover no-repeat",s=" "+r+"% "+n+"% / cover no-repeat"}var o=this.getProperty("bgcolor"),a=this.getProperty("bgcolorgradient"),l=this.getProperty("bgcolorgradientend"),h=this.getBackgroundCSS(o,a,l,t,s);this.addLocalStyle("normal","bgcolor",h);var d="",p=!1,c=this.getProperty("bgcolor-hover"),u=this.getProperty("bgcolorgradient-hover"),y=this.getProperty("bgcolorgradientend-hover");c!==e&&c!=o&&(p=!0),u!==e&&u!=a&&(p=!0),y!==e&&y!=l&&(p=!0),p&&(c===e&&(c=o),u===e&&(u=a),y===e&&(y=l),d=this.getBackgroundCSS(c,u,y,t,s)),this.addLocalStyle("hover","bgcolor",d)},i.prototype.getBackgroundCSS=function(t,e,i,s,r){if(0!=N2Color.hex2alpha(t)||"off"!=e&&0!=N2Color.hex2alpha(i)){var n="";switch(""!=s&&(n=r+","+s),e){case"horizontal":return"background:linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+n+";";case"vertical":return"background:linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+n+";";case"diagonal1":return"background:linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+n+";";case"diagonal2":return"background:linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+n+";";case"off":default:return""!=s?"background: linear-gradient("+N2Color.hex2rgbaCSS(t)+", "+N2Color.hex2rgbaCSS(t)+")"+n+";":"background:"+N2Color.hex2rgbaCSS(t)+";"}}else if(""!=s)return"background:"+s+";";return""},i.prototype.getData=function(t){var e=N2Classes.ComponentAbstract.prototype.getData.call(this,t);return t.layersIncluded&&(e.layers=this.container.getData(t)),e},i.prototype.onChildCountChange=function(){this.layer.toggleClass("n2-ss-content-empty",0==this.container.getLayerCount()),this.update()},i.prototype.renderModeProperties=function(t){N2Classes.ComponentAbstract.prototype.renderModeProperties.call(this,t),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign()},i.prototype.getDroppable=function(){return this.layer.is(":visible")&&this.status!=N2Classes.ComponentAbstract.STATUS.HIDDEN&&this.status!=N2Classes.ComponentAbstract.STATUS.LOCKED?{$container:this.$content,layer:this,placement:"normal",axis:"y"}:"hidden"},i.prototype.getLLDroppable=function(t){switch(t.type){case"layer":case"row":return{$container:this.container.$ul,layer:this}}return!1},i.prototype.getContents=function(){return this.$content},i.prototype.setPropertystylemode=function(t,e,i){this.stylemode=e,this.syncAdvancedField("bgcolor"),this.syncAdvancedField("bgcolorgradient"),this.syncAdvancedField("bgcolorgradientend")},i.prototype.onSyncFields=function(){this.fragmentEditor.layerOptions.updateField("stylemode",this.stylemode)},i}),N2D("Layer",["ComponentAbstract"],function(t,e){"use strict";function i(e,i,s){this.label=n2_("Layer"),this.type="layer",this.parent=!1,this.itemEditor=e.itemEditor,N2Classes.ComponentAbstract.prototype.constructor.call(this,e,i,s),this.placement.allow("absolute"),this.placement.allow("normal"),this.$.on("load create",t.proxy(this.startItem,this))}return i.prototype=Object.create(N2Classes.ComponentAbstract.prototype),i.prototype.constructor=i,i.prototype.create=function(){N2Classes.ComponentAbstract.prototype.create.apply(this,arguments),this.initUI(),this._onReady()},i.prototype.load=function(t,e){N2Classes.ComponentAbstract.prototype.load.call(this,t,e),this.initUI(),this._onReady()},i.prototype.startItem=function(){var t=this.layer.find(".n2-ss-item");new(N2Classes[this.itemEditor.getItemClass(t.data("item"))])(t,this,this.itemEditor),this.layer.nUICanvasItem({canvasUIManager:this.fragmentEditor.mainContainer.canvasUIManager,layer:this,$layer:this.layer}),this.item.needSize&&this.layer.addClass("n2-ss-layer-needsize")},i.prototype.initUI=function(){this.layer.on({mousedown:t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"layerClicked"),click:t.proxy(function(t){this.fragmentEditor.preventActivationBubbling()&&this.activate(t)},this),dblclick:t.proxy(function(e){N2Classes.WindowManager.get().isPreventDblClick||(e.stopPropagation(),t('[data-tab="item"]').trigger("click"),this.item.itemEditor.focusFirst("dblclick"))},this)})},i.prototype.getContent=function(){var t=this.layer,e=t.data("animatableselector");return e&&(t=t.find(e)),t},i.prototype._createLayer=function(){return t('<div class="n2-ss-layer"></div>').attr("data-sstype",this.type)},i.prototype.createRow=function(){var e=t('<div class="n2-ss-layer-status"></div>'),i=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Delete layer")+'"><i class="n2-i n2-i-delete n2-i-grey-opacity"></i></div>').on("click",t.proxy(this["delete"],this)),s=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Duplicate layer")+'"><i class="n2-i n2-i-duplicate n2-i-grey-opacity"></i></div>').on("click",t.proxy(function(){this.duplicate(!0,!1)},this));t('<a href="#" class="n2-ss-sc-hide n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-eye"></i></a>').appendTo(e).on("click",t.proxy(function(t){t.preventDefault(),this.status==N2Classes.ComponentAbstract.STATUS.HIDDEN?this.setStatusNormal():this.changeStatus(N2Classes.ComponentAbstract.STATUS.HIDDEN)},this)),this._createLayerListRow([t('<div class="n2-actions-left"></div>').append(e),t('<div class="n2-actions"></div>').append(s).append(i)]).addClass("n2-ss-layer-layer-row")},i.prototype.activate=function(t,e,i){N2Classes.PluginActivatable.prototype.activate.call(this,t,e,i),this.item?this.item.activate(null,e):console.error("The layer do not have item on it!")},i.prototype.getHTML=function(t){var e=N2Classes.ComponentAbstract.prototype.getHTML.call(this,t),i=this.item.getHTML(t);return e.attr("style",e.attr("style")+this.getStyleText()).append(i),e},i.prototype.getData=function(t){var e=N2Classes.ComponentAbstract.prototype.getData.call(this,t);return t.itemsIncluded&&(e.item=this.item.getData()),e},i.prototype.getStyleText=function(){var t="",e=this.property.crop;return"auto"!=e&&"mask"!=e||(e="hidden"),t+="overflow:"+e+";"},i.prototype.getContents=function(){return this.item.$item},i.prototype.onSelfChange=function(){N2Classes.ComponentAbstract.prototype.onSelfChange.call(this),this.item.setSelf(this.self.item)},i}),N2D("LayerAdvancedProperty",function(t,e){"use strict";function i(t,e,i,s,r){this.basename=t,this.def=e,this.modesDef=i,this.obj=s,this.propName=r}return i.prototype.getBaseName=function(){return this.basename},i.prototype.getNames=function(){var t={};t[this.basename]=this.def;for(var e in this.modesDef)t[this.basename+e]=this.modesDef[e];return t},i.prototype.getCurrentMode=function(){return this.obj[this.propName]},i.prototype.getName=function(){var t=this.getCurrentMode();return""!==t?this.basename+t:this.basename},i.prototype.getDefault=function(){var t=this.getCurrentMode();return""!==t?this.modesDef[t]:this.def},i.prototype.resetMode=function(t){if(this.propName==t){var e=this.getCurrentMode();if(""!==e){var i=this.obj.property[this.basename+e];this.obj.property[this.basename+e]=this.modesDef[e],this.obj.syncAdvancedField(this.basename),this.obj.render(this.basename+e,i,"manager")}}},i}),N2D("MainContainer",["LayerContainer"],function(t,e){"use strict";function i(e){this.baseSize=16,this.activeLayer=null,this.$=e.$,this.isActiveGroupBlurred=!0,this.isMainGroup=!0,this.fragmentEditor=e,this.layer=e.editor.getMainContainerElement(),this.layer.nUICanvas({mainContainer:this,tolerance:5,smartguides:t.proxy(function(t){return t.$layer.triggerHandler("LayerParent"),this.fragmentEditor.getSnap()},this),display:{hidden:!0,show:t.proxy(function(){N2Classes.PositionDisplay.get().show("Canvas")},this),update:t.proxy(function(t,e){N2Classes.PositionDisplay.get().update(t,"Canvas","L: "+parseInt(0|e.left)+"px<br />T: "+parseInt(0|e.top)+"px")},this),hide:t.proxy(function(){N2Classes.PositionDisplay.get().hide("Canvas")},this)},start:t.proxy(function(t,e){this.fragmentEditor.canvasDragStart(t,e)},this),drag:t.proxy(function(t,e){this.fragmentEditor.canvasDragMove(t,e),e.layer&&e.layer.placement.current.triggerLayerResized()},this),stop:t.proxy(function(t,e){this.fragmentEditor.canvasDragStop(t,e),e.layer&&e.layer.placement.current.triggerLayerResized()},this)}),this.canvasUIManager=this.layer.nUICanvas("instance"),this.layer.nUILayerList({mainContainer:this,$fixed:t("#n2-ss-layers"),$scrolled:t("#n2-ss-layer-list")}),this.layerListUIManager=this.layer.nUILayerList("instance"),this.layer.parent().prepend('<div class="n2-ss-slide-border n2-ss-slide-border-left" /><div class="n2-ss-slide-border n2-ss-slide-border-top" /><div class="n2-ss-slide-border n2-ss-slide-border-right" /><div class="n2-ss-slide-border n2-ss-slide-border-bottom" />'),this.container=new N2Classes.LayerContainer(this,t("#n2-ss-layer-list").find("ul"),"absolute","> .n2-ss-layer, > .n2-ss-layer-group",["content","row","layer","group"]),this.layerRow=this.container.$ul,this.$.on("layerCreated",t.proxy(function(){this.refreshHasLayers()},this))}return i.prototype.lateInit=function(){this.container.startWithExistingNodes(!0),this.layer.parent().on("click",t.proxy(function(){this.fragmentEditor.shouldPreventActivationBubble?this.blurActiveGroup():this.unBlurActiveGroup(),this.fragmentEditor.allowActivation()},this))},i.prototype.onResize=function(t){for(var e=this.getEverySortedLayers(),i=0;i<e.length;i++)e[i].placement.doLinearResize(t)},i.prototype.getEverySortedLayers=function(){for(var t=this.container.getChildLayersRecursive(!1),e={},i=t.length-1;i>=0;i--)"undefined"!=typeof t[i].property.parentid&&t[i].property.parentid&&("undefined"==typeof e[t[i].property.parentid]&&(e[t[i].property.parentid]=[]),e[t[i].property.parentid].push(t[i]),t.splice(i,1));for(var i=0;i<t.length;i++)"undefined"!=typeof t[i].property.id&&t[i].property.id&&"undefined"!=typeof e[t[i].property.id]&&(e[t[i].property.id].unshift(0),e[t[i].property.id].unshift(i+1),t.splice.apply(t,e[t[i].property.id]),delete e[t[i].property.id]);return t},i.prototype.deleteLayers=function(){for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e]["delete"]()},i.prototype.blurActiveGroup=function(){this.isActiveGroupBlurred=!0},i.prototype.unBlurActiveGroup=function(){this.isActiveGroupBlurred=!1},i.prototype.getActiveGroup=function(){if(this.isActiveGroupBlurred){var t=this,e=this.activeLayer;switch(this.fragmentEditor.isGroup(e)||this.fragmentEditor.isCol(e)||this.fragmentEditor.isContent(e)?t=e:this.fragmentEditor.isRow(e)?t=e.container.getSortedLayers()[0]:e&&(t=e.group),this.fragmentEditor.currentEditorMode){case"content":t==this&&(t=this.fragmentEditor.mainContent);break;case"canvas":t==this.fragmentEditor.mainContent&&(t=this)}return t}switch(this.fragmentEditor.currentEditorMode){case"content":return this.fragmentEditor.mainContent}return this},i.prototype.getSelectedLayer=function(){return null==this.activeLayer?!1:this.activeLayer},i.prototype.getLayerData=function(t){if(t===e)return[];for(var i=[],s=[],r=0;r<t.length;r++)t[r].getDataWithChildren(i,s);return i},i.prototype.layerDeleted=function(t){for(var e=this.fragmentEditor.selectedLayers.length;e--;)t==this.fragmentEditor.selectedLayers[e]&&this.fragmentEditor.selectedLayers.splice(e,1);this._afterLayerDeletedDeBounced(t),this.refreshHasLayers()},i.prototype._afterLayerDeletedDeBounced=NextendDeBounce(function(t){this.activeLayer&&!this.activeLayer.isDeleted||this.fragmentEditor.resetActiveLayer()},50),i.prototype.refreshHasLayers=function(){t("body").toggleClass("n2-ss-has-layers",this.container.getLayerCount()>0),nextend.triggerResize()},i.prototype.getName=function(){return"Slide"},i.prototype.update=function(){},i.prototype.onChildCountChange=function(){},i.prototype.markEnter=function(t){},i.prototype.markLeave=function(t){},i.prototype.getSelf=function(){return this},i.prototype.createLayerAnimations=function(){for(var t=this.fragmentEditor.editor.getHorizontalRatio(),e=this.fragmentEditor.editor.getVerticalRatio(),i=[],s=this.container.getSortedLayers(),r=0;r<s.length;r++)i.push.apply(i,s[r].createLayerAnimations(t,e));return i},i.prototype.getDroppables=function(e){var i,s=this.fragmentEditor.currentEditorMode,r=[];if("canvas"==s){r.push(this.getDroppable()),i=this.container.getSortedLayers();var n=t.inArray(this.fragmentEditor.mainContent,i);n>-1&&i.splice(n,1)}else"content"==s&&(i=[this.fragmentEditor.mainContent]);for(var o=0;o<i.length;o++)if(i[o]!=e){var a=i[o].getDroppable();"object"==typeof a&&r.push(a),"hidden"!=a&&i[o].container&&r.push.apply(r,i[o].container.getDroppables(e))}return r},i.prototype.getLLDroppables=function(t){return this.container.getLLDroppables(t)},i.prototype.getDroppable=function(){return{$container:this.layer,layer:this,placement:"absolute"}},i.prototype.getLLDroppable=function(t){switch(t.type){case"layer":case"row":case"group":case"content":return{$container:this.container.$ul,layer:this}}return!1},i.prototype.replaceLayers=function(e){this._idTranslation={};var i=this.dataToLayers(t.extend(!0,[],e).reverse()),s=[];this.deleteLayers(),this.fragmentEditor.mainContent.remove();for(var r=0;r<i.length;r++)s.push(this.container.append(i[r]));return this.fragmentEditor.refreshMode(),this.container.layerContainerElement.n2imagesLoaded().always(t.proxy(this.fragmentEditor.refreshMode,this.fragmentEditor)),this.getSelectedLayer()||s.length>0&&s[0].activate(),N2Classes.History.get().isEnabled()&&N2Classes.History.get().addSimple(this,this.historyDeleteAll,this.historyReplaceLayers,[e,s,this.container.getAllLayers()]),s},i.prototype.historyDeleteAll=function(t,e){for(var i=0;i<e.length;i++)e[i].getSelf()["delete"]();this.fragmentEditor.mainContent.getSelf().remove()},i.prototype.historyReplaceLayers=function(t,e,i){this.replaceLayers(t);for(var s=this.container.getAllLayers(),r=0;r<i.length;r++)i[r].setSelf(s[r])},i.prototype.addLayers=function(e,i){this._idTranslation={};for(var s=this.dataToLayers(t.extend(!0,[],e)),r=[],n=0;n<s.length;n++)r.push(i.container.append(s[n]));return this.fragmentEditor.refreshMode(),N2Classes.History.get().addSimple(this,this.historyDeleteLayers,this.historyAddLayers,[e,r,i]),r},i.prototype.historyDeleteLayers=function(t,e,i){for(var s=0;s<e.length;s++)e[s].getSelf()["delete"]()},i.prototype.historyAddLayers=function(t,e,i){for(var s=this.addLayers(t,i.getSelf()),r=0;r<e.length;r++)e[r].setSelf(s[r])},i.prototype.dataToLayers=function(t,e){for(var i=[],s=0;s<t.length;s++)switch(t[s].type){case"group":console.error("Group data to layer not implemented!");break;case"row":i.push(this.buildRowNode(t[s],e));break;case"col":i.push(this.buildColNode(t[s],e));break;case"content":i.push(this.buildContentNode(t[s],e));break;case"layer":default:i.push(this.buildLayerNode(t[s],e))}return i},i.prototype._buildNodePrepareID=function(e,i){if(i.id){var s=t.fn.uid(),r=!1;"object"==typeof this._idTranslation[i.id]&&(r=this._idTranslation[i.id]),this._idTranslation[i.id]=s,i.id=s,e.attr("id",s),r&&r.resolve(i.id,s)}if(i.parentid)switch(typeof this._idTranslation[i.parentid]){case"string":i.parentid=this._idTranslation[i.parentid];break;case"undefined":this._idTranslation[i.parentid]=t.Deferred();case"object":this._idTranslation[i.parentid].done(t.proxy(function(t,e,i){t.data("parentid",i)},this,e));break;default:i.parentid=""}},i.prototype.buildContentNode=function(i,s){var r=t("<div class='n2-ss-layer' data-sstype='content'/>"),n=t("<div class='n2-ss-section-main-content n2-ss-layer-content' />").appendTo(r);for(var o in i)r.data(o,i[o]);return s!==e&&r.appendTo(s),this.dataToLayers(i.layers,n),r},i.prototype.buildRowNode=function(i,s){var r=t("<div class='n2-ss-layer' data-sstype='row'/>"),n=t("<div class='n2-ss-layer-row' />").appendTo(r);this._buildNodePrepareID(r,i);for(var o in i)r.data(o,i[o]);return s!==e&&r.appendTo(s),this.dataToLayers(i.cols,n),r},i.prototype.buildColNode=function(i,s){var r=t("<div class='n2-ss-layer' data-sstype='col'/>"),n=t("<div class='n2-ss-layer-col n2-ss-layer-content' />").appendTo(r);for(var o in i)r.data(o,i[o]);return s!==e&&r.appendTo(s),this.dataToLayers(i.layers,n),r},i.prototype.buildLayerNode=function(i,s){var r=t("<div class='n2-ss-layer' data-sstype='layer'></div>").attr("style",i.style),n=1;i.zIndex&&(n=i.zIndex),this._buildNodePrepareID(r,i),i.items!==e&&(i.item=i.items[0],delete i.items),t('<div class="n2-ss-item n2-ss-item-'+i.item.type+'"></div>').data("item",i.item.type).data("itemvalues",i.item.values).appendTo(r),delete i.style,delete i.item;for(var o in i)r.data(o,i[o]);return s!==e&&r.appendTo(s),r},i}),N2D("Row",["LayerContainer","ComponentAbstract"],function(t,e){"use strict";function i(e,i,s){this.label=n2_("Row"),this.type="row",this._syncbgThrottled=NextendThrottle(this._syncbgThrottled,50),this.innerContainer="> .n2-ss-layer-row > .n2-ss-layer-row-inner",this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],this.columnsField=t("#layerrow-columns").data("field"),this.refreshUI=NextendDeBounce(this.refreshUI,100),this.stylemode="",N2Classes.ComponentAbstract.prototype.constructor.call(this,e,i,s),this.placement.allow("absolute"),this.placement.allow("normal")}return i.prototype=Object.create(N2Classes.ComponentAbstract.prototype),i.prototype.constructor=i,i.prototype.addProperties=function(i){this.createProperty("opened",1,i,this),N2Classes.ComponentAbstract.prototype.addProperties.call(this,i),this.createProperty("href","",i),this.createProperty("href-target","_self",i),this.createProperty("bgimage","",i),this.createProperty("bgimagex",50,i),this.createProperty("bgimagey",50,i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolor","00000000",{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradient","off",{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradientend","00000000",{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderradius",0,{"-hover":e},this,"stylemode"),i),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("boxshadow","0|*|0|*|0|*|0|*|00000080",{"-hover":e},this,"stylemode"),i),this.createProperty("fullwidth",1,i),this.createProperty("stretch",0,i),this.createDeviceProperty("inneralign",{desktopPortrait:"inherit"},i),this.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10|*|px+"},i),this.createDeviceProperty("gutter",{desktopPortrait:20},i),this.createDeviceProperty("wrapafter",{desktopPortrait:0,mobilePortrait:1,mobileLandscape:1},i),this.$.on("baseSizeUpdated.row",t.proxy(this._syncpadding,this))},i.prototype.historyDeleteSelf=function(){this["delete"]()},i.prototype.historyCreateSelf=function(t,e,i){var s=new N2Classes.Row(this.fragmentEditor,t.getSelf(),{});s.create(e),this.setSelf(s);for(var r=s.container.getSortedLayers(),n=0;n<r.length;n++)i[n].setSelf(r[n])},i.prototype.create=function(e){var i,s=function(e){return t("<div class='n2-ss-layer' />").append(t("<div class='n2-ss-layer-row' />").append(t("<div class='n2-ss-layer-row-inner' />").append(e))).attr("data-sstype","row")},r=function(e){return t("<div class='n2-ss-layer' data-sstype='col'/>").append(t("<div class='n2-ss-layer-col n2-ss-layer-content' />").append(e))};switch(e){case"2col":i=function(t){return s([r(),r()])};break;case"2col-60-40":i=function(t){return s([r().data("colwidth","6/10"),r().data("colwidth","4/10")])};break;case"2col-40-60":i=function(t){return s([r().data("colwidth","4/10"),r().data("colwidth","6/10")])};break;case"2col-80-20":i=function(t){return s([r().data("colwidth","8/10"),r().data("colwidth","2/10")])};break;case"2col-20-80":i=function(t){return s([r().data("colwidth","2/10"),r().data("colwidth","8/10")])};break;case"3col":i=function(t){return s([r(),r(),r()])};break;case"3col-20-60-20":i=function(t){return s([r().data("colwidth","2/10"),r().data("colwidth","6/10"),r().data("colwidth","2/10")])};break;case"4col":i=function(t){return s([r(),r(),r(),r()])};break;case"special":i=function(t){var e=s([r(),r()]);return s([r().data("colwidth","1/5"),r(e).data("colwidth","4/5")])};break;default:i=function(t){return s([r()])}}"absolute"===this.group.container.allowedPlacementMode&&(this.originalProperties=t.extend({width:"100%",align:"center",valign:"top",top:20},this.originalProperties)),N2Classes.ComponentAbstract.prototype.create.call(this,i,!0),this.initUI(),this.container.startWithExistingNodes(!1),this._syncpadding(),this._syncinneralign(),this._syncfullwidth(),this._syncstretch(),this._syncbgThrottled(),this._syncborderradius(),this._syncboxshadow(),this.renderModeProperties(),this.container.renderModeProperties(),N2Classes.History.get().addSimple(this,this.historyDeleteSelf,this.historyCreateSelf,[this.group,e,this.container.getSortedLayers()]),this._onReady()},i.prototype.load=function(t,e){N2Classes.ComponentAbstract.prototype.load.call(this,t,e),this.initUI(),this.container.startWithExistingNodes(e),this._syncpadding(),this._syncinneralign(),this._syncfullwidth(),this._syncstretch(),this._syncbgThrottled(),this._syncborderradius(),this._syncboxshadow(),this._onReady()},i.prototype.initUI=function(){this.layer.nUICanvasItem({canvasUIManager:this.fragmentEditor.mainContainer.canvasUIManager,layer:this,$layer:this.layer}),this.layer.on({mousedown:t.proxy(N2Classes.WindowManager.setMouseDownArea,null,"layerClicked"),click:t.proxy(function(t){!nextend.shouldPreventMouseUp&&this.fragmentEditor.preventActivationBubbling()&&this.activate(t)},this),dblclick:t.proxy(function(e){e.stopPropagation(),t('[data-tab="row"]').trigger("click")},this)}),this.$row.nUISpacing({handles:"n, s, e, w",start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("Spacing")},this),spacing:t.proxy(function(t,e){var i="";for(var s in e.changed)i+="Padding "+s+": "+e.changed[s]+"px<br>";N2Classes.PositionDisplay.get().update(t,"Spacing",i)},this),stop:t.proxy(this.____makeLayerResizeableStop,this)}),this.$row.nUIColumns({columns:"1",gutter:this.getGutter(),start:t.proxy(function(t,e){N2Classes.PositionDisplay.get().show("Columns")},this),colwidth:t.proxy(function(t,e){this.updateColumnWidth(e.currentPercent),N2Classes.PositionDisplay.get().update(t,"Columns",Math.round(100*e.currentPercent[e.index])+"% &mdash; "+Math.round(100*e.currentPercent[e.index+1])+"%")},this),stop:t.proxy(function(t,e){N2Classes.PositionDisplay.get().hide("Columns"),this.setRealColsWidth(e.currentFractions)},this)});var e={};this.$rowInner.nUISortableRow({distance:10,helper:"clone_hide",forceHelperSize:!0,forcePlaceholderSize:!0,items:"> .n2-ss-layer",handle:" > .n2-ss-layer-ui-label-container > .n2-ss-layer-ui-label-self",start:t.proxy(function(t,i){e.originalPrevLayer=i.item.prevAll(".n2-ss-layer").not(i.placeholder).first().data("layerObject");var s=this.getColumns().split("+");i.placeholder.css({width:100*new Fraction(s[i.item.data("layerObject").getIndex()]).valueOf()+"%",visibility:"visible",margin:this.getGutter()+"px"}),i.helper.hasClass("n2-ss-last-in-row")&&i.placeholder.addClass("n2-ss-last-in-row"),i.placeholder.css("order",i.helper.css("order")),i.placeholder.attr("data-r",i.helper.attr("data-r"))},this),beforestop:t.proxy(function(t,i){i.placeholder.detach(),e.layer=i.item.data("layerObject"),e.oldIndex=e.layer.getOrderedIndex()},this),stop:t.proxy(function(t,i){var s=e.layer,r=e.oldIndex,n=0;switch(e.originalPrevLayer?s.layer.insertAfter(e.originalPrevLayer.layer):s.layer.prependTo(s.group.container.layerContainerElement),i.lastPosition[1]){case"before":n=i.lastPosition[0].data("layerObject").getOrderedIndex(),n>r&&n--;break;case"after":n=i.lastPosition[0].data("layerObject").getOrderedIndex(),r>n&&n++}r!==n&&this.moveCol(r,n)},this)})},i.prototype.____makeLayerResizeableStop=function(e,i){N2Classes.PositionDisplay.get().hide("Spacing");var s=this.getPadding().split("|*|"),r=1,n=1;"px+"==s[s.length-1]&&Math.abs(parseFloat(this.layer.css("fontSize"))-this.baseSize)>1&&(r=this.fragmentEditor.getResponsiveRatioHorizontal(),n=this.fragmentEditor.getResponsiveRatioVertical());for(var o in i.changed){var a=i.changed[o];switch(o){case"top":s[0]=Math.round(a/n);break;case"right":s[1]=Math.round(a/r);break;case"bottom":s[2]=Math.round(a/n);break;case"left":s[3]=Math.round(a/r)}}this.setProperty("padding",s.join("|*|")),t("#layerrow-padding").data("field").insideChange(s.join("|*|"))},i.prototype._createLayer=function(){return t('<div class="n2-ss-layer"><div class="n2-ss-layer-row"><div class="n2-ss-layer-row-inner"></div></div></div>').attr("data-sstype",this.type)},i.prototype.historyDeleteCol=function(t,e){e.getSelf()["delete"]()},i.prototype.historyCreateCol=function(t,e){var i=t.getSelf().createCol();e.setSelf(i)},i.prototype.createCol=function(){var t=new N2Classes.Col(this.fragmentEditor,this,{});return N2Classes.History.get().addSimple(this,this.historyDeleteCol,this.historyCreateCol,[this,t]),t.create(),this.isReady()&&this.placement.updatePosition(),t},i.prototype.createRow=function(){this.$row=this.layer.find(".n2-ss-layer-row:first"),this.$rowInner=this.$row.find(".n2-ss-layer-row-inner:first"),0===this.$rowInner.length&&(this.$rowInner=t('<div class="n2-ss-layer-row-inner"></div>').append(this.$row.find("> *")).appendTo(this.$row)),this.container=new N2Classes.LayerContainer(this,t('<ul class="n2-list n2-h4 n2-list-orderable" />'),"default"," > .n2-ss-layer",["col"]),this.container.setLayerContainerElement(this.$rowInner),this.addClassElement(this.layer),this.addClassElement(this.$row,"-inner");var e=t('<div class="n2-ss-layer-status"></div>'),i=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Delete layer")+'"><i class="n2-i n2-i-delete n2-i-grey-opacity"></i></div>').on("click",t.proxy(this["delete"],this)),s=t('<div class="n2-button n2-button-icon n2-button-m n2-button-m-narrow" data-n2tip="'+n2_("Duplicate layer")+'"><i class="n2-i n2-i-duplicate n2-i-grey-opacity"></i></div>').on("click",t.proxy(function(){this.duplicate(!0,!1)},this));t('<a href="#" class="n2-ss-sc-hide n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-eye"></i></a>').appendTo(e).on("click",t.proxy(function(t){t.preventDefault(),this.status==N2Classes.ComponentAbstract.STATUS.HIDDEN?this.setStatusNormal():this.changeStatus(N2Classes.ComponentAbstract.STATUS.HIDDEN)},this)),this._createLayerListRow([t('<div class="n2-actions-left"></div>').append(e),t('<div class="n2-actions"></div>').append(s).append(i)]).addClass("n2-ss-layer-row-row"),this.openerElement=t('<a href="#" class="n2-ss-layer-icon n2-button n2-button-icon n2-button-m"><i class="n2-i n2-i-row"></i></a>').insertBefore(this.layerTitleSpan).on("click",t.proxy(this.switchOpened,this)),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(t.proxy(this._syncopened,this))},i.prototype.activate=function(){N2Classes.PluginActivatable.prototype.activate.apply(this,arguments),this.columnsField.setRow(this),this.$row.nUIColumns("option","active",1)},i.prototype.deActivate=function(){this.$row.nUIColumns("option","active",0),N2Classes.PluginActivatable.prototype.deActivate.apply(this,arguments)},i.prototype.switchOpened=function(t){t.preventDefault(),this.getProperty("opened")?this.setProperty("opened",0):this.setProperty("opened",1)},i.prototype._syncopened=function(){this.getProperty("opened")?(this.openerElement.removeClass("n2-closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened")):(this.openerElement.addClass("n2-closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},i.prototype.getColumns=function(){for(var t=this.container.getSortedLayers(),e=[],i=0;i<t.length;i++)e.push(t[i].getProperty("colwidth"));return e.join("+")},i.prototype.getColumnsOrdered=function(){for(var t=this.getOrderedColumns(),e=[],i=0;i<t.length;i++)e.push(t[i].getProperty("colwidth"));return e.join("+")},i.prototype._synccolumns=function(){for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e]._synccolwidth();this.update()},i.prototype.getPadding=function(){return this.getProperty("padding")},i.prototype._syncpadding=function(){var t=this.getPadding().split("|*|"),e=t.pop(),i=this.baseSize;if("px+"==e&&i>0){e="em";for(var s=0;s<t.length;s++)t[s]=parseInt(t[s])/i}var r=t.join(e+" ")+e;this.$row.css("padding",r),this.$row.nUISpacing("option","current",r),this.update()},i.prototype.getGutter=function(){return this.getProperty("gutter")},i.prototype._syncgutter=function(){var t=this.getGutter(),e=t/2,i=this.container.getSortedLayers();if(i.length>0)for(var s=i.length-1;s>=0;s--)i[s].layer.css("margin",e+"px");this.$rowInner.css({width:"calc(100% + "+(t+1)+"px)",margin:-e+"px"}),this.$row.nUIColumns("option","gutter",this.getGutter()),this._syncwrapafter(),this.update()},i.prototype._syncwrapafter=function(){if(!this.isDeleted&&!this.isDeleteStarted){var t,e=parseInt(this.getProperty("wrapafter")),i=this.getOrderedColumns(),s=!1;for(t=i.length-1;t>=0;t--)i[t].showsOnCurrent||i.splice(t,1);var r=i.length;if(e>0&&r>e&&(s=!0),this.$row.attr("row-wrapped",s?1:0),s){var n=[];for(t=0;r>t;t++){var o=Math.floor(t/e);"undefined"==typeof n[o]&&(n[o]=[]),n[o].push(i[t]),i[t].layer.attr("data-r",o).toggleClass("n2-ss-last-in-row",(t+1)%e===0||t===r-1)}var a=this.getGutter();for(t=0;t<n.length;t++){var l,h=n[t],d=0;for(l=0;l<h.length;l++)d+=h[l].getWidthPercentage();for(l=0;l<h.length;l++)h[l].layer.css("width","calc("+h[l].getWidthPercentage()/d*100+"% - "+(n2const.isIE||n2const.isEdge?a+1:a)+"px)")}}else{var d=0;for(t=0;r>t;t++)d+=i[t].getWidthPercentage();for(t=0;r>t;t++)i[t].layer.css("width",i[t].getWidthPercentage()/d*100+"%").removeClass("n2-ss-last-in-row").attr("data-r",0);r>0&&i[r-1].layer.addClass("n2-ss-last-in-row")}this.update()}},i.prototype.getOrderedColumns=function(){return this.container.getSortedLayers().sort(function(t,e){return t.getRealOrder()-e.getRealOrder()})},i.prototype.getInnerAlign=function(){return this.getProperty("inneralign")},i.prototype._syncinneralign=function(){this.layer.attr("data-csstextalign",this.getInnerAlign()),this.refreshTextAlign()},i.prototype._syncfullwidth=function(){this.layer.attr("data-frontend-fullwidth",0==this.getProperty("fullwidth")?"0":"1")},i.prototype._syncstretch=function(){this.layer.toggleClass("n2-ss-stretch-layer",1==this.getProperty("stretch"))},i.prototype._syncborderradius=i.prototype["_syncborderradius-hover"]=function(){var t=this.getProperty("borderradius");
t>0&&this.addLocalStyle("normal","borderradius","border-radius:"+t+"px;");var e=this.getProperty("borderradius-hover");e&&e!=t&&this.addLocalStyle("hover","borderradius","border-radius:"+e+"px;")},i.prototype._syncboxshadow=i.prototype["_syncboxshadow-hover"]=function(){var t=this.getProperty("boxshadow");this.addLocalStyle("normal","boxshadow",this.getBoxShadowCSS(t.split("|*|")));var i="",s=this.getProperty("boxshadow-hover");s!==e&&s!=t&&(i=this.getBoxShadowCSS(s.split("|*|"))),this.addLocalStyle("hover","boxshadow",i)},i.prototype.getBoxShadowCSS=function(t){return 0==t[0]&&0==t[1]&&0==t[2]&&0==t[3]||0==N2Color.hex2alpha(t[4])?"":"box-shadow:"+t[0]+"px "+t[1]+"px "+t[2]+"px "+t[3]+"px "+N2Color.hex2rgbaCSS(t[4])+";"},i.prototype._synchref=i.prototype["_synchref-target"]=function(){},i.prototype._syncbgimage=i.prototype._syncbgimagex=i.prototype._syncbgimagey=i.prototype._syncbgcolor=i.prototype._syncbgcolorgradient=i.prototype._syncbgcolorgradientend=i.prototype["_syncbgcolor-hover"]=i.prototype["_syncbgcolorgradient-hover"]=i.prototype["_syncbgcolorgradientend-hover"]=function(){this._syncbgThrottled()},i.prototype._syncbgThrottled=function(){var t="",i=this.fragmentEditor.editor.generator.fill(this.getProperty("bgimage")),s="";if(""!=i){var r=parseInt(this.getProperty("bgimagex"));isFinite(r)||(r=50);var n=parseInt(this.getProperty("bgimagey"));isFinite(n)||(n=50),t+='URL("'+nextend.imageHelper.fixed(i)+'") '+r+"% "+n+"% / cover no-repeat",s=" "+r+"% "+n+"% / cover no-repeat"}var o=this.getProperty("bgcolor"),a=this.getProperty("bgcolorgradient"),l=this.getProperty("bgcolorgradientend"),h=this.getBackgroundCSS(o,a,l,t,s);this.addLocalStyle("normal","bgcolor",h);var d="",p=!1,c=this.getProperty("bgcolor-hover"),u=this.getProperty("bgcolorgradient-hover"),y=this.getProperty("bgcolorgradientend-hover");c!==e&&c!=o&&(p=!0),u!==e&&u!=a&&(p=!0),y!==e&&y!=l&&(p=!0),p&&(c===e&&(c=o),u===e&&(u=a),y===e&&(y=l),d=this.getBackgroundCSS(c,u,y,t,s)),this.addLocalStyle("hover","bgcolor",d)},i.prototype.getBackgroundCSS=function(t,e,i,s,r){if(0!=N2Color.hex2alpha(t)||"off"!=e&&0!=N2Color.hex2alpha(i)){var n="";switch(""!=s&&(n=r+","+s),e){case"horizontal":return"background:linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+n+";";case"vertical":return"background:linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+n+";";case"diagonal1":return"background:linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+n+";";case"diagonal2":return"background:linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+n+";";case"off":default:return""!=s?"background: linear-gradient("+N2Color.hex2rgbaCSS(t)+", "+N2Color.hex2rgbaCSS(t)+")"+n+";":"background:"+N2Color.hex2rgbaCSS(t)+";"}}else if(""!=s)return"background:"+s+";";return""},i.prototype.getData=function(t){var e=N2Classes.ComponentAbstract.prototype.getData.call(this,t);return t.itemsIncluded&&(e.cols=this.container.getData(t)),e},i.prototype.moveCol=function(t,e){if("desktopPortrait"==this.getMode()){this._moveCol(t,e);var i=N2Classes.History.get().addValue(this,this.historyMoveCol,[]);i&&i.setValues({oldIndex:e,newIndex:t},{oldIndex:t,newIndex:e})}else{var s=this.getOrderedColumns(),r=s[t];s.splice(t,1),s.splice(e,0,r);for(var n=0;n<s.length;n++)s[n].setProperty("order",n+1);this.refreshUI()}},i.prototype._moveCol=function(t,e){var i=this.container.getSortedLayers();this.container.insertLayerAt(i[t],e),this.refreshUI()},i.prototype.historyMoveCol=function(t){this._moveCol(t.oldIndex,t.newIndex)},i.prototype.setColsWidth=function(t){for(var e=this.container.getSortedLayers(),i=0;i<t.length;i++)e[i].setProperty("colwidth",t[i].toFraction());this._syncwrapafter(),this.update(),this.refreshUI()},i.prototype.setRealColsWidth=function(t){for(var e=this.getOrderedColumns(),i=0;i<t.length;i++)e[i].setProperty("colwidth",t[i].toFraction());this._syncwrapafter(),this.update(),this.refreshUI()},i.prototype.updateColumnWidth=function(t){var e,i=parseInt(this.getProperty("wrapafter")),s=this.getOrderedColumns();for(e=s.length-1;e>=0;e--)s[e].showsOnCurrent||(s.splice(e,1),t.splice(e,1));var r=s.length;if(i>0&&r>i){var n=[];for(e=0;r>e;e++){var o=Math.floor(e/i);"undefined"==typeof n[o]&&(n[o]=[]),s[e]._tempWidth=t[e],n[o].push(s[e])}var a=this.getGutter();for(e=0;e<n.length;e++){var l,h=n[e],d=0;for(l=0;l<h.length;l++)d+=h[l]._tempWidth;for(l=0;l<h.length;l++)h[l].layer.css("width","calc("+h[l]._tempWidth/d*100+"% - "+(n2const.isIE||n2const.isEdge?a+1:a)+"px)")}}else for(e=0;r>e;e++)s[e].layer.css("width",100*t[e]+"%");this.update()},i.prototype.activateColumn=function(t,e){this.container.getSortedLayers()[t].activate(e)},i.prototype.onChildCountChange=function(){if(!this.isDeleted&&!this.isDeleteStarted){var t=this.container.getSortedLayers(),e=t.length;if(e){for(var i=this.getColumns().split("+"),s=0,r=0;r<i.length;r++)s=new Fraction(i[r]).add(s);if(1!=s.valueOf())for(var r=0;e>r;r++)t[r].setProperty("colwidth","1/"+e);else for(var r=0;e>r;r++)t[r]._synccolwidth();this.refreshUI()}this._syncgutter()}},i.prototype.renderModeProperties=function(t){N2Classes.ComponentAbstract.prototype.renderModeProperties.call(this,t),this._syncpadding(),this._syncinneralign(),this._syncgutter(),this.isActive&&this.columnsField.setRow(this)},i.prototype.hightlightStructure=function(e){e=e||4e3,this.isStructureHighlighted&&(clearTimeout(this.isStructureHighlighted),this.isStructureHighlighted=!1),this.layer.addClass("n2-highlight-structure"),this.isStructureHighlighted=setTimeout(t.proxy(function(){this.isDeleted||this.layer.removeClass("n2-highlight-structure")},this),e)},i.prototype.refreshUI=function(){this.isDeleteStarted||(this.isActive&&this.columnsField.setRow(this),this._syncwrapafter(),this.$row.nUIColumns("option","columns",this.getColumnsOrdered()))},i.prototype.getDroppable=function(){return this.layer.is(":visible")&&this.status!=N2Classes.ComponentAbstract.STATUS.HIDDEN&&this.status!=N2Classes.ComponentAbstract.STATUS.LOCKED?{$container:this.$row,layer:this,placement:"normal",axis:"x"}:"hidden"},i.prototype.getLLDroppable=function(t){switch(t.type){case"col":if(t.group==this)return{$container:this.container.$ul,layer:this}}return!1},i.prototype.getContents=function(){return this.$row},i.prototype.setPropertystylemode=function(t,e,i){this.stylemode=e,this.syncAdvancedField("bgcolor"),this.syncAdvancedField("bgcolorgradient"),this.syncAdvancedField("bgcolorgradientend"),this.syncAdvancedField("borderradius"),this.syncAdvancedField("boxshadow")},i.prototype.onSyncFields=function(){this.fragmentEditor.layerOptions.updateField("stylemode",this.stylemode)},i}),N2D("ComponentSettings",function(t,e){"use strict";function i(e){this.componentType="undefined",this.placementType="undefined",t("html").attr("data-component","").attr("data-placement",""),this.currentForm={},this.forms={undefined:null,placement:{absolute:{},normal:{},"default":{}},component:{content:{},layer:{},row:{},col:{},group:{}},global:{id:t("#layerid"),uniqueclass:t("#layeruniqueclass"),desktopPortrait:t("#layershow-desktop-portrait"),desktopLandscape:t("#layershow-desktop-landscape"),tabletPortrait:t("#layershow-tablet-portrait"),tabletLandscape:t("#layershow-tablet-landscape"),mobilePortrait:t("#layershow-mobile-portrait"),mobileLandscape:t("#layershow-mobile-landscape"),"class":t("#layerclass"),generatorvisible:t("#layergenerator-visible"),crop:t("#layercrop"),rotation:t("#layerrotation"),parallax:t("#layerparallax"),fontsize:t("#layerfont-size"),adaptivefont:t("#layeradaptive-font"),mouseenter:t("#layeronmouseenter"),click:t("#layeronclick"),mouseleave:t("#layeronmouseleave"),play:t("#layeronplay"),pause:t("#layeronpause"),stop:t("#layeronstop")}},e.editor.generator.registerField(this.forms.global["class"]),this.fragmentEditor=e;var i=e.editor.getAvailableDeviceModes();i.desktopLandscape||this.forms.global.desktopLandscape.closest(".n2-mixed-group").css("display","none"),i.tabletPortrait||this.forms.global.tabletPortrait.closest(".n2-mixed-group").css("display","none"),i.tabletLandscape||this.forms.global.tabletLandscape.closest(".n2-mixed-group").css("display","none"),i.mobilePortrait||this.forms.global.mobilePortrait.closest(".n2-mixed-group").css("display","none"),i.mobileLandscape||this.forms.global.mobileLandscape.closest(".n2-mixed-group").css("display","none"),this.forms.placement.absolute={parentid:t("#layerparentid"),parentalign:t("#layerparentalign"),parentvalign:t("#layerparentvalign"),left:t("#layerleft"),top:t("#layertop"),responsiveposition:t("#layerresponsive-position"),width:t("#layerwidth"),height:t("#layerheight"),responsivesize:t("#layerresponsive-size"),align:t("#layeralign"),valign:t("#layervalign")},this.forms.placement.normal={margin:t("#layernormal-margin"),height:t("#layernormal-height"),maxwidth:t("#layernormal-maxwidth"),selfalign:t("#layernormal-selfalign")},this.forms.component.content={maxwidth:t("#layercontent-maxwidth"),selfalign:t("#layercontent-selfalign"),padding:t("#layercontent-padding"),inneralign:t("#layercontent-inneralign"),verticalalign:t("#layercontent-verticalalign"),stylemode:t("#layercontent-style-mode").on("n2resetmode",t.proxy(this.resetStyleMode,this,"stylemode")),bgcolor:t("#layercontent-background-color"),bgimage:t("#layercontent-background-image"),bgimagex:t("#layercontent-background-focus-x"),bgimagey:t("#layercontent-background-focus-y"),bgcolorgradient:t("#layercontent-background-gradient"),bgcolorgradientend:t("#layercontent-background-color-end"),opened:t("#layercontent-opened")},e.editor.generator.registerField(this.forms.component.content.bgimage),this.forms.component.row={padding:t("#layerrow-padding"),gutter:t("#layerrow-gutter"),fullwidth:t("#layerrow-fullwidth"),stretch:t("#layerrow-stretch"),wrapafter:t("#layerrow-wrap-after"),inneralign:t("#layerrow-inneralign"),href:t("#layerrow-href"),"href-target":t("#layerrow-href-target"),bgimage:t("#layerrow-background-image"),bgimagex:t("#layerrow-background-focus-x"),bgimagey:t("#layerrow-background-focus-y"),stylemode:t("#layerrow-style-mode").on("n2resetmode",t.proxy(this.resetStyleMode,this,"stylemode")),bgcolor:t("#layerrow-background-color"),bgcolorgradient:t("#layerrow-background-gradient"),bgcolorgradientend:t("#layerrow-background-color-end"),borderradius:t("#layerrow-border-radius"),boxshadow:t("#layerrow-boxshadow"),opened:t("#layerrow-opened")},e.editor.generator.registerField(this.forms.component.row.href),e.editor.generator.registerField(this.forms.component.row.bgimage),this.forms.component.col={maxwidth:t("#layercol-maxwidth"),padding:t("#layercol-padding"),inneralign:t("#layercol-inneralign"),verticalalign:t("#layercol-verticalalign"),href:t("#layercol-href"),"href-target":t("#layercol-href-target"),bgimage:t("#layercol-background-image"),bgimagex:t("#layercol-background-focus-x"),bgimagey:t("#layercol-background-focus-y"),stylemode:t("#layercol-style-mode").on("n2resetmode",t.proxy(this.resetStyleMode,this,"stylemode")),bgcolor:t("#layercol-background-color"),bgcolorgradient:t("#layercol-background-gradient"),bgcolorgradientend:t("#layercol-background-color-end"),borderradius:t("#layercol-border-radius"),boxshadow:t("#layercol-boxshadow"),borderwidth:t("#layercol-border-width"),borderstyle:t("#layercol-border-style"),bordercolor:t("#layercol-border-color"),opened:t("#layercol-opened"),colwidth:t("#layercol-colwidth"),order:t("#layercol-order")},e.editor.generator.registerField(this.forms.component.col.href),e.editor.generator.registerField(this.forms.component.col.bgimage)}return i.prototype.changeActiveComponent=function(e,i,s,r){if(this.currentLayer=e,this.componentType!=i){t("html").attr("data-component",i);var n=t("#n2-tabbed-slide-editor-settings").data("pane");switch(i){case"content":n.showTabs(["content","animations","position"]);break;case"layer":n.showTabs(["item","style","animations","position"]);break;case"group":n.showTabs(["group","animations"]);break;case"row":n.showTabs(["row","animations","position"]);break;case"col":n.showTabs(["column","animations","position"])}this.componentType=i}this.changeActiveComponentPlacement(s),this.syncFields(r)},i.prototype.changeActiveComponentPlacement=function(e,i){this.placementType!=e&&(t("html").attr("data-placement",e),this.placementType=e),this.syncFields(i)},i.prototype.syncFields=function(i){if("object"==typeof i){this.currentForm=t.extend({},this.forms.global,this.forms.component[this.componentType],this.forms.placement[this.placementType]);for(var s in i)typeof i[s]!==e?this.updateField(s,i[s]):console.error("Value is undefined for: "+s);this.currentLayer.onSyncFields();for(var r in this.currentForm)this.currentForm[r].off(".layeroptions").on("outsideChange.layeroptions",t.proxy(this.activeComponentPropertyChanged,this,r))}},i.prototype.onUpdateField=function(t,e,i){t.target==this.currentLayer&&this.updateField(e,i)},i.prototype.updateField=function(t,i){if("function"==typeof this.currentLayer["formSet"+t])this.currentLayer["formSet"+t](this,i);else if(this.currentForm[t]!==e){var s=this.currentForm[t].data("field");s!==e&&s.insideChange(i)}},i.prototype.activeComponentPropertyChanged=function(t,e){if(this.currentLayer&&!this.currentLayer.isDeleted)this.updateLayerProperty(t);else{var i=this.currentForm[t].data("field");"undefined"!=typeof i&&null!==i&&i.insideChange("")}},i.prototype.updateLayerProperty=function(t){var e=this.currentForm[t].val();this.currentLayer.setProperty(t,e,"manager")},i.prototype.startFeatures=function(){this.layerFeatures=new N2Classes.LayerFeatures(this.forms.placement.absolute,this.fragmentEditor);var e=t("#n2-ss-layer-adaptive-font").on("click",t.proxy(function(){this.currentForm.adaptivefont.data("field").onoff.trigger("click")},this));this.forms.global.adaptivefont.on("nextendChange",t.proxy(function(){1==this.currentForm.adaptivefont.val()?e.addClass("n2-active"):e.removeClass("n2-active")},this)),new N2Classes.FormElementNumber("n2-ss-layer-font-size",-Number.MAX_VALUE,Number.MAX_VALUE),new N2Classes.FormElementNumberSlider("n2-ss-layer-font-size",{min:50,max:300,step:5});var i=t("#n2-ss-layer-font-size").on("outsideChange",t.proxy(function(){var t=parseInt(i.val());this.currentForm.fontsize.val(t).trigger("change")},this));this.forms.global.fontsize.on("nextendChange",t.proxy(function(){i.data("field").insideChange(this.forms.global.fontsize.val())},this))},i.prototype.resetStyleMode=function(t,e){this.currentLayer.resetStyleMode(t)},i}),N2D("BgAnimationEditor",["NextendFragmentEditorController"],function(t,e){function i(){this.parameters={shiftedBackgroundAnimation:0},this.$css=t("<style></style>").appendTo("head"),this.backgroundAnimations={color:"eeeeeeff"},N2Classes.NextendFragmentEditorController.prototype.constructor.call(this,!1),this.bgAnimationElement=t(".n2-bg-animation"),this.slides=t(".n2-bg-animation-slide"),this.bgImages=t(".n2-bg-animation-slide-bg"),NextendTween.set(this.bgImages,{rotationZ:1e-4}),this.directionTab=new N2Classes.FormElementRadio("n2-background-animation-preview-tabs",["0","1"]),this.directionTab.element.on("nextendChange.n2-editor",t.proxy(this.directionTabChanged,this)),(n2const.isIE||n2const.isEdge)&&N2Classes.Notification.error("Background animations are not available in your browser. It works if the <i>transform-style: preserve-3d</i> feature available. "),this.$colorField=t("#n2-background-animationcolor").on("nextendChange",t.proxy(this.changeColor,this))}return i.prototype=Object.create(N2Classes.NextendFragmentEditorController.prototype),i.prototype.constructor=i,i.prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorController.prototype.loadDefaults.call(this),this.type="backgroundanimation",this.current=0,this.animationProperties=!1,this.direction=0},i.prototype.get=function(){return null},i.prototype.load=function(t,e,i,s){this.lightbox.addClass("n2-editor-loaded")},i.prototype.setTabs=function(t){},i.prototype.directionTabChanged=function(){this.direction=parseInt(this.directionTab.element.val())},i.prototype.start=function(i){i.color!==e?(this.$colorField.data("field").insideChange(i.color),this.backgroundAnimations.color=i.color):(t("#n2-tab-background-animation-form").remove(),this.$css.html(".n2-3d-side,.tile-colored-overlay{background: "+nextend.currentEditor.frontend.parameters.bgAnimationsColor+";}")),this.animationProperties&&(this.timeline?this.timeline.play():this.next())},i.prototype.changeColor=function(){this.backgroundAnimations.color=this.$colorField.val(),this.$css.html(".n2-3d-side,.tile-colored-overlay{background: "+N2Color.hex2rgbaCSS(this.backgroundAnimations.color)+";}")},i.prototype.pause=function(){this.timeline&&this.timeline.pause()},i.prototype.next=function(){this.timeline=new NextendTimeline({paused:!0,onComplete:t.proxy(this.ended,this)});var e=this.bgImages.eq(this.current),i=this.bgImages.eq(1-this.current);n2const.isIE||n2const.isEdge?(this.timeline.to(this.slides.eq(this.current),1.5,{opacity:0},0),this.timeline.to(this.slides.eq(1-this.current),1.5,{opacity:1},0)):(this.currentAnimation=new N2Classes["SmartSliderBackgroundAnimation"+this.animationProperties.type](this,e,i,this.animationProperties,1,this.direction),this.slides.eq(this.current).css("zIndex",2),this.slides.eq(1-this.current).css("zIndex",3),this.timeline.to(this.slides.eq(this.current),.5,{opacity:0},this.currentAnimation.getExtraDelay()),this.timeline.to(this.slides.eq(1-this.current),.5,{opacity:1},this.currentAnimation.getExtraDelay()),this.currentAnimation.postSetup()),this.current=1-this.current,this.timeline.play()},i.prototype.ended=function(){this.currentAnimation&&this.currentAnimation.ended(),this.next()},i.prototype.setAnimationProperties=function(t){var e=this.animationProperties;this.animationProperties=t,e||this.next()},i}),N2D("BgAnimationManager",["NextendVisualManagerMultipleSelection"],function(t,e){function i(){this.type="backgroundanimation",N2Classes.NextendVisualManagerMultipleSelection.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.NextendVisualManagerMultipleSelection.prototype),i.prototype.constructor=i,i.prototype.loadDefaults=function(){N2Classes.NextendVisualManagerMultipleSelection.prototype.loadDefaults.apply(this,arguments),this.type="backgroundanimation",this.labels={visual:"Background animation",visuals:"Background animations"}},i.prototype.initController=function(){return new N2Classes.BgAnimationEditor},i.prototype.createVisual=function(t,e){return new N2Classes.NextendVisualWithSetRowMultipleSelection(t,e,this)},i.prototype.show=function(e,i){var s={},r=t("#sliderbackground-animation-color");r.length&&(s.color=r.val()),N2Classes.NextendVisualManagerMultipleSelection.prototype.show.call(this,e,i,s)},i.prototype.getAsString=function(){var e=t("#sliderbackground-animation-color");return e.length&&e.val(t("#n2-background-animationcolor").val()),N2Classes.NextendVisualManagerMultipleSelection.prototype.getAsString.call(this)},i}),N2D("ItemButton",["Item"],function(t,e){"use strict";function i(){this.type="button",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.added=function(){this.needFill=["content","class"],this.addedFont("link","font"),this.addedStyle("button","style"),this.generator.registerFields(["#item_buttoncontent","#item_buttonhref","#item_buttonclass"])},i.prototype.getName=function(t){return t.content},i.prototype.parseAll=function(t){t.classes="",parseInt(t.fullwidth)&&(t.classes+=" n2-ss-fullwidth"),parseInt(t.nowrap)&&(t.classes+=" n2-ss-nowrap"),N2Classes.Item.prototype.parseAll.apply(this,arguments)},i.prototype._render=function(e){var i=t('<div class="n2-ss-button-container n2-ow '+e.fontclass+" "+e.classes+'" />'),s=t('<a href="#" onclick="return false;" class="'+e.styleclass+" "+e["class"]+' n2-ow"></a>').appendTo(i);t("<span><span>"+e.content+"</span></span>").appendTo(s);this.$item.append(i)},i}),N2D("ItemHeading",["Item"],function(t,e){"use strict";function i(){this.type="heading",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getDefault=function(){return{href:"",font:"",style:""}},i.prototype.added=function(){this.needFill=["heading","class"],this.addedFont("hover","font"),this.addedStyle("heading","style"),this.generator.registerFields(["#item_headingheading","#item_headinghref","#item_headingclass"])},i.prototype.getName=function(t){return t.heading},i.prototype.parseAll=function(e){e.uid=t.fn.uid(),parseInt(e.fullwidth)?e.display="block":e.display="inline-block",e.extrastyle=parseInt(e.nowrap)?"white-space: nowrap;":"",e.heading=t("<div>"+e.heading+"</div>").text().replace(/\n/g,"<br />"),e.priority=2,e["class"]="",N2Classes.Item.prototype.parseAll.apply(this,arguments),"#"==e.href||""==e.href?(e.afontclass="",e.astyleclass=""):(e.afontclass=e.fontclass,e.fontclass="",e.astyleclass=e.styleclass,e.styleclass="")},i.prototype._render=function(e){var i=t('<div class="n2-ow" />'),s=t('<div id="'+e.uid+'" style="'+e.extrastyle+'"></div>').addClass("n2-ow "+e.fontclass+" "+e.styleclass+" "+e["class"]).css({display:e.display}).appendTo(i);"#"==e.href||""==e.href?s.html(e.heading):s.append(t('<a style="display:'+e.display+';" href="#" class="'+e.afontclass+" "+e.astyleclass+' n2-ow" onclick="return false;">'+e.heading+"</a>")),this.$item.append(i)},i}),N2D("ItemImage",["Item"],function(t,e){"use strict";function i(){this.type="image",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getDefault=function(){return{size:"auto|*|auto",href:"",style:""}},i.prototype.added=function(){this.needFill=["image","cssclass"],this.generator.registerFields(["#item_imageimage","#item_imagealt","#item_imagetitle","#item_imagehref","#item_imagecssclass"])},i.prototype.getName=function(t){return t.image.split("/").pop()},i.prototype.parseAll=function(t){var e=t.size.split("|*|");t.width=e[0],t.height=e[1],delete t.size,N2Classes.Item.prototype.parseAll.apply(this,arguments),t.image!=this.values.image?(t.image=nextend.imageHelper.fixed(t.image),"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(t.image))):t.image=nextend.imageHelper.fixed(t.image)},i.prototype.fitLayer=function(){return"absolute"==this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(this.values.image)),!0},i.prototype._render=function(e){e.styleclass="";var i=t('<div class="'+e.styleclass+' n2-ss-img-wrapper n2-ow" style="overflow:hidden"></div>'),s=i;"#"!=e.href&&""!=e.href&&(s=t('<a href="#" class="n2-ow" onclick="return false;" style="display: block;background: none !important;"></a>').appendTo(i)),t('<img class="n2-ow '+e.cssclass+'" src="'+e.image+'"/>').css({display:"inline-block",maxWidth:"100%",width:e.width,height:e.height}).appendTo(s),this.$item.append(i)},i}),N2D("ItemText",["Item"],function(t,e){"use strict";function i(){this.type="text",N2Classes.Item.prototype.constructor.apply(this,arguments)}function s(t){var e=!1,i=!1,s="table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary";return t=t.replace(/\r\n|\r/g,"\n")+"\n",-1===t.indexOf("\n")?t:(-1!==t.indexOf("<object")&&(t=t.replace(/<object[\s\S]+?<\/object>/g,function(t){return t.replace(/\n+/g,"")})),t=t.replace(/<[^<>]+>/g,function(t){return t.replace(/[\n\t ]+/g," ")}),-1===t.indexOf("<pre")&&-1===t.indexOf("<script")||(e=!0,t=t.replace(/<(pre|script)[^>]*>[\s\S]*?<\/\1>/g,function(t){return t.replace(/\n/g,"<wp-line-break>")})),-1!==t.indexOf("<figcaption")&&(t=t.replace(/\s*(<figcaption[^>]*>)/g,"$1"),t=t.replace(/<\/figcaption>\s*/g,"</figcaption>")),-1!==t.indexOf("[caption")&&(i=!0,t=t.replace(/\[caption[\s\S]+?\[\/caption\]/g,function(t){return t=t.replace(/<br([^>]*)>/g,"<wp-temp-br$1>"),t=t.replace(/<[^<>]+>/g,function(t){return t.replace(/[\n\t ]+/," ")}),t.replace(/\s*\n\s*/g,"<wp-temp-br />")})),t+="\n\n",t=t.replace(/<br \/>\s*<br \/>/gi,"\n\n"),t=t.replace(new RegExp("(<(?:"+s+")(?: [^>]*)?>)","gi"),"\n\n$1"),t=t.replace(new RegExp("(</(?:"+s+")>)","gi"),"$1\n\n"),t=t.replace(/<hr( [^>]*)?>/gi,"<hr$1>\n\n"),t=t.replace(/\s*<option/gi,"<option"),t=t.replace(/<\/option>\s*/gi,"</option>"),t=t.replace(/\n\s*\n+/g,"\n\n"),t=t.replace(/([\s\S]+?)\n\n/g,"<p>$1</p>\n"),t=t.replace(/<p>\s*?<\/p>/gi,""),t=t.replace(new RegExp("<p>\\s*(</?(?:"+s+")(?: [^>]*)?>)\\s*</p>","gi"),"$1"),t=t.replace(/<p>(<li.+?)<\/p>/gi,"$1"),t=t.replace(/<p>\s*<blockquote([^>]*)>/gi,"<blockquote$1><p>"),t=t.replace(/<\/blockquote>\s*<\/p>/gi,"</p></blockquote>"),t=t.replace(new RegExp("<p>\\s*(</?(?:"+s+")(?: [^>]*)?>)","gi"),"$1"),t=t.replace(new RegExp("(</?(?:"+s+")(?: [^>]*)?>)\\s*</p>","gi"),"$1"),t=t.replace(/(<br[^>]*>)\s*\n/gi,"$1"),t=t.replace(/\s*\n/g,"<br />\n"),t=t.replace(new RegExp("(</?(?:"+s+")[^>]*>)\\s*<br />","gi"),"$1"),t=t.replace(/<br \/>(\s*<\/?(?:p|li|div|dl|dd|dt|th|pre|td|ul|ol)>)/gi,"$1"),t=t.replace(/(?:<p>|<br ?\/?>)*\s*\[caption([^\[]+)\[\/caption\]\s*(?:<\/p>|<br ?\/?>)*/gi,"[caption$1[/caption]"),t=t.replace(/(<(?:div|th|td|form|fieldset|dd)[^>]*>)(.*?)<\/p>/g,function(t,e,i){return i.match(/<p( [^>]*)?>/)?t:e+"<p>"+i+"</p>"}),e&&(t=t.replace(/<wp-line-break>/g,"\n")),i&&(t=t.replace(/<wp-temp-br([^>]*)>/g,"<br$1>")),t)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!1,i.prototype.getDefault=function(){return{contentmobile:"",contenttablet:"",font:"",style:""}},i.prototype.added=function(){this.needFill=["content","contenttablet","contentmobile"],this.addedFont("paragraph","font"),this.addedStyle("heading","style"),this.generator.registerFields(["#item_textcontent","#item_textcontenttablet","#item_textcontentmobile"])},i.prototype.getName=function(t){return t.content},i.prototype.parseAll=function(t){N2Classes.Item.prototype.parseAll.apply(this,arguments),t.p=s(t.content),t.ptablet=s(t.contenttablet),t.pmobile=s(t.contentmobile)},i.prototype._render=function(e){var i=t('<div class="n2-ss-desktop n2-ow n2-ow-all">'+e.p+"</div>").appendTo(this.$item);""==e.contenttablet?i.addClass("n2-ss-tablet"):i=t('<div class="n2-ss-tablet n2-ow n2-ow-all">'+e.ptablet+"</div>").appendTo(this.$item),""==e.contentmobile?i.addClass("n2-ss-mobile"):t('<div class="n2-ss-mobile n2-ow n2-ow-all">'+e.pmobile+"</div>").appendTo(this.$item),this.$item.find("p").addClass(e.fontclass+" "+e.styleclass)},i}),N2D("ItemVimeo",["Item"],function(t,e){"use strict";function i(){this.type="vimeo",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!0,i.prototype.added=function(){this.needFill=["vimeourl"],this.generator.registerField("#item_vimeovimeourl")},i.prototype.getName=function(t){return t.vimeourl},i.prototype.parseAll=function(e){var i=this.values.vimeourl!=e.vimeourl;if(N2Classes.Item.prototype.parseAll.apply(this,arguments),""==e.image&&(e.image="$system$/images/placeholder/video.png"),e.image=nextend.imageHelper.fixed(e.image),i&&""!=e.vimeourl){var s=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,r=e.vimeourl.match(s),n=!1;r?n=r[3]:e.vimeourl.match(/^[0-9]+$/)&&(n=e.vimeourl),n?N2Classes.AjaxHelper.getJSON("https://vimeo.com/api/v2/video/"+encodeURI(n)+".json").done(t.proxy(function(e){t("#item_vimeoimage").val(e[0].thumbnail_large).trigger("change")},this)).fail(function(t){0==t.privateurl&&N2Classes.Notification.error("Video not found or private.")}):N2Classes.Notification.error("The provided URL does not match any known Vimeo url or code.")}},i.prototype._render=function(e){var i=t('<div class="n2-ow"></div>').css({width:"100%",height:"100%",minHeight:"50px",background:"url("+e.image+") no-repeat 50% 50%",backgroundSize:"cover"});t('<div class="n2-ss-layer-player n2-ss-layer-player-cover"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48Y2lyY2xlIGN4PSIyNCIgY3k9IjI0IiByPSIyNCIgZmlsbD0iIzAwMCIgb3BhY2l0eT0iLjYiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMTkuOCAzMmMtLjEyNCAwLS4yNDctLjAyOC0uMzYtLjA4LS4yNjQtLjExNi0uNDM2LS4zNzUtLjQ0LS42NjRWMTYuNzQ0Yy4wMDUtLjI5LjE3Ni0uNTUuNDQtLjY2Ni4yNzMtLjEyNi41OTItLjEuODQuMDdsMTAuNCA3LjI1N2MuMi4xMzIuMzIuMzU1LjMyLjU5NXMtLjEyLjQ2My0uMzIuNTk1bC0xMC40IDcuMjU2Yy0uMTQuMS0uMzEuMTUtLjQ4LjE1eiIvPjwvZz48L3N2Zz4=" /></div>').appendTo(i),this.$item.append(i)},i.prototype.fitLayer=function(){return!0},i}),N2D("ItemYoutube",["Item"],function(t,e){"use strict";function i(){this.type="youtube",N2Classes.Item.prototype.constructor.apply(this,arguments)}return i.prototype=Object.create(N2Classes.Item.prototype),i.prototype.constructor=i,i.needSize=!0,i.prototype.added=function(){this.needFill=["youtubeurl","image","start"],this.generator.registerFields(["#item_youtubeyoutubeurl","#item_youtubeimage","#item_youtubestart"])},i.prototype.getName=function(t){return t.youtubeurl},i.prototype.parseAll=function(e){var i=this.values.youtubeurl!==e.youtubeurl;if(N2Classes.Item.prototype.parseAll.apply(this,arguments),""===e.image&&(e.image="$system$/images/placeholder/video.png"),e.image=nextend.imageHelper.fixed(e.image),i){var s=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,r=e.youtubeurl.match(s);r?N2Classes.AjaxHelper.getJSON("https://www.googleapis.com/youtube/v3/videos?id="+encodeURI(r[2])+"&part=snippet&key=AIzaSyC3AolfvPAPlJs-2FgyPJdEEKS6nbPHdSM").done(t.proxy(function(e){if(e.items.length){var i=e.items[0].snippet.thumbnails,s=i.maxres||i.standard||i.high||i.medium||i["default"],n=s.url;"{video_url}"==this.values.youtubeurl&&(n=n.replace(r[2],"{video_id}")),t("#item_youtubeimage").val(n).trigger("change")}},this)).fail(function(t){N2Classes.Notification.error(t.error.errors[0].message)}):N2Classes.Notification.error("The provided URL does not match any known YouTube url or code!")}},i.prototype.fitLayer=function(){return!0},i.prototype._render=function(e){var i=t('<div class="n2-ow"></div>').css({width:"100%",height:"100%",minHeight:"50px",background:"url("+e.image+") no-repeat 50% 50%",backgroundSize:"cover"});parseInt(e.playbutton)&&t('<div class="n2-ss-layer-player n2-ss-layer-player-cover"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48Y2lyY2xlIGN4PSIyNCIgY3k9IjI0IiByPSIyNCIgZmlsbD0iIzAwMCIgb3BhY2l0eT0iLjYiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMTkuOCAzMmMtLjEyNCAwLS4yNDctLjAyOC0uMzYtLjA4LS4yNjQtLjExNi0uNDM2LS4zNzUtLjQ0LS42NjRWMTYuNzQ0Yy4wMDUtLjI5LjE3Ni0uNTUuNDQtLjY2Ni4yNzMtLjEyNi41OTItLjEuODQuMDdsMTAuNCA3LjI1N2MuMi4xMzIuMzIuMzU1LjMyLjU5NXMtLjEyLjQ2My0uMzIuNTk1bC0xMC40IDcuMjU2Yy0uMTQuMS0uMzEuMTUtLjQ4LjE1eiIvPjwvZz48L3N2Zz4=" /></div>').appendTo(i),this.$item.append(i)},i}),N2D("smartslider-backend");