(function(){var t=this;t.N2_=t.N2_||{r:[],d:[]},t.N2R=t.N2R||function(){t.N2_.r.push(arguments)},t.N2D=t.N2D||function(){t.N2_.d.push(arguments)}}).call(window),N2R("$",function(s,t,n){window.nextend=window.nextend||{},s.extend(window.nextend,{animationManager:null,browse:null}),window.n2_=function(t){return nextend.localization[t]!==n?nextend.localization[t]:t},window.n2_sprintf=function(t){var e=arguments,i=1;return t.replace(/%s/g,function(){return e[i++]})},window.nextendtime=s.now(),window.nextend.roundTo=5,window.nextend.roundHelper=function(t){return window.nextend.roundTo<=1?t:Math.round(t/window.nextend.roundTo)*window.nextend.roundTo},s.fn.n2opener=function(){return this.each(function(){console.error("deprecated $.fn.n2opener");var e=s(this).on("click",function(t){e.toggleClass("n2-active")});e.siblings("span").on("click",function(t){e.toggleClass("n2-active")}),e.parent().on("mouseleave",function(){e.removeClass("n2-active")}),e.find(".n2-button-menu").on("click",function(t){t.stopPropagation(),e.removeClass("n2-active")})})},jQuery!==n&&jQuery(document).on("wp-collapse-menu",function(){s(window).trigger("resize")}),nextend.deepDiff={map:function(t,e){if(this.isValue(t))return t!==n&&t!=e?t:n;for(var i in e)this.isFunction(e[i])||(t[i]=this.map(t[i],e[i]),(t[i]===n||s.isPlainObject(t[i])&&s.isEmptyObject(t[i])||this.isArray(t[i])&&0==t[i].length)&&delete t[i]);return t},isFunction:function(t){return"[object Function]"==={}.toString.apply(t)},isArray:function(t){return"[object Array]"==={}.toString.apply(t)},isObject:function(t){return"[object Object]"==={}.toString.apply(t)},isValue:function(t){return!this.isObject(t)&&!this.isArray(t)}},nextend.UnicodeToHTMLEntity=function(e){try{var t,i=/(?:[\uD800-\uDBFF][\uDC00-\uDFFF])/g;for(;t=i.exec(e);)e=e.substr(0,t.index)+function(t){for(var e,i=[],s=0;s<t.length;)55296==(63488&(e=t.charCodeAt(s)))?i.push(((1023&e)<<10)+(1023&t.charCodeAt(++s))+65536):i.push(e),++s;return"&#"+i+";"}(e.substr(t.index,i.lastIndex-t.index))+e.substr(i.lastIndex)}catch(t){return console.error(t),e}return e}}),N2D("Popover",function(s){function e(t){this.$container=t,this.$content=t.find(".n2_popover_content"),this.$exit=this.$content.find(".n2_popover_content_exit").on("click",this.hide.bind(this)),this.positionCallback=this.position.bind(this),this.$trigger=t.find(".n2_popover__trigger").on("click",this.show.bind(this))}return e.prototype.lazyLoad=function(){this.options=s.extend({horizontal:"right",vertical:"below",relatedclass:!1},this.$container.data()),this.$content.appendTo("body"),this.$inner=this.$content.find(".n2_popover_content_inner"),this.$content.find(".n2_floating_menu__item").on("click",function(t){s(t.currentTarget).data("stay-open")||this.hide(t)}.bind(this)),this.lazyLoad=function(){}},e.prototype.position=function(){var t=this.$trigger[0].getBoundingClientRect(),e=this.$inner[0].getBoundingClientRect(),i=0,s=0,n=1;"left"===this.options.horizontal?(i=this.getXLeft(t,e))<0&&(i=this.getXRight(t,e)):(i=this.getXRight(t,e))<0&&(i=this.getXLeft(t,e)),"above"===this.options.vertical?(s=this.getYAbove(t,e))<0?s=this.getYBelow(t,e):n=3:(s=this.getYBelow(t,e))+e.height>window.innerHeight&&(s=this.getYAbove(t,e),n=3),this.$content.css({transform:"translate("+Math.round(i)+"px, "+Math.round(s)+"px)"}),this.$exit.css({order:n,height:t.height+5+"px"})},e.prototype.getXLeft=function(t,e){return t.x},e.prototype.getXRight=function(t,e){return t.x-e.width+t.width},e.prototype.getYAbove=function(t,e){return t.y-e.height-5},e.prototype.getYBelow=function(t,e){return t.y},e.prototype.show=function(t){t&&t.preventDefault(),this.lazyLoad(),this.options.relatedclass&&(this.$related=this.$container.closest("."+this.options.relatedclass),this.$related.addClass(this.options.relatedclass+"--popover-visible")),this.$content.addClass("n2_popover_content--visible").on("mouseleave",this.hide.bind(this)),this.position(),window.addEventListener("scroll",this.positionCallback,{capture:!0,passive:!0})},e.prototype.hide=function(t){this.$related&&(this.$related.removeClass(this.options.relatedclass+"--popover-visible"),delete this.$related),this.$content.off("mouseleave").removeClass("n2_popover_content--visible"),window.removeEventListener("scroll",this.positionCallback,{capture:!0,passive:!0})},e.prototype.setStates=function(i){this.$content.find("a[data-state]").each(function(){var t=s(this),e=t.data("state").match(/^(!)?(.*)$/);"!"===e[1]?t.toggleClass("n2_floating_menu__item--has-state",!i[e[2]]):t.toggleClass("n2_floating_menu__item--has-state",i[e[2]])})},s.fn.nextendPopover=function(){return this.each(function(){var t=s(this);t.data("popover",new e(t))})},e}),N2D("NextendHeadingPane",function(r,t){function e(t,e,i,s){this.$node=t.data("pane",this),this.headings=e,this.contents=i,this.tabNames=[],this.headings.each(function(t,e){this.tabNames.push(r(e).data("tab"))}.bind(this)),this.identifier=s,this._active=e.index(e.filter(".n2-active"));for(var n=0;n<e.length;n++)e.eq(n).on("click",this.switchToPane.bind(this,n));if(s){var o=localStorage.getItem(this.identifier+"-pane")||-1;if(-1!=o)return void this.switchToPane(o)}this.hideAndShow()}return e.prototype.switchToPane=function(t,e){e&&e.preventDefault(),this.headings.eq(this._active).removeClass("n2-active"),this.headings.eq(t).addClass("n2-active"),this._active=t,this.hideAndShow(),this.store(this._active),this.$node.triggerHandler("changetab")},e.prototype.hideAndShow=function(){r(this.contents[this._active]).css("display","block").trigger("activate");for(var t=0;t<this.contents.length;t++)t!=this._active&&r(this.contents[t]).css("display","none")},e.prototype.store=function(t){this.identifier&&localStorage.setItem(this.identifier+"-pane",t)},e.prototype.showTabs=function(t){for(var e=!1,i=0;i<this.tabNames.length;i++)"-1"!=t.indexOf(this.tabNames[i])?(this.headings.eq(i).css("display",""),r(this.contents[i]).css("display",""),i!=this._active&&!1!==e||(e=i)):(this.headings.eq(i).css("display","none"),r(this.contents[i]).css("display","none"));this.switchToPane(e)},e}),N2D("Window",function(t,e){var i=!1;function s(){return i=t(".navbar-fixed-top").height(),n.getTopOffset=function(){return i},i}var n={getTopOffset:s,getBottomOffset:function(){return 0},getHeight:function(){return(window.innerHeight||document.documentElement.clientHeight)-n.getTopOffset()},getWidth:function(){return window.innerWidth||document.documentElement.clientWidth}};return N2R("documentReady",function(){s()}),n}),N2D("WindowManager",function(t,e){var i=["main"],s={};return{addWindow:function(t){i.push(t)},removeWindow:function(){i.pop()},getCurrentWindow:function(){return i[i.length-1]},actionPrevent:function(t){this.actionCancelPreventRelease(t),s[t]=requestAnimationFrame(this.actionPreventRelease.bind(this,t))},actionPreventFunction:function(t){return this.actionPrevent.bind(this,t)},actionCancelPreventRelease:function(t){s[t]!==e&&(cancelAnimationFrame(s[t]),delete s[t])},actionPreventRelease:function(t){delete s[t]},isActionPrevented:function(t){return s[t]!==e}}}),N2D("LoadingScreen",function(e,t){var i,s,n;N2R("documentReady",function(){i=e('<div class="n2_loading_screen"><div class="n2_loading_screen__circle"></div></div>').appendTo("body")});var o={startLoading:function(){s&&clearTimeout(s),n=e.now(),i.addClass("n2_loading_screen--visible")},stopLoading:function(){var t=e.now()-n;300<=t?i.removeClass("n2_loading_screen--visible"):s=setTimeout(function(){i.removeClass("n2_loading_screen--visible")},300-t)}};return o}),N2D("AjaxHelper",function(e,o){function r(){}r.query={};var i={};return r.addAdminUrl=function(t,e){i[t]=e},r.getAdminUrl=function(t){return i[t]},r.addAjaxArray=function(t){for(var e in t)r.query[e]=t[e]},r.makeAjaxUrl=function(t,e){var i=t.split("?");i.length<2&&(i[1]="");var s=N2Classes.N2QueryString.parse(i[1]);if(e!==o)for(var n in e)s[n]=e[n];for(var n in r.query)s[n]=r.query[n];return N2Classes.N2QueryString.add_query_arg(s,i[0])},r.ajax=function(t){return N2Classes.LoadingScreen.startLoading(),e.ajax(t).always(function(e,t){N2Classes.LoadingScreen.stopLoading();try{if("success"!==t?e=JSON.parse(e.responseText):"string"==typeof e&&(e=JSON.parse(e)),e.redirect!==o)return N2Classes.LoadingScreen.startLoading(),void(window.location.href=e.redirect);r.notification(e)}catch(t){var i=/<body[^>]*>((.|[\n\r])*)<\/body>/im.exec(e.responseText);i?N2Classes.ModalSafeHTML(i[1]):console.error(e.responseText,e)}})},r.notification=function(t){if(t.notification!==o&&t.notification)for(var e in t.notification)for(var i=0;i<t.notification[e].length;i++)N2Classes.Notification[e](t.notification[e][i][0],t.notification[e][i][1])},r.getJSON=function(t){return N2Classes.LoadingScreen.startLoading(),e.getJSON(t).always(function(){N2Classes.LoadingScreen.stopLoading()})},r}),N2D("Esc",function(e,t){function i(){this.FiLo=[],this.doc=e(document),this.isListening=!1}return i.prototype.add=function(t){this.FiLo.push(t),this.isListening||(this.doc.on("keydown.n2-esc",function(t){27!==t.keyCode&&8!==t.keyCode||(e(t.target).is("input, textarea")?27===t.keyCode&&(t.preventDefault(),e(t.target).blur()):(t.preventDefault(),this.onClose()))}.bind(this)).on("n2Close.n2-esc",function(t){this.onClose()}.bind(this)),this.isListening=!0)},i.prototype.pop=function(){this.FiLo.pop(),0===this.FiLo.length&&(this.doc.off(".n2-esc"),this.isListening=!1)},i.prototype.onClose=function(){this.FiLo[this.FiLo.length-1]()&&this.pop()},new i}),N2D("tooltip",function(e,s){function t(){this.$element=e('<div class="n2_tooltip"></div>'),this.timeout=null,this.$tipFor=null,e(window).ready(this.ready.bind(this))}function i(){this.isVisible=!1,this.$body=e("body"),this.$element=e('<div class="n2_tooltip"></div>').appendTo(this.$body)}return t.prototype.ready=function(){this.$element.appendTo("body"),this.add(e("body"))},t.prototype.add=function(t){t.find("[data-n2tip]").off(".n2hastip").on({"mouseenter.n2hastip":this.onEnter.bind(this)})},t.prototype.addElement=function(t,e,i,s){t.data({n2tip:e,n2tipv:s,n2tiph:i}).off(".n2hastip").on({"mouseenter.n2hastip":this.onEnter.bind(this)})},t.prototype.removeElement=function(t){t.off(".n2hastip")},t.prototype.hide=function(){this.onLeave()},t.prototype.onEnter=function(t){this.lastE=t,this.timeout&&clearTimeout(this.timeout),this.$tipFor=e(t.currentTarget).on({"mousemove.n2tip":this.onMove.bind(this),"mouseleave.n2tip":this.onLeave.bind(this)}),this.timeout=setTimeout(function(){var t=this.$tipFor.data("n2tipv"),e=this.$tipFor.data("n2tiph");t===s&&(t=10),e===s&&(e=10);var i=this.$tipFor.data("n2tip");"function"==typeof i&&(i=i.call()),this.$element.css({margin:t+"px "+e+"px"}).html(i).addClass("n2_tooltip--active"),this.onMove(this.lastE)}.bind(this),500)},t.prototype.onMove=function(t){this.lastE=t,this.$element.css({left:Math.min(t.clientX,window.innerWidth-this.$element.outerWidth()-30),top:Math.min(t.clientY,window.innerHeight-this.$element.height()-20)})},t.prototype.onLeave=function(){this.timeout&&clearTimeout(this.timeout),this.$tipFor&&(this.$tipFor.off(".n2tip"),this.$tipFor=null,this.$element.removeClass("n2_tooltip--active").css("margin",""))},i.prototype.show=function(t,e){this.isVisible?this.$element.html(t):(this.isVisible=!0,this.$body.on("mousemove.tooltipMouse",this.mouseMove.bind(this)),this.mouseMove(e),this.$element.html(t).addClass("n2_tooltip--active"))},i.prototype.mouseMove=function(t){this.$element.css({left:Math.min(t.clientX+10,window.innerWidth-this.$element.outerWidth()-32),top:Math.min(t.clientY+10,window.innerHeight-this.$element.height()-40)})},i.prototype.hide=function(){this.$body.off("mousemove.tooltipMouse"),this.$element.removeClass("n2_tooltip--active").html(""),this.isVisible=!1},nextend.tooltip=new t,e(window).ready(function(){nextend.tooltipMouse=new i}),nextend.tooltip}),N2D("FormTipManager",function(e,t){var i=1;function s(t){this.$el=t,this.id=i++,this.isVisible=!1,this.$tip=!1,this.ui="el",this.$el.on({"mouseenter.formTip":this.onMouseEnter.bind(this),"mouseleave.formTip":this.onMouseLeave.bind(this)})}s.prototype.onMouseEnter=function(){this.mouseLeaveTimeout&&clearTimeout(this.mouseLeaveTimeout),this.mouseEnterTimeout=setTimeout(this.onMouseEnterTimeout.bind(this),300)},s.prototype.onMouseEnterTimeout=function(){delete this.mouseEnterTimeout,this.isVisible||(this.ui="el",this.show(),this.isVisible=!0)},s.prototype.onMouseLeave=function(){this.mouseEnterTimeout&&clearTimeout(this.mouseEnterTimeout),this.mouseLeaveTimeout=setTimeout(this.onMouseLeaveTimeout.bind(this),300)},s.prototype.onMouseLeaveTimeout=function(){delete this.mouseLeaveTimeout,this.isVisible&&"el"===this.ui&&this.hide()},s.prototype.show=function(){!1===this.$tip&&this.buildTip(),this.$tip.addClass("n2_form_tip--visible"),e(window).on("scroll.formTip"+this.id,this.positionTip.bind(this)).on("resize.formTip"+this.id,this.positionTip.bind(this)),this.positionTip()},s.prototype.hide=function(){e(window).off(".formTip"+this.id),this.$tip.removeClass("n2_form_tip--visible"),this.isVisible=!1},s.prototype.stopPropagation=function(t){t.stopPropagation()},s.prototype.buildTip=function(){this.$tip=e('<div class="n2_form_tip"></div>').on({mouseenter:this.onTipMouseEnter.bind(this),mouseleave:this.onTipMouseLeave.bind(this),mousedown:this.stopPropagation.bind(this),mouseup:this.stopPropagation.bind(this),click:this.stopPropagation.bind(this)}).appendTo("body"),e('<div class="n2_form_tip__overlay"></div>').appendTo(this.$tip);var t=e('<div class="n2_form_tip__content"></div>').appendTo(this.$tip);this.$el.data("tip-label")&&e('<div class="n2_form_tip__label"></div>').text(this.$el.data("tip-label")).appendTo(t),this.$description=e('<div class="n2_form_tip__description"></div>').html(this.$el.data("tip-description")).appendTo(t),this.$el.data("tip-link")&&e('<a class="n2_form_tip__link" href="'+this.$el.data("tip-link")+'" target="_blank">'+n2_("Open docs")+"</a>").appendTo(t)},s.prototype.setDescription=function(t){this.$description?this.$description.html(t):this.$el.data("tip-description",t)},s.prototype.onTipMouseEnter=function(){this.ui="tip"},s.prototype.onTipMouseLeave=function(){this.hide()},s.prototype.positionTip=function(){this.$tip.css({left:0,top:0});var t,e,i=window.innerWidth,s=(window.innerHeight,this.$el[0].getBoundingClientRect()),n=this.$tip[0].getBoundingClientRect(),o={left:0,top:0},r=n2const.rtl.isRtl?s.left>n.width:i-s.left<n.width;r?(t="right",o.left=s.left+s.width-n.width):(t="left",o.left=s.left),s.top>n.height?(e="bottom",o.top=s.top-n.height):(e="top",o.top=s.top+s.height),this.$tip.attr("data-position-horizontal",t).attr("data-position-vertical",e).css(o)};var n={add:function(t){t.find("[data-tip-description]").each(function(){var t=e(this);t.data("formTip")||t.data("formTip",new s(t))})}};return N2R("windowLoad",function(){n.add(e("body"))}),n}),window.N2Color={hex2rgba:function(t){6===t.length&&(t+="ff");var e=parseInt(t,16);return[e>>24&255,e>>16&255,e>>8&255,(255&e)/255]},hex2rgbaCSS:function(t){return"RGBA("+N2Color.hex2rgba(t).join(",")+")"},hexdec:function(t){return t=(t+"").replace(/[^a-f0-9]/gi,""),parseInt(t,16)},hex2alpha:function(t){return 8!==t.length?1:((255&parseInt(t,16))/255).toFixed(3)},colorizeSVG:function(t,e){var i=t.split("base64,");return 1===i.length?t:(i[1]=N2Classes.Base64.encode(N2Classes.Base64.decode(i[1]).replace('fill="#FFF"','fill="#'+e.substr(0,6)+'"').replace('opacity="1"','opacity="'+N2Color.hex2alpha(e)+'"')),i.join("base64,"))},colorToSVG:function(t){var e=parseInt(t,16);return[t.substr(0,6),(255&e)/255]}},N2D("N2QueryString",function(t,o){"use strict";return{parse:function(t){return"string"==typeof t&&(t=t.trim().replace(/^(\?|#)/,""))?t.trim().split("&").reduce(function(t,e){var i=e.replace(/\+/g," ").split("="),s=i[0],n=i[1],s=decodeURIComponent(s),n=n===o?null:decodeURIComponent(n);return t.hasOwnProperty(s)?Array.isArray(t[s])?t[s].push(n):t[s]=[t[s],n]:t[s]=n,t},{}):{}},stringify:function(i){return i?Object.keys(i).map(function(e){var t=i[e];return Array.isArray(t)?t.map(function(t){return encodeURIComponent(e)+"[]="+encodeURIComponent(t)}).join("&"):encodeURIComponent(e)+"="+encodeURIComponent(t)}).join("&"):""},add_query_arg:function(t,e){var i=e.split("?");i.length<2&&(i[1]="");var s=this.parse(i[1]);for(var n in t)t.hasOwnProperty(n)&&(s[n]=t[n]);return i[0]+"?"+this.stringify(s)}}}),function(t){var n=[],o=[],r=[],a=[],l="0123456789abcdef".split(""),d=[],h=[],c=!1,p=0,u=0,f=[];if(t.Int32Array)o=new Int32Array(16),r=new Int32Array(16),a=new Int32Array(4),d=new Int32Array(4),h=new Int32Array(4),f=new Int32Array(4);else{for(var e=0;e<16;e++)o[e]=r[e]=0;for(e=0;e<4;e++)a[e]=d[e]=h[e]=f[e]=0}function g(t){for(var e=16;e--;){var i=e<<2;r[e]=t.charCodeAt(i)+(t.charCodeAt(1+i)<<8)+(t.charCodeAt(2+i)<<16)+(t.charCodeAt(3+i)<<24)}}function y(t,e,i,s,n,o,r){return((e+=t+s+r)<<n|e>>>o)+i<<0}function m(t){i(0,0,0,0,t),h[0]=f[0]+1732584193<<0,h[1]=f[1]-271733879<<0,h[2]=f[2]-1732584194<<0,h[3]=f[3]+271733878<<0}function v(t){i(h[0],h[1],h[2],h[3],t),h[0]=f[0]+h[0]<<0,h[1]=f[1]+h[1]<<0,h[2]=f[2]+h[2]<<0,h[3]=f[3]+h[3]<<0}function i(t,e,i,s,n){var o,r;e=c?(t=y((i^s)&e^s,t,e,n[0],7,25,-680876936),s=y((e^i)&t^i,s,t,n[1],12,20,-389564586),i=y((t^e)&s^e,i,s,n[2],17,15,606105819),y((s^t)&i^t,e,i,n[3],22,10,-1044525330)):(t=((t=n[0]-680876937)<<7|t>>>25)-271733879<<0,s=((s=n[1]-117830708+(2004318071&t^-1732584194))<<12|s>>>20)+t<<0,i=((i=n[2]-1126478375+((-271733879^t)&s^-271733879))<<17|i>>>15)+s<<0,((e=n[3]-1316259209+((s^t)&i^t))<<22|e>>>10)+i<<0),t=y((i^s)&e^s,t,e,n[4],7,25,-176418897),s=y((e^i)&t^i,s,t,n[5],12,20,1200080426),i=y((t^e)&s^e,i,s,n[6],17,15,-1473231341),e=y((s^t)&i^t,e,i,n[7],22,10,-45705983),t=y((i^s)&e^s,t,e,n[8],7,25,1770035416),s=y((e^i)&t^i,s,t,n[9],12,20,-1958414417),i=y((t^e)&s^e,i,s,n[10],17,15,-42063),e=y((s^t)&i^t,e,i,n[11],22,10,-1990404162),t=y((i^s)&e^s,t,e,n[12],7,25,1804603682),s=y((e^i)&t^i,s,t,n[13],12,20,-40341101),i=y((t^e)&s^e,i,s,n[14],17,15,-1502002290),e=y((s^t)&i^t,e,i,n[15],22,10,1236535329),t=y((e^i)&s^i,t,e,n[1],5,27,-165796510),s=y((t^e)&i^e,s,t,n[6],9,23,-1069501632),i=y((s^t)&e^t,i,s,n[11],14,18,643717713),e=y((i^s)&t^s,e,i,n[0],20,12,-373897302),t=y((e^i)&s^i,t,e,n[5],5,27,-701558691),s=y((t^e)&i^e,s,t,n[10],9,23,38016083),i=y((s^t)&e^t,i,s,n[15],14,18,-660478335),e=y((i^s)&t^s,e,i,n[4],20,12,-405537848),t=y((e^i)&s^i,t,e,n[9],5,27,568446438),s=y((t^e)&i^e,s,t,n[14],9,23,-1019803690),i=y((s^t)&e^t,i,s,n[3],14,18,-187363961),e=y((i^s)&t^s,e,i,n[8],20,12,1163531501),t=y((e^i)&s^i,t,e,n[13],5,27,-1444681467),s=y((t^e)&i^e,s,t,n[2],9,23,-51403784),i=y((s^t)&e^t,i,s,n[7],14,18,1735328473),e=y((i^s)&t^s,e,i,n[12],20,12,-1926607734),t=y((o=e^i)^s,t,e,n[5],4,28,-378558),s=y(o^t,s,t,n[8],11,21,-2022574463),i=y((r=s^t)^e,i,s,n[11],16,16,1839030562),e=y(r^i,e,i,n[14],23,9,-35309556),t=y((o=e^i)^s,t,e,n[1],4,28,-1530992060),s=y(o^t,s,t,n[4],11,21,1272893353),i=y((r=s^t)^e,i,s,n[7],16,16,-155497632),e=y(r^i,e,i,n[10],23,9,-1094730640),t=y((o=e^i)^s,t,e,n[13],4,28,681279174),s=y(o^t,s,t,n[0],11,21,-358537222),i=y((r=s^t)^e,i,s,n[3],16,16,-722521979),e=y(r^i,e,i,n[6],23,9,76029189),t=y((o=e^i)^s,t,e,n[9],4,28,-640364487),s=y(o^t,s,t,n[12],11,21,-421815835),i=y((r=s^t)^e,i,s,n[15],16,16,530742520),e=y(r^i,e,i,n[2],23,9,-995338651),t=y(i^(e|~s),t,e,n[0],6,26,-198630844),s=y(e^(t|~i),s,t,n[7],10,22,1126891415),i=y(t^(s|~e),i,s,n[14],15,17,-1416354905),e=y(s^(i|~t),e,i,n[5],21,11,-57434055),t=y(i^(e|~s),t,e,n[12],6,26,1700485571),s=y(e^(t|~i),s,t,n[3],10,22,-1894986606),i=y(t^(s|~e),i,s,n[10],15,17,-1051523),e=y(s^(i|~t),e,i,n[1],21,11,-2054922799),t=y(i^(e|~s),t,e,n[8],6,26,1873313359),s=y(e^(t|~i),s,t,n[15],10,22,-30611744),i=y(t^(s|~e),i,s,n[6],15,17,-1560198380),e=y(s^(i|~t),e,i,n[13],21,11,1309151649),t=y(i^(e|~s),t,e,n[4],6,26,-145523070),s=y(e^(t|~i),s,t,n[11],10,22,-1120210379),i=y(t^(s|~e),i,s,n[2],15,17,718787259),e=y(s^(i|~t),e,i,n[9],21,11,-343485551),f[0]=t,f[1]=e,f[2]=i,f[3]=s}a[0]=128,a[1]=32768,a[2]=8388608,a[3]=-2147483648,d[0]=0,d[1]=8,d[2]=16,d[3]=24,t.md5=t.md5||function(t,e,i){!function(t){var e,i;if(c=!1,p=u=(t+="").length,63<u){for(g(t.substring(0,64)),m(r),c=!0,e=128;e<=u;e+=64)g(t.substring(e-64,e)),v(r);t=t.substring(e-64),u=t.length}for(o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0,e=o[15]=0;e<u;e++)0==(i=e%4)?o[e>>2]=t.charCodeAt(e):o[e>>2]|=t.charCodeAt(e)<<d[i];if(o[e>>2]|=a[e%4],55<e)return c?v(o):(m(o),c=!0),v([0,0,0,0,0,0,0,0,0,0,0,0,0,0,p<<3,0]);o[14]=p<<3,(c?v:m)(o)}(e?t:function(t){for(var e=enc="",i=end=0,s=0,n=t.length;s<n;s++){var o=t.charCodeAt(s);o<128?end++:(enc=127<o&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),end>i&&(e+=t.slice(i,end)),e+=enc,i=end=s+1)}return end>i&&(e+=t.slice(i,n)),e}(t));var s=h[0];return n[1]=l[15&s],n[0]=l[15&(s>>=4)],n[3]=l[15&(s>>=4)],n[2]=l[15&(s>>=4)],n[5]=l[15&(s>>=4)],n[4]=l[15&(s>>=4)],n[7]=l[15&(s>>=4)],n[6]=l[15&(s>>=4)],s=h[1],n[9]=l[15&s],n[8]=l[15&(s>>=4)],n[11]=l[15&(s>>=4)],n[10]=l[15&(s>>=4)],n[13]=l[15&(s>>=4)],n[12]=l[15&(s>>=4)],n[15]=l[15&(s>>=4)],n[14]=l[15&(s>>=4)],s=h[2],n[17]=l[15&s],n[16]=l[15&(s>>=4)],n[19]=l[15&(s>>=4)],n[18]=l[15&(s>>=4)],n[21]=l[15&(s>>=4)],n[20]=l[15&(s>>=4)],n[23]=l[15&(s>>=4)],n[22]=l[15&(s>>=4)],s=h[3],n[25]=l[15&s],n[24]=l[15&(s>>=4)],n[27]=l[15&(s>>=4)],n[26]=l[15&(s>>=4)],n[29]=l[15&(s>>=4)],n[28]=l[15&(s>>=4)],n[31]=l[15&(s>>=4)],n[30]=l[15&(s>>=4)],i?n:n.join("")}}(window),N2D("CssInjection",function(t,e){function i(t,e){this.baseClassName=t;var i=document.body;this.style=document.createElement("style"),this.style.setAttribute("data-base-class-name",t),this.style.setAttribute("type","text/css"),this.style.styleSheet?this.style.styleSheet.cssText=e:this.style.appendChild(document.createTextNode(e)),i.appendChild(this.style)}return i.prototype.getBaseClassName=function(){return this.baseClassName},i.prototype.destroy=function(){this.style.parentNode.removeChild(this.style)},i}),N2D("NextendCSS",function(t,e){function i(){this.style=""}return i.prototype.add=function(t,e){return new N2Classes.CssInjection(t,e)},i.prototype.deleteRule=function(t){for(var e=t.toLowerCase(),i=e.replace(".","\\."),s=document.styleSheets.length-1;0<=s;s--)for(var n,o=this._getRulesArray(s),r=0;o&&r<o.length;r++){o[r].selectorText&&((n=o[r].selectorText.toLowerCase())!=e&&n!=i||(document.styleSheets[s].cssRules?document.styleSheets[s].deleteRule(r):document.styleSheets[s].removeRule(r)))}return!0},i.prototype._getRulesArray=function(t){var e=null;try{document.styleSheets[t].cssRules?e=document.styleSheets[t].cssRules:document.styleSheets[t].rules&&(e=document.styleSheets[t].rules)}catch(t){}return e},window.nextend.css=new i,window.nextend.css}),N2D("ImageHelper",function(e,t){function i(t){(nextend.imageHelper=this).parameters=e.extend({siteKeywords:[],imageUrls:[],wordpressUrl:"",placeholderImage:"",placeholderRepeatedImage:"",protocolRelative:1},t)}return i.prototype.protocolRelative=function(t){return this.parameters.protocolRelative?t.replace(/^http(s)?:\/\//,"//"):t},i.prototype.dynamic=function(t){for(var e=this.parameters.imageUrls,i=this.parameters.siteKeywords,s=this.protocolRelative(t),n=0;n<i.length;n++)if(0===s.indexOf(e[n])){t=i[n]+s.slice(e[n].length);break}return t},i.prototype.fixed=function(t){if("string"==typeof t)for(var e=this.parameters.imageUrls,i=this.parameters.siteKeywords,s=0;s<i.length;s++)if(0===t.indexOf(i[s])){t=e[s]+t.slice(i[s].length);break}return t},i.prototype.openLightbox=function(t){N2Classes.PlatformImageChooser.single(t)},i.prototype.openMultipleLightbox=function(t){N2Classes.PlatformImageChooser.multiple(t)},i.prototype.getPlaceholder=function(){return this.fixed(this.parameters.placeholderImage)},i.prototype.getRepeatedPlaceholder=function(){return this.fixed(this.parameters.placeholderRepeatedImage)},i}),N2D("PlatformImageChooser",function(e,t){function i(){}return i.switchToDefaultSelector=function(t){t&&t.preventDefault(),localStorage.setItem("joomla-image-selector",""),this.defaultModal.show(),this.joomlaModal&&this.joomlaModal.hide()},i.switchToJoomlaSelector=function(t){t&&t.preventDefault(),localStorage.setItem("joomla-image-selector","1"),this.defaultModal.hide(),this.showJoomlaSelector()},i.single=function(e){var t;this.joomlaModalSingle?nextend.browse.selected=[]:(this.joomlaModalSingle=new N2Classes.ModalLightbox(n2_("Select image"),"joomla-image-selector"),t=N2Classes.UI.modalButton(n2_("Use Joomla selector"),"grey-dark").on("click",this.switchToJoomlaSelector.bind(this)),this.joomlaModalSingle.addButton(t,!0).addClass("n2_modal_joomla_image_selector__legacy_button"));var i=window.jInsertFieldValue;this.joomlaModalSingle.addContent(nextend.browse.getNode("single",function(t){e(t),this.joomlaModalSingle.hide(),window.jInsertFieldValue=i}.bind(this))),window.jInsertFieldValue=function(t){e("$/"+t),this.joomlaModalSingle.hide(),window.jInsertFieldValue=i}.bind(this),this.defaultModal=this.joomlaModalSingle,localStorage.getItem("joomla-image-selector")?this.switchToJoomlaSelector():this.switchToDefaultSelector()},i.multiple=function(n){var t,e;this.joomlaModalMultiple?(this.joomlaModalMultiple.$modalBody.find(".n2_modal_filesystem_box--active").removeClass("n2_modal_filesystem_box--active"),nextend.browse.selected=[]):(this.joomlaModalMultiple=new N2Classes.ModalLightbox(n2_("Select image"),"joomla-image-selector"),t=N2Classes.UI.modalButton(n2_("Use Joomla selector"),"grey-dark").on("click",this.switchToJoomlaSelector.bind(this)),this.joomlaModalMultiple.addButton(t,!0).addClass("n2_modal_joomla_image_selector__legacy_button"),e=N2Classes.UI.modalButton(n2_("Select"),"green"),this.joomlaModalMultiple.addButton(e),e.on("click",function(t){t.preventDefault();for(var e=nextend.browse.getSelected(),i=[],s=0;s<e.length;s++)i[s]={image:e[s],title:e[s].split("/").pop(),description:""};this.joomlaModalMultiple.hide(),n(i),window.jInsertFieldValue=o}.bind(this))),this.joomlaModalMultiple.addContent(nextend.browse.getNode("multiple"));var o=window.jInsertFieldValue;window.jInsertFieldValue=function(t){n([{image:"$/"+t,title:t,description:""}]),this.joomlaModalMultiple.hide(),window.jInsertFieldValue=o}.bind(this),this.defaultModal=this.joomlaModalMultiple,localStorage.getItem("joomla-image-selector")?this.switchToJoomlaSelector():this.switchToDefaultSelector()},i.showJoomlaSelector=function(){var t;this.joomlaModal||(this.joomlaModal=new N2Classes.ModalLightbox(n2_("Select image"),"joomla-image-selector-legacy"),t=N2Classes.UI.modalButton(n2_("Use default selector"),"grey-dark").on("click",this.switchToDefaultSelector.bind(this)),this.joomlaModal.addButton(t,!0).addClass("n2_modal_joomla_image_selector__legacy_button"),this.joomlaModal.addContent(e('<iframe src="index.php?option=com_media&view=images&tmpl=component&asset=com_content&author=&fieldid=notused&folder="></iframe>')),window.jModalClose=function(){this.joomlaModal.hide()}.bind(this)),this.joomlaModal.show()},i}),N2D("AbstractModal",function(s,t){function i(t,e){i.counter++,this.id=i.counter,this.type=t,this.buttons=[],this.options=s.extend({hasClose:!0,width:!1,destroyOnHide:!1},e),this.$modal=s('<div class="n2 n2_modal" data-modal-type="'+this.type+'"></div>').appendTo("body"),this.options.hasClose&&s('<div class="n2_modal__overlay"></div>').on("click",this.hide.bind(this)).appendTo(this.$modal),this.$modalWindow=s('<div class="n2_modal__window"></div>').appendTo(this.$modal),!1!==this.options.width&&this.$modalWindow.css("width",this.options.width),this.renderModal()}return i.counter=0,i.prototype.renderModal=function(){},i.prototype.show=function(){document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),N2Classes.WindowManager.addWindow("modal"),this.options.hasClose&&N2Classes.Esc.add(function(){return this.hide("esc"),!0}.bind(this)),this.$modal.addClass("n2_modal--visible")},i.prototype.hide=function(t){N2Classes.WindowManager.removeWindow(),"esc"!==t&&(N2Classes.Esc.pop(),t&&t.preventDefault()),this.$modal.removeClass("n2_modal--visible"),this.options.destroyOnHide&&this.$modal.remove(),document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur()},i.prototype.getBody=function(){return this.$modalBody},i.prototype.addContent=function(t){t.appendTo(this.$modalBody)},i.prototype.clearButtons=function(){for(var t in this.buttons)this.buttons[t].remove();this.buttons=[],this.$modalButtons.html("").attr("data-buttons",0)},i.prototype.addButton=function(t,e){e=e||!1;var i=s('<div class="n2_modal__button"></div>').append(t);return e?i.prependTo(this.$modalButtons):i.appendTo(this.$modalButtons),this.buttons.push(i),this.$modalButtons.attr("data-buttons",this.buttons.length),i},i}),N2D("ModalDeleteConfirm",function(s,t){function n(t,e){var i=new N2Classes.ModalSimple("delete",{destroyOnHide:!0});i.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--delete","red")),i.addContent(N2Classes.UI.modalHeading(n2_("Are you sure?"))),i.addContent(N2Classes.UI.modalParagraphHTML(n2_sprintf("You're about to %s. ",t)+n2_sprintf("The deletion is irreversible, and it's not possible to recover %s.",t)).css("margin-bottom","19px"));var s=N2Classes.UI.modalButton(n2_("Cancel"),"grey").on("click",function(t){t.preventDefault(),i.hide()});i.addButton(s);var n=N2Classes.UI.modalButton(n2_("Delete"),"red").on("click",function(t){t.preventDefault(),e(),i.hide(t)});i.addButton(n),i.show()}return n.href=function(t,e,i){t.preventDefault(),n(i,function(){window.location.href=s(e).attr("href")})},n}),N2D("ModalIframe","AbstractModal",function(i,t){function e(t,e){N2Classes.AbstractModal.prototype.constructor.call(this,t,i.extend({},e))}return((e.prototype=Object.create(N2Classes.AbstractModal.prototype)).constructor=e).prototype.renderModal=function(){this.$modal.addClass("n2_modal--iframe"),this.$frame=i('<iframe name="'+this.type+'" src="about:blank" style="width: 100%;height:100%;" allowfullscreen></iframe>').appendTo(this.$modalWindow)},e.prototype.setSrc=function(t){this.$frame.attr("src",t)},e.prototype.hide=function(t){N2Classes.AbstractModal.prototype.hide.call(this,t),this.$frame.attr("src","about:blank")},e}),N2D("ModalLightbox","AbstractModal",function(s,t){function e(t,e,i){this.title=t,N2Classes.AbstractModal.prototype.constructor.call(this,e,s.extend({},i))}return((e.prototype=Object.create(N2Classes.AbstractModal.prototype)).constructor=e).prototype.renderModal=function(){var t;this.$modal.addClass("n2_modal--lightbox"),this.$modalTopBar=s('<div class="n2_modal__top_bar"></div>').appendTo(this.$modalWindow),this.$title=s('<div class="n2_modal__top_bar_title"></div>').text(this.title).appendTo(this.$modalTopBar),this.$modalButtons=s('<div class="n2_modal__top_bar_buttons" data-buttons="0"></div>').appendTo(this.$modalTopBar),this.options.hasClose&&(t=N2Classes.UI.modalButton(n2_("Close"),"grey-dark").on("click",this.hide.bind(this)),this.addButton(t)),this.$modalBody=s('<div class="n2_modal__body"></div>').appendTo(this.$modalWindow)},e.prototype.setTitle=function(t){this.title=t,this.$title.text(t)},e}),N2D("ModalSimple","AbstractModal",function(i,t){function e(t,e){N2Classes.AbstractModal.prototype.constructor.call(this,t,i.extend({width:500},e))}return((e.prototype=Object.create(N2Classes.AbstractModal.prototype)).constructor=e).prototype.renderModal=function(){var t;this.$modal.addClass("n2_modal--simple"),this.$modalBodyOuter=i('<div class="n2_modal__body_outer"></div>').appendTo(this.$modalWindow),this.options.hasClose&&(t=i('<div class="n2_modal__close_wrap"></div>').appendTo(this.$modalBodyOuter),i('<div class="n2_modal__close"><i class="ssi_16 ssi_16--remove"></i></div>').on("click",this.hide.bind(this)).appendTo(t)),this.$modalBody=i('<div class="n2_modal__body"></div>').appendTo(this.$modalBodyOuter),this.$modalButtons=i('<div class="n2_modal__buttons" data-buttons="0"></div>').appendTo(this.$modalWindow)},e}),N2D("PreviewPopup",function(t,e){return function(t,e){var i=["height="+screen.availHeight,"width="+screen.availWidth,"toolbar=yes,scrollbars=yes,resizable=yes"].join(","),s=window.open(t,e,i);return s.moveTo(0,0),s.resizeTo(screen.availWidth,screen.availHeight),s}}),N2D("ModalGeneratorRecordViewer",function(r,t){return function(t,e){this.createRecordModal=new N2Classes.ModalSimple("generator-record-viewer",{width:1e3,destroyOnHide:!0}),this.createRecordModal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--data","blue")),this.createRecordModal.addContent(N2Classes.UI.modalHeading(n2_("Records"))),function(t,e,i){var s=r('<div class="n2_generator_records_table"></div>').css("grid-template-columns","40px repeat("+(e.length-1)+", auto)").appendTo(t),n=0;for(r('<div class="n2_generator_records_table__heading" data-col="1"></div>').text(e[n]).appendTo(s),n=1;n<e.length;n++)r('<div class="n2_generator_records_table__heading"></div>').text(e[n]).appendTo(s);for(n=0;n<i.length;n++){var o=0;for(r('<div class="n2_generator_records_table__heading" data-col="1"></div>').text(i[n][o]).appendTo(s),o=1;o<i[n].length;o++)r('<div class="n2_generator_records_table__cell"></div>').html(i[n][o]).appendTo(s)}}(this.createRecordModal.getBody(),t,e),this.createRecordModal.show()}}),N2D("ModalHotkey",function(g,t){function e(){var t=this.getHotkeys();this.modal=new N2Classes.ModalSimple("hotkey",{width:800}),this.modal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--keyboard","blue")),this.modal.addContent(N2Classes.UI.modalHeading(n2_("Keyboard shortcuts")));var e=g('<div class="n2_modal__hotkey"></div>');this.modal.addContent(e);for(var i=0;i<t.length;i++)for(var s=g('<div class="n2_modal__hotkey_column"></div>').appendTo(e),n=0;n<t[i].length;n++){var o=t[i][n][0],r=t[i][n][1],a=g('<div class="n2_modal__hotkey_group"></div>').appendTo(s);g('<div class="n2_modal__hotkey_title">'+o+"</div>").appendTo(a);for(var l=0;l<r.length;l++){var d=g('<div class="n2_modal__hotkey_row"></div>').appendTo(a),h=r[l][0];g('<div class="n2_modal__hotkey_text">'+h+"</div>").appendTo(d);for(var c=g('<div class="n2_modal__hotkey_keys"></div>').appendTo(d),p=r[l][1],u=0;u<p.length;u++)g('<div class="n2_modal__hotkey_key">'+p[u]+"</div>").appendTo(c)}}var f=N2Classes.UI.modalButton(n2_("Got it"),"blue");this.modal.addButton(f),f.on("click",function(t){this.modal.hide()}.bind(this))}e.prototype.getHotkeys=function(){var t="ctrl",e=[],i=[];this.isMac()&&(t="cmd");var s=[n2_("General"),[[n2_("Content tab"),["q"]],[n2_("Style tab"),["w"]]]];e.push(s),s[1].push([n2_("Add Layer"),["a"]],[n2_("Layer List"),["s"]]);var n=[n2_("View"),[[n2_("Preview"),[t,"1"]],[n2_("Desktop"),[t,"2"]],[n2_("Tablet"),[t,"3"]],[n2_("Mobile"),[t,"4"]]]];e.push(n);var o=[n2_("Adjust"),[[n2_("Move (Absolute)"),[n2_("Arrows")]],[n2_("Align (Absolute)"),[n2_("Numeric keys")]]]];e.push(o);var r=[n2_("Action"),[[n2_("Delete"),["del"]],[n2_("Duplicate"),[t,"d"]],[n2_("Copy"),[t,"c"]],[n2_("Paste"),[t,"v"]],[n2_("Undo"),[t,"z"]],[n2_("Redo"),[t,"shift","z"]],[n2_("Save"),[t,"s"]]]];i.push(r);var a=[n2_("Clear device specific settings"),[[n2_("Current layer, current device"),["shift","e"]],[n2_("Current layer, all devices"),["shift","alt","e"]],[n2_("All layers, current device"),["shift","r"]],[n2_("All layers, all devices"),["shift","alt","r"]]]];return i.push(a),[e,i]},e.prototype.isMac=function(){return 0<=navigator.platform.toUpperCase().indexOf("MAC")};var i=!(e.prototype.show=function(){this.modal.show()});function s(){}return s.show=function(){(i=i||new e).show()},s}),N2D("ModalSafeHTML",function(s,t){return function(t){var i=new N2Classes.ModalSimple("safe-html",{destroyOnHide:!1,width:440});i.addContent(N2Classes.UI.modalHeading(n2_("Unexpected response")));var e=s(t.replace(/document\.write/g,"n2Write"));window.n2Write=function(t){i.addContent(s("<span></span>").html(t))},e.each(function(t,e){i.addContent(s(e))}),delete window.n2Write,i.show()}}),N2D("ModalUrlTabPro",function(i,t){function e(t,e){i(".n2_free_need_more").eq(0).clone().appendTo(t)}return e.prototype.show=function(t){},e}),N2D("ModalUrlTabUrl",function(e,i){function t(t,e){this.modalManager=e,this.cache={};var i=N2Classes.UI.modalFormRow(!0).appendTo(t);this.$url=N2Classes.UI.modalFieldText(i,"url",n2_("URL"),"");var s=N2Classes.UI.modalFormRow(!0).appendTo(t);this.$searchKeyword=N2Classes.UI.modalFieldText(s,"search-keyword",n2_("Search keyword"),"").on("keyup",this.search.bind(this)).focus();var n=N2Classes.UI.modalFormRow(!0).appendTo(t);this.$postSelector=N2Classes.UI.modalSelectList(n,"url-post",n2_("Posts"),function(t){this.$url.val(t.link)}.bind(this),{mode:"insert"})}return t.prototype.show=function(t){this.$url.val(t),this.$searchKeyword.val(""),this.search()},t.prototype.search=function(){this.searchString=this.$searchKeyword.val(),this.getAjaxSearchResult(this.searchString).done(function(t){if(this.$searchKeyword.val()===this.searchString){this.$postSelector.removeOptions();for(var e=t.data,i=0;i<e.length;i++)this.$postSelector.addOption(e[i].title,e[i].info,e[i])}}.bind(this))},t.prototype.getAjaxSearchResult=function(t){return this.cache[t]===i&&(this.cache[t]=e.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.modalManager.ajaxUrl),data:{keyword:t},dataType:"json"})),this.cache[t]},t.prototype.getResult=function(){return this.$url.val()},t}),N2D("ModalUrl",function(t,e){function s(t){this.ajaxUrl=t,this.activeTab="",this.modal=new N2Classes.ModalSimple("url-modal"),this.modal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--link","green").css("margin-bottom","20px")),this.uiTabs=N2Classes.UI.modalTabs(this.modal.getBody(),"url-tabs",{url:n2_("URL"),lightbox:n2_("Lightbox"),action:n2_("Action")},this.onTabActiveChange.bind(this)),this.tabs={},this.tabs.url=new N2Classes.ModalUrlTabUrl(this.uiTabs.tabs.url.$content,this),this.tabs.lightbox=new N2Classes.ModalUrlTabPro(this.uiTabs.tabs.lightbox.$content),this.tabs.action=new N2Classes.ModalUrlTabPro(this.uiTabs.tabs.action.$content);var e=N2Classes.UI.modalButton(n2_("Insert"),"green");this.modal.addButton(e),e.on("click",function(t){t.preventDefault(),this.setCallback(this.tabs[this.activeTab].getResult()),this.modal.hide()}.bind(this))}s.prototype.onTabActiveChange=function(t){this.activeTab=t,this.tabs[t].show(this.originalValue)};var n=!(s.prototype.show=function(t,e){this.originalValue=t,this.setCallback=e,t.match(/lightbox\[(.+)\]/)?this.uiTabs.setActiveTab("lightbox"):t.match(/ScrollTo|ScrollToAlias|SlideEvent|ToSlide|ToSlideID|\[(.+)\]/)||t.match(/PreviousSlide|NextSlide|\[\]/)?this.uiTabs.setActiveTab("action"):this.uiTabs.setActiveTab("url"),this.modal.show()});function i(){}return i.show=function(t,e,i){(n=n||new s(e)).show(t,i)},i}),N2D("UI",function(f,n){var h={modalButton:function(t,e,i){return f('<a class="n2_button n2_button--'+(i=i||"big")+" n2_button--"+e+'" href="#"><span class="n2_button__label">'+t+"</span></a>")},modalIcon:function(t,e){return f('<div class="n2_modal__icon n2_modal__icon--'+e+'"><i class="'+t+'"></i></div>')},modalHeading:function(t){return f('<div class="n2_modal__heading"></div>').text(t)},modalSubHeading:function(t){return f('<div class="n2_modal__subheading"></div>').text(t)},modalParagraph:function(t){return f('<div class="n2_modal__paragraph"></div>').text(t)},modalParagraphHTML:function(t){return f('<div class="n2_modal__paragraph"></div>').html(t)},modalInput:function(t,e,i,s){return f('<input class="n2_modal__input" type="'+e+'" id="'+t+'" name="'+t+'" value="'+i+'" '+(s!==n?'placeholder="'+s+'"':"")+"/>")},modalFormTable:function(t){var e=f('<div class="n2_form__table"></div>');return f('<div class="n2_form__table_label"></div>').append(f('<div class="n2_form__table_label_title"></div>').text(t)).appendTo(e),{$table:e,$content:f('<div class="n2_form__table_preview"></div>').appendTo(e)}},modalFormContainer:function(t,e){return f('<div class="n2_modal__form_container" data-field="'+e+'"></div>').appendTo(t)},modalHiddenContainer:function(t){return f('<div class="n2_modal__container_hidden"></div>').appendTo(t)},modalFormRow:function(t){return f('<div class="n2_modal__form_row"></div>').toggleClass("n2_modal__form_row--fullwidth",!0===t)},modalFormRowLarge:function(t){return f('<div class="n2_modal__form_row n2_modal__form_row--large"></div>').toggleClass("n2_modal__form_row--fullwidth",!0===t)},modalFieldWrapper:function(t,e,i){var s=f('<div class="n2_field" data-field="'+e+'"></div>').appendTo(t);return!1===i?s.addClass("n2_field--label-none"):""===i&&s.addClass("n2_field--label-placeholder"),i&&f('<div class="n2_field__label"><label for="modal-field-'+e+'">'+i+"</label></div>").appendTo(s),{$field:s,$element:f('<div class="n2_field__element"></div>').appendTo(s)}},modalFieldText:function(t,e,i,s){var n=h.modalFieldWrapper(t,e,i),o=f('<div class="n2_field_text"></div>').appendTo(n.$element),r=f('<input type="text" id="modal-field-'+e+'" name="'+e+'" autocomplete="off">').val(s).appendTo(o);return new N2Classes.FormElementText("modal-field-"+e),r},modalOnOff:function(t,e,i,s,n){var o=h.modalFieldWrapper(t,e,i),r=f('<div class="n2_field_onoff"><div class="n2_field_onoff__slider"><div class="n2_field_onoff__slider_bullet"></div></div><div class="n2_field_onoff__labels"><div class="n2_field_onoff__label n2_field_onoff__label_off">'+n2_("Off")+'</div><div class="n2_field_onoff__label n2_field_onoff__label_on">'+n2_("On")+"</div></div></div>").appendTo(o.$element),a=f('<input id="modal-field-'+e+'" name="'+e+'" value="'+s+'" type="hidden" autocomplete="off">').val(s).appendTo(r);return new N2Classes.FormElementOnoff("modal-field-"+e,n),a},modalSelect:function(t,e,i,s,n,o){o=f.extend({isMultiple:!1},o);var r=h.modalFieldWrapper(t,e,i),a=f('<input id="modal-field-'+e+'" name="'+e+'" value="'+n+'" type="hidden" autocomplete="off">').appendTo(r.$element),l=f('<select id="modal-field-'+e+'_select" name="select'+e+'" autocomplete="off"></select>');for(var d in o.isMultiple&&l.attr("multiple","multiple").attr("size","8"),s)l.append('<option value="'+d+'">'+s[d]+"</option>");return f('<div class="n2_field_select"></div>').append(l).appendTo(r.$element),new N2Classes.FormElementList("modal-field-"+e).insideChange(n),a},modalNumber:function(t,e,i,s,n){var o=100;switch((n=f.extend({unit:!1,min:-Number.MAX_VALUE,max:Number.MAX_VALUE,wide:4,sublabel:""},n)).wide){case 2:o=20;break;case 3:o=26;break;case 4:o=32;break;case 5:o=44;break;case 6:o=60}var r=h.modalFieldWrapper(t,e,i),a=f('<div class="n2_field_text n2_field_number"></div>').appendTo(r.$element);""!==n.sublabel&&f('<div class="n2_field_number__unit"></div>').text(n.sublabel).appendTo(a);var l=f('<input id="modal-field-'+e+'" name="'+e+'" value="'+s+'" type="text" autocomplete="off">').css("width",o).appendTo(a);return n.unit&&f('<div class="n2_field_number__unit"></div>').text(n.unit).appendTo(a),new N2Classes.FormElementNumber("modal-field-"+e,n.min,n.max),l},modalTextarea:function(t,e,i){var s=h.modalFieldWrapper(t,e,i),n=f('<div class="n2_field_textarea"></div>').appendTo(s.$element);return f('<textarea name="'+e+'" autocomplete="off"></textarea>').appendTo(n)},modalTable:function(t,e,i,s){var n=h.modalFieldWrapper(t,e,i);n.$field.addClass("n2_field_table");for(var o=f('<div class="n2_field_table__content"></div>').css("grid-template-columns","repeat("+s[0].length+", auto)").appendTo(n.$element),r=0;r<s.length;r++)for(var a=0;a<s[r].length;a++)f('<div class="n2_field_table__cell">'+s[r][a]+"</div>").appendTo(o);return o},modalSelectList:function(t,e,i,s,n){n=f.extend({mode:"select"},n);var o=h.modalFieldWrapper(t,e,i),r=f('<div class="n2_field_select_list"></div>').appendTo(o.$element);return{getField:function(){return o.$field},addOption:function(t,e,i){f('<div class="n2_field_select_list__option"></div>').on("click",function(t,e){"select"===n.mode&&(o.$field.find(".n2_field_select_list__option--selected").removeClass("n2_field_select_list__option--selected"),f(e.currentTarget).addClass("n2_field_select_list__option--selected")),s(t)}.bind(this,i)).append(f('<div class="n2_field_select_list__option_primary"></div>').text(t)).append(f('<div class="n2_field_select_list__option_secondary"></div>').text(e)).appendTo(r)},removeOptions:function(){r.html("")}}},modalGeneratorVariableList:function(t,e,i,s,n,o){t.addContent(this.modalHeading(n2_(i)));var r=N2Classes.UI.modalFormRow(!0);t.addContent(r);var a,l=N2Classes.UI.modalFieldWrapper(r,s,n),d=f('<div class="n2_generator_variables"></div>').appendTo(l.$element),h=[];if(Number.isInteger(e))for(var c=1;c<=e;c++)h[c]=c;else h=e;for(var p in h){var u=f('<div class="n2_generator_variables__variable"></div>');u.text(p).on("click",function(t){a.removeClass("n2_generator_variables__variable--selected"),this.addClass("n2_generator_variables__variable--selected"),o(t)}.bind(u,p)).appendTo(d)}(a=d.find(".n2_generator_variables__variable")).eq(0).addClass("n2_generator_variables__variable--selected")},modalTabs:function(t,e,i,s){var n=f('<div class="n2_modal_tab"></div>').appendTo(t),o=f('<div class="n2_modal_tab__tabs"></div>').appendTo(n),r=f('<div class="n2_modal_tab__tabs_contents"></div>').appendTo(n),a=!1,l={};function d(t){a&&a!==t&&(l[a].$button.removeClass("n2_modal_tab__tabs_button--active"),l[a].$content.removeClass("n2_modal_tab__tabs_content--active")),l[a=t].$button.addClass("n2_modal_tab__tabs_button--active"),l[a].$content.addClass("n2_modal_tab__tabs_content--active"),s(a)}for(var h in i)l[h]={$button:f('<div class="n2_modal_tab__tabs_button" data-tab="'+h+'">'+i[h]+"</div>").on("click",d.bind(this,h)).appendTo(o),$content:f('<div class="n2_modal_tab__tabs_content" data-tab="'+h+'"></div>').appendTo(r)};return{tabs:l,setActiveTab:d}},modalFieldSelectIcon:function(t,e,i,s,n,o){var r=h.modalFieldWrapper(t,e,i),a=f('<div class="n2_field_select_icon"></div>').appendTo(r.$element);for(var l in s)f('<div class="n2_field_select_icon__option"></div>').attr("data-value",l).toggleClass("n2_field_select_icon__option--selected",l===n).append('<div class="n2_field_select_icon__option_icon"><i class="'+s[l].icon+'"></i></div>').append('<div class="n2_field_select_icon__option_label">'+s[l].label+"</div>").append('<div class="n2_field_select_icon__selected_marker"><i class="ssi_16 ssi_16--check"></i></div>').appendTo(a);var d=f('<input id="modal-field-'+e+'" name="'+e+'" value="'+n+'" type="hidden" />').appendTo(r.$element);return new N2Classes.FormElementSelectIcon("modal-field-"+e,o),d},modalNotice:function(t,e,i){var s=h.modalFieldWrapper(t,"notice",n2_("Notice"));return f('<div class="n2_field_message n2_field_message--'+i+'"></div>').html(n2_(e)).appendTo(s.$element)}};return h}),N2D("AutocompleteSimple",function(s,t){return function(t,e){var i=s("#"+t);new N2Classes.UIAutocomplete(i,{positionTo:".n2_autocomplete_position_to",y:-2,appendTo:function(){return i.closest(".n2_container_scrollable, body")},source:function(){return e},select:function(t,e){s(this).val(e.value).trigger("change")}})}}),N2D("Spectrum",function(St,Nt){var t,kt=null,Pt={beforeShow:i,move:i,change:i,show:i,hide:i,color:!1,flat:!1,showInput:!1,showButtons:!0,clickoutFiresChange:!1,showInitial:!1,showPalette:!1,showPaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",preferredFormat:!1,className:"",showAlpha:!1,theme:"n2-sp-light",palette:["fff","000"],selectionPalette:[],disabled:!1},Tt=[],It=!!/msie/i.exec(window.navigator.userAgent),Dt=((t=document.createElement("div").style).cssText="background-color:rgba(0,0,0,.5)",e(t.backgroundColor,"rgba")||e(t.backgroundColor,"hsla")),$t=["<div class='n2-sp-replacer'>","<div class='n2-sp-preview'></div>","</div>"].join(""),Mt=function(){var t="";if(It)for(var e=1;e<=6;e++)t+="<div class='n2-sp-"+e+"'></div>";return["<div class='n2-sp-container'>","<div class='n2-sp-palette-container'>","<div class='n2-sp-palette n2-sp-thumb n2-sp-cf'></div>","</div>","<div class='n2-sp-picker-container'>","<div class='n2-sp-top n2-sp-cf'>","<div class='n2-sp-fill'></div>","<div class='n2-sp-top-inner'>","<div class='n2-sp-color'>","<div class='n2-sp-sat'>","<div class='n2-sp-val'>","<div class='n2-sp-dragger'></div>","</div>","</div>","</div>","<div class='n2-sp-hue'>","<div class='n2-sp-slider'></div>",t,"</div>","</div>","<div class='n2-sp-alpha'><div class='n2-sp-alpha-inner'><div class='n2-sp-alpha-handle'></div></div></div>","</div>","<div class='n2-sp-input-container n2-sp-cf'>","<input class='n2-sp-input' type='text' spellcheck='false'  />","</div>","<div class='n2-sp-initial n2-sp-thumb n2-sp-cf'></div>","<div class='n2-sp-button-container n2-sp-cf'>","<a class='n2-sp-cancel' href='#'></a>","<button class='n2-sp-choose'></button>","</div>","</div>","</div>"].join("")}();function e(t,e){return!!~(""+t).indexOf(e)}function Et(t,e,i){for(var s=[],n=0;n<t.length;n++){var o=kt(t[n]),r=o.toHsl().l<.5?"n2-sp-thumb-el n2-sp-thumb-dark":"n2-sp-thumb-el n2-sp-thumb-light";r+=kt.equals(e,t[n])?" n2-sp-thumb-active":"";var a="background-color:"+o.toRgbString();s.push('<span title="'+o.toRgbString()+'" data-color="'+o.toRgbString()+'" class="'+r+'"><span class="n2-sp-thumb-inner" style="'+a+';"></span></span>')}return"<div class='n2-sp-cf "+i+"'>"+s.join("")+"</div>"}function o(t,e){var i,s,n,o,r,a,l,d=(r=e,a=t,(l=St.extend({},Pt,r)).callbacks={move:Ft(l.move,a),change:Ft(l.change,a),show:Ft(l.show,a),hide:Ft(l.hide,a),beforeShow:Ft(l.beforeShow,a)},l),h=d.flat,c=d.showSelectionPalette,p=d.localStorageKey,u=d.theme,f=d.callbacks,g=(i=Ct,function(){var t=this,e=arguments;n&&clearTimeout(o),!n&&o||(o=setTimeout(function(){o=null,i.apply(t,e)},s))}),y=!(s=10),m=0,v=0,_=0,b=0,C=0,w=0,x=0,S=0,N=0,k=0,P=1,T=d.palette.slice(0),I=St.isArray(T[0])?T:[T],D=d.selectionPalette.slice(0),$="n2-sp-dragging",M=t.ownerDocument,E=M.body,A=St(t),F=!1,L=St(Mt,M).addClass(u),R=L.find(".n2-sp-color"),z=L.find(".n2-sp-dragger"),O=L.find(".n2-sp-hue"),H=L.find(".n2-sp-slider"),U=L.find(".n2-sp-alpha-inner"),j=L.find(".n2-sp-alpha"),B=L.find(".n2-sp-alpha-handle"),V=L.find(".n2-sp-input"),W=L.find(".n2-sp-palette"),q=L.find(".n2-sp-initial"),X=L.find(".n2-sp-cancel"),Y=L.find(".n2-sp-choose"),G=A.is("input"),K=G&&!h,J=null,Z=null,Q=null,tt=d.color||G&&A.val(),et=!1,it=d.preferredFormat,st=it,nt=!d.showButtons||d.clickoutFiresChange;function ot(t){L.toggleClass("n2-sp-flat",h),L.toggleClass("n2-sp-input-disabled",!d.showInput),L.toggleClass("n2-sp-alpha-enabled",d.showAlpha),L.toggleClass("n2-sp-buttons-disabled",!d.showButtons||h),L.toggleClass("n2-sp-palette-disabled",!d.showPalette),L.toggleClass("n2-sp-palette-only",d.showPaletteOnly),L.toggleClass("n2-sp-initial-disabled",!d.showInitial),L.addClass(d.className),t===Nt&&Ct()}function rt(t){if(c){var e=kt(t).toRgbString();if(-1===D.indexOf(e)&&D.push(e),p&&window.localStorage)try{window.localStorage[p]=D.join(";")}catch(t){}}}function at(){var i=yt(),t=St.map(I,function(t,e){return Et(t,i,"n2-sp-palette-row n2-sp-palette-row-"+e)});D&&t.push(Et(function(){var t,e=[],i=D,s={};if(d.showPalette){for(var n,o=0;o<I.length;o++)for(var r=0;r<I[o].length;r++)s[t=kt(I[o][r]).toRgbString()]=!0;for(o=0;o<i.length;o++){!d.showAlpha&&i[o].startsWith("rgba")&&((n=i[o].split(","))[0]=n[0].replace("rgba","rgb"),n.pop(),i[o]=n.join(",")+")"),t=kt(i[o]).toRgbString(),s.hasOwnProperty(t)||(e.push(i[o]),s[t]=!0)}}return d.showAlpha||(d.maxSelectionSize=5),e.reverse().slice(0,d.maxSelectionSize)}(),i,"n2-sp-palette-row n2-sp-palette-row-selection")),W.html(t.join(""))}function lt(){var t,e;d.showInitial&&(t=et,e=yt(),q.html(Et([t,e],e,"n2-sp-palette-row-initial")))}function dt(){0!==v&&0!==m&&0!==b||Ct(),L.addClass($)}function ht(){L.removeClass($)}function ct(){var t=kt(V.val());t.ok?gt(t):V.addClass("n2-sp-validation-error")}function pt(){(y?ft:ut)()}function ut(){y?Ct():!1!==f.beforeShow(yt())&&(function(){for(var t=0;t<Tt.length;t++)Tt[t]&&Tt[t].hide()}(),y=!0,St(M).bind("click.spectrum",ft),St(window).bind("resize.spectrum",g),J.addClass("n2-sp-active"),L.show(),d.showPalette&&at(),Ct(),vt(),et=yt(),lt(),f.show(et))}function ft(t){t&&"click"==t.type&&2==t.button||y&&!h&&(y=!1,St(M).unbind("click.spectrum",ft),St(window).unbind("resize.spectrum",g),J.removeClass("n2-sp-active"),L.hide(),kt.equals(yt(),et)||(nt&&"cancel"!==t?bt(!0):gt(et,!0)),f.hide(yt()))}function gt(t,e){var i,s;kt.equals(t,yt())||(s=(i=kt(t)).toHsv(),S=s.h,N=s.s,k=s.v,P=s.a,vt(),e||(st=it||i.format))}function yt(){return kt.fromRatio({h:S,s:N,v:k,a:Math.round(100*P)/100})}function mt(){vt(),f.move(yt())}function vt(){V.removeClass("n2-sp-validation-error"),_t();var t=kt({h:S,s:"1.0",v:"1.0"});R.css("background-color","#"+t.toHexString());var e=st;P<1&&("hex"!==e&&"name"!==e||(e="rgb"));var i,s,n=yt(),o=n.toHexString(),r=n.toRgbString();Dt||1===n.alpha?Q.css("background-color",r):(Q.css("background-color","transparent"),Q.css("filter",n.toFilter())),d.showAlpha&&((i=n.toRgb()).a=0,s="linear-gradient(to right, "+kt(i).toRgbString()+", "+o+")",U.css("background",s)),d.showInput&&(P<1&&("hex"!==e&&"name"!==e||(e="rgb")),V.val(n.toString(e))),d.showPalette&&at(),lt()}function _t(){var t=N*m,e=v-k*v,t=Math.max(-_,Math.min(m-_,t-_)),e=Math.max(-_,Math.min(v-_,e-_));z.css({top:e,left:t});var i=P*C;B.css({left:i-w/2});var s=S*b;H.css({top:s-x})}function bt(t){var e=yt();G&&A.val(e.toString(st)).change();rt(et=e),t&&f.change(e)}function Ct(){var t,e,i,s,n,o,r,a,l,d;m=R.width(),v=R.height(),_=z.height(),O.width(),b=O.height(),x=H.height(),C=j.width(),w=B.width(),h||L.offset((t=L,e=Z.parent(),i=t.outerWidth(),s=t.outerHeight(),n=e.outerHeight(),o=t[0].ownerDocument,r=o.documentElement,a=r.clientWidth+St(o).scrollLeft(),l=r.clientHeight+St(o).scrollTop(),(d=e.offset()).top+=n+3,d.left-=Math.min(d.left,d.left+i>a&&i<a?Math.abs(d.left+i-a):0),d.top-=Math.min(d.top,d.top+s>l&&s<l?Math.abs(+(s+n+6)):0),d)),_t()}function wt(){ft(),F=!0,A.attr("disabled",!0),Z.addClass("n2-sp-disabled")}!function(){It&&L.find("*:not(input)").attr("unselectable","on");var t=A.parent().find(".n2-sp-replacer");if(t.length?J=t:(J=K?St($t).addClass(u):St([]),K&&A.parent().after(J)),Z=K?J:A,Q=J.find(".n2-sp-preview"),ot(!0),h?A.parent().after(L).hide():St(E).append(L.hide()),p&&window.localStorage)try{D=window.localStorage[p].split(";")}catch(t){}function e(t){return t.data&&t.data.ignore?(gt(St(this).data("color")),mt()):(gt(St(this).data("color")),bt(!0),mt(),ft()),!1}Z.bind("click.spectrum touchstart.spectrum",function(t){F||pt(),t.stopPropagation(),St(t.target).is("input")||t.preventDefault()}),!A.is(":disabled")&&!0!==d.disabled||wt(),L.click(At),V.change(ct),V.bind("paste",function(){setTimeout(ct,1)}),V.keydown(function(t){13==t.keyCode&&ct()}),X.text(d.cancelText),X.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),ft("cancel")}),Y.text(d.chooseText),Y.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),V.hasClass("n2-sp-validation-error")||(bt(!0),ft())}),Lt(j,function(t,e,i){P=t/C,i.shiftKey&&(P=Math.round(10*P)/10),mt()}),Lt(O,function(t,e){S=parseFloat(e/b),mt()},dt,ht),Lt(R,function(t,e){N=parseFloat(t/m),k=parseFloat((v-e)/v),mt()},dt,ht),tt?(gt(tt),vt(),st=it||kt(tt).format,rt(tt)):vt(),h&&ut();var i=It?"mousedown.spectrum":"click.spectrum touchstart.spectrum";W.delegate(".n2-sp-thumb-el",i,e),q.delegate(".n2-sp-thumb-el:nth-child(1)",i,{ignore:!0},e)}();var xt={show:ut,hide:ft,toggle:pt,reflow:Ct,option:function(t,e){return t===Nt?St.extend({},d):e===Nt?d[t]:(d[t]=e,void ot())},enable:function(){F=!1,A.attr("disabled",!1),Z.removeClass("n2-sp-disabled")},disable:wt,set:function(t){gt(t),bt()},get:yt,destroy:function(){A.show(),Z.unbind("click.spectrum touchstart.spectrum"),L.remove(),J.remove(),Tt[xt.id]=null},container:L};return xt.id=Tt.push(xt)-1,xt}function i(){}function At(t){t.stopPropagation()}function Ft(t,e){var i=Array.prototype.slice,s=i.call(arguments,2);return function(){return t.apply(e,s.concat(i.call(arguments)))}}function Lt(r,a,i,t){a=a||function(){},i=i||function(){},t=t||function(){};var s=r.ownerDocument||document,l=!1,d={},h=0,c=0,p=!1,n={};function u(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function o(t){if(l){if(It&&document.documentMode<9&&!t.button)return f();var e=t.originalEvent.touches,i=e?e[0].pageX:t.pageX,s=e?e[0].pageY:t.pageY,n=Math.max(0,Math.min(i-d.left,c)),o=Math.max(0,Math.min(s-d.top,h));p&&u(t),a.apply(r,[n,o,t])}}function f(){l&&(St(s).unbind(n),St(s.body).removeClass("n2-sp-dragging"),t.apply(r,arguments)),l=!1}n.selectstart=u,n.dragstart=u,n[p?"touchmove":"mousemove"]=o,n[p?"touchend":"mouseup"]=f,St(r).bind(p?"touchstart":"mousedown",function(t){var e=t.which?3==t.which:2==t.button;t.originalEvent.touches,e||l||!1!==i.apply(r,arguments)&&(l=!0,h=St(r).height(),c=St(r).width(),d=St(r).offset(),St(s).bind(n),St(s.body).addClass("n2-sp-dragging"),p||o(t),u(t))})}var r="spectrum.id";return St.fn.n2spectrum=function(i,t){if("string"!=typeof i)return this.n2spectrum("destroy").each(function(){var t=o(this,i);St(this).data(r,t.id)});var s=this,n=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=Tt[St(this).data(r)];if(t){var e=t[i];if(!e)throw new Error("Spectrum: no such method: '"+i+"'");"get"==i?s=t.get():"container"==i?s=t.container:"option"==i?s=t.option.apply(t,n):"destroy"==i?(t.destroy(),St(this).removeData(r)):e.apply(t,n)}}),s},St.fn.n2spectrum.load=!0,St.fn.n2spectrum.loadOpts={},St.fn.n2spectrum.draggable=Lt,St.fn.n2spectrum.defaults=Pt,St.n2spectrum={},St.n2spectrum.localization={},St.n2spectrum.palettes={},function(){var o=/^[\s,#]+/,r=/\s+$/,n=0,p=Math,a=p.round,u=p.min,f=p.max,t=p.random;function g(t,e,i){t=b(t,255),e=b(e,255),i=b(i,255);var s,n=f(t,e,i),o=u(t,e,i),r=(n+o)/2;if(n==o)s=l=0;else{var a=n-o,l=.5<r?a/(2-n-o):a/(n+o);switch(n){case t:s=(e-i)/a+(e<i?6:0);break;case e:s=(i-t)/a+2;break;case i:s=(t-e)/a+4}s/=6}return{h:s,s:l,l:r}}function y(t,e,i){t=b(t,255),e=b(e,255),i=b(i,255);var s,n=f(t,e,i),o=u(t,e,i),r=n,a=n-o,l=0===n?0:a/n;if(n==o)s=0;else{switch(n){case t:s=(e-i)/a+(e<i?6:0);break;case e:s=(i-t)/a+2;break;case i:s=(t-e)/a+4}s/=6}return{h:s,s:l,v:r}}function m(t,e,i,s){var n=[w(a(t).toString(16)),w(a(e).toString(16)),w(a(i).toString(16))];return s||n[0].charAt(0)!=n[0].charAt(1)||n[1].charAt(0)!=n[1].charAt(1)||n[2].charAt(0)!=n[2].charAt(1)?n.join(""):n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0)}(kt=function(t,e){if("object"==typeof t&&t.hasOwnProperty("_tc_id"))return t;var i=function(t){var e={r:0,g:0,b:0},i=1,s=!1,n=!1;"string"==typeof t&&(t=function(t){t=t.replace(o,"").replace(r,"").toLowerCase();var e,i=!1;if(v[t])t=v[t],i=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0};if(e=x.rgb.exec(t))return{r:e[1],g:e[2],b:e[3]};if(e=x.rgba.exec(t))return{r:e[1],g:e[2],b:e[3],a:e[4]};if(e=x.hsl.exec(t))return{h:e[1],s:e[2],l:e[3]};if(e=x.hsla.exec(t))return{h:e[1],s:e[2],l:e[3],a:e[4]};if(e=x.hsv.exec(t))return{h:e[1],s:e[2],v:e[3]};if(e=x.hex6.exec(t))return{r:C(e[1]),g:C(e[2]),b:C(e[3]),format:i?"name":"hex"};if(e=x.hex8.exec(t))return{r:C(e[1]),g:C(e[2]),b:C(e[3]),a:C(e[4])/255,format:i?"name":"hex"};if(e=x.hex3.exec(t))return{r:C(e[1]+""+e[1]),g:C(e[2]+""+e[2]),b:C(e[3]+""+e[3]),format:i?"name":"hex"};return!1}(t));"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(e=function(t,e,i){return{r:255*b(t,255),g:255*b(e,255),b:255*b(i,255)}}(t.r,t.g,t.b),s=!0,n="rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(e=function(t,e,i){t=6*b(t,360),e=b(e,100),i=b(i,100);var s=p.floor(t),n=t-s,o=i*(1-e),r=i*(1-n*e),a=i*(1-(1-n)*e),l=s%6;return{r:255*[i,r,o,o,a,i][l],g:255*[a,i,i,r,o,o][l],b:255*[o,o,a,i,i,r][l]}}(t.h,t.s,t.v),s=!0,n="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(e=function(t,e,i){var s,n,o;function r(t,e,i){return i<0&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}{var a,l;t=b(t,360),e=b(e,100),i=b(i,100),0===e?s=n=o=i:(s=r(l=2*i-(a=i<.5?i*(1+e):i+e-i*e),a,t+1/3),n=r(l,a,t),o=r(l,a,t-1/3))}return{r:255*s,g:255*n,b:255*o}}(t.h,t.s,t.l),s=!0,n="hsl"),t.hasOwnProperty("a")&&(i=t.a));e.r=u(255,f(e.r,0)),e.g=u(255,f(e.g,0)),e.b=u(255,f(e.b,0)),e.r<1&&(e.r=a(e.r));e.g<1&&(e.g=a(e.g));e.b<1&&(e.b=a(e.b));return{ok:s,format:t&&t.format||n,r:e.r,g:e.g,b:e.b,a:i}}(t),l=i.r,d=i.g,h=i.b,c=parseFloat(i.a),s=i.format;return{ok:i.ok,format:s,_tc_id:n++,alpha:c,toHsv:function(){var t=y(l,d,h);return{h:t.h,s:t.s,v:t.v,a:c}},toHsvString:function(){var t=y(l,d,h),e=a(360*t.h),i=a(100*t.s),s=a(100*t.v);return 1==c?"hsv("+e+", "+i+"%, "+s+"%)":"hsva("+e+", "+i+"%, "+s+"%, "+c+")"},toHsl:function(){var t=g(l,d,h);return{h:t.h,s:t.s,l:t.l,a:c}},toHslString:function(){var t=g(l,d,h),e=a(360*t.h),i=a(100*t.s),s=a(100*t.l);return 1==c?"hsl("+e+", "+i+"%, "+s+"%)":"hsla("+e+", "+i+"%, "+s+"%, "+c+")"},toHex:function(){return m(l,d,h)},toHexString:function(t){return m(l,d,h,t)},toHexString8:function(){return m(l,d,h,!0)+w(a(255*c).toString(16))},toRgb:function(){return{r:a(l),g:a(d),b:a(h),a:c}},toRgbString:function(){return 1==c?"rgb("+a(l)+", "+a(d)+", "+a(h)+")":"rgba("+a(l)+", "+a(d)+", "+a(h)+", "+c+")"},toName:function(){return _[m(l,d,h)]||!1},toFilter:function(t,e){var i,s=m(l,d,h,!0),n=s,o=Math.round(255*parseFloat(c)).toString(16),r=o,a=t&&t.gradientType?"GradientType = 1, ":"";return e&&(n=(i=kt(e)).toHex(),r=Math.round(255*parseFloat(i.alpha)).toString(16)),"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr=#"+w(o)+s+",endColorstr=#"+w(r)+n+")"},toString:function(t){var e=!1;return"rgb"===(t=t||this.format)&&(e=this.toRgbString()),"hex"===t&&(e=this.toHexString()),"hex6"===t&&(e=this.toHexString(!0)),"hex8"===t&&(e=this.toHexString8()),"name"===t&&(e=this.toName()),"hsl"===t&&(e=this.toHslString()),"hsv"===t&&(e=this.toHsvString()),e||this.toHexString(!0)}}}).fromRatio=function(t){if("object"==typeof t)for(var e in t)1===t[e]&&(t[e]="1.0");return kt(t)},kt.equals=function(t,e){return!(!t||!e)&&kt(t).toRgbString()==kt(e).toRgbString()},kt.random=function(){return kt.fromRatio({r:t(),g:t(),b:t()})},kt.desaturate=function(t,e){var i=kt(t).toHsl();return i.s-=(e||10)/100,i.s=s(i.s),kt(i)},kt.saturate=function(t,e){var i=kt(t).toHsl();return i.s+=(e||10)/100,i.s=s(i.s),kt(i)},kt.greyscale=function(t){return kt.desaturate(t,100)},kt.lighten=function(t,e){var i=kt(t).toHsl();return i.l+=(e||10)/100,i.l=s(i.l),kt(i)},kt.darken=function(t,e){var i=kt(t).toHsl();return i.l-=(e||10)/100,i.l=s(i.l),kt(i)},kt.complement=function(t){var e=kt(t).toHsl();return e.h=(e.h+.5)%1,kt(e)},kt.triad=function(t){var e=kt(t).toHsl(),i=360*e.h;return[kt(t),kt({h:(120+i)%360,s:e.s,l:e.l}),kt({h:(240+i)%360,s:e.s,l:e.l})]},kt.tetrad=function(t){var e=kt(t).toHsl(),i=360*e.h;return[kt(t),kt({h:(90+i)%360,s:e.s,l:e.l}),kt({h:(180+i)%360,s:e.s,l:e.l}),kt({h:(270+i)%360,s:e.s,l:e.l})]},kt.splitcomplement=function(t){var e=kt(t).toHsl(),i=360*e.h;return[kt(t),kt({h:(72+i)%360,s:e.s,l:e.l}),kt({h:(216+i)%360,s:e.s,l:e.l})]},kt.analogous=function(t,e,i){e=e||6,i=i||30;var s=kt(t).toHsl(),n=360/i,o=[kt(t)];for(s.h*=360,s.h=(s.h-(n*e>>1)+720)%360;--e;)s.h=(s.h+n)%360,o.push(kt(s));return o},kt.monochromatic=function(t,e){e=e||6;for(var i=kt(t).toHsv(),s=i.h,n=i.s,o=i.v,r=[],a=1/e;e--;)r.push(kt({h:s,s:n,v:o})),o=(o+a)%1;return r},kt.readable=function(t,e){var i=kt(t).toRgb(),s=kt(e).toRgb();return 10404<(s.r-i.r)*(s.r-i.r)+(s.g-i.g)*(s.g-i.g)+(s.b-i.b)*(s.b-i.b)};var v=kt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},_=kt.hexNames=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[t[i]]=i);return e}(v);function b(t,e){var i;"string"==typeof(i=t)&&-1!=i.indexOf(".")&&1===parseFloat(i)&&(t="100%");var s,n="string"==typeof(s=t)&&-1!=s.indexOf("%");return t=u(e,f(0,parseFloat(t))),n&&(t*=e/100),p.abs(t-e)<1e-6?1:1<=t?t%e/parseFloat(e):t}function s(t){return u(1,f(0,t))}function C(t){return parseInt(t,16)}function w(t){return 1==t.length?"0"+t:""+t}var e,i,l,x=(i="[\\s|\\(]+("+(e="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",l="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",{rgb:new RegExp("rgb"+i),rgba:new RegExp("rgba"+l),hsl:new RegExp("hsl"+i),hsla:new RegExp("hsla"+l),hsv:new RegExp("hsv"+i),hex3:/^([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/})}(),St.fn.n2spectrum}),N2D("Notification",function(r,t){function e(){this.deferred=r.Deferred(),N2R("documentReady",this.ready.bind(this))}return e.prototype.ready=function(){this.$container=r('<div class="n2_notification_center n2_admin_ui"></div>').appendTo("body"),this.deferred.resolve()},e.prototype.error=function(t,e){e=r.extend({wide:!1,heading:n2_("Oops, Something Went Wrong")},e);var i=new N2Classes.ModalSimple("notification error",{width:e.wide?1e3:440});i.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--error","red")),i.addContent(N2Classes.UI.modalHeading(e.heading)),i.addContent(N2Classes.UI.modalParagraphHTML(t));var s=N2Classes.UI.modalButton(n2_("Got it"),"red");i.addButton(s),s.on("click",function(t){t.preventDefault(),i.hide(t)}),i.show()},e.prototype.success=function(t){this.message("success",n2_("Success"),t,{timeout:3})},e.prototype.notice=function(t){this.message("notice",n2_("Notice"),t)},e.prototype.message=function(t,e,i,s){s=r.extend({timeout:0},s);var n=r('<div class="n2_notification_center__message n2_notification_center__message--'+t+'"></div>').scrollTop(0).prependTo(this.$container);r('<div class="n2_notification_center__message_icon"><i class="ssi_24"></i></div>').appendTo(n);var o=r('<div class="n2_notification_center__message_content"></div>').appendTo(n);r('<div class="n2_notification_center__message_content_label">'+e+"</div>").appendTo(o),r('<div class="n2_notification_center__message_content_description">'+i+"</div>").appendTo(o),s.timeout?(n.one("mouseenter",function(){n.remove()}),setTimeout(function(){n.remove()},1e3*s.timeout)):r('<div class="n2_notification_center__message_action"></div>').text(n2_("Got it")).on("click",function(){n.remove()}).appendTo(n),setTimeout(function(t){t.addClass("n2_notification_center__message--animate")}.bind(this,n),100)},new e}),N2D("Form",function(e,t){function i(){this.skipChangeConfirm=!1,this.onChangeCallback=this.onChange.bind(this),document.formvalidator!==t&&(document.formvalidator.isValid=function(){return!0})}return i.prototype.setID=function(t){this.$form=e(t).data("form",this)},i.prototype.onReady=function(){this.window=e("#n2-admin")[0],this.initButtons(),this.resetChangeTracker(),this.registerBeforeUnload(),document.addEventListener("keydown",this.onKeyDown.bind(this),{capture:!0})},i.prototype.initButtons=function(){},i.prototype.resetChangeTracker=function(){this.hasChange=!1,this.window.addEventListener("nextendChange",this.onChangeCallback,{passive:!0,capture:!0}),this.window.addEventListener("change",this.onChangeCallback,{passive:!0,capture:!0}),this.$saveButton.addClass("n2_button--inactive")},i.prototype.onChange=function(){this.hasChange=!0,this.$saveButton.removeClass("n2_button--inactive"),this.window.removeEventListener("nextendChange",this.onChangeCallback,{passive:!0,capture:!0}),this.window.removeEventListener("change",this.onChangeCallback,{passive:!0,capture:!0})},i.prototype.onKeyDown=function(t){var e;t.defaultPrevented||(e=!1,t.ctrlKey||t.metaKey?83===t.keyCode&&(this.actionSave(),e=!0):27===t.keyCode&&("INPUT"!==t.target.tagName&&"textarea"!==t.target.tagName||(t.target.blur(),e=!0)),e&&t.preventDefault())},i.prototype.isChanged=function(){return this.hasChange},i.prototype.registerBeforeUnload=function(){window.addEventListener("beforeunload",this.actionUnload.bind(this))},i.prototype.actionUnload=function(t){if(!this.skipChangeConfirm&&this.isChanged()){var e=n2_("The changes you made will be lost if you navigate away from this page.");return t.returnValue=e}},i.prototype.actionSave=function(){},i.prototype.afterSave=function(){this.resetChangeTracker()},i}),N2D("FormElement",function(t,e){function i(){this.connectedField=null,this.element.data("field",this)}return i.prototype.triggerOutsideChange=function(){this.element[0].dispatchEvent(new CustomEvent("outsideChange",{cancelable:!1,bubbles:!0,detail:{field:this}})),this.element[0].dispatchEvent(new CustomEvent("nextendChange",{cancelable:!1,bubbles:!0,detail:{field:this}}))},i.prototype.triggerInsideChange=function(){this.element[0].dispatchEvent(new CustomEvent("insideChange",{cancelable:!1,bubbles:!0,detail:{field:this}})),this.element[0].dispatchEvent(new CustomEvent("nextendChange",{cancelable:!1,bubbles:!0,detail:{field:this}}))},i.prototype.focus=function(t){this.connectedField&&this.connectedField.focus(t)},i}),N2D("FormElementAutocomplete","FormElementText",function(s,t){function e(t,e){this.tags=e,N2Classes.FormElementText.prototype.constructor.call(this,t),this.parent.find(".n2_field_text__clear").on("click",this.clear.bind(this)),new N2Classes.UIAutocomplete(this.element,{positionTo:".n2_field_autocomplete",y:-2,appendTo:function(){return this.element.closest(".n2_container_scrollable, body")}.bind(this),source:function(){return this.tags}.bind(this),select:function(t,e){var i=this.value.split(/,/);i.pop(),i.push(e.value),i.push(""),this.value=i.join(","),s(this).trigger("change")}})}return((e.prototype=Object.create(N2Classes.FormElementText.prototype)).constructor=e).prototype.clear=function(t){t.preventDefault(),this.element.val(""),this.change()},e}),N2D("BasicCSSFont",["BasicCSSSkeleton"],function(t,e){function i(){this._singular="font",this._prular="fonts",N2Classes.BasicCSSSkeleton.prototype.constructor.apply(this,arguments),this.form={afont:t("#layer-font-family"),color:t("#layer-font-color"),size:t("#layer-font-size"),weight:t("#layer-font-weight"),lineheight:t("#layer-font-lineheight"),align:t("#layer-font-textalign"),underline:t("#layer-font-decoration"),italic:t("#layer-font-decoration"),letterspacing:t("#layer-font-letterspacing"),wordspacing:t("#layer-font-wordspacing"),texttransform:t("#layer-font-texttransform"),tshadow:t("#layer-font-tshadow"),extra:t("#layer-font-extracss")},this.loaded()}return((i.prototype=Object.create(N2Classes.BasicCSSSkeleton.prototype)).constructor=i).prototype.activateVisual=function(t){this.activeVisual=t,this.setValue(N2Classes.CSSRendererFont.transformData(this.visuals[t].value,this.visuals[t].mode)),this.setStates(N2Classes.CSSRendererFont.rendererModes[this.visuals[t].mode].tabs),N2Classes.BasicCSSSkeleton.prototype.activateVisual.call(this,t)},i.prototype.setValue=function(t){this.value=N2Classes.CSSRendererFont.fixBold(t)},i.prototype._transformsize=function(t){return t.split("||").join("|*|")},i.prototype._setsize=function(t,e){t.size=e.replace("|*|","||")},i.prototype._transformweight=function(t){return parseInt(t)},i.prototype._setweight=function(t,e){t.weight=parseInt(e)},i.prototype._transformunderline=function(t){return[1==this.value[this.activeState].italic?"italic":"",1==t?"underline":""].join("||")},i.prototype._setunderline=function(t,e){var i=e.split("||");t.underline="underline"===i[1]?1:0},i.prototype._transformitalic=function(t){return[1==t?"italic":"",1==this.value[this.activeState].underline?"underline":""].join("||")},i.prototype._setitalic=function(t,e){var i=e.split("||");t.italic="italic"===i[0]?1:0},i}),N2D("BasicCSSSkeleton",function(o,n){function t(t){this.hasVisuals=!1,this.isInsideChange=!1,this.isReload=!1,this.manager=t,this.$container=t.$container.find('.n2_fields_layer_window[data-field="fieldset-layer-window-basiccss-'+this._singular+'"]'),this.$relatedContainers=t.$container.find('.n2_fields_layer_window[data-parent-design="fieldset-layer-window-basiccss-'+this._singular+'"]'),this.$containers=this.$container.add(this.$relatedContainers).attr("data-state","0"),this.elementField=o("#layerbasiccss-"+this._singular+"-element").data("field"),this.elementField.element.on("nextendChange",function(){this.activateVisual(this.elementField.element.val()),this.activateState(0)}.bind(this)),this.stateField=o("#layerbasiccss-"+this._singular+"-state").data("field"),this.stateField.element.on("nextendChange",function(){this.activateState(this.stateField.element.val())}.bind(this)),this.relatedElementFields=[],this.relatedStateFields=[],this.$relatedContainers.each(function(t,e){var i=o(e),s=i.find("#layerbasiccss-"+i.data("singular")+"-element").data("field"),n=i.find("#layerbasiccss-"+i.data("singular")+"-state").data("field");s.element.on("outsideChange",function(t){this.elementField.insideChange(t.val())}.bind(this,s.element)),n.element.on("outsideChange",function(t){this.stateField.insideChange(t.val())}.bind(this,n.element)),this.relatedElementFields.push(s),this.relatedStateFields.push(n)}.bind(this)),this.$containers.find('.n2_form__table_label_field[data-design-feature="reset-to-normal"] a').on("click",function(t){t.preventDefault(),this.value[this.activeState]={},this._lazySave(t),this.activateState(this.activeState)}.bind(this)),this.activeVisual=0,this.activeState=0}return t.prototype.loaded=function(){for(var t in this.form)this.form[t].on({nextendChange:this.changeValue.bind(this,t)})},t.prototype.changeValue=function(t,e){this.isReload||("function"==typeof this["_set"+t]?this["_set"+t](this.value[this.activeState],this.form[t].val()):this.value[this.activeState][t]=this.form[t].val(),this._lazySave(e))},t.prototype._lazySave=NextendDeBounce(function(t){this.isInsideChange=!0;var e=this.getData();this.visuals[this.activeVisual].field.save(t,e),this.visuals[this.activeVisual].value=e,this.isInsideChange=!1},50),t.prototype.save=function(t){for(var e in this.isInsideChange=!0,t)this.visualsByName[e].field.save({},t[e]),this.visualsByName[e].value=t[e];this.isInsideChange=!1},t.prototype.getData=function(){return JSON.stringify({data:this.value})},t.prototype.load=function(t,e){if(this.hasVisuals=0<e.length,this.$containers.attr("data-elements",e.length),this.hasVisuals){var i={};this.visuals=[],this.visualsByName={};for(var s=0;s<e.length;s++){var n=e[s];this.visualsByName[n.name]={value:t[n.name],mode:n.mode,field:n.field},n.field.element.off(".basiccss").on("outsideChange.basiccss",this.loadSingleValue.bind(this,s,n.name)),this.visuals.push(this.visualsByName[n.name]),i[s]=n.field.getLabel()}this.elementField.setOptions(i);for(s=0;s<this.relatedElementFields.length;s++)this.relatedElementFields[s].setOptions(i);this.activateVisual(0),this.activateState(0)}},t.prototype.loadSingleValue=function(t){this.isInsideChange||(this.visuals[t].value=this.visuals[t].field.element.val(),this.activeVisual==t&&(this.activateVisual(t),this.activateState(this.activeState)))},t.prototype.activateVisual=function(t){for(var e=0;e<this.relatedElementFields.length;e++)parseInt(this.relatedElementFields[e].element.val())!==t&&this.relatedElementFields[e].insideChange(t)},t.prototype.setValue=function(t){this.value=t},t.prototype.setStates=function(t){for(var e={},i=0;i<t.length;i++)e[i]=t[i];this.stateField.setOptions(e);for(i=0;i<this.relatedStateFields.length;i++)this.relatedStateFields[i].setOptions(e)},t.prototype.activateState=function(t){var e;for(var i in t=Math.max(0,parseInt(t)),this.isReload=!0,this.activeState=t,this.$containers.attr("data-state",t),e=0===t?this.value[0]:o.extend({},this.value[0],this.value[t]))this.form[i]!==n&&("function"==typeof this["_transform"+i]?this.form[i].data("field").insideChange(this["_transform"+i](e[i])):this.form[i].data("field").insideChange(e[i]));for(var s=0;s<this.relatedStateFields.length;s++)parseInt(this.relatedStateFields[s].element.val())!==t&&this.relatedStateFields[s].insideChange(t);this.isReload=!1},t.prototype.serialize=function(){if(this.hasVisuals){var t={};for(var e in this.visualsByName)t[e]=this.visualsByName[e].value;return t}return{}},t.prototype.unSerialize=function(t){for(var e in t)t.hasOwnProperty(e)&&(this.visualsByName[e].field.save({},t[e]),this.visualsByName[e].value=t[e])},t}),N2D("BasicCSSStyle",["BasicCSSSkeleton"],function(t,e){function i(){this._singular="style",this._prular="styles",N2Classes.BasicCSSSkeleton.prototype.constructor.apply(this,arguments),this.form={backgroundcolor:t("#layer-style-backgroundcolor"),opacity:t("#layer-style-opacity"),padding:t("#layer-style-padding"),border:t("#layer-style-border"),borderradius:t("#layer-style-borderradius"),boxshadow:t("#layer-style-boxshadow"),extra:t("#layer-style-extracss")},this.loaded()}return((i.prototype=Object.create(N2Classes.BasicCSSSkeleton.prototype)).constructor=i).prototype.activateVisual=function(t){this.activeVisual=t,this.setValue(N2Classes.CSSRendererStyle.transformData(this.visuals[t].value,this.visuals[t].mode)),this.setStates(N2Classes.CSSRendererStyle.rendererModes[this.visuals[t].mode].tabs),N2Classes.BasicCSSSkeleton.prototype.activateVisual.call(this,t)},i}),N2D("BasicCSS",function(o,r){function t(t,e){this.inPresetList=!1,this.$container=o("#"+t),this.options=o.extend({ajaxUrl:""},e),this.throttleSetTimeout=null,this.throttleExitTimeout=null,this.storage={},this.assets={font:new N2Classes.BasicCSSFont(this),style:new N2Classes.BasicCSSStyle(this)},this.$preset=o('<div class="n2_layer_window_design_preset"><div class="n2_layer_window_design_preset__label_container"><div class="n2_layer_window_design_preset__label">'+n2_("Preset")+'</div><i class="ssi_16 ssi_16--info" data-tip-description="'+n2_("You can use presets to save style settings for later use. Clicking on any preset will load its styling to your current layer, and the previous style settings will be lost.")+'" data-tip-label="'+n2_("Preset")+'"></i></div></div>').prependTo(this.$container),this.$notice=o('<div class="n2_layer_window_notice n2_layer_window_notice__device_icon"><div class="n2_field" data-field="layerslide-background-notice-image"><div class="n2_field__label"><label for="layerslide-background-notice-image">Note</label></div><div class="n2_field__element"><div class="n2_field_message n2_field_message--warning">'+n2_("Layer design options affect every device. If you need to make responsive adjustments, look for the options with the device icon.")+"</div></div></div></div>").prependTo(this.$container);var i=o('<div class="n2_layer_window_design_preset__fields"></div>').appendTo(this.$preset),s=o('<div class="n2_layer_window_design_preset__fields_secondary"></div>').appendTo(i);o('<a class="n2_layer_window_design_preset__button_secondary" href="#" data-n2tip="'+n2_("Reset style to default")+'"><i class="ssi_16 ssi_16--reset"></i></a>').on("click",function(t){t.preventDefault(),this.exitPresetList(this.defs,t)}.bind(this)).appendTo(s),o('<a class="n2_layer_window_design_preset__button_secondary" href="#" data-n2tip="'+n2_("Save style as new preset")+'"><i class="ssi_16 ssi_16--save"></i></a>').on("click",function(t){t.preventDefault(),this.saveAsNew()}.bind(this)).appendTo(s),this.$presets=o('<div class="n2_layer_window_design_preset__presets"></div>').insertAfter(this.$preset),o('<a class="n2_layer_window_design_preset__button_choose" data-n2tip="'+n2_("Load style")+'" href="#"><i class="ssi_16 ssi_16--plus"></i></a>').on("click",function(t){t.preventDefault(),this.showList()}.bind(this)).appendTo(i),o('<a class="n2_layer_window_design_preset__button_back" href="#"><i class="ssi_16 ssi_16--remove"></i></a>').on("click",function(t){t.preventDefault(),this.exitPresetList(!1,t)}.bind(this)).appendTo(i),nextend.basicCSS=this}return t.prototype.showList=function(){this.inPresetList=!0,this.lastState=this.serialize(),this.$presets.on("mouseleave",function(){this.throttledUnSerialize(this.lastState)}.bind(this)),o.when(this.loadType()).done(function(t){0===this.storage[this.type].data("presets")?(N2Classes.Notification.notice(n2_("You have not created any presets for this layer yet.")),this.deActivate()):(this.$presets.append(this.storage[this.type]),o(".n2_ss_layer_window").addClass("n2_ss_layer_window--show-presets"),o(".n2_ss_layer_window__tab_container").scrollTop(0))}.bind(this))},t.prototype.activate=function(t,e,i){this.inPresetList&&this.exitPresetList(!1),this.type&&this.type!==t&&this.storage[this.type]!==r&&this.storage[this.type].detach();var s=!1;for(var n in this.defs={font:[],style:[]},this.type=t,this.assets){for(var o=0;o<i[n].length;o++)this.defs[n][i[n][o].name]=i[n][o].def;this.assets[n].load(e,i[n]),s=s||this.assets[n].hasVisuals}this.$container.toggleClass("n2_ss_design_layer_window_design--visible",s)},t.prototype.deActivate=function(){this.inPresetList&&this.exitPresetList(!1)},t.prototype.serialize=function(){var t={};for(var e in this.assets)t[e]=this.assets[e].serialize();return t},t.prototype.unSerialize=function(t){this.assets.font.unSerialize(t.font),this.assets.style.unSerialize(t.style)},t.prototype.throttledUnSerialize=function(t){this._addThrottledRenderTimeout(this.unSerialize.bind(this,t))},t.prototype.saveAsNew=function(t){var i=new N2Classes.ModalSimple("section-save-as",{destroyOnHide:!1,width:440});i.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--plus","green")),i.addContent(N2Classes.UI.modalHeading(n2_("Save as")));var e=N2Classes.UI.modalFormRow(!0);i.addContent(e);var s=N2Classes.UI.modalFieldText(e,"name",n2_("Name"),""),n=N2Classes.UI.modalButton(n2_("Save as"),"green");i.addButton(n),n.on("click",function(e){e.preventDefault();var t=s.val();""===t?N2Classes.Notification.error(n2_("Please fill the name field!")):N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendaction:"addVisual"}),data:{type:this.type,value:N2Classes.Base64.encode(JSON.stringify({name:t,data:this.serialize()}))},dataType:"json"}).done(function(t){o.when(this.loadType()).done(function(){this.addVisual(t.data.visual).prependTo(this.storage[this.type])}.bind(this)),i.hide(e),N2Classes.Notification.success(n2_("Preset saved."))}.bind(this))}.bind(this)),i.show()},t.prototype.loadType=function(){var i,e;return this.storage[this.type]===r&&(i=o.Deferred(),e=function(t){this.storage[this.type]=o('<div class="n2_layer_window_design_preset__presets_list"></div>').data("presets",0);for(var e=0;e<t.length;e++)this.addVisual(t[e]);i.resolve()}.bind(this),window[this.type]===r?(this.storage[this.type]=i,N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendaction:"loadVisuals"}),data:{type:this.type},dataType:"json"}).done(function(t){e(t.data.visuals)}.bind(this))):e(window[this.type])),this.storage[this.type]},t.prototype.addVisual=function(t){var e=t.value;"{"!==e[0]&&(e=N2Classes.Base64.decode(e));var i,s=JSON.parse(e),n=o('<div class="n2_layer_window_design_preset__preset_list_preset"><span>'+s.name+"</span></div>").on({mouseenter:function(t,e){this.throttledUnSerialize(t.data)}.bind(this,s),click:function(t,e){e.preventDefault(),this.exitPresetList(t,e)}.bind(this,s.data)}).appendTo(this.storage[this.type]);return this.storage[this.type].data("presets",this.storage[this.type].data("presets")+1),1e4<t.id&&(i=o('<div class="n2_layer_window_design_preset__preset_list_preset_buttons"></div>').appendTo(n),o('<div class="n2_layer_window_design_preset__preset_list_preset_button" data-n2tip="'+n2_("Overwrite preset")+'"><i class="ssi_16 ssi_16--save"></i></div>').on("click",function(t,e,i){i.stopPropagation(),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendaction:"changeVisual"}),data:{visualId:t,value:N2Classes.Base64.encode(JSON.stringify({name:e,data:this.lastState})),type:this.type},dataType:"json"}).done(function(t){n.replaceWith(this.addVisual(t.data.visual)),this.storage[this.type].data("presets",this.storage[this.type].data("presets")-1),N2Classes.Notification.success(n2_("Preset saved."))}.bind(this))}.bind(this,t.id,s.name)).appendTo(i),o('<div class="n2_layer_window_design_preset__preset_list_preset_button"><i class="ssi_16 ssi_16--delete"></i></div>').on("click",function(t,e){e.preventDefault(),e.stopPropagation(),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendaction:"deleteVisual"}),data:{visualId:t,type:this.type},dataType:"json"}).done(function(t){n.remove(),this.storage[this.type].data("presets",this.storage[this.type].data("presets")-1),N2Classes.Notification.success(n2_("Preset deleted."))}.bind(this))}.bind(this,t.id)).appendTo(i),nextend.tooltip.add(i)),n},t.prototype.exitPresetList=function(t,e){this.throttleSetTimeout&&clearTimeout(this.throttleSetTimeout),this.$presets.off("mouseleave"),t?(this.inPresetList=!1,this.unSerialize(t)):this.unSerialize(this.lastState),o(".n2_ss_layer_window").removeClass("n2_ss_layer_window--show-presets"),o(".n2_ss_layer_window__tab_container").scrollTop(0),this.inPresetList=!1},t.prototype._addThrottledRenderTimeout=function(t){this.throttleSetTimeout&&clearTimeout(this.throttleSetTimeout),this.throttleSetTimeout=setTimeout(t,100)},t.prototype._addThrottledExitTimeout=function(t){this.throttleExitTimeout&&clearTimeout(this.throttleExitTimeout),this.throttleExitTimeout=setTimeout(t,100)},t}),N2D("FormElementBreakpoint",function(r,a){function t(t,e){this.$container=r("#"+t).find(".n2_field_breakpoint__breakpoint_container"),this.options=r.extend({orientation:"",devices:[],fields:{},enables:!1,global:!1},e),this.hasEnables=!!this.options.enables,this.useGlobal=!1,this.$container.toggleClass("n2_field_breakpoint--with-enables",this.hasEnables),this.$orientationField=r("#"+this.options.orientation).on("nextendChange",this.onOrientationChanged.bind(this)),this.breakpoints={},r('<div class="n2_field_breakpoint__breakpoint_start"><div class="n2_field_breakpoint__breakpoint_label_container"><div class="n2_field_breakpoint__breakpoint_label">0</div></div></div>').prependTo(this.$container),this.$devices=this.$container.find(".n2_field_breakpoint__device"),this.options.global&&(this.$useGlobalField=r("#"+this.options.global.field).on("nextendChange",this.syncUseGlobal.bind(this)),this.useGlobal="1"===this.$useGlobalField.val(),this.syncUseGlobal());for(var i=!1,s=!1,n=0;n<this.$devices.length;n++){var o=this.createBreakpoint(this.$devices.eq(n),i);o!==a?(s?o.$breakpoint.insertBefore(o.$device):o.$breakpoint.insertAfter(o.$device),i=o):s=!0}this.options.global&&this.syncUseGlobal(),r('<div class="n2_field_breakpoint__breakpoint_end"><div class="n2_field_breakpoint__breakpoint_label_container"><div class="n2_field_breakpoint__breakpoint_label">&infin;</div></div></div>').appendTo(this.$container)}function s(t,e,i,s){this.parentField=t,(this.prev=s)&&s.setNext(this),this.next=!1,this.disableEdit=!1,this.orientation="portrait",this.device=e,this.$device=i,this.$breakpoint=r('<div class="n2_field_breakpoint__breakpoint" data-id="'+e+'"><div class="n2_field_breakpoint__breakpoint_divider"></div></div>'),this.$fieldPortrait=r("#"+t.options.fields[e+"-portrait"]),this.$fieldLandscape=r("#"+t.options.fields[e+"-landscape"]),this.$labelContainer=r('<div class="n2_field_breakpoint__breakpoint_label_container"></div>').appendTo(this.$breakpoint),r('<div class="n2_field_breakpoint__breakpoint_label_rename"><i class="ssi_16 ssi_16--rename"></i></div>').on("click",this.edit.bind(this)).appendTo(this.$labelContainer),this.$labelPortrait=r('<div class="n2_field_breakpoint__breakpoint_label" data-orientation="portrait"></div>').text(this.$fieldPortrait.val()).appendTo(this.$labelContainer),this.$labelLandscape=r('<div class="n2_field_breakpoint__breakpoint_label" data-orientation="landscape"></div>').text(this.$fieldLandscape.val()).appendTo(this.$labelContainer),t.hasEnables&&t.options.enables[e]&&(this.$enableField=r("#"+t.options.enables[e]),this.enableField=this.$enableField.data("field"),this.isEnabled=1===parseInt(this.$enableField.val()),this.syncEnabledClass(),this.$device.append('<div class="n2_field_breakpoint__device_disable"><i class="ssi_16 ssi_16--remove"></i></div>'),this.$device.on("click",this.toggleEnable.bind(this)))}return t.prototype.syncUseGlobal=function(){for(var t in this.useGlobal="1"===this.$useGlobalField.val(),this.breakpoints)this.breakpoints[t].syncUseGlobal(this.useGlobal)},t.prototype.createBreakpoint=function(t,e){var i=t.data("id");return"desktopportrait"!==i?(this.breakpoints[i]=new s(this,i,t,e),this.breakpoints[i]):a},t.prototype.onOrientationChanged=function(){var t=this.$orientationField.val();for(var e in this.breakpoints)this.breakpoints[e].setOrientation(t);this.$container.attr("data-orientation",t)},s.prototype.setOrientation=function(t){this.orientation=t},s.prototype.setNext=function(t){this.next=t},s.prototype.getValue=function(){return parseInt(this.$fieldPortrait.val())},s.prototype.syncUseGlobal=function(t){t?(this.disableEdit=!0,this.$labelPortrait.text(this.parentField.options.global.values[this.device+"-portrait"]),this.$labelLandscape.text(this.parentField.options.global.values[this.device+"-landscape"])):(this.disableEdit=!1,this.$labelPortrait.text(this.$fieldPortrait.val()),this.$labelLandscape.text(this.$fieldLandscape.val())),this.$labelContainer.toggleClass("n2_field_breakpoint__breakpoint_label_container--disable-edit",this.disableEdit)},s.prototype.toggleEnable=function(t){t.preventDefault(),this.isEnabled=!this.isEnabled,this.enableField.insideChange(this.isEnabled?1:0),this.syncEnabledClass()},s.prototype.syncEnabledClass=function(){this.$device.toggleClass("n2_field_breakpoint__device--enabled",this.isEnabled),this.$breakpoint.toggleClass("n2_field_breakpoint__breakpoint--enabled",this.isEnabled),r("body").attr("data-"+this.device,this.isEnabled?1:0)},s.prototype.edit=function(t){var e="portrait"===this.orientation?this.$labelPortrait:this.$labelLandscape,i="portrait"===this.orientation?this.$fieldPortrait:this.$fieldLandscape;this.disableEdit||"true"===e[0].contentEditable||(t.preventDefault(),new N2Classes.InlineTextEditor(e[0],{filter:this.onFilter.bind(this),onSave:this.onSave.bind(this,i,e),onCancel:this.onCancel.bind(this,i,e)}))},s.prototype.onFilter=function(t){return t.replace(/[^0-9]/gi,"").replace(/^[0]+/gi,"").substr(0,4)},s.prototype.onSave=function(t,e,i){(i=parseInt(i))?(i=Math.max(100,Math.min(99999,parseInt(i))),t.val(i).trigger("change"),e.text(i)):this.onCancel(t,e)},s.prototype.onCancel=function(t,e){e.text(parseInt(t.val()))},t}),N2D("FormElementButtonMoreLess",function(s,n){function t(t,e){if(this.$button=s("#"+t).on("click",this.switchState.bind(this)),this.options=s.extend({labelMore:"",labelLess:"",relatedFields:[]},e),this.shownMore=!1,this.relatedFields=s(""),e.relatedFields!==n&&e.relatedFields.length)for(var i=0;i<e.relatedFields.length;i++)this.relatedFields=this.relatedFields.add(s('[data-field="'+e.relatedFields[i]+'"]'));this.syncState()}return t.prototype.switchState=function(t){t.preventDefault(),this.shownMore=!this.shownMore,this.shownMore?this.$button.text(this.options.labelLess):this.$button.text(this.options.labelMore),this.syncState()},t.prototype.syncState=function(){this.relatedFields.toggleClass("n2_form_element--hidden",!this.shownMore)},t}),N2D("FormElementCheckboxOnOff",["FormElement"],function(s,n){function t(t,e){if(this.separator="||",this.element=s("#"+t),this.$parent=this.element.parent(),this.options=s.extend({invert:!1},e),this.relatedFields=s(""),e.relatedFields!==n&&e.relatedFields.length){for(var i=0;i<e.relatedFields.length;i++)this.relatedFields=this.relatedFields.add(s('[data-field="'+e.relatedFields[i]+'"]'));this.setValue(parseInt(this.element.val())?1:0)}N2Classes.FormElement.prototype.constructor.call(this),this.$parent.on("click",this.switchCheckbox.bind(this))}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype.switchCheckbox=function(){this.setValue(parseInt(this.element.val())?0:1),this.triggerOutsideChange()},t.prototype.setValue=function(t){this.element.val(t);var e=!1;(!this.options.invert&&1===t||this.options.invert&&1!==t)&&(e=!0),this.$parent.toggleClass("n2_field_checkbox_onoff--active",e),this.relatedFields.toggleClass("n2_form_element--hidden",this.options.invert?e:!e)},t.prototype.insideChange=function(t){this.setValue(parseInt(t)?1:0),this.triggerInsideChange()},t}),N2D("FormElementColor",["FormElement"],function(s,t){function e(t,e){this.element=s("#"+t),this.alpha=1===e;var i=[["000000","55aa39","357cbd","bb4a28","8757b2"],["81898d","5cba3c","4594e1","d85935","9e74c2"],["ced3d5","27ae60","01add3","e79d19","e264af"],["ffffff","2ecc71","00c1c4","ecc31f","ec87c0"]];this.alpha&&(i[0].push("000000CC"),i[1].push("00000080"),i[2].push("FFFFFFCC"),i[3].push("FFFFFF80")),this.element.off("change").n2spectrum({showAlpha:this.alpha,preferredFormat:this.alpha?"hex8":"hex6",showInput:!1,showButtons:!1,move:this.onMove.bind(this),showSelectionPalette:!0,showPalette:!0,maxSelectionSize:6,localStorageKey:"color",palette:i}).on("change",this.onChange.bind(this)),this.text=this.element.data("field"),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onMove=function(){this.element.val(this.getCurrent()),this.triggerOutsideChange()},e.prototype.onChange=function(t){var e=this.getCurrent(),i=this.element.val();e!==i&&(0===i.length?(i=this.alpha?"00000000":"000000",this.element.val(i),this.element.n2spectrum("set",i)):"{"!==i.charAt(0)&&this.element.n2spectrum("set",i),this.triggerInsideChange(),this.triggerOutsideChange()),t.stopImmediatePropagation()},e.prototype.insideChange=function(t){this.element.val(t),0<t.length&&"{"!==t.charAt(0)&&this.element.n2spectrum("set",t),this.triggerInsideChange()},e.prototype.getCurrent=function(){return this.alpha?this.element.n2spectrum("get").toHexString8():this.element.n2spectrum("get").toHexString(!0)},e}),N2D("FormElementDecoration",["FormElement"],function(s,n){function t(t,e){this.separator="||",this.element=s("#"+t),this.values=e,this.checkboxes=this.element.parent().find(".n2_field_decoration__option"),this.states=this.element.val().split(this.separator);for(var i=0;i<this.checkboxes.length;i++)this.states[i]!==n&&this.states[i]===this.values[i]||(this.states[i]=""),this.checkboxes.eq(i).on("click",this.switchCheckbox.bind(this,i));N2Classes.FormElement.prototype.constructor.call(this)}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype.switchCheckbox=function(t){this.states[t]===this.values[t]?(this.states[t]="",this.setSelected(t,0)):(this.states[t]=this.values[t],this.setSelected(t,1)),this.element.val(this.states.join(this.separator)),this.triggerOutsideChange()},t.prototype.insideChange=function(t){for(var e=t.split(this.separator),i=0;i<this.checkboxes.length;i++)e[i]===n||e[i]!==this.values[i]?(this.states[i]="",this.setSelected(i,0)):(this.states[i]=this.values[i],this.setSelected(i,1));this.element.val(this.states.join(this.separator)),this.triggerInsideChange()},t.prototype.setSelected=function(t,e){this.checkboxes.eq(t).toggleClass("n2_field_decoration__option--selected",1===e)},t}),N2D("FormElementDevice",["FormElementOnoff"],function(t,e){function i(t){N2Classes.FormElementOnoff.prototype.constructor.call(this,t,{values:{0:1,1:0}})}return((i.prototype=Object.create(N2Classes.FormElementOnoff.prototype)).constructor=i).prototype.detach=function(){this.onoff.detach()},i.prototype.syncOff=function(){this.onoff.removeClass("n2_field_radio__option--selected")},i.prototype.syncOn=function(){this.onoff.addClass("n2_field_radio__option--selected")},i}),N2D("FormElementDevices",["FormElementDevice"],function(s,t){function e(t,e){this.$el=s("#"+t).data("field",this),this.fields={};for(var i=0;i<e.length;i++)this.fields[e[i]]=new N2Classes.FormElementDevice(t+"-"+e[i])}return e.prototype.setAvailableDevices=function(t){for(var e in t){var i=this.fields[e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()];!t[e]&&i&&i.detach()}this.$el.children().first().addClass("n2-first"),this.$el.children().last().addClass("n2-last")},e}),N2D("FormElementFloatToPercent",["FormElement"],function(s,t){function e(t,e,i){this.min=e,this.max=i,this.element=s("#"+t),this.$parent=this.element.parent(),this.$input=this.$parent.find('input[type="text"]'),this.$input.on({focus:this._focus.bind(this),blur:this.blur.bind(this),change:this.change.bind(this)}),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype._focus=function(){this.$parent.addClass("n2_field_text--focus"),this.$input.on("keypress.n2-text",function(t){13===t.which&&(this.$input.off("keypress.n2-text"),this.$input.trigger("blur"))}.bind(this))},e.prototype.blur=function(){this.$parent.removeClass("n2_field_text--focus")},e.prototype.change=function(){var t=this.validate(this.$input.val());!0===t?(this.element.val(this.$input.val()/100),this.triggerOutsideChange()):this.$input.val(t).trigger("change")},e.prototype.insideChange=function(t){var e=this.validate(t);!0===e?this.$input.val(t):this.$input.val(e),this.element.val(this.$input.val()/100),this.triggerInsideChange()},e.prototype.validate=function(t){var e=parseFloat(t);return isNaN(e)&&(e=0),(e=Math.max(this.min,Math.min(this.max,e))).toString()===t||e},e}),N2D("FormElementFolders",["FormElementText"],function(t,e){function i(t,e){N2Classes.FormElementText.prototype.constructor.call(this,t),this.parameters=e,this.parent.find(".n2_field_text__clear").on("click",this.clear.bind(this)),this.parent.find(".n2_field_text__choose").on("click",this.show.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return((i.prototype=Object.create(N2Classes.FormElementText.prototype)).constructor=i).prototype.clear=function(t){t.preventDefault(),this.val("")},i.prototype.val=function(t){this.element.val(t),this.change()},i.prototype.show=function(t){t.preventDefault(),this.modal=new N2Classes.ModalLightbox(n2_("Choose folder"),"filesystem"),this.modal.addContent(nextend.browse.getNode("folder"));var e=N2Classes.UI.modalButton(n2_("Select"),"green").on("click",function(t){t.preventDefault(),this.modal.hide(t),this.val(nextend.browse.getCurrentFolder())}.bind(this));this.modal.addButton(e),this.modal.show()},i}),N2D("FormElementFontHidden",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parameters=i.extend({mode:"",label:""},e),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.getLabel=function(){return this.parameters.label},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t),this.triggerInsideChange()},e.prototype.renderFont=function(){return N2Classes.CSSRendererFont.addCSS("",N2Classes.CSSRendererFont.getClass(),this.element.val(),N2Classes.CSSRendererFont.rendererModes[this.parameters.mode])},e}),N2D("FormElementFont",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parent=this.element.parent(),this.parameters=i.extend({mode:"",label:"",style:"",style2:"",preview:""},e),N2Classes.FormElement.prototype.constructor.call(this),this.parent.on("click",this.show.bind(this))}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.getLabel=function(){return this.parameters.label},e.prototype.show=function(t){t.preventDefault(),""!==this.parameters.style&&nextend.fontManager.setConnectedStyle(this.parameters.style),""!==this.parameters.style2&&nextend.fontManager.setConnectedStyle2(this.parameters.style2),nextend.fontManager.setFieldID(this.element.attr("id")),nextend.fontManager.show(this.element.val(),this.save.bind(this),{previewMode:this.parameters.mode,previewHTML:this.parameters.preview})},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t),this.triggerInsideChange()},e.prototype.renderFont=function(){return N2Classes.CSSRendererFont.addCSS("",N2Classes.CSSRendererFont.getClass(),this.element.val(),N2Classes.CSSRendererFont.rendererModes[this.parameters.mode])},e}),N2D("FormTabbed",function(n,t){function e(t,e){var i,s;this.options=n.extend({toggleMode:!1,sessionID:""},e),this.id=t,this.$buttons=n('.n2_form__tab_button[data-related-form="'+t+'"]'),this.$tabs=n('.n2_form__tab[data-related-form="'+t+'"]'),this.$buttons.on("click",this.showTab.bind(this)),this.options.toggleMode||(i=this.$buttons.eq(0).data("related-tab"),""!==this.options.sessionID&&(i=localStorage.getItem(this.options.sessionID)),0===(s=this.$buttons.filter('[data-related-tab="'+i+'"]')).length&&(s=this.$buttons.eq(0)),s.triggerHandler("click"))}return e.prototype.showTab=function(t){t.preventDefault();var e=n(t.currentTarget),i=e.data("related-tab");this.$buttons.removeClass("n2_form__tab_button--active"),this.$tabs.removeClass("n2_form__tab--active"),this.options.toggleMode&&this.currentTab===i?delete this.currentTab:(e.addClass("n2_form__tab_button--active"),this.$tabs.filter('[data-tab="'+i+'"]').addClass("n2_form__tab--active"),this.currentTab=i,""!==this.options.sessionID&&localStorage.setItem(this.options.sessionID,i))},e}),N2D("FormElementIconTab",["FormElement"],function(a,t){function e(t,e){if(this.options=a.extend({relatedValueFields:[],relatedAttribute:""},e),this.parent=a("#"+t+"_icon_tab"),this.parent.find(".n2_field_icon_tab__option").each(function(t,e){a(e).on("click",function(t){this.onClick(a(t.currentTarget))}.bind(this))}.bind(this)),this.element=a("#"+t).on("change",this.onHiddenChange.bind(this)),this.relatedValueFields=!1,this.options.relatedValueFields.length){var i=this.element.val();this.relatedValueFields=a("");for(var s=0;s<this.options.relatedValueFields.length;s++)for(var n,o=0;o<this.options.relatedValueFields[s].field.length;o++)(n=a('[data-field="'+this.options.relatedValueFields[s].field[o]+'"]').data("show-values",this.options.relatedValueFields[s].values)).toggleClass("n2_form_element--hidden",-1===this.options.relatedValueFields[s].values.indexOf(i)),this.relatedValueFields=this.relatedValueFields.add(n)}var r;""!==this.options.relatedAttribute&&(r=a("#n2-admin").attr("data-"+this.options.relatedAttribute,this.element.val()),this.element.on("nextendChange",function(){r.attr("data-"+this.options.relatedAttribute,this.element.val())}.bind(this))),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onHiddenChange=function(){var t=this.element.val();t&&this.insideChange(t)},e.prototype.onClick=function(t){t.hasClass("n2_field_icon_tab__option--selected")||(this.parent.find(".n2_field_icon_tab__option--selected").removeClass("n2_field_icon_tab__option--selected"),t.addClass("n2_field_icon_tab__option--selected"),this.setHiddenValue(t.attr("data-ssoption")),this.triggerOutsideChange())},e.prototype.insideChange=function(t){this.setHiddenValue(t);var e=this.parent.find('.n2_field_icon_tab__option[data-ssoption="'+t+'"]');this.onClick(e),this.triggerInsideChange()},e.prototype.setHiddenValue=function(e){this.element.val(e),this.relatedValueFields&&this.relatedValueFields.each(function(){var t=a(this);t.toggleClass("n2_form_element--hidden",-1===t.data("show-values").indexOf(e))})},e}),N2D("FormElementIcon2Manager",["FormElement"],function(e,t){function i(t){this.element=e("#"+t),this.parent=this.element.parent(),N2Classes.FormElement.prototype.constructor.call(this),this.parent.find(".n2_field_chooser__clear").on("click",this.clear.bind(this)),this.parent.find(".n2_field_chooser__choose").on("click",this.openModal.bind(this)),this.$preview=this.parent.find(".n2_field_icon__preview").on("click",this.openModal.bind(this)),this.updateIsEmpty()}return((i.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=i).prototype.isEmpty=function(t){return""===t},i.prototype.clear=function(t){t.preventDefault(),this.val("")},i.prototype.insideChange=function(t){this.updatePreview(t),this.element.val(t),this.updateIsEmpty(),this.triggerInsideChange()},i.prototype.openModal=function(t){t&&t.preventDefault(),N2Classes.Icons.showModal(this.setIcon.bind(this),this.element.val())},i.prototype.val=function(t){this.element.val(t),this.updatePreview(t),this.updateIsEmpty(),this.triggerOutsideChange()},i.prototype.setIcon=function(t){this.val(t)},i.prototype.updateIsEmpty=function(){this.parent.toggleClass("n2_field_chooser--empty",this.isEmpty(this.element.val()))},i.prototype.updatePreview=function(t){var e=N2Classes.Icons.render(t);e?this.$preview.html('<i class="n2i '+e.class+'">'+e.ligature+"</i>"):this.$preview.html("")},i.prototype.focus=function(t){t&&this.openModal()},i}),N2D("FormElementImageList",["FormElement"],function(n,o){function t(t,e,i){if(this.id=t,this.element=n("#"+t),this.$parent=this.element.parent(),this.$preview=this.$parent.find(".n2_field_image_list__preview"),this.$fields=this.$parent.find(".n2_field_image_list__fields"),this.$fields.length&&(this.field=this.$fields.find('input[type="text"]').data("field"),this.field.element.on("outsideChange",function(){var t=this.element.val();this.markSelected(t),this.renderPreview(t)}.bind(this))),this.$popover=!1,this.parameters=n.extend({width:120,column:3,hasDisabled:!1,options:[]},e),this.realItemWidth=this.parameters.width+10,this.relatedFields=!1,i!==o&&i.length){this.relatedFields=n("");for(var s=0;s<i.length;s++)this.relatedFields=this.relatedFields.add(n('[data-field="'+i[s]+'"]'));this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(this.element.val()))}N2Classes.FormElement.prototype.constructor.call(this),this.$parent.on("click",this.toggle.bind(this)),this.renderPreview(this.element.val())}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype.stopPropagation=function(t){return t.originalEvent["handled"+this.id]!==o||!(t.originalEvent["handled"+this.id]=!0)},t.prototype.toggle=function(t){this.$parent.hasClass("n2_field_image_list--focus")?this.blur(t):this.focus(t)},t.prototype.focus=function(t){this.stopPropagation(t)||(this.$parent.addClass("n2_field_image_list--focus"),n("body").on("click."+this.id,this.blur.bind(this)),this.buildPopover(),this.markSelected(this.element.val()))},t.prototype.blur=function(t){this.stopPropagation(t)||(this.$parent.removeClass("n2_field_image_list--focus"),n("body").off("click."+this.id))},t.prototype.isOff=function(t){return"-1"===t},t.prototype.buildPopover=function(){if(!this.$popover){this.items={},this.$popover=n('<div class="n2_field_image_list__popover"></div>').on("click",this.stopPropagation.bind(this));var t=n('<div class="n2_field_image_list__popover_items"></div>').css("width",(this.realItemWidth+20)*this.parameters.column).appendTo(this.$popover);for(var e in this.parameters.options){this.items[e]=n('<div class="n2_field_image_list__popover_item"></div>').css("width",this.realItemWidth).on("click",this.selectOption.bind(this,e)).appendTo(t);var i=n('<div class="n2_field_image_list__popover_item_image"></div>').appendTo(this.items[e]);this.loadImage(this.parameters.options[e].url,i),this.parameters.options[e].label!==o&&n('<div class="n2_field_image_list__popover_item_label"></div>').text(this.parameters.options[e].label).appendTo(this.items[e])}this.parameters.hasDisabled&&(this.parameters.options[-1]={url:""},this.items[-1]=n('<div class="n2_field_image_list__popover_item"></div>').on("click",this.selectOption.bind(this,"-1")).append(n('<div class="n2_field_image_list__popover_item_disabled"></div>').text(n2_("Disabled"))).appendTo(t)),this.$fields.appendTo(this.$popover),this.$parent.append(this.$popover),this.$items=this.$popover.find(".n2_field_image_list__popover_item")}},t.prototype.selectOption=function(t,e){this.setValue(t),this.markSelected(t),this.renderPreview(t),this.triggerOutsideChange(),this.blur(e)},t.prototype.setValue=function(t){this.element.val(t),this.relatedFields&&this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(t))},t.prototype.markSelected=function(t){this.$items.removeClass("n2_field_image_list__popover_item--selected"),this.field&&""!==this.field.element.val()||this.items[t].addClass("n2_field_image_list__popover_item--selected")},t.prototype.renderPreview=function(t){var e,i;this.$preview.html(""),this.field&&""!==this.field.element.val()?e=nextend.imageHelper.fixed(this.field.element.val()):"-1"!==t&&this.parameters.options[t]!==o&&(e=this.parameters.options[t].url,i=this.parameters.options[t].label),e!==o?(this.loadImage(e,this.$preview),i&&n('<div class="n2_field_image_list__preview_label"></div>').text(i).appendTo(this.$preview)):n('<div class="n2_field_image_list__preview_label"></div>').text(n2_("Disabled")).appendTo(this.$preview)},t.prototype.insideChange=function(t){this.parameters.options[t]!==o&&(this.setValue(t),this.markSelected(t),this.renderPreview(t),this.triggerInsideChange())},t.prototype.loadImage=function(t,e){this.getImage(t,"94b2c1").done(function(t){n('<img alt="" src="'+t+'"/>').prependTo(e)})},t.prototype.getCurrentImage=function(t){return this.getImage(this.parameters.options[this.element.val()].url,t)},t.prototype.getImage=function(t,i){var s=n.Deferred();return"svg"===t.split("?")[0].split(".").pop()?n.ajax({url:t,method:"GET",dataType:"text",success:function(t){var e=t.replace(/fill="#FFF"/gi,'fill="#'+i.substr(0,6)+'"').replace('opacity="1"','opacity="'+N2Color.hex2alpha(i)+'"');s.resolve("data:image/svg+xml;base64,"+btoa(e))}.bind(this)}):s.resolve(t),s},t}),N2D("FormElementImage",["FormElementText"],function(i,t){function e(t,e){N2Classes.FormElementText.prototype.constructor.call(this,t),this.parameters=i.extend({alt:!1},e),this.preview=this.parent.find(".n2_field_text_image__preview").on("click",this.open.bind(this)),this.element.on("nextendChange",this.makePreview.bind(this)),this.parent.find(".n2_field_text__choose").on("click",this.open.bind(this)),this.parent.find(".n2_field_text__clear").on("click",this.clear.bind(this)),this.$sizeLabel=i('<div class="n2_field_text_image__size_label"></div>').appendTo(this.parent),this.refreshSizeLabel()}return((e.prototype=Object.create(N2Classes.FormElementText.prototype)).constructor=e).prototype.clear=function(t){t.preventDefault(),this.val("")},e.prototype.val=function(t,e){(e=i.extend({alt:!1},e)).alt&&""!==e.alt&&this.parameters.alt&&""!==this.parameters.alt&&i("#"+this.parameters.alt).val(e.alt).trigger("change"),this.element.val(t),this.change()},e.prototype.makePreview=function(){var t=this.element.val();"{"===t.substr(0,1)?this.preview.css("background-image",""):this.preview.css("background-image","url("+nextend.imageHelper.fixed(t)+")"),this.refreshSizeLabel()},e.prototype.open=function(t){t&&t.preventDefault(),nextend.imageHelper.openLightbox(this.val.bind(this))},e.prototype.focus=function(t){t&&this.open()},e.prototype.refreshSizeLabel=function(){this.$sizeLabel.removeClass("n2_field_text_image__size_label--visible");var t,e=this.element.val();""!==e&&"{"!==e.substr(0,1)&&((t=new Image).addEventListener("load",function(){t.naturalWidth&&t.naturalHeight&&this.$sizeLabel.text(t.naturalWidth+"x"+t.naturalHeight).addClass("n2_field_text_image__size_label--visible")}.bind(this)),t.src=nextend.imageHelper.fixed(e))},e}),N2D("FormElementLayerWindowFocus",["UIDragTooltip"],function(i,t){var n=new N2Classes.UIDragTooltip("Focus");function e(t,e){this.$field=i("#"+t).on("mousedown",this.onMouseDown.bind(this)),this.onMouseMoveCallback=this.onMouseMove.bind(this),this.onMouseUpCallback=this.onMouseUp.bind(this),this.$image=this.$field.find(".n2_field_layer_window_focus__image").on({error:function(){this.$image.attr("src",nextend.imageHelper.fixed("$system$/images/placeholder/image.png"))}.bind(this)}),this.$dot=i('<div class="n2_field_layer_window_focus__dot"></div>').on("mouseenter",this.onMouseEnter.bind(this)).appendTo(this.$field),this.options=i.extend({image:"",focusX:"",focusY:""},e),this.$imageField=i("#"+this.options.image).on("nextendChange",this.onImageChange.bind(this)),this.imageField=this.$imageField.data("field"),this.$focusXField=i("#"+this.options.focusX).on("nextendChange",this.onFocusXChange.bind(this)),this.focusXField=this.$focusXField.data("field"),this.$focusYField=i("#"+this.options.focusY).on("nextendChange",this.onFocusYChange.bind(this)),this.focusYField=this.$focusYField.data("field")}return e.prototype.onImageChange=function(){var t=nextend.imageHelper.fixed(nextend.currentEditor.generator.fill(this.$imageField.val()));this.image!==t&&(this.image=t,this.$image.attr("src",this.image))},e.prototype.onFocusXChange=function(){var t=this.$focusXField.val();t!==this.focusX&&(this.focusX=t,this.$dot.css("left",this.focusX+"%"))},e.prototype.onFocusYChange=function(){var t=this.$focusYField.val();t!==this.focusY&&(this.focusY=t,this.$dot.css("top",this.focusY+"%"))},e.prototype.onMouseDown=function(t){this.context={originalFocusX:this.$focusXField.val(),originalFocusY:this.$focusYField.val()},N2Classes.History.get().off(),n.dragShow(),this.onMouseMove(t),document.addEventListener("mousemove",this.onMouseMoveCallback),document.addEventListener("mouseup",this.onMouseUpCallback)},e.prototype.onMouseMove=function(t){t.preventDefault();var e=this.$field[0].getBoundingClientRect(),i=Math.max(Math.min(Math.round((t.clientX-e.left)/e.width*100),100),0),s=Math.max(Math.min(Math.round((t.clientY-e.top)/e.height*100),100),0);this.$focusXField.val(i).trigger("change"),this.$focusYField.val(s).trigger("change"),n.dragUpdate(t,"X: "+i+"%<br />Y: "+s+"%")},e.prototype.onMouseUp=function(t){this.$focusXField.val(this.context.originalFocusX).trigger("change"),this.$focusYField.val(this.context.originalFocusY).trigger("change"),N2Classes.History.get().on(),n.dragHide(),document.removeEventListener("mousemove",this.onMouseMoveCallback),document.removeEventListener("mouseup",this.onMouseUpCallback),this.onMouseMove(t),delete this.context},e.prototype.onMouseEnter=function(t){n.hoverShow(t,function(){return"X: "+this.$focusXField.val()+"%<br />Y: "+this.$focusYField.val()+"%"}.bind(this)),this.$dot.on({"mousemove.tooltip":function(t){n.hoverUpdatePosition(t)},"mouseleave.tooltip":function(){this.timeout&&(clearTimeout(this.timeout),delete this.timeout),this.$dot.off(".tooltip"),n.hoverHide()}.bind(this)})},e}),N2D("FormElementList",["FormElement"],function(a,t){function e(t,e){if(this.separator="||",this.options=a.extend({relatedFields:[],relatedValueFields:[],relatedAttribute:""},e),this.element=a("#"+t).on("change",this.onHiddenChange.bind(this)),this.select=a("#"+t+"_select").on("change",this.onChange.bind(this)),this.relatedFields=!1,this.options.relatedFields.length){this.relatedFields=a("");for(var i=0;i<this.options.relatedFields.length;i++)this.relatedFields=this.relatedFields.add(a('[data-field="'+this.options.relatedFields[i]+'"]'));this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(this.element.val()))}if(this.relatedValueFields=!1,this.options.relatedValueFields.length){var s=this.element.val();this.relatedValueFields=a("");for(i=0;i<this.options.relatedValueFields.length;i++)for(var n,o=0;o<this.options.relatedValueFields[i].field.length;o++)(n=a('[data-field="'+this.options.relatedValueFields[i].field[o]+'"]').data("show-values",this.options.relatedValueFields[i].values)).toggleClass("n2_form_element--hidden",-1===this.options.relatedValueFields[i].values.indexOf(s)),this.relatedValueFields=this.relatedValueFields.add(n)}var r;""!==this.options.relatedAttribute&&(r=a("#n2-admin").attr("data-"+this.options.relatedAttribute,this.element.val()),this.element.on("nextendChange",function(){r.attr("data-"+this.options.relatedAttribute,this.element.val())}.bind(this))),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onHiddenChange=function(){var t=this.element.val();t&&t!==this.select.val()&&this.insideChange(t)},e.prototype.onChange=function(){var t=this.select.val();null!==t&&"object"==typeof t&&(t=t.join(this.separator)),this.setHiddenValue(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){"object"==typeof t?(this.select.val(t),t=t.join("||")):this.select.val(t),this.setHiddenValue(t),this.triggerInsideChange()},e.prototype.setHiddenValue=function(e){this.element.val(e),this.relatedFields&&this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(e)),this.relatedValueFields&&this.relatedValueFields.each(function(){var t=a(this);t.toggleClass("n2_form_element--hidden",-1===t.data("show-values").indexOf(e))})},e.prototype.isOff=function(t){return""==t||"0"==t||"off"==t},e.prototype.setOptions=function(t){for(var e in this.select.html(""),t)a('<option value="'+e+'"></option>').text(t[e]).appendTo(this.select)},e}),N2D("FormElementMarginPadding",["FormElementMixed"],function(t,e){function i(t,e,i){this.linkedValues=!1,N2Classes.FormElementMixed.prototype.constructor.apply(this,arguments),this.$field=this.element.parent(),this.$field.find(".n2_field_margin_padding__pre_label").on("click",function(t){t.preventDefault(),this.linkedValues=!this.linkedValues,this.$field.toggleClass("n2_field_margin_padding--linked-values",this.linkedValues),this.linkedValues&&this.elements[0].trigger("change")}.bind(this)),this.refresh()}return((i.prototype=Object.create(N2Classes.FormElementMixed.prototype)).constructor=i).prototype.onFieldChange=function(){if(this.linkedValues)for(var t=this.elements[0].val(),e=1;e<4;e++)this.elements[e].data("field").insideChange(t);this.element.val(this.getValue()),this.triggerOutsideChange()},i.prototype.insideChange=function(t){N2Classes.FormElementMixed.prototype.insideChange.apply(this,arguments),this.refresh()},i.prototype.refresh=function(){this.linkedValues=!0;for(var t=this.elements[0].val(),e=1;e<4;e++)if(t!==this.elements[e].val()){this.linkedValues=!1;break}this.$field.toggleClass("n2_field_margin_padding--linked-values",this.linkedValues)},i.prototype.relatedFieldsOff=function(){return"0|*|0|*|0|*|0"===this.element.val()},i.prototype.isEmpty=function(t){return"|*||*||*|"===t||"0|*|0|*|0|*|0"===t},i}),N2D("FormElementMixed",["FormElement"],function(n,t){function e(t,e,i){this.element=n("#"+t),this.elements=[];for(var s=0;s<e.length;s++)this.elements.push(n("#"+e[s]).on("outsideChange",this.onFieldChange.bind(this)));this.separator=i,N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onFieldChange=function(){this.element.val(this.getValue()),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t);for(var e=t.split(this.separator),i=0;i<this.elements.length;i++)this.elements[i].data("field").insideChange(e[i]);this.triggerInsideChange()},e.prototype.getValue=function(){for(var t=[],e=0;e<this.elements.length;e++)t.push(this.elements[e].val());return t.join(this.separator)},e}),N2D("FormElementNumberSlider",function(n,o){function t(t,e){this.localChange=!1,this.element=n("#"+t),this.$parent=this.element.parent().on({"mouseenter.n2slider":this.startSlider.bind(this,e)});var i,s=this.$parent.siblings(".n2_field_unit").find("> input");e.units&&s.length&&(i=e.units,s.on("nextendChange",function(){e.min=i[s.val()+"Min"],e.max=i[s.val()+"SliderMax"],this.slider&&(this.uiSlider.setOption("min",e.min),this.uiSlider.setOption("max",e.max))}.bind(this)))}return t.prototype.startSlider=function(t,e){var i,s;this.element.parent().off(".n2slider"),this.slider||(i=n('<div class="n2_field_number__slider"></div>').appendTo(this.$parent),s=n('<div class="n2_field_number__slider_inner"></div>').appendTo(i),this.slider=n("<div></div>").appendTo(s).removeAttr("slide").prop("slide",!1),this.uiSlider=new N2Classes.UISlider(this.slider,n.extend({start:function(){this.element.parent().addClass("n2-active")}.bind(this),stop:function(){this.element.parent().removeClass("n2-active")}.bind(this),sliding:function(t,e){this.localChange=!0,this.element.val(e.value).trigger("change"),this.localChange=!1}.bind(this)},t)),this.slider[0].slide!==o&&(this.slider[0].slide=null),this.element.on("nextendChange",function(){var t;this.localChange||(t=parseFloat(this.element.val()),isFinite(t)&&this.uiSlider.setOption("value",t))}.bind(this))),this.uiSlider.setOption("value",parseFloat(this.element.val()))},t}),N2D("FormElementNumber",["FormElement"],function(o,i){function t(t,e,i,s){this.min=e,this.max=i,this.element=o("#"+t).on({focus:this._focus.bind(this),blur:this.blur.bind(this),change:this.change.bind(this)}),this.parent=this.element.parent();var n=this.parent.siblings(".n2-form-element-units").find("> input");s&&n.length&&n.on("nextendChange",function(){this.min=s[n.val()+"Min"],this.max=s[n.val()+"Max"]}.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype._focus=function(){this.parent.addClass("n2_field_text--focus"),this.element.on("keypress.n2-text",function(t){13===t.which&&(this.element.off("keypress.n2-text"),this.element.trigger("blur"))}.bind(this))},t.prototype.blur=function(){this.parent.removeClass("n2_field_text--focus")},t.prototype.change=function(){var t=this.validate(this.element.val());!0===t?this.triggerOutsideChange():this.element.val(t).trigger("change")},t.prototype.insideChange=function(t){var e=this.validate(t);!0===e?this.element.val(t):this.element.val(e),this.triggerInsideChange()},t.prototype.validate=function(t){if(t!==i&&0<t.length&&"{"===t.charAt(0))return!0;var e=parseFloat(t);return isNaN(e)&&(e=0),(e=Math.max(this.min,Math.min(this.max,e)))+""===t||e},t.prototype.relatedFieldsOff=function(){return 0===parseInt(this.element.val())},t.prototype.isEmpty=function(t){return""===t||0===t},t}),N2D("FormElementOnoff",["FormElement"],function(o,t){function e(t,e){for(var i in this.element=o("#"+t),this.options=o.extend({values:{0:0,1:1},relatedFieldsOff:[],relatedFieldsOn:[],relatedAttribute:""},e),this.options.valuesDict={},this.options.values)this.options.valuesDict[this.options.values[i]]=i;if(this.options.relatedFieldsOff.length){this.relatedFieldsOff=o("");for(var s=0;s<this.options.relatedFieldsOff.length;s++)this.relatedFieldsOff=this.relatedFieldsOff.add(o('[data-field="'+this.options.relatedFieldsOff[s]+'"]'))}else this.relatedFieldsOff=!1;if(this.options.relatedFieldsOn.length){this.relatedFieldsOn=o("");for(s=0;s<this.options.relatedFieldsOn.length;s++)this.relatedFieldsOn=this.relatedFieldsOn.add(o('[data-field="'+this.options.relatedFieldsOn[s]+'"]'))}else this.relatedFieldsOn=!1;var n;""!==this.options.relatedAttribute&&((n=o("#n2-admin")).attr("data-"+this.options.relatedAttribute,this.element.val()),this.element.on("nextendChange",function(){n.attr("data-"+this.options.relatedAttribute,this.element.val())}.bind(this))),this.onoff=this.element.parent().on({click:this.switch.bind(this),keydown:function(t){32===t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.onoff.trigger("click"))}.bind(this)}),this.options.values[this.element.val()]?this.syncOn():this.syncOff(),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.switch=function(){var t=this.options.values[this.element.val()]?0:1;this.element.val(this.options.valuesDict[t]),this.setSelected(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){var e=this.options.values[t];this.element.val(this.options.valuesDict[e]),this.setSelected(e),this.triggerInsideChange()},e.prototype.setSelected=function(t){t?this.syncOn():this.syncOff()},e.prototype.syncOff=function(){this.onoff.removeClass("n2_field_onoff--on").attr("aria-checked","false"),this.relatedFieldsOff&&this.relatedFieldsOff.removeClass("n2_form_element--hidden"),this.relatedFieldsOn&&this.relatedFieldsOn.addClass("n2_form_element--hidden")},e.prototype.syncOn=function(){this.onoff.addClass("n2_field_onoff--on").attr("aria-checked","true"),this.relatedFieldsOff&&this.relatedFieldsOff.addClass("n2_form_element--hidden"),this.relatedFieldsOn&&this.relatedFieldsOn.removeClass("n2_form_element--hidden")},e}),N2D("FormElementRadio",["FormElement"],function(n,o){function t(t,e,i){if(this.element=n("#"+t),this.values=e,this.relatedFields=!1,i!==o&&i.length){this.relatedFields=n("");for(var s=0;s<i.length;s++)this.relatedFields=this.relatedFields.add(n('[data-field="'+i[s]+'"]'));this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(this.element.val()))}this.parent=this.element.parent(),this.options=this.parent.find(".n2_field_radio__option");for(s=0;s<this.options.length;s++)this.options.eq(s).on("click",this.click.bind(this));N2Classes.FormElement.prototype.constructor.call(this)}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype.click=function(t){this.changeSelectedIndex(this.options.index(t.currentTarget))},t.prototype.changeSelectedIndex=function(t){var e=this.values[t];this.setValue(e),this.setSelected(t),this.triggerOutsideChange()},t.prototype.insideChange=function(t,e){var i=this.values.indexOf(t);-1===i&&(i=this.partialSearch(t)),-1===i&&e!==o&&(i=this.addOption(t,e)),-1!==i?(this.setValue(this.values[i]),this.setSelected(i),this.triggerInsideChange()):this.options.eq(0).trigger("click")},t.prototype.setSelected=function(t){this.options.removeClass("n2_field_radio__option--selected"),this.options.eq(t).addClass("n2_field_radio__option--selected")},t.prototype.partialSearch=function(t){t=t.replace(/^.*[\\\/]/,"");for(var e=0;e<this.values.length;e++)if(-1!==this.values[e].indexOf(t))return e;return-1},t.prototype.addOption=function(t,e){var i=this.values.push(t)-1;return e.appendTo(this.parent).on("click",this.click.bind(this)),this.options=this.options.add(e),i},t.prototype.addTabOption=function(t,e){var i=this.values.push(t)-1,s=n('<div class="n2_field_radio__option">'+e+"</div>").insertAfter(this.options.last()).on("click",this.click.bind(this));return this.options=this.options.add(s),i},t.prototype.removeTabOption=function(t){var e=this.values.indexOf(t),i=this.options.eq(e);this.options=this.options.not(i),i.remove(),this.values.splice(e,1)},t.prototype.moveTab=function(t,e){},t.prototype.setValue=function(t){this.element.val(t),this.relatedFields&&this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(t))},t.prototype.isOff=function(t){return""===t||"0"===t||0===t||"off"===t},t}),N2D("FormRelatedFields",function(s,n){function t(t,e){this.$field=s("#"+t),this.options=s.extend({relatedFieldsOn:[],relatedFieldsOff:[]},e),this.field=this.$field.data("field"),this.field&&this.field.relatedFieldsOff!==n?this.fieldChanged=this.fieldChangedCallback:this.fieldChanged=this.fieldChangedSimple,this.$field.on("nextendChange",this.fieldChanged.bind(this)),this.relatedFieldsOn=s("");for(var i=0;i<this.options.relatedFieldsOn.length;i++)this.relatedFieldsOn=this.relatedFieldsOn.add(s('[data-field="'+this.options.relatedFieldsOn[i]+'"]'));this.relatedFieldsOff=s("");for(i=0;i<this.options.relatedFieldsOff.length;i++)this.relatedFieldsOff=this.relatedFieldsOff.add(s('[data-field="'+this.options.relatedFieldsOff[i]+'"]'));this.fieldChanged()}return t.prototype.fieldChangedSimple=function(){var t=this.$field.val(),e=this.field.isEmpty(t);this.relatedFieldsOn.toggleClass("n2_form_element--hidden",e),this.relatedFieldsOff.toggleClass("n2_form_element--hidden",!e)},t.prototype.fieldChangedCallback=function(){var t=this.field.relatedFieldsOff();this.relatedFieldsOn.toggleClass("n2_form_element--hidden",t),this.relatedFieldsOff.toggleClass("n2_form_element--hidden",!t)},t}),N2D("FormElementRichText",["FormElementText"],function(e,t){function i(t){N2Classes.FormElementText.prototype.constructor.apply(this,arguments),this.parent.find(".n2_field_textarea_rich__button").on("click",this.onButtonClick.bind(this))}return((i.prototype=Object.create(N2Classes.FormElementText.prototype)).constructor=i).prototype.onButtonClick=function(t){switch(e(t.currentTarget).data("action")){case"bold":this.bold();break;case"italic":this.italic();break;case"link":this.link()}},i.prototype.bold=function(){this.wrapText("<b>","</b>")},i.prototype.italic=function(){this.wrapText("<i>","</i>")},i.prototype.link=function(){this.wrapText('<a href="#">',"</a>")},i.prototype.wrapText=function(t,e){var i=this.element,s=i.val().length,n=i[0].selectionStart,o=i[0].selectionEnd,r=t+i.val().substring(n,o)+e;i.val(i.val().substring(0,n)+r+i.val().substring(o,s)),this.triggerOutsideChange(),this.element.focus(),i[0].selectionEnd=o+t.length+e.length},i}),N2D("FormElementSelectIcon",["FormElement"],function(r,t){function e(t,e){if(this.options=r.extend({relatedFields:[],relatedValueFields:[]},e),this.element=r("#"+t),this.$parent=this.element.parent(),this.$options=this.$parent.find(".n2_field_select_icon__option").on("click",this.onSelect.bind(this)),this.relatedFields=!1,this.options.relatedFields.length){this.relatedFields=r("");for(var i=0;i<this.options.relatedFields.length;i++)this.relatedFields=this.relatedFields.add(r('[data-field="'+this.options.relatedFields[i]+'"]'));this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(this.element.val()))}if(this.relatedValueFields=!1,this.options.relatedValueFields.length){var s=this.element.val();this.relatedValueFields=r("");for(i=0;i<this.options.relatedValueFields.length;i++)for(var n,o=0;o<this.options.relatedValueFields[i].field.length;o++)(n=r('[data-field="'+this.options.relatedValueFields[i].field[o]+'"]').data("show-values",this.options.relatedValueFields[i].values)).toggleClass("n2_form_element--hidden",-1===this.options.relatedValueFields[i].values.indexOf(s)),this.relatedValueFields=this.relatedValueFields.add(n)}N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onSelect=function(t){var e=r(t.currentTarget);e.data("value")!==this.element.val()&&(this.$options.removeClass("n2_field_select_icon__option--selected"),e.addClass("n2_field_select_icon__option--selected"),this.setHiddenValue(e.data("value")),this.triggerOutsideChange())},e.prototype.insideChange=function(t){this.$options.removeClass("n2_field_select_icon__option--selected"),this.$options.filter('[data-value="'+t+'"]').addClass("n2_field_select_icon__option--selected"),this.setHiddenValue(t),this.triggerInsideChange()},e.prototype.setHiddenValue=function(e){this.element.val(e),this.relatedFields&&this.relatedFields.toggleClass("n2_form_element--hidden",this.isOff(e)),this.relatedValueFields&&this.relatedValueFields.each(function(){var t=r(this);t.toggleClass("n2_form_element--hidden",-1===t.data("show-values").indexOf(e))})},e}),N2D("FormElementSkin",["FormElement"],function(n,t){function e(t,e,i,s){this.element=n("#"+t),this.preId=e,this.skins=i,this.list=this.element.data("field"),this.fixedMode=s,this.firstOption=this.list.select.find("option").eq(0),this.originalText=this.firstOption.text(),this.element.on("outsideChange",this.onSkinSelect.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.onSkinSelect=function(){var t,e=this.element.val();if("0"!==e){for(var i in e=this.skins[e].settings){!e.hasOwnProperty(i)||(t=n("#"+this.preId+i)).length&&t.data("field").insideChange(e[i])}this.fixedMode||(this.changeFirstOptionText(n2_("Done")),this.list.insideChange("0"),setTimeout(this.changeFirstOptionText.bind(this,this.originalText),3e3))}},e.prototype.changeFirstOptionText=function(t){this.firstOption.text(t)},e.prototype.insideChange=function(t){this.element.val(t),this.list.insideChange(t)},e}),N2D("FormElementStyleHidden",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parameters=i.extend({mode:"",label:""},e),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.getLabel=function(){return this.parameters.label},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t),this.triggerInsideChange()},e.prototype.renderStyle=function(){return N2Classes.CSSRendererStyle.addCSS("",N2Classes.CSSRendererStyle.getClass(),this.element.val(),N2Classes.CSSRendererStyle.rendererModes[this.parameters.mode])},e}),N2D("FormElementStyle",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parent=this.element.parent(),this.parameters=i.extend({mode:"",label:"",font:"",font2:"",style2:"",preview:""},e),N2Classes.FormElement.prototype.constructor.call(this),this.parent.on("click",this.show.bind(this))}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.getLabel=function(){return this.parameters.label},e.prototype.show=function(t){t.preventDefault(),""!==this.parameters.font&&nextend.styleManager.setConnectedFont(this.parameters.font),""!==this.parameters.font2&&nextend.styleManager.setConnectedFont2(this.parameters.font2),""!==this.parameters.style2&&nextend.styleManager.setConnectedStyle(this.parameters.style2),nextend.styleManager.setFieldID(this.element.attr("id")),nextend.styleManager.show(this.element.val(),this.save.bind(this),{previewMode:this.parameters.mode,previewHTML:this.parameters.preview})},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t),this.triggerInsideChange()},e.prototype.renderStyle=function(){return N2Classes.CSSRendererStyle.addCSS("",N2Classes.CSSRendererStyle.getClass(),this.element.val(),N2Classes.CSSRendererStyle.rendererModes[this.parameters.mode])},e}),N2D("FormElementSubformIcon",["FormElement"],function($,undefined){function FormElementSubformIcon(t,e,i,s){this.id=t,this.ajaxUrl=e,this.element=$("#"+t).data("field",this),this.$parent=this.element.parent(),this.$targetContainer=$("#"+i),this.originalValue=s,this.form=this.element.closest("form").data("form"),this.$options=this.$parent.find(".n2_field_subform_icon__option").on("click",this.selectOption.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return FormElementSubformIcon.prototype=Object.create(N2Classes.FormElement.prototype),FormElementSubformIcon.prototype.constructor=FormElementSubformIcon,FormElementSubformIcon.prototype.selectOption=function(t){var e=$(t.currentTarget),i=e.data("value");this.$options.removeClass("n2_field_subform_icon__option--selected"),e.addClass("n2_field_subform_icon__option--selected"),this.element.val(i),this.triggerOutsideChange(),this.loadSubform(i)},FormElementSubformIcon.prototype.loadSubform=function(t){var e={values:[],value:t};t===this.originalValue&&(e.values=this.form.values),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl),data:e,dataType:"json"}).done(this.load.bind(this))},FormElementSubformIcon.prototype.load=function(response){this.$targetContainer.html(response.data.html),eval(response.data.scripts),N2Classes.FormTipManager.add(this.$targetContainer)},FormElementSubformIcon}),N2D("FormElementSubformImage",["FormElement"],function(s,t){function e(t,e){this.element=s("#"+t),this.options=s("#"+e).find(".n2-subform-image-option"),this.subform=this.element.data("field"),this.active=this.getIndex(this.options.filter(".n2-active").get(0));for(var i=0;i<this.options.length;i++)this.options.eq(i).on("click",this.selectOption.bind(this));N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.selectOption=function(t){var e,i=this.getIndex(t.currentTarget);i!=this.active&&(this.options.eq(i).addClass("n2-active"),this.options.eq(this.active).removeClass("n2-active"),this.active=i,e=this.subform.list.select.find("option").eq(i).val(),this.subform.list.insideChange(e))},e.prototype.getIndex=function(t){return this.options.indexOf(t)},e}),N2D("FormElementTab",["FormElement"],function(r,t){function a(t,e){if(this.parent=r("#"+t+"_tab"),this.parent.find(".n2_field_tab__option").each(function(t,e){r(e).on("click",function(t){this.onClick(r(t.currentTarget))}.bind(this))}.bind(this)),this.element=r("#"+t).on("change",this.onHiddenChange.bind(this)),this.relatedValueFields=!1,e.length){var i=this.element.val();this.relatedValueFields=r("");for(var s=0;s<e.length;s++)for(var n,o=0;o<e[s].field.length;o++)(n=r('[data-field="'+e[s].field[o]+'"]').data("show-values",e[s].values)).toggleClass("n2_form_element--hidden",-1===e[s].values.indexOf(i)),this.relatedValueFields=this.relatedValueFields.add(n)}N2Classes.FormElement.prototype.constructor.call(this)}return((a.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=a).prototype.onHiddenChange=function(){var t=this.element.val();t&&this.insideChange(t)},a.prototype.onClick=function(t){t.hasClass("n2_field_tab__option--selected")||(this.parent.find(".n2_field_tab__option--selected").removeClass("n2_field_tab__option--selected"),t.addClass("n2_field_tab__option--selected"),this.setHiddenValue(t.attr("data-ssoption")),this.triggerOutsideChange())},a.prototype.insideChange=function(t){this.setHiddenValue(t),this.triggerInsideChange()},a.prototype.setHiddenValue=function(e){this.element.val(e),this.relatedValueFields&&this.relatedValueFields.each(function(){var t=r(this);t.toggleClass("n2_form_element--hidden",-1===t.data("show-values").indexOf(e))})},a.prototype.setOptions=function(t,e,i,s){for(var n in s=s||[],e.html(""),t){var o=r('<div class="n2_field_tab__option" data-ssoption="'+n+'">'+t[n]+"</div>");i===n&&o.addClass("n2_field_tab__option--selected"),e.append(o),new a(e.attr("id").replace("_tab",""),s)}},a}),N2D("FormElementText",["FormElement"],function(e,t){function i(t){this.element=e("#"+t).on({focus:this._focus.bind(this),blur:this._blur.bind(this),change:this.change.bind(this)}),this.tagName=this.element.prop("tagName"),this.parent=this.element.parent(),N2Classes.FormElement.prototype.constructor.call(this),this.updateIsEmpty()}return((i.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=i).prototype._focus=function(){this.parent.addClass("n2_field_text--focus"),"TEXTAREA"!==this.tagName&&this.element.on("keypress.n2-text",function(t){13===t.which&&(this.element.off("keypress.n2-text"),this.element.trigger("blur"))}.bind(this))},i.prototype._blur=function(){this.parent.removeClass("n2_field_text--focus")},i.prototype.change=function(){this.updateIsEmpty(),this.triggerOutsideChange()},i.prototype.insideChange=function(t){this.element.val(t),this.updateIsEmpty(),this.triggerInsideChange()},i.prototype.updateIsEmpty=function(){this.parent.toggleClass("n2_field_text--empty",this.isEmpty(this.element.val()))},i.prototype.isEmpty=function(t){return""===t},i.prototype.focus=function(t){this.connectedField?this.connectedField.focus(t):t&&this.element.focus().select()},i}),N2D("FormElementUnits",["FormElement"],function(s,t){function e(t,e){this.element=s("#"+t),this.$parent=this.element.parent(),this.options=this.$parent.find(".n2_field_unit__unit"),this.currentUnit=this.$parent.find(".n2_field_unit__current_unit"),this.values=e;for(var i=0;i<this.options.length;i++)this.options.eq(i).on("click",this.switch.bind(this,i));N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.switch=function(t,e){this.element.val(this.values[t]),this.setSelected(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){var e=this.values.indexOf(t);this.element.val(this.values[e]),this.setSelected(e),this.triggerInsideChange()},e.prototype.setSelected=function(t){this.currentUnit.html(this.options.eq(t).html())},e}),N2D("FormElementUpload",["FormElement"],function(e,t){function i(t){this.element=e("#"+t).on("change",this.updateName.bind(this)),this.parent=this.element.parent(),this.$name=this.parent.find(".n2_field_chooser__label"),this.updateName(this.element.val()),N2Classes.FormElement.prototype.constructor.call(this)}return((i.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=i).prototype.insideChange=function(t){this.updateName(),this.triggerInsideChange()},i.prototype.updateName=function(){var t,e=this.element[0].value;this.parent.toggleClass("n2_field_chooser--empty",""===e),this.isEmpty(e)?this.$name.text(n2_("No file selected.")):(t=e.split("\\").pop(),this.$name.text(t))},i.prototype.isEmpty=function(t){return""===t},i}),N2D("FormElementUrl",["FormElementText"],function(t,e){function i(t,e){N2Classes.FormElementText.prototype.constructor.call(this,t),this.parameters=e,this.button=this.parent.find(".n2_field_text__choose").on("click",this.open.bind(this)),this.element.siblings(".n2_field_text__clear").on("click",this.clear.bind(this))}return((i.prototype=Object.create(N2Classes.FormElementText.prototype)).constructor=i).prototype.isEmpty=function(t){return""===t||"#"===t},i.prototype.clear=function(t){t.preventDefault(),this.val("#")},i.prototype.val=function(t){this.element.val(t),this.change()},i.prototype.open=function(t){t.preventDefault(),this.element.val(),N2Classes.ModalUrl.show(this.element.val(),this.parameters.url,function(t){this.val(t)}.bind(this))},i}),N2R("$",function(i){function s(t){return t+Math.floor(281474976710656*(1+Math.random())).toString(16)}i.fn.uid=function(t){var e=null;for(t=t||"n";e=s(t),0<i("#"+e).length;);return e},i.fn.generateUniqueClass=function(t){var e=null;for(t=t||"n";e=s(t),0<i("."+e).length;);return e}}),N2D("UIAutocomplete",["UIWidgetBase"],function(d,t){"use strict";function e(t,e){this.isRendered=!1,this.element=t,this.widgetName=this.widgetName||"UIAutocomplete",this.widgetEventPrefix="autocomplete",this.isActive=!1,this.allowBlur=!0,this.options=d.extend({appendTo:"body",source:null,select:null,positionTo:"self",x:0,y:0},this.options,e),N2Classes.UIWidgetBase.prototype.constructor.apply(this,arguments),this.element.on({focus:this.focus.bind(this),blur:this.blur.bind(this)}),"self"===this.options.positionTo?this.positionTo=this.element:this.positionTo=this.element.closest(this.options.positionTo)}return((e.prototype=Object.create(N2Classes.UIWidgetBase.prototype)).constructor=e).prototype.focus=function(t){!1===this.isActive&&(this.showList(t),this.element.on("click."+this.widgetEventPrefix,this.showList.bind(this)),this.isActive=!0)},e.prototype.showList=function(t){"function"==typeof this.options.appendTo?this.options.appendTo=this.options.appendTo.call(window):this.options.appendTo=d(this.options.appendTo);var e,i,s,n,o=this.getList().appendTo(this.options.appendTo),r={left:0,top:0},a=this.positionTo.offset(),l=0;this.options.appendTo.is(d("body"))||((r=this.options.appendTo.offset()).top-=this.options.appendTo.scrollTop(),o.css("height",""),e=o.height(),i=this.options.appendTo[0].getBoundingClientRect(),s=this.positionTo[0].getBoundingClientRect(),(n=Math.min(i.top+i.height-s.top-s.height-10,e))<100&&n<e&&(n=Math.min(s.top-i.top-10,e),r.top=r.top+s.height+n),o.css("height",n),n2const.rtl.isRtl&&(l=i.width-this.options.appendTo[0].clientWidth)),o.css({left:a.left-r.left+this.options.x-l,top:a.top+this.positionTo.outerHeight()-r.top+this.options.y,minWidth:this.element.parent().outerWidth()+"px"}),o.off("."+this.widgetEventPrefix).on("mousedown."+this.widgetEventPrefix,function(t){d(t.target).is(o)&&(this.element.parent().addClass("focus2"),this.allowBlur=!1)}.bind(this)).on("mouseup."+this.widgetEventPrefix,function(t){d(t.target).is(o)&&(this.allowBlur=!0,this.element.focus(),this.element.parent().removeClass("focus2"))}.bind(this))},e.prototype.blur=function(t){this.allowBlur&&(this.hide(),this.element.off("."+this.widgetEventPrefix))},e.prototype.hide=function(){this.$list.detach(),this.isActive=!1},e.prototype.getList=function(){if(!this.isRendered){this.$list=d('<div class="n2_autocomplete_options"></div>').attr({unselectable:"on"}).on({wheel:function(t){t.stopPropagation()}});for(var t=this.options.source.call(this,this.ui()),e=0;e<t.length;e++)d('<div class="n2_autocomplete_option" tabindex="-1">'+t[e]+"</div>").on({mousedown:function(t){t.preventDefault()},click:function(t,e){this._trigger("select",e,{value:t}),this.hide()}.bind(this,t[e])}).appendTo(this.$list);this.isRendered=!0}return this.$list},e.prototype.ui=function(){return{}},e}),N2D("UIDraggableBar",["UIMouse"],function(i,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UIDraggable",this.widgetEventPrefix="drag",this.options=i.extend({drag:null,start:null,stop:null},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this._mouseInit()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype._mouseStart=function(t){return this.currentData=this.originalData={margin:parseInt(this.element.css("marginLeft"))},this.originalMousePosition={left:t.pageX},this.element.addClass("nui-draggable-dragging"),this._trigger("start",t,this.ui()),this._mouseDrag(t),!0},e.prototype._mouseDrag=function(t){var e=t.pageX-this.originalMousePosition.left||0;return this.currentData={},this.currentData.margin=Math.max(0,this.originalData.margin+e),this._trigger("drag",t,this.ui()),this.element.css("marginLeft",this.currentData.margin),!0},e.prototype._mouseStop=function(t){return this._trigger("stop",t,this.ui()),!0},e.prototype.ui=function(){return{currentData:this.currentData}},e}),N2D("UIDraggableDelay",["UIMouse"],function(i,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UIDraggable",this.widgetEventPrefix="drag",this.options=i.extend({drag:null,start:null,stop:null},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this._mouseInit()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype._mouseStart=function(t){return this.currentData=this.originalData={width:parseInt(this.element.width())},this.originalMousePosition={left:t.pageX},this.element.addClass("nui-draggable-dragging"),this._trigger("start",t,this.ui()),this._mouseDrag(t),!0},e.prototype._mouseDrag=function(t){var e=t.pageX-this.originalMousePosition.left||0;return this.currentData={},this.currentData.width=Math.max(0,this.originalData.width+e),this._trigger("drag",t,this.ui()),this.element.width(this.currentData.width),!0},e.prototype._mouseStop=function(t){return this._trigger("stop",t,this.ui()),!0},e.prototype.ui=function(){return{currentData:this.currentData}},e}),N2D("UIDraggable",["UIMouse"],function(o,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UIDraggable",this.widgetEventPrefix="drag",this.options=o.extend(!0,{addClasses:!0,appendTo:"parent",axis:!1,containment:!1,cursor:"auto",cursorAt:!1,handle:!1,helper:"original",scroll:!0,scrollSensitivity:20,scrollSpeed:20,min:{top:!1,left:!1},drag:null,start:null,stop:null},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("nui-draggable"),this._setHandleClassName(),this._mouseInit()},e.prototype._setPositionRelative=function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},e.prototype._getHandle=function(t){return!this.options.handle||!!o(t.target).closest(this.element.find(this.options.handle)).length},e.prototype._setHandleClassName=function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("nui-draggable-handle")},e.prototype._mouseCapture=function(t){var e=this.options;return!(this.helper||e.disabled||0<o(t.target).closest(".nui_resize_absolute").length)&&(this.handle=this._getHandle(t),!!this.handle&&(this._blurActiveElement(t),!0))},e.prototype.cancel=function(){return this.helper.is(".nui-draggable-dragging")?this._mouseUp(new o.Event("mouseup",{target:this.element[0]})):this._clear(),this},o.fn.nuiScrollParent=function(t){var e=this.css("position"),i="absolute"===e,s=t?/(auto|scroll|hidden)/:/(auto|scroll)/,n=this.parents().filter(function(){var t=o(this);return(!i||"static"!==t.css("position"))&&s.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&n.length?n:o(this[0].ownerDocument||document)},e.prototype._mouseStart=function(t){var e=this.options;return this.helper=this._createHelper(t),this.helper.addClass("nui-draggable-dragging"),this._cacheHelperProportions(),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.nuiScrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===o(this).css("position")}).length,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),this._mouseDrag(t,!0),!0)},e.prototype._mouseDrag=function(t,e){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!e){var i=this._uiHash();if(!1===this._trigger("drag",t,i))return this._mouseUp(new o.Event("mouseup",t)),!1;this.position=i.position}return!1!==this.options.min.top&&(this.position.top=Math.max(this.position.top,this.options.min.top)),!1!==this.options.min.left&&(this.position.left=Math.max(this.position.left,this.options.min.left)),this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",!1},e.prototype._mouseStop=function(t){return!1!==this._trigger("stop",t)&&this._clear(),!1},e.prototype._mouseUp=function(t){return this.handleElement.is(t.target)&&this.element.trigger("focus"),N2Classes.UIMouse.prototype._mouseUp.call(this,t)},e.prototype._trigger=function(t,e,i){return i=i||this._uiHash(),N2Classes.UIWidgetBase.prototype._trigger.call(this,t,e,i)},e.prototype._uiHash=function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition}},e.prototype._createHelper=function(t){var e=this.options,i=o.isFunction(e.helper),s=i?o(e.helper.apply(this.element[0],[t])):"clone"===e.helper?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo("parent"===e.appendTo?this.element[0].parentNode:e.appendTo),i&&s[0]===this.element[0]&&this._setPositionRelative(),s[0]===this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s},e.prototype._cacheHelperProportions=function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},e.prototype._cacheMargins=function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},e.prototype._refreshOffsets=function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},e.prototype._getParentOffset=function(){var t=this.offsetParent.offset(),e=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==e&&o.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},e.prototype._getRelativeOffset=function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},e.prototype._convertPositionTo=function(t,e){e=e||this.position;var i="absolute"===t?1:-1,s=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)*i}},e.prototype._setContainment=function(){var t,e,i,s=this.options,n=this.document[0];this.relativeContainer=null,s.containment?"window"!==s.containment?"document"!==s.containment?s.containment.constructor!==Array?("parent"===s.containment&&(s.containment=this.helper[0].parentNode),(i=(e=o(s.containment))[0])&&(t=/(scroll|auto)/.test(e.css("overflow")),this.containment=[(parseInt(e.css("borderLeftWidth"),10)||0)+(parseInt(e.css("paddingLeft"),10)||0),(parseInt(e.css("borderTopWidth"),10)||0)+(parseInt(e.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(e.css("borderRightWidth"),10)||0)-(parseInt(e.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(e.css("borderBottomWidth"),10)||0)-(parseInt(e.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=e)):this.containment=s.containment:this.containment=[0,0,o(n).width()-this.helperProportions.width-this.margins.left,(o(n).height()||n.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=[o(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,o(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,o(window).scrollLeft()+o(window).width()-this.helperProportions.width-this.margins.left,o(window).scrollTop()+(o(window).height()||n.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:this.containment=null},e.prototype._adjustOffsetFromHelper=function(t){"string"==typeof t&&(t=t.split(" ")),o.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},e.prototype._isRootNode=function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},e.prototype._generatePosition=function(t,e){var i,s,n=this.options,o=this._isRootNode(this.scrollParent[0]),r=t.pageX,a=t.pageY;return o&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(i=this.relativeContainer?(s=this.relativeContainer.offset(),[this.containment[0]+s.left,this.containment[1]+s.top,this.containment[2]+s.left,this.containment[3]+s.top]):this.containment,t.pageX-this.offset.click.left<i[0]&&(r=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(a=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(r=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(a=i[3]+this.offset.click.top)),"y"===n.axis&&(r=this.originalPageX),"x"===n.axis&&(a=this.originalPageY)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:o?0:this.offset.scroll.top),left:r-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:o?0:this.offset.scroll.left)}},e.prototype._clear=function(){this.helper.removeClass("nui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()};return e.prototype._blurActiveElement=function(t){var e,i=function(e){var i;try{i=e.activeElement}catch(t){i=e.body}return(i=i||e.body).nodeName||(i=e.body),i}(this.document[0]);o(t.target).closest(i).length||(e=i)&&"body"!==e.nodeName.toLowerCase()&&o(e).trigger("blur")},e}),N2D("UIFileUpload",["UIWidgetBase"],function(m,v){"use strict";function t(i){var s="dragover"===i;return function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var e=t.dataTransfer;e&&-1!==e.types.indexOf("Files")&&!1!==this._trigger(i,m.Event(i,{delegatedEvent:t}))&&(t.preventDefault(),s&&(e.dropEffect="copy"))}}function e(t,e){this.element=t,this.widgetName=this.widgetName||"UIFileUpload",this.options=m.extend({dropZone:m(document),pasteZone:v,fileInput:v,replaceFileInput:!0,paramName:v,singleFileUploads:!0,limitMultiFileUploads:v,limitMultiFileUploadSize:v,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:v,forceIframeTransport:!1,redirect:v,redirectParamName:v,postMessage:v,multipart:!0,maxChunkSize:v,uploadedBytes:v,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(i,t){return i=this.messages[i]||i.toString(),t&&m.each(t,function(t,e){i=i.replace("{"+t+"}",e)}),i},formData:function(t){return t.serializeArray()},add:function(t,e){if(t.isDefaultPrevented())return!1;(e.autoUpload||!1!==e.autoUpload&&m(this).UIFileUpload("option","autoUpload"))&&e.process().done(function(){e.submit()})},processData:!1,contentType:!1,cache:!1},this.options,e),N2Classes.UIWidgetBase.prototype.constructor.apply(this,arguments),this._specialOptions=["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],this.create()}return m.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||m('<input type="file">').prop("disabled")),m.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),m.support.xhrFormDataFileUpload=!!window.FormData,m.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),((e.prototype=Object.create(N2Classes.UIWidgetBase.prototype)).constructor=e).prototype._blobSlice=m.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},e.prototype._BitrateTimer=function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(t,e,i){var s=t-this.timestamp;return this.bitrate&&i&&!(i<s)||(this.bitrate=(e-this.loaded)*(1e3/s)*8,this.loaded=e,this.timestamp=t),this.bitrate}},e.prototype._isXHRUpload=function(t){return!t.forceIframeTransport&&(!t.multipart&&m.support.xhrFileUpload||m.support.xhrFormDataFileUpload)},e.prototype._getFormData=function(t){var i;return"function"===m.type(t.formData)?t.formData(t.form):m.isArray(t.formData)?t.formData:"object"===m.type(t.formData)?(i=[],m.each(t.formData,function(t,e){i.push({name:t,value:e})}),i):[]},e.prototype._getTotal=function(t){var i=0;return m.each(t,function(t,e){i+=e.size||1}),i},e.prototype._initProgressObject=function(t){var e={loaded:0,total:0,bitrate:0};t._progress?m.extend(t._progress,e):t._progress=e},e.prototype._initResponseObject=function(t){var e;if(t._response)for(e in t._response)t._response.hasOwnProperty(e)&&delete t._response[e];else t._response={}},e.prototype._onProgress=function(t,e){if(t.lengthComputable){var i,s=Date.now?Date.now():(new Date).getTime();if(e._time&&e.progressInterval&&s-e._time<e.progressInterval&&t.loaded!==t.total)return;e._time=s,i=Math.floor(t.loaded/t.total*(e.chunkSize||e._progress.total))+(e.uploadedBytes||0),this._progress.loaded+=i-e._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(s,this._progress.loaded,e.bitrateInterval),e._progress.loaded=e.loaded=i,e._progress.bitrate=e.bitrate=e._bitrateTimer.getBitrate(s,i,e.bitrateInterval),this._trigger("progress",m.Event("progress",{delegatedEvent:t}),e),this._trigger("progressall",m.Event("progressall",{delegatedEvent:t}),this._progress)}},e.prototype._initProgressListener=function(i){var s=this,t=i.xhr?i.xhr():m.ajaxSettings.xhr();t.upload&&(m(t.upload).bind("progress",function(t){var e=t.originalEvent;t.lengthComputable=e.lengthComputable,t.loaded=e.loaded,t.total=e.total,s._onProgress(t,i)}),i.xhr=function(){return t})},e.prototype._isInstanceOf=function(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"},e.prototype._initXHRData=function(i){var s,n=this,t=i.files[0],e=i.multipart||!m.support.xhrFileUpload,o="array"===m.type(i.paramName)?i.paramName[0]:i.paramName;i.headers=m.extend({},i.headers),i.contentRange&&(i.headers["Content-Range"]=i.contentRange),e&&!i.blob&&this._isInstanceOf("File",t)||(i.headers["Content-Disposition"]='attachment; filename="'+encodeURI(t.name)+'"'),e?m.support.xhrFormDataFileUpload&&(i.postMessage?(s=this._getFormData(i),i.blob?s.push({name:o,value:i.blob}):m.each(i.files,function(t,e){s.push({name:"array"===m.type(i.paramName)&&i.paramName[t]||o,value:e})})):(n._isInstanceOf("FormData",i.formData)?s=i.formData:(s=new FormData,m.each(this._getFormData(i),function(t,e){s.append(e.name,e.value)})),i.blob?s.append(o,i.blob,t.name):m.each(i.files,function(t,e){(n._isInstanceOf("File",e)||n._isInstanceOf("Blob",e))&&s.append("array"===m.type(i.paramName)&&i.paramName[t]||o,e,e.uploadName||e.name)})),i.data=s):(i.contentType=t.type||"application/octet-stream",i.data=i.blob||t),i.blob=null},e.prototype._initIframeSettings=function(t){var e=m("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&e&&e!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},e.prototype._initDataSettings=function(t){this._isXHRUpload(t)?(this._chunkedUpload(t,!0)||(t.data||this._initXHRData(t),this._initProgressListener(t)),t.postMessage&&(t.dataType="postmessage "+(t.dataType||""))):this._initIframeSettings(t)},e.prototype._getParamName=function(t){var e=m(t.fileInput),s=t.paramName;return s?m.isArray(s)||(s=[s]):(s=[],e.each(function(){for(var t=m(this),e=t.prop("name")||"files[]",i=(t.prop("files")||[1]).length;i;)s.push(e),--i}),s.length||(s=[e.prop("name")||"files[]"])),s},e.prototype._initFormSettings=function(t){t.form&&t.form.length||(t.form=m(t.fileInput.prop("form")),t.form.length||(t.form=m(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===m.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},e.prototype._getAJAXSettings=function(t){var e=m.extend({},this.options,t);return this._initFormSettings(e),this._initDataSettings(e),e},e.prototype._getDeferredState=function(t){return t.state?t.state():t.isResolved()?"resolved":t.isRejected()?"rejected":"pending"},e.prototype._enhancePromise=function(t){return t.success=t.done,t.error=t.fail,t.complete=t.always,t},e.prototype._getXHRPromise=function(t,e,i){var s=m.Deferred(),n=s.promise();return e=e||this.options.context||n,!0===t?s.resolveWith(e,i):!1===t&&s.rejectWith(e,i),n.abort=s.promise,this._enhancePromise(n)},e.prototype._addConvenienceMethods=function(t,i){function s(t){return m.Deferred().resolveWith(n,t).promise()}var n=this;i.process=function(t,e){return(t||e)&&(i._processQueue=this._processQueue=(this._processQueue||s([this])).pipe(function(){return i.errorThrown?m.Deferred().rejectWith(n,[i]).promise():s(arguments)}).pipe(t,e)),this._processQueue||s([this])},i.submit=function(){return"pending"!==this.state()&&(i.jqXHR=this.jqXHR=!1!==n._trigger("submit",m.Event("submit",{delegatedEvent:t}),this)&&n._onSend(t,this)),this.jqXHR||n._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",n._trigger("fail",null,this),n._getXHRPromise(!1))},i.state=function(){return this.jqXHR?n._getDeferredState(this.jqXHR):this._processQueue?n._getDeferredState(this._processQueue):void 0},i.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===n._getDeferredState(this._processQueue)},i.progress=function(){return this._progress},i.response=function(){return this._response}},e.prototype._getUploadedBytes=function(t){var e=t.getResponseHeader("Range"),i=e&&e.split("-"),s=i&&1<i.length&&parseInt(i[1],10);return s&&s+1},e.prototype._chunkedUpload=function(o,t){o.uploadedBytes=o.uploadedBytes||0;var e,r,a=this,i=o.files[0],l=i.size,d=o.uploadedBytes,h=o.maxChunkSize||l,c=this._blobSlice,p=m.Deferred(),s=p.promise();return!(!(this._isXHRUpload(o)&&c&&(d||h<l))||o.data)&&(!!t||(l<=d?(i.error=o.i18n("uploadedBytes"),this._getXHRPromise(!1,o.context,[null,"error",i.error])):(r=function(){var s=m.extend({},o),n=s._progress.loaded;s.blob=c.call(i,d,d+h,i.type),s.chunkSize=s.blob.size,s.contentRange="bytes "+d+"-"+(d+s.chunkSize-1)+"/"+l,a._initXHRData(s),a._initProgressListener(s),e=(!1!==a._trigger("chunksend",null,s)&&m.ajax(s)||a._getXHRPromise(!1,s.context)).done(function(t,e,i){d=a._getUploadedBytes(i)||d+s.chunkSize,n+s.chunkSize-s._progress.loaded&&a._onProgress(m.Event("progress",{lengthComputable:!0,loaded:d-s.uploadedBytes,total:d-s.uploadedBytes}),s),o.uploadedBytes=s.uploadedBytes=d,s.result=t,s.textStatus=e,s.jqXHR=i,a._trigger("chunkdone",null,s),a._trigger("chunkalways",null,s),d<l?r():p.resolveWith(s.context,[t,e,i])}).fail(function(t,e,i){s.jqXHR=t,s.textStatus=e,s.errorThrown=i,a._trigger("chunkfail",null,s),a._trigger("chunkalways",null,s),p.rejectWith(s.context,[t,e,i])})},this._enhancePromise(s),s.abort=function(){return e.abort()},r(),s)))},e.prototype._beforeSend=function(t,e){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(e),this._initProgressObject(e),e._progress.loaded=e.loaded=e.uploadedBytes||0,e._progress.total=e.total=this._getTotal(e.files)||1,e._progress.bitrate=e.bitrate=0,this._active+=1,this._progress.loaded+=e.loaded,this._progress.total+=e.total},e.prototype._onDone=function(t,e,i,s){var n=s._progress.total,o=s._response;s._progress.loaded<n&&this._onProgress(m.Event("progress",{lengthComputable:!0,loaded:n,total:n}),s),o.result=s.result=t,o.textStatus=s.textStatus=e,o.jqXHR=s.jqXHR=i,this._trigger("done",null,s)},e.prototype._onFail=function(t,e,i,s){var n=s._response;s.recalculateProgress&&(this._progress.loaded-=s._progress.loaded,this._progress.total-=s._progress.total),n.jqXHR=s.jqXHR=t,n.textStatus=s.textStatus=e,n.errorThrown=s.errorThrown=i,this._trigger("fail",null,s)},e.prototype._onAlways=function(t,e,i,s){this._trigger("always",null,s)},e.prototype._onSend=function(t,e){e.submit||this._addConvenienceMethods(t,e);function i(){return a._sending+=1,l._bitrateTimer=new a._BitrateTimer,s=s||((n||!1===a._trigger("send",m.Event("send",{delegatedEvent:t}),l))&&a._getXHRPromise(!1,l.context,n)||a._chunkedUpload(l)||m.ajax(l)).done(function(t,e,i){a._onDone(t,e,i,l)}).fail(function(t,e,i){a._onFail(t,e,i,l)}).always(function(t,e,i){if(a._onAlways(t,e,i,l),--a._sending,--a._active,l.limitConcurrentUploads&&l.limitConcurrentUploads>a._sending)for(var s=a._slots.shift();s;){if("pending"===a._getDeferredState(s)){s.resolve();break}s=a._slots.shift()}0===a._active&&a._trigger("stop")})}var s,n,o,r,a=this,l=a._getAJAXSettings(e);return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?((r=1<this.options.limitConcurrentUploads?(o=m.Deferred(),this._slots.push(o),o.pipe(i)):(this._sequence=this._sequence.pipe(i,i),this._sequence)).abort=function(){return n=[v,"abort","abort"],s?s.abort():(o&&o.rejectWith(l.context,n),i())},this._enhancePromise(r)):i()},e.prototype._onAdd=function(s,n){var o,t,r,e,a=this,l=!0,i=m.extend({},this.options,n),d=n.files,h=d.length,c=i.limitMultiFileUploads,p=i.limitMultiFileUploadSize,u=i.limitMultiFileUploadSizeOverhead,f=0,g=this._getParamName(i),y=0;if(!p||h&&d[0].size!==v||(p=v),(i.singleFileUploads||c||p)&&this._isXHRUpload(i))if(i.singleFileUploads||p||!c)if(!i.singleFileUploads&&p)for(r=[],o=[],e=0;e<h;e+=1)f+=d[e].size+u,(e+1===h||f+d[e+1].size+u>p||c&&c<=e+1-y)&&(r.push(d.slice(y,e+1)),(t=g.slice(y,e+1)).length||(t=g),o.push(t),y=e+1,f=0);else o=g;else for(r=[],o=[],e=0;e<h;e+=c)r.push(d.slice(e,e+c)),(t=g.slice(e,e+c)).length||(t=g),o.push(t);else r=[d],o=[g];return n.originalFiles=d,m.each(r||d,function(t,e){var i=m.extend({},n);return i.files=r?e:[e],i.paramName=o[t],a._initResponseObject(i),a._initProgressObject(i),a._addConvenienceMethods(s,i),l=a._trigger("add",m.Event("add",{delegatedEvent:s}),i)}),l},e.prototype._replaceFileInput=function(t){var i=t.fileInput,s=i.clone(!0);t.fileInputClone=s,m("<form></form>").append(s)[0].reset(),i.after(s).detach(),m.cleanData(i.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(t,e){return e===i[0]?s[0]:e}),i[0]===this.element[0]&&(this.element=s)},e.prototype._handleFileTreeEntry=function(i,s){function n(t){t&&!t.entry&&(t.entry=i),r.resolve([t])}var t,o=this,r=m.Deferred(),a=function(){t.readEntries(function(t){var e;t.length?(l=l.concat(t),a()):(e=l,o._handleFileTreeEntries(e,s+i.name+"/").done(function(t){r.resolve(t)}).fail(n))},n)},l=[];return s=s||"",i.isFile?i._file?(i._file.relativePath=s,r.resolve(i._file)):i.file(function(t){t.relativePath=s,r.resolve(t)},n):i.isDirectory?(t=i.createReader(),a()):r.resolve([]),r.promise()},e.prototype._handleFileTreeEntries=function(t,e){var i=this;return m.when.apply(m,m.map(t,function(t){return i._handleFileTreeEntry(t,e)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},e.prototype._getDroppedFiles=function(t){var e=(t=t||{}).items;return e&&e.length&&(e[0].webkitGetAsEntry||e[0].getAsEntry)?this._handleFileTreeEntries(m.map(e,function(t){var e;return t.webkitGetAsEntry?((e=t.webkitGetAsEntry())&&(e._file=t.getAsFile()),e):t.getAsEntry()})):m.Deferred().resolve(m.makeArray(t.files)).promise()},e.prototype._getSingleFileInputFiles=function(t){var e,i,s=(t=m(t)).prop("webkitEntries")||t.prop("entries");if(s&&s.length)return this._handleFileTreeEntries(s);if((e=m.makeArray(t.prop("files"))).length)e[0].name===v&&e[0].fileName&&m.each(e,function(t,e){e.name=e.fileName,e.size=e.fileSize});else{if(!(i=t.prop("value")))return m.Deferred().resolve([]).promise();e=[{name:i.replace(/^.*\\/,"")}]}return m.Deferred().resolve(e).promise()},e.prototype._getFileInputFiles=function(t){return t instanceof m&&1!==t.length?m.when.apply(m,m.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},e.prototype._onChange=function(e){var i=this,s={fileInput:m(e.target),form:m(e.target.form)};this._getFileInputFiles(s.fileInput).always(function(t){s.files=t,i.options.replaceFileInput&&i._replaceFileInput(s),!1!==i._trigger("change",m.Event("change",{delegatedEvent:e}),s)&&i._onAdd(e,s)})},e.prototype._onPaste=function(t){var e=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,s={files:[]};e&&e.length&&(m.each(e,function(t,e){var i=e.getAsFile&&e.getAsFile();i&&s.files.push(i)}),!1!==this._trigger("paste",m.Event("paste",{delegatedEvent:t}),s)&&this._onAdd(t,s))},e.prototype._onDrop=function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var i=this,t=e.dataTransfer,s={};t&&t.files&&t.files.length&&(e.preventDefault(),e.stopPropagation(),this._getDroppedFiles(t).always(function(t){s.files=t,!1!==i._trigger("drop",m.Event("drop",{delegatedEvent:e}),s)&&i._onAdd(e,s)}))},e.prototype._onDragOver=t("dragover"),e.prototype._onDragEnter=t("dragenter"),e.prototype._onDragLeave=t("dragleave"),e.prototype._initEventHandlers=function(){this._isXHRUpload(this.options)&&(m(this.options.dropZone).on({dragover:this._onDragOver.bind(this),drop:this._onDrop.bind(this),dragenter:this._onDragEnter.bind(this),dragleave:this._onDragLeave.bind(this)}),m(this.options.pasteZone).on({paste:this._onPaste.bind(this)})),m.support.fileInput&&m(this.options.fileInput).on({change:this._onChange.bind(this)})},e.prototype._destroyEventHandlers=function(){m(this.options.dropZone).off("dragenter dragleave dragover drop"),m(this.options.pasteZone).off("paste"),m(this.options.fileInput).off("change")},e.prototype.setOption=function(t,e){var i=-1!==this._specialOptions.indexOf(t);i&&this._destroyEventHandlers(),N2Classes.UIWidgetBase.prototype.setOption.apply(this,arguments),i&&(this._initSpecialOptions(),this._initEventHandlers())},e.prototype._initSpecialOptions=function(){var t=this.options;t.fileInput===v?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof m||(t.fileInput=m(t.fileInput)),t.dropZone instanceof m||(t.dropZone=m(t.dropZone)),t.pasteZone instanceof m||(t.pasteZone=m(t.pasteZone))},e.prototype._getRegExp=function(t){var e=t.split("/"),i=e.pop();return e.shift(),new RegExp(e.join("/"),i)},e.prototype._isRegExpOption=function(t,e){return"url"!==t&&"string"===m.type(e)&&/^\/.*\/[igm]{0,3}$/.test(e)},e.prototype._initDataAttributes=function(){var n=this,o=this.options,r=this.element.data();m.each(this.element[0].attributes,function(t,e){var i,s=e.name.toLowerCase();/^data-/.test(s)&&(s=s.slice(5).replace(/-[a-z]/g,function(t){return t.charAt(1).toUpperCase()}),i=r[s],n._isRegExpOption(s,i)&&(i=n._getRegExp(i)),o[s]=i)})},e.prototype.create=function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},e.prototype.active=function(){return this._active},e.prototype.progress=function(){return this._progress},e.prototype.add=function(e){var i=this;e&&!this.options.disabled&&(e.fileInput&&!e.files?this._getFileInputFiles(e.fileInput).always(function(t){e.files=t,i._onAdd(null,e)}):(e.files=m.makeArray(e.files),this._onAdd(null,e)))},e.prototype.send=function(e){if(e&&!this.options.disabled){if(e.fileInput&&!e.files){var i,s,n=this,o=m.Deferred(),t=o.promise();return t.abort=function(){return s=!0,i?i.abort():(o.reject(null,"abort","abort"),t)},this._getFileInputFiles(e.fileInput).always(function(t){s||(t.length?(e.files=t,(i=n._onSend(null,e)).then(function(t,e,i){o.resolve(t,e,i)},function(t,e,i){o.reject(t,e,i)})):o.reject())}),this._enhancePromise(t)}if(e.files=m.makeArray(e.files),e.files.length)return this._onSend(null,e)}return this._getXHRPromise(!1,e&&e.context)},e}),N2D("ajaxTransportIframe",function(l,d){"use strict";var s=0;l.ajaxTransport("iframe",function(n){if(n.async){var o,r,e,a=n.initialIframeSrc||"javascript:false;";return{send:function(t,i){(o=l('<form style="display:none;"></form>')).attr("accept-charset",n.formAcceptCharset),e=/\?/.test(n.url)?"&":"?","DELETE"===n.type?(n.url=n.url+e+"_method=DELETE",n.type="POST"):"PUT"===n.type?(n.url=n.url+e+"_method=PUT",n.type="POST"):"PATCH"===n.type&&(n.url=n.url+e+"_method=PATCH",n.type="POST"),r=l('<iframe src="'+a+'" name="iframe-transport-'+(s+=1)+'"></iframe>').bind("load",function(){var s,e=l.isArray(n.paramName)?n.paramName:[n.paramName];r.unbind("load").bind("load",function(){var e;try{if(!(e=r.contents()).length||!e[0].firstChild)throw new Error}catch(t){e=d}i(200,"success",{iframe:e}),l('<iframe src="'+a+'"></iframe>').appendTo(o),window.setTimeout(function(){o.remove()},0)}),o.prop("target",r.prop("name")).prop("action",n.url).prop("method",n.type),n.formData&&l.each(n.formData,function(t,e){l('<input type="hidden"/>').prop("name",e.name).val(e.value).appendTo(o)}),n.fileInput&&n.fileInput.length&&"POST"===n.type&&(s=n.fileInput.clone(),n.fileInput.after(function(t){return s[t]}),n.paramName&&n.fileInput.each(function(t){l(this).prop("name",e[t]||n.paramName)}),o.append(n.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),n.fileInput.removeAttr("form")),o.submit(),s&&s.length&&n.fileInput.each(function(t,e){var i=l(s[t]);l(e).prop("name",i.prop("name")).attr("form",i.attr("form")),i.replaceWith(e)})}),o.append(r).appendTo(document.body)},abort:function(){r&&r.unbind("load").prop("src",a),o&&o.remove()}}}}),l.ajaxSetup({converters:{"iframe text":function(t){return t&&l(t[0].body).text()},"iframe json":function(t){return t&&l.parseJSON(l(t[0].body).text())},"iframe html":function(t){return t&&l(t[0].body).html()},"iframe xml":function(t){var e=t&&t[0];return e&&l.isXMLDoc(e)?e:l.parseXML(e.XMLDocument&&e.XMLDocument.xml||l(e.body).html())},"iframe script":function(t){return t&&l.globalEval(l(t[0].body).text())}}})}),N2D("UILayerWindow",["UIMouse"],function(i,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UILayerWindow",this.widgetEventPrefix="layerWindow",this.options=i.extend(!0,{},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){this.bodyRect=document.body.getBoundingClientRect(),window.addEventListener("resize",function(){this.bodyRect=document.body.getBoundingClientRect(),this.limitHorizontal(this.left,this.width,!0),this.limitVertical(this.top,this.height,!0)}.bind(this),{passive:!0}),this.left=parseInt(localStorage.getItem("ssPanelLeft")),this.left||(this.left=200),this.top=parseInt(localStorage.getItem("ssPanelTop")),this.top||(this.top=100),this.width=355,this.height=parseInt(localStorage.getItem("ssPanelHeight")),this.height||(this.height=400),this.limitHorizontal(this.left,this.width),this.limitVertical(this.top,this.height),this._setupHandles(),this._mouseInit()},e.prototype._setupHandles=function(){this.$title=this.element.find(".n2_ss_layer_window__title_inner").on("mousedown",this._mouseDown.bind(this)),this.$resize=i('<div class="n2_ss_layer_window__resize"></div>').on("mousedown",this._mouseDown.bind(this)).appendTo(this.element)},e.prototype._mouseInit=function(){},e.prototype._mouseCapture=function(t){return this.$title.is(t.target)?(this.currentAction="move",!0):!!this.$resize.is(t.target)&&(this.currentAction="resize",!0)},e.prototype._mouseStart=function(t){var e=this.element[0].getBoundingClientRect();this.context={},"move"===this.currentAction?this.context.mouseDiff={x:t.clientX-e.left,y:t.clientY-e.top}:"resize"===this.currentAction&&(this.context.mouseDiff={y:t.clientY-e.top-e.height})},e.prototype._mouseDrag=function(t){"move"===this.currentAction?(this.limitHorizontal(t.clientX-this.context.mouseDiff.x,this.width),this.limitVertical(t.clientY-this.context.mouseDiff.y,this.height)):"resize"===this.currentAction&&this.limitVertical(this.top,t.clientY-this.top-this.context.mouseDiff.y)},e.prototype._mouseStop=function(t){"move"===this.currentAction?(this.limitHorizontal(t.clientX-this.context.mouseDiff.x,this.width,!0),this.limitVertical(t.clientY-this.context.mouseDiff.y,this.height,!0)):"resize"===this.currentAction&&this.limitVertical(this.top,t.clientY-this.top-this.context.mouseDiff.y,!0),delete this.currentAction},e.prototype.limitVertical=function(t,e,i){this.height=e,this.top=Math.min(Math.max(t,60),this.bodyRect.height-this.height),this.top<60&&(this.height=this.height+this.top-60,this.top=60),this.height=Math.max(this.height,200),this.element.css({top:this.top,height:this.height}),i&&(localStorage.setItem("ssPanelTop",this.top),localStorage.setItem("ssPanelHeight",this.height))},e.prototype.limitHorizontal=function(t,e,i){this.left=Math.min(Math.max(t,50),this.bodyRect.width-e),this.element.css({left:this.left}),i&&localStorage.setItem("ssPanelLeft",this.left)},e}),N2D("UIMouse",["UIWidgetBase"],function(n,t){"use strict";var e=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),o=!1;function i(t,e){this.widgetName=this.widgetName||"UIMouse",this.options=n.extend({cancel:"input, textarea, button, select, option",distance:1,delay:0},this.options),N2Classes.UIWidgetBase.prototype.constructor.apply(this,arguments)}return n(document).on("mouseup",function(){o=!1}),((i.prototype=Object.create(N2Classes.UIWidgetBase.prototype)).constructor=i).prototype._mouseInit=function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(t){if(!0===n.data(t.target,e.widgetName+".preventClickEvent"))return n.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1})},i.prototype._mouseDestroy=function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},i.prototype._mouseDown=function(t){if(!o){document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var e=this,i=1===t.which,s=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&n(t.target).closest(this.options.cancel).length;return i&&!s&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===n.data(t.target,this.widgetName+".preventClickEvent")&&n.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return e._mouseMove(t)},this._mouseUpDelegate=function(t){return e._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),o=!0)):!0}},i.prototype._mouseMove=function(t){if(this._mouseMoved){if(e&&(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},i.prototype._mouseUp=function(t){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted?(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&n.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)):this._mouseCancel(t),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,o=!1,t.preventDefault()},i.prototype._mouseDistanceMet=function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},i.prototype._mouseDelayMet=function(){return this.mouseDelayMet},i.prototype._mouseStart=function(){},i.prototype._mouseDrag=function(){},i.prototype._mouseStop=function(){},i.prototype._mouseCancel=function(){},i.prototype._mouseCapture=function(){return!0},i}),N2D("UIResizeBar",["UIMouse"],function(n,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UIResizable",this.widgetEventPrefix="resize",this.options=n.extend({resize:null,start:null,stop:null},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){this.options;this.element.addClass("nui_resize_bar"),this._setupHandles(),this._mouseInit(),this._trigger("create",null,{})},e.prototype._setupHandles=function(){var t=["e","w"];this.handles={},this.$handles=n();for(var e=0;e<t.length;e++){var i=t[e],s=n("<div>").addClass("nui_resize_bar__handle nui_resize_bar__handle--"+i).on({mousedown:function(t,e){this.currentHandle=t,this._mouseDown(e)}.bind(this,i)}).appendTo(this.element);this.handles[i]=s,this.$handles=this.$handles.add(s)}},e.prototype._mouseStart=function(t){this.currentData=this.originalData={margin:parseInt(this.element.css("marginLeft")),width:parseInt(this.element.width())},this.originalMousePosition={left:t.pageX};var e=this.handles[this.currentHandle].css("cursor");return n("body").css("cursor",e),this._trigger("start",t,this.ui()),!0},e.prototype._mouseDrag=function(t){var e=t.pageX-this.originalMousePosition.left||0;this.currentData={},"e"===this.currentHandle?(this.currentData.margin=this.originalData.margin,this.currentData.width=Math.max(0,this.originalData.width+e)):"w"===this.currentHandle&&(this.currentData.margin=Math.max(0,this.originalData.margin+e),this.currentData.width=Math.max(0,this.originalData.width-e)),this.currentData.width=Math.max(0,this.currentData.width),this._trigger("resize",t,this.ui()),this.element.css("marginLeft",this.currentData.margin),this.element.css("width",this.currentData.width)},e.prototype._mouseStop=function(t){n("body").css("cursor","auto"),this._trigger("stop",t,this.ui())},e.prototype.ui=function(){return{currentData:this.currentData}},e}),N2D("UISlider",["UIMouse"],function(i,e){"use strict";function t(t,e){this.element=i(t),this.widgetName=this.widgetName||"UISlider",this.widgetEventPrefix="sliding",this.options=i.extend({min:0,max:100,step:1,value:0,change:null,sliding:null,start:null,stop:null},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((t.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=t).prototype.create=function(){this._mouseSliding=!1,this._mouseInit(),this._calculateNewMax(),this.element.addClass("nui-slider nui-slider-horizontal"),this._refresh()},t.prototype.doAction=function(t){if(N2Classes.UIWidgetBase.prototype.doAction.apply(this,arguments),"value"===t)return this._value()},t.prototype.setOption=function(t,e){switch(N2Classes.UIWidgetBase.prototype.setOption.call(this,t,e),t){case"value":this._refreshValue(),this._change(null,0);break;case"step":case"min":case"max":this._calculateNewMax(),this._refreshValue()}},t.prototype._refresh=function(){this._createHandle(),this._refreshValue()},t.prototype._createHandle=function(){var t=this.element.find(".nui-slider-handle");t.length?this.handle=t:this.handle=i("<span></span>"),this.handle.addClass("nui-slider-handle").appendTo(this.element)},t.prototype._mouseCapture=function(t){var e,i,s=this.handle;return!this.options.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e),!1!==this._start(t)&&(this._mouseSliding=!0,s.trigger("focus"),this._slide(t,i),!0))},t.prototype._mouseStart=function(){return this.lastValue=Number.MAX_VALUE,!0},t.prototype._mouseDrag=function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this.lastValue!=i&&(this._slide(t,i),this.lastValue=i),!1},t.prototype._mouseStop=function(t){return this._mouseSliding=!1,this._stop(t),this._change(t),!1},t.prototype._mouseCancel=function(t){this._trigger("cancel",t)},t.prototype._normValueFromMouse=function(t){var e,i,s=this.elementSize.width,n=(t.x-this.elementOffset.left)/s;return 1<n&&(n=1),n<0&&(n=0),e=this._valueMax()-this._valueMin(),i=this._valueMin()+n*e,this._trimAlignValue(i)},t.prototype._trimAlignValue=function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=0<this.options.step?this.options.step:1,i=(t-this._valueMin())%e,s=t-i;return 2*Math.abs(i)>=e&&(s+=0<i?e:-e),parseFloat(s.toFixed(5))},t.prototype._calculateNewMax=function(){var t=this.options.max,e=this._valueMin(),i=this.options.step;(t=Math.round((t-e)/i)*i+e)>this.options.max&&(t-=i),this.max=parseFloat(t.toFixed(this._precision()))},t.prototype._precision=function(){var t=this._precisionOf(this.options.step);return null!==this.options.min&&(t=Math.max(t,this._precisionOf(this.options.min))),t},t.prototype._precisionOf=function(t){var e=t.toString(),i=e.indexOf(".");return-1===i?0:e.length-i-1},t.prototype._change=function(t){this._mouseSliding||this._trigger("change",t,this._uiHash())},t.prototype.value=function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},t.prototype._value=function(){var t=this.options.value;return t=this._trimAlignValue(t)},t.prototype._valueMin=function(){return this.options.min},t.prototype._valueMax=function(){return this.max},t.prototype._refreshValue=function(){var t=this.value(),e=this._valueMin(),i=this._valueMax(),s=i!==e?(t-e)/(i-e)*100:0;this.handle.css("left",s+"%")},t.prototype._uiHash=function(t){return{handle:this.handle[0],value:t!==e?t:this.value()}},t.prototype._start=function(t){return this._trigger("start",t,this._uiHash())},t.prototype._slide=function(t,e){e!==this.value()&&!1!==this._trigger("sliding",t,this._uiHash(e))&&this.value(e)},t.prototype._stop=function(t){this._trigger("stop",t,this._uiHash())},t}),N2D("UISortable",["UIMouse"],function(a,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UISortable",this.widgetEventPrefix="sortable",this.options=a.extend({items:"> *",handle:"",placeholder:!1,helper:"original",forcePlaceholderSize:!1,forceHelperSize:!1,axis:!1,droppables:!1},this.options,e),this.isOver=!1,N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){this._mouseInit()},e.prototype._mouseCapture=function(t){if(this.options.disabled)return!1;var e=null,i=a(t.target);if(""!==this.options.handle){var s=this.element.find(this.options.items+" "+this.options.handle);if(-1===s.index(i)&&!s.has(i).length)return!1}var n=this.element.find(this.options.items);return!!(e=-1!==n.index(i)?i:n.has(i)).length&&(this.currentItem=e,!0)},e.prototype._mouseStart=function(t){this._trigger("beforestart",t,{currentItem:this.currentItem}),this.context={e:t,original:{pageX:t.pageX,pageY:t.pageY,clientX:t.clientX,clientY:t.clientY,elementBCR:this.element[0].getBoundingClientRect(),currentItemBCR:this.currentItem[0].getBoundingClientRect()},offsetShift:{top:0,left:0},scrollCB:this._mouseScroll.bind(this)},this.element.addClass("n2-ui-sortable-in-progress"),this._cacheItems(),this.placeholder=a("<div></div>").addClass(this.options.placeholder||this.currentItem[0].className);var e={width:this.currentItem.width(),height:this.currentItem.height()};"clone"===this.options.helper?this.helper=this.currentItem.clone():"clone_hide"===this.options.helper?(this.helper=this.currentItem.clone(),this.currentItem.css("display","none")):this.helper=this.currentItem,this.options.forceHelperSize&&this.helper.css(e),this.options.forcePlaceholderSize&&this.placeholder.css(e),this.helper.addClass("n2-ui-sortable-helper").css({position:"absolute",zIndex:1e3}).appendTo(this.element),this._trigger("start",t,this.ui()),window.addEventListener("scroll",this.context.scrollCB,{capture:!0,passive:!0})},e.prototype._mouseDrag=function(t){this.context.e=t;var e,i,s=this.element[0].getBoundingClientRect(),n={};this.options.axis&&"x"!==this.options.axis||(e=s.left+this.context.original.clientX-t.clientX,this.context.offsetShift.left=t.pageX-this.context.original.pageX-this.context.original.elementBCR.left+e,n.left=this.context.original.currentItemBCR.left-e),this.options.axis&&"y"!==this.options.axis||(i=s.top+this.context.original.clientY-t.clientY,this.context.offsetShift.top=t.pageY-this.context.original.pageY-this.context.original.elementBCR.top+i,n.top=this.context.original.currentItemBCR.top-i),this.helper.css(n);var o=this._findClosestItem(t),r="before"===o[1]?this.items[Math.max(0,o[2]-1)]:this.items[Math.min(this.items.length-1,o[2])];"clone"===this.options.helper&&(o[0].is(this.currentItem)||a(r).is(this.currentItem))?this.placeholder.detach():this.positionPlaceholder(o),this.options.droppables&&("over"!==o[1]?this.isOver&&(this._trigger("out",t,this.ui()),this.isOver=!1):(this.isOver&&!this.isOver.is(o[0])&&(this._trigger("out",t,this.ui()),this.isOver=!1),this.isOver||(this.isOver=o[0],this._trigger("over",t,this.ui()))))},e.prototype.positionPlaceholder=function(t){switch(t[1]){case"before":this.placeholder.insertBefore(t[0]);break;case"after":this.placeholder.insertAfter(t[0]);break;case"over":this.placeholder.detach()}},e.prototype._mouseStop=function(t){this.context.e=t,this._trigger("beforestop",t,this.ui()),window.removeEventListener("scroll",this.context.scrollCB,{capture:!0,passive:!0}),this.placeholder.remove();var e=this._findClosestItem(t);switch(e[1]){case"before":this.currentItem.insertBefore(e[0]);break;case"after":this.currentItem.insertAfter(e[0])}this.helper.removeClass("n2-ui-sortable-helper").css({position:"",zIndex:"",left:"",top:""}),"clone"!==this.options.helper&&"clone_hide"!==this.options.helper||this.helper.remove(),"clone_hide"===this.options.helper&&this.currentItem.css("display",""),this.element.removeClass("n2-ui-sortable-in-progress"),"over"===e[1]?(this._trigger("drop",t,this.ui()),this._trigger("out",t,this.ui())):this._trigger("stop",t,this.ui()),this.currentItem=null},e.prototype._findClosestItem=function(t){for(var e,i,s,n=Number.MAX_VALUE,o=t.pageX-this.context.offsetShift.left,r=t.pageY-this.context.offsetShift.top,a=0;a<this.itemsData.length;a++){var l=this.itemsData[a];for(var d in l.side){var h=Math.sqrt(Math.pow((o-l.side[d].left)/l.width,2)+Math.pow((r-l.side[d].top)/l.height,2));h<n&&(n=h,e=l.item,"after"===(i=d)?s=a+1:"before"===d&&(s=a))}}return[e,i,s]},e.prototype.getItems=function(){return this.element.find(this.options.items)},e.prototype._cacheItems=function(){this.items=this.getItems(),this.itemsData=[];for(var t,e,i,s,n,o=0;o<this.items.length;o++){"original"===this.options.helper&&this.items[o]===this.currentItem[0]||(t=this.items.eq(o).offset(),e=this.items.eq(o).width(),i=this.items.eq(o).height(),s={},this.options.droppables&&!this.currentItem.hasClass(this.options.droppables)&&this.items.eq(o).hasClass(this.options.droppables)?(s.before={left:t.left+e/6,top:t.top+i/6},s.over={left:t.left+3*e/6,top:t.top+3*i/6},s.after={left:t.left+5*e/6,top:t.top+5*i/6}):(s.before={left:t.left+e/4,top:t.top+i/4},s.after={left:t.left+3*e/4,top:t.top+3*i/4}),window.n2const.isRTL()&&(n=s.after,s.after=s.before,s.before=n),this.itemsData.push({item:this.items.eq(o),side:s,width:e,height:i}))}},e.prototype._mouseScroll=function(){var t=this.context.e;document.dispatchEvent(new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY}))},e.prototype.ui=function(){return{placeholder:this.placeholder,helper:this.helper,item:this.currentItem,droppable:this.isOver}},e}),N2D("UIWidgetBase",function(r,t){"use strict";function e(t,e){var i=t[0];this.document=r(i.style?i.ownerDocument:i.document||i),this.window=r(this.document[0].defaultView||this.document[0].parentWindow),this.disabled=!1,this.plugins=[]}return e.prototype.setOption=function(t,e){return this.options[t]=e,this},e.prototype.destroy=function(){return this},e.prototype._trigger=function(t,e,i){var s,n,o=this.options[t];if(i=i||{},(e=r.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],n=e.originalEvent)for(s in n)s in e||(e[s]=n[s]);return this.element.trigger(e,i),!(r.isFunction(o)&&!1===o.apply(this.element[0],[e].concat(i))||e.isDefaultPrevented())},e.prototype._triggerInteraction=function(){this.element.trigger("interaction")},e.addPlugin=function(t,e,i){for(var s in i)t.plugins[s]=t.plugins[s]||[],t.plugins[s].push([e,i[s]])},e.prototype.callPlugin=function(t,e,i){var s=this.constructor.plugins[t];if(s&&(i||this.element[0].parentNode&&11!==this.element[0].parentNode.nodeType))for(var n=0;n<s.length;n++)this.options[s[n][0]]&&s[n][1].apply(this.element,e)},e}),N2D("NextendVisualCore",function(t,s){function e(t,e){this.id=t.id,this.visualManager=e,this.setValue(t.value,!1),this.visual=t,this.visualManager.visuals[this.id]=this}return e.prototype.compare=function(t){for(var e=Math.max(this.value.length,t.length),i=0;i<e;i++)if(!this._compareTab(this.value[i]===s?{}:this.value[i],t[i]===s?{}:t[i]))return!1;return!0},e.prototype._compareTab=function(t,e){var i=Object.getOwnPropertyNames(t),s=Object.getOwnPropertyNames(e);if(0===t.length&&0===s.length)return!0;if(i.length!=s.length)return!1;for(var n=0;n<i.length;n++){var o=i[n];if(t[o]!==e[o])return!1}return!0},e.prototype.setValue=function(t,e){var i,s=null,s="string"==typeof t?("{"!=(i=t)[0]?(this.base64=i,i=N2Classes.Base64.decode(i)):this.base64=N2Classes.Base64.encode(i),JSON.parse(i)):t;this.name=s.name,this.value=s.data,e&&this.render()},e.prototype.isSystem=function(){return 1==this.visual.system},e.prototype.isEditable=function(){return 1==this.visual.editable},e.prototype.activate=function(t,e){t&&t.preventDefault(),this.visualManager.changeActiveVisual(this),"function"==typeof e?this.visualManager.controller.asyncVisualData(this.value,this.visualManager.showParameters,e):this.visualManager.controller.load(this.value,!1,this.visualManager.showParameters)},e.prototype.active=function(){},e.prototype.notActive=function(){},e.prototype.delete=function(t){t&&t.preventDefault(),this._delete()},e.prototype._delete=function(){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.visualManager.parameters.ajaxUrl,{nextendaction:"deleteVisual"}),data:{visualId:this.id},dataType:"json"}).done(function(t){t.data.visual;this.visualManager.activeVisual&&this.id==this.visualManager.activeVisual.id&&this.visualManager.changeActiveVisual(null),delete this.visualManager.visuals[this.id],delete this.set.visuals[this.id],this.row.remove(),this.visualManager.$.trigger("visualDelete",[this.id]),N2Classes.Notification.success(n2_("Deleted."))}.bind(this))},e.prototype.render=function(){},e.prototype.isUsed=function(){return!1},e}),N2D("NextendFragmentEditorController",["NextendFragmentEditorControllerWithEditor"],function(n,i){function t(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.constructor.apply(this,arguments),this.clearTabButton=n("#n2-"+this.type+"-editor"+this.type+"-clear-tab").on("click",this.clearCurrentTab.bind(this)),this.$tabField=n("#n2-"+this.type+"-editor"+this.type+"-state").on("nextendChange.n2-editor",this.tabChanged.bind(this)),this.$tabContainer=n("#n2-"+this.type+"-editor"+this.type+"-state_tab")}return((t.prototype=Object.create(N2Classes.NextendFragmentEditorControllerWithEditor.prototype)).constructor=t).prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.loadDefaults.call(this),this.currentTabIndex=0,this._renderTimeout=!1,this._delayStart=0},t.prototype._load=function(t,e,i){this.currentVisual=[];for(var s=0;s<t.length;s++)this.currentVisual[s]=n.extend(!0,this.getCleanVisual(),t[s]);this.localModePreview={},this.mode=i.previewMode,!1===e&&(e=this.getTabs());for(s=this.currentVisual.length;s<e.length;s++)this.currentVisual[s]=this.getCleanVisual();if(!1!==i.previewHTML&&""!==i.previewHTML&&(this.localModePreview[i.previewMode]=i.previewHTML),this.setPreview(),!1===e){e=[];for(s=0;s<this.currentVisual.length;s++)e.push("#"+s)}this.setTabs(e)},t.prototype.getCleanVisual=function(){return{}},t.prototype.getTabs=function(){return[]},t.prototype.setTabs=function(t){for(var e=this.$tabField.data("field"),i={},s=0;s<t.length;s++)i[s]=t[s];e.setOptions(i,this.$tabContainer,"0"),e.insideChange("0")},t.prototype.tabChanged=function(){document.activeElement&&document.activeElement.blur();var t=this.$tabField.val();this.currentTabIndex=t,this.currentVisual[t]===i&&(this.currentVisual[t]={});var e=n.extend({},this.currentVisual[0]);"0"!==t?(n.extend(e,this.currentVisual[t]),this.clearTabButton.css("display","")):this.clearTabButton.css("display","none"),this.editor.load(e),this._tabChanged()},t.prototype._tabChanged=function(){this.renderCSS()},t.prototype.clearCurrentTab=function(t){t&&t.preventDefault(),this.currentVisual[this.currentTabIndex]={},this.tabChanged(),this.renderCSS()},t.prototype.setPreview=function(){},t.prototype.propertyChanged=function(t,e,i){this.isChanged=!0,this.currentVisual[this.currentTabIndex][e]=i,this.renderPreview()},t.prototype.renderPreview=function(){var t=n.now();this._renderTimeout?(clearTimeout(this._renderTimeout),100<t-this._delayStart&&(this.renderCSS(),this._delayStart=t)):this._delayStart=t,this._renderTimeout=setTimeout(this.renderCSS.bind(this),33)},t.prototype.renderCSS=function(){this._renderTimeout=!1},t}),N2D("NextendFragmentEditorControllerWithEditor",function(s,t){function e(){this.loadDefaults(),this.lightbox=s("#n2-lightbox-"+this.type),this.editor=this.initEditor(),this.editor.$.on("change",this.propertyChanged.bind(this))}return e.prototype.loadDefaults=function(){this.type="",this.isChanged=!1,this.visible=!1},e.prototype.pause=function(){},e.prototype.getEmptyVisual=function(){return[]},e.prototype.get=function(){return this.currentVisual},e.prototype.initEditor=function(){return new N2Classes.NextendFragmentEditor},e.prototype.propertyChanged=function(t,e,i){this.isChanged=!0,this.currentVisual[e]=i},e.prototype.load=function(t,e,i){this.isChanged=!1,this._load(t,e,i)},e.prototype._load=function(t,e,i){this.currentVisual=s.extend(!0,{},t),this.loadToEditor()},e.prototype.loadToEditor=function(){this.editor.load(this.currentVisual)},e.prototype.show=function(){this.visible=!0,N2Classes.WindowManager.addWindow("visual")},e.prototype.close=function(){this.visible=!1,N2Classes.WindowManager.removeWindow()},e}),N2D("CSSRenderer",function(c,o){function t(){}return t.prototype.decodeData=function(t){if("object"==typeof t)return t;if(""===t)return!1;"{"!==t[0]&&(t=N2Classes.Base64.decode(t));var e=JSON.parse(t);return e.data!==o&&e.data},t.prototype.getCSS=function(t,e,i,s,n){n=c.extend({deleteRule:!1},n);var o="",r=new RegExp("@pre","g"),a=new RegExp("@selector","g");for(var l in s.selectors){var d=l.replace(r,t).replace(a,e);o+=d+"{\n"+s.selectors[l]+"}\n",n.deleteRule&&nextend.css.deleteRule(d)}if(s.renderOptions.combined)for(var h=0;h<i.length;h++)o=o.replace(new RegExp("@tab"+h,"g"),this.render(i[h]));else for(h=0;h<i.length;h++)i[h]=c.extend({},i[h]),o=o.replace(new RegExp("@tab"+h,"g"),this.render(i[h]));return o},t.prototype.render=function(t){var e=this.makeVisualData(t),i="",s="";for(var n in e.raw!==o&&(s=e.raw,delete e.raw),e)i+=this.deCase(n)+": "+e[n]+";\n";return i+=s},t.prototype.makeVisualData=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&"function"!=typeof t[i]&&this["makeStyle"+i](t[i],e);return e},t.prototype.deCase=function(t){return t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})},t}),N2D("NextendFragmentEditor",function(t,e){function i(){this.fields={},this.$=t(this)}return i.prototype.load=function(t){this._off(),this._on()},i.prototype._on=function(){for(var t in this.fields)this.fields[t].element.on(this.fields[t].events)},i.prototype._off=function(){for(var t in this.fields)this.fields[t].element.off(".n2-editor")},i.prototype.trigger=function(t,e){this.$.trigger("change",[t,e])},i}),N2D("NextendVisualWithSet",["NextendVisualCore"],function(t,e){function i(t,e,i){this.set=e,N2Classes.NextendVisualCore.prototype.constructor.call(this,t,i)}return((i.prototype=Object.create(N2Classes.NextendVisualCore.prototype)).constructor=i).prototype.active=function(){var t=this.set.set.id;this.visualManager.changeSet(t),N2Classes.NextendVisualCore.prototype.active.call(this)},i}),N2D("NextendVisualWithSetRow",["NextendVisualWithSet"],function(t,e){function i(){N2Classes.NextendVisualWithSet.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.NextendVisualWithSet.prototype)).constructor=i).prototype.createRow=function(){return this.row=t('<div class="n2_fullscreen_editor__visual"></div>').append(t('<div class="n2_fullscreen_editor__visual_label"></div>').text(this.name).on("click",this.activate.bind(this))),this.isSystem()||this.row.append(t('<div class="n2_fullscreen_editor__visual_actions"></div>').append(t('<div class="n2_fullscreen_editor__visual_action"><i class="ssi_16 ssi_16--delete"></i></div>').on("click",this.delete.bind(this)))),this.row},i.prototype.setValue=function(t,e){N2Classes.NextendVisualWithSet.prototype.setValue.call(this,t,e),this.row&&this.row.find(".n2_fullscreen_editor__visual_label").text(this.name)},i.prototype.active=function(){this.row.addClass("n2_fullscreen_editor__visual--active"),N2Classes.NextendVisualWithSet.prototype.active.call(this)},i.prototype.notActive=function(){this.row.removeClass("n2_fullscreen_editor__visual--active"),N2Classes.NextendVisualWithSet.prototype.notActive.call(this)},i}),N2D("NextendVisualWithSetRowMultipleSelection",["NextendVisualWithSetRow"],function(e,t){function i(t,e,i){this.checked=!1,t.system=1,t.editable=0,N2Classes.NextendVisualWithSetRow.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.NextendVisualWithSetRow.prototype)).constructor=i).prototype.createRow=function(){var t=N2Classes.NextendVisualWithSetRow.prototype.createRow.call(this);return this.checkbox=e('<div class="n2_fullscreen_editor__visual_select_tick"><i class="ssi_16 ssi_16--check"></i></div>').on("click",this.checkOrUnCheck.bind(this)).prependTo(t),t},i.prototype.setValue=function(t,e){this.name=t.name,this.value=t.data,this.row&&this.row.find(".n2_fullscreen_editor__visual_label").text(this.name),e&&this.render()},i.prototype.activate=function(t,e){t&&t.preventDefault(),this.visualManager.changeActiveVisual(this),this.visualManager.controller.setAnimationProperties(this.value)},i.prototype.checkOrUnCheck=function(t){t.preventDefault(),t.stopPropagation(),this.checked?this.unCheck():this.check()},i.prototype.check=function(){this.checked=!0,this.row.addClass("n2_fullscreen_editor__visual--selected"),this.activate()},i.prototype.unCheck=function(){this.checked=!1,this.row.removeClass("n2_fullscreen_editor__visual--selected"),this.activate()},i}),N2D("NextendVisualSetsManager",function(e,t){return function(t){this.visualManager=t,this.$=e(this)}}),N2D("NextendVisualSet",function(i,s){function t(t,e){this.set=t,this.visualManager=e,this.visualList=i('<div class="n2_fullscreen_editor__visual_list"></div>'),this.visualManager.sets[t.id]=this,""!==t.referencekey&&(this.visualManager.setsByReference[t.referencekey]=t),this.visualManager.setsSelector&&(this.option=i('<option value="'+t.id+'"></option>').text(t.value).appendTo(this.visualManager.setsSelector))}return t.prototype.active=function(){i.when(this._loadVisuals()).done(function(){this.visualList.appendTo(this.visualManager.visualListContainer)}.bind(this))},t.prototype.notActive=function(){this.visualList.detach()},t.prototype.loadVisuals=function(t){if(this.visuals===s){this.visuals={};for(var e=0;e<t.length;e++)this.addVisual(t[e])}},t.prototype._loadVisuals=function(){return null!=this.visuals||N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.visualManager.parameters.ajaxUrl,{nextendaction:"loadVisualsForSet"}),data:{setId:this.set.id},dataType:"json"}).done(function(t){this.loadVisuals(t.data.visuals)}.bind(this))},t.prototype.addVisual=function(t){return this.visuals[t.id]===s&&(this.visuals[t.id]=this.visualManager.createVisual(t,this),this.visualList.append(this.visuals[t.id].createRow())),this.visuals[t.id]},t.prototype.rename=function(t){this.set.value=t,this.option.text(t)},t.prototype.delete=function(){this.option.remove(),delete this.visualManager.sets[this.set.id]},t}),N2D("NextendVisualManagerCore",function(s,n){function t(t){this.loadDefaults(),this.$=s(this),(window.nextend[this.type+"Manager"]=this).lightbox=s("#n2-lightbox-"+this.type),this.lightbox.find(".n2_fullscreen_editor__overlay").on("click",this.hide.bind(this)),this.visualListContainer=s('<div class="n2_fullscreen_editor__visual_list_container"></div>').appendTo(this.lightbox.find(".n2_fullscreen_editor__content_sidebar")),this.parameters=t,this.visuals={},this.controller=this.initController(),this.controller&&(this.renderer=this.controller.renderer),this.firstLoadVisuals(t.visuals),this.lightbox.find(".n2_fullscreen_editor__save_as_new").on("click",this.saveAsNew.bind(this)),this.cancelButton=this.lightbox.find(".n2_fullscreen_editor__cancel").on("click",this.hide.bind(this)),this.saveButton=this.lightbox.find(".n2_fullscreen_editor__save"),this.setVisual!==n&&this.saveButton.on("click",this.setVisual.bind(this))}return t.prototype.loadDefaults=function(){this.mode="linked",this.labels={visual:"visual",visuals:"visuals"},this.visualLoadDeferreds={},this.showParameters=!1},t.prototype.firstLoadVisuals=function(t){for(var e in t)this.sets[e].loadVisuals(t[e])},t.prototype.initController=function(){},t.prototype.getVisual=function(t){if(0<parseInt(t)){if(this.visuals[t]!==n)return this.visuals[t];if(this.visualLoadDeferreds[t]!==n)return this.visualLoadDeferreds[t];var e=s.Deferred();return this.visualLoadDeferreds[t]=e,this._loadVisualFromServer(t).done(function(){e.resolve(this.visuals[t]),delete this.visualLoadDeferreds[t]}.bind(this)).fail(function(){e.resolve({id:-1,name:n2_("Empty")}),delete this.visualLoadDeferreds[t]}.bind(this)),e}try{var i=t;return"{"!=i[0]&&(i=N2Classes.Base64.decode(i)),JSON.parse(i),{id:0,name:n2_("Static")}}catch(t){return{id:-1,name:n2_("Empty")}}},t.prototype._loadVisualFromServer=function(t){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.parameters.ajaxUrl,{nextendaction:"loadVisual"}),data:{visualId:t},dataType:"json"})},t.prototype.show=function(t,e,i){N2Classes.Esc.add(function(){return this.hide(),!0}.bind(this)),this.showParameters=s.extend({previewMode:!1,previewHTML:!1},i),s("body").addClass("n2_body--fullscreen-editor-visible"),this.lightbox.addClass("n2_fullscreen_editor--visible"),this.loadDataToController(t),this.$.on("save",e),this._show()},t.prototype._show=function(){s(":focus").blur(),this.controller.show(),s(window).on({"keydown.visual":function(t){"TEXTAREA"===t.target.tagName||"INPUT"===t.target.tagName||t.target.isContentEditable||13===t.keyCode&&this.saveButton.trigger("click")}.bind(this)})},t.prototype.setAndClose=function(t){this.$.trigger("save",[t])},t.prototype.hide=function(t){this.controller.pause(),t!==n&&(t.preventDefault(),N2Classes.Esc.pop()),this.controller.close(),this.$.off("save"),s("body").removeClass("n2_body--fullscreen-editor-visible"),this.lightbox.removeClass("n2_fullscreen_editor--visible"),s(window).off("keydown.visual")},t.prototype.getDataFromController=function(t,e,i){return this.showParameters=s.extend({previewMode:!1,previewHTML:!1},e),this.loadDataToController(t,i)},t.prototype.loadDataToController=function(e){this.isVisualData(e)?s.when(this.getVisual(e)).done(function(t){0<t.id?t.activate():console.error(e+" visual is not found linked")}.bind(this)):console.error(e+" visual not found")},t.prototype.isVisualData=function(t){return 0<parseInt(t)},t.prototype.saveAsNew=function(t){t.preventDefault();var i=new N2Classes.ModalSimple("section-save-as",{destroyOnHide:!1,width:440});i.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--plus","green")),i.addContent(N2Classes.UI.modalHeading(n2_("Save as")));var e=N2Classes.UI.modalFormRow(!0);i.addContent(e);var s=N2Classes.UI.modalFieldText(e,"name",n2_("Name"),""),n=N2Classes.UI.modalButton(n2_("Save as New"),"green");i.addButton(n),n.on("click",function(t){t.preventDefault();var e=s.val();""===e?N2Classes.Notification.error(n2_("Please fill the name field!")):this._saveAsNew(e).done(i.hide.bind(i,t),N2Classes.Notification.success(n2_("Saved.")))}.bind(this)),i.show()},t.prototype._saveAsNew=function(t){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.parameters.ajaxUrl,{nextendaction:"addVisual"}),data:{setId:this.getSetValue(),value:N2Classes.Base64.encode(JSON.stringify({name:t,data:this.controller.get("saveAsNew")}))},dataType:"json"}).done(function(t){var e=t.data.visual;this.changeActiveVisual(this.sets[e.referencekey].addVisual(e))}.bind(this))},t.prototype.saveActiveVisual=function(t){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.parameters.ajaxUrl,{nextendaction:"changeVisual"}),data:{visualId:this.activeVisual.id,value:this.getBase64(t)},dataType:"json"}).done(function(t){this.activeVisual.setValue(t.data.visual.value,!0)}.bind(this))},t.prototype.changeActiveVisual=function(t){this.activeVisual&&(this.activeVisual.notActive(),this.activeVisual=!1),t&&("static"==this.mode&&this.setMode("linked"),t.active(),this.activeVisual=t)},t.prototype.getBase64=function(t){return N2Classes.Base64.encode(JSON.stringify({name:t,data:this.controller.get("set")}))},t}),N2D("NextendVisualManagerMultipleSelection",["NextendVisualManagerVisibleSets"],function(r,t){function e(t){(window.nextend[this.type+"Manager"]=this)._lateInit=function(t){N2Classes.NextendVisualManagerVisibleSets.prototype.constructor.call(this,t)}.bind(this,t)}return((e.prototype=Object.create(N2Classes.NextendVisualManagerVisibleSets.prototype)).constructor=e).prototype.lateInit=function(){this.inited||(this.inited=!0,this._lateInit())},e.prototype.show=function(t,e,i){this.lateInit(),N2Classes.Esc.add(function(){return this.hide(),!0}.bind(this)),r("body").addClass("n2_body--fullscreen-editor-visible"),this.lightbox.addClass("n2_fullscreen_editor--visible");var s=0;if(""!=t)for(var n=t.split("||"),o=!1;s<n.length;s++)r.when(this.getVisual(n[s])).done(function(t){t&&t.check&&(t.check(),o||(o=!0,t.activate()))});this.$.on("save",e),this.controller.start(i),0==s&&r.when(this.activeSet._loadVisuals()).done(function(){for(var t in this.activeSet.visuals){this.activeSet.visuals[t].activate();break}}.bind(this)),this._show()},e.prototype.setVisual=function(t){t.preventDefault(),this.setAndClose(this.getAsString()),this.hide(t)},e.prototype.getAsString=function(){var t=[];for(var e in this.sets){var i=this.sets[e];for(var s in i.visuals)i.visuals[s].checked&&t.push(i.visuals[s].id)}return 0==t.length&&this.activeVisual&&t.push(this.activeVisual.id),t.join("||")},e.prototype.hide=function(t){for(var e in N2Classes.NextendVisualManagerVisibleSets.prototype.hide.apply(this,arguments),this.sets){var i=this.sets[e];for(var s in i.visuals)i.visuals[s].unCheck()}},e}),N2D("NextendVisualManagerSetsAndMore",["NextendVisualManagerVisibleSets"],function(s,n){function t(){N2Classes.NextendVisualManagerVisibleSets.prototype.constructor.apply(this,arguments),this.setMode(0)}return((t.prototype=Object.create(N2Classes.NextendVisualManagerVisibleSets.prototype)).constructor=t).prototype.setMode=function(t){if("static"==t&&this.changeActiveVisual(null),this.mode!=t){switch(t){case 0:this.cancelButton.css("display","none"),this.saveButton.off("click");break;case"static":default:this.cancelButton.css("display","inline-block"),this.saveButton.off("click").on("click",this.setVisualAsStatic.bind(this))}this.mode=t}},t.prototype.loadDataToController=function(t,e){if(0<parseInt(t))s.when(this.getVisual(t)).done(function(t){0<t.id?(this.setMode("linked"),t.activate(n,e)):(this.setMode("static"),"function"==typeof e?this.controller.asyncVisualData("",this.showParameters,e):this.controller.load("",!1,this.showParameters))}.bind(this));else{var i="";this.setMode("static");try{i=this.getStaticData(t)}catch(t){}"function"==typeof e?this.controller.asyncVisualData(i,this.showParameters,e):this.controller.load(i,!1,this.showParameters)}},t.prototype.getStaticData=function(t){var e=t;"{"!==e[0]&&(e=N2Classes.Base64.decode(e));var i=JSON.parse(e).data;return i===n?"":i},t.prototype.setVisualAsStatic=function(t){t.preventDefault(),this.setAndClose(this.getBase64(n2_("Static"))),this.hide(t)},t}),N2D("NextendVisualManagerVisibleSets",["NextendVisualManagerCore"],function(s,e){function t(){N2Classes.NextendVisualManagerCore.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.NextendVisualManagerCore.prototype)).constructor=t).prototype.firstLoadVisuals=function(t){this.sets={},this.setsByReference={},this.setsSelector=s("#"+this.parameters.setsIdentifier+"sets_select");for(var e=0;e<this.parameters.sets.length;e++)this.newVisualSet(this.parameters.sets[e]);for(var i in this.initSetsManager(),t)this.sets[i].loadVisuals(t[i]);this.activeSet=this.sets[this.getSetValue()],this.activeSet.active(),this.setsSelector.length&&this.setsSelector.on("change",function(){this.activeSet.notActive(),this.activeSet=this.sets[this.getSetValue()],this.activeSet.active()}.bind(this))},t.prototype.initSetsManager=function(){new N2Classes.NextendVisualSetsManager(this)},t.prototype._loadVisualFromServer=function(t){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.parameters.ajaxUrl,{nextendaction:"loadSetByVisualId"}),data:{visualId:t},dataType:"json"}).done(function(t){this.sets[t.data.set.setId].loadVisuals(t.data.set.visuals)}.bind(this))},t.prototype.changeSet=function(t){this.getSetValue()!=t&&this.setsSelector.val(t).trigger("change")},t.prototype.changeSetById=function(t){this.sets[t]!==e&&this.changeSet(t)},t.prototype.newVisualSet=function(t){return new N2Classes.NextendVisualSet(t,this)},t.prototype.getSetValue=function(){return this.setsSelector.length?this.setsSelector.val():this.parameters.fixedSet},t}),N2D("NextendBrowse",function(n,t){var s={};function o(t,e){var i=n('<div class="n2_modal_filesystem_box n2_modal_filesystem_box--file" title="'+t+'"><div class="n2-button n2-button-icon n2-button-s n2-button-blue"><i class="ssi_16 ssi_16--check"></i></div><div class="n2_modal_filesystem_box__label">'+t+"</div></div>"),s=t.split(".").pop();return"mp4"!==s&&"mp3"!==s?n('<div class="n2_modal_filesystem_box__image"></div>').css("background-image","url("+encodeURI(nextend.imageHelper.fixed(e))+")").prependTo(i):n('<div class="n2_modal_filesystem_box__icon"><i class="ssi_64 ssi_64--dummy"></i></div>').prependTo(i),i}function e(t,e){this.url=t,this.uploadAllowed=parseInt(e),this.currentPath=localStorage.getItem("browsePath")||"";var i=null;this.node=n('<div class="n2_modal_filesystem__content"></div>').on("dragover",function(t){null!==i?(clearTimeout(i),i=null):n(t.currentTarget).addClass("n2-drag-over"),i=setTimeout(function(){n(t.currentTarget).removeClass("n2-drag-over"),i=null},400)}),nextend.browse=this}return e.prototype.clear=function(){this.uiFileUpload&&this.uiFileUpload.destroy(),this.node.empty()},e.prototype.getNode=function(t,e){return this.clear(),this.node.attr("data-mode",t),"multiple"===(this.mode=t)&&(this.selected=[]),this.callback=e,this._loadPath(this.getCurrentFolder(),this._renderBoxes.bind(this)),this.node},e.prototype._renderBoxes=function(t){for(var e in this.clear(),localStorage.setItem("browsePath",this.getCurrentFolder()),n('<div class="n2_modal_filesystem__current_path">'+n2_("Current path")+": "+t.fullPath+"</div>").appendTo(this.node),this.uploadAllowed&&this.initUpload(),""!==t.path&&n('<div class="n2_modal_filesystem_box n2_modal_filesystem_box--directory-up"><div class="n2_modal_filesystem_box__icon"><i class="ssi_64 ssi_64--folderup"></i></div><div class="n2_modal_filesystem_box__label">'+n2_("Parent directory")+"</div></div>").appendTo(this.node).on("click",function(t){this._loadPath(t,this._renderBoxes.bind(this))}.bind(this,t.path+"/..")),t.directories)t.directories.hasOwnProperty(e)&&n('<div class="n2_modal_filesystem_box n2_modal_filesystem_box--directory"><div class="n2_modal_filesystem_box__icon"><i class="ssi_64 ssi_64--folder"></i></div><div class="n2_modal_filesystem_box__label">'+e+"</div></div>").appendTo(this.node).on("click",function(t){this._loadPath(t,this._renderBoxes.bind(this))}.bind(this,t.directories[e]));var i;for(var s in t.files){t.files.hasOwnProperty(s)&&(i=o(s,t.files[s]).appendTo(this.node).on("click",this.clickImage.bind(this,t.files[s])),"multiple"===this.mode&&-1!==this.selected.indexOf(t.files[s])&&i.addClass("n2_modal_filesystem_box--active"))}},e.prototype._loadPath=function(e,i){s[e]===t&&(s[e]=N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.url),data:{path:e},dataType:"json"})),n.when(s[e]).done(function(t){this.currentPath=t.data.path,s[t.data.path]=t,s[e]=t,i(t.data)}.bind(this))},e.prototype.initUpload=function(){n('<div class="n2_modal_filesystem_box n2_modal_filesystem_box--upload"><input id="n2-browse-upload" type="file" name="image" multiple></div>').append('<div class="n2_modal_filesystem_box__icon"><i class="ssi_48 ssi_48--drop"></i></div>').append('<div class="n2_modal_filesystem_box__label">'+n2_("Drop files here or")+' <a href="#">'+n2_("Upload")+"</a></div>").appendTo(this.node),this.uiFileUpload=new N2Classes.UIFileUpload(this.node.find("#n2-browse-upload"),{url:N2Classes.AjaxHelper.makeAjaxUrl(this.url,{nextendaction:"upload"}),sequentialUploads:!0,dropZone:this.node,pasteZone:!1,dataType:"json",paramName:"image",add:function(t,e){e.box=n('<div class="n2_modal_filesystem_box n2_modal_filesystem_box--file"><div class="n2_modal_filesystem_box__label">0%</div></div>').appendTo(this.node),e.formData={path:this.currentPath},e.submit()}.bind(this),progress:function(t,e){var i=parseInt(e.loaded/e.total*100,10);e.box.find(".n2_modal_filesystem_box__label").text(i+"%")},done:function(t,e){e.box.remove();var i=e.result;i.data&&i.data.name&&(s[i.data.path].data.files[i.data.name]=i.data.url,o(i.data.name,i.data.url).appendTo(this.node).on("click",this.clickImage.bind(this,i.data.url)),"multiple"===this.mode&&(this.selected.push(i.data.url),e.box.addClass("n2_modal_filesystem_box--active"))),N2Classes.AjaxHelper.notification(i)}.bind(this),fail:function(t,e){e.box.remove(),N2Classes.AjaxHelper.notification(e.jqXHR.responseJSON)}.bind(this)})},e.prototype.clickImage=function(t,e){var i;"single"===this.mode?this.callback(t):"multiple"===this.mode&&(-1===(i=this.selected.indexOf(t))?(n(e.currentTarget).addClass("n2_modal_filesystem_box--active"),this.selected.push(t)):(n(e.currentTarget).removeClass("n2_modal_filesystem_box--active"),this.selected.splice(i,1)))},e.prototype.getSelected=function(){return this.selected},e.prototype.getCurrentFolder=function(){return this.currentPath},e}),N2D("IconPack",function(i,e){function t(t,e){this.currentQuery="",this.manager=t,this.data=e,this.$li=i('<div class="n2_modal_icons__list_item">'+e.label+"</div>").on("click",function(t){t.preventDefault(),this.activate()}.bind(this)).appendTo(this.manager.$list)}return t.prototype.load=function(){this.data.isLoaded===e&&(i("head").append("<link rel='stylesheet' href='"+this.data.css+"' type='text/css' media='screen'>"),this.data.isLoaded=!0)},t.prototype.render=function(){if(this.table===e){for(var t in this.table=N2Classes.UI.modalFormTable(this.data.label),this.data.data)i('<div class="n2_modal_icons__icon" data-identifier="'+this.data.id+":"+t+'" data-kw="'+this.data.data[t].kw.toLowerCase()+'">'+this._render(t)+"</div>").on("click",function(t){this.manager.selectIcon(i(t.currentTarget).data("identifier"),t)}.bind(this)).appendTo(this.table.$content);this.$icons=this.table.$content.find(".n2_modal_icons__icon")}},t.prototype.activate=function(){this.manager.activate(this),this.$li.addClass("n2_modal_icons__list_item--active"),this.load(),this.render(),this.search(this.manager.getQuery()),console.log(this.table.$table),this.manager.$content.append(this.table.$table)},t.prototype.search=function(t){var e;this.currentQuery!==t&&(t.length<=1?this.$icons.css("display",""):(e=this.$icons.filter("[data-kw*='"+t+"']"),this.$icons.not(e).css("display","none"),e.css("display",""))),this.currentQuery=t},t.prototype.deActivate=function(){this.$li.removeClass("n2_modal_icons__list_item--active"),this.table.$table.detach()},t.prototype._render=function(t){return this.data.isLigature?'<i class="n2i '+this.data.class+'">'+t+"</i>":'<i class="n2i '+this.data.class+" "+this.data.prefix+t+'"></i>'},t.prototype.getIcon=function(t){return this.data.isLigature?{class:this.data.class,ligature:t}:{class:this.data.class+" "+this.data.prefix+t,ligature:""}},t}),N2D("Icons",function(s,o){function t(t){for(var e in(N2Classes.Icons=this).data=t,this.$list=s('<div class="n2_modal_icons__list"></div>'),this.iconPacks={},this.data)this.iconPacks[this.data[e].id]=new N2Classes.IconPack(this,this.data[e]);this.defaultId=Object.keys(this.iconPacks)[0]}return t.prototype.render=function(t){var e=t.split(":");if(2!==e.length)return!1;var i=e[0],s=e[1];if(this.iconPacks[i]===o)return!1;var n=this.iconPacks[i];return n.data.data[s]!==o&&(n.load(),n.getIcon(s))},t.prototype.showModal=function(t,e){this.callback=t;var i=!1;this.modal===o&&(i=!0,this.startModal());var s=!1,n=e.split(":");this.iconPacks[n[0]]!==o&&(this.iconPacks[n[0]].activate(),s=!0),i&&!s&&this.iconPacks[this.defaultId].activate(),this.modal.show()},t.prototype.selectIcon=function(t,e){this.callback(t),this.modal.hide(e)},t.prototype.startModal=function(){this.modal=new N2Classes.ModalLightbox(n2_("Icons"),"icons");var t=s('<div class="n2_modal__sidebar n2_form--dark"></div>');this.modal.addContent(t),this.$sidebar=s('<div class="n2_modal__sidebar_inner"></div>').appendTo(t);var e=s('<div class="n2_modal_icons__search_area" />').appendTo(this.$sidebar);this.$searchField=N2Classes.UI.modalFieldText(e,"search-icon",!1,"").attr("placeholder",n2_("Search")).on("keyup",function(t){this.activePack.search(this.$searchField.val())}.bind(this)),this.$list.appendTo(this.$sidebar);var i=s('<div class="n2_modal__content"></div>');this.$content=s('<div class="n2_modal__content_inner"></div>').appendTo(i),this.modal.addContent(i)},t.prototype.activate=function(t){this.activePack!==o&&this.activePack.deActivate(),this.activePack=t},t.prototype.getQuery=function(){return this.$searchField.val()},t}),N2D("NextendFontServiceGoogle",function(n,s){function t(t,e,i,s){this.style=t,this.subset=e,this.fonts=i,this.loadedFamilies=s,n(window).on("n2Family",this.loadFamily.bind(this))}return t.prototype.loadFamily=function(t,e){var i=e.toLowerCase();return this.fonts[i]!==s&&-1===this.loadedFamilies.indexOf(this.fonts[i])?(n("<link />").attr({rel:"stylesheet",type:"text/css",href:"//fonts.googleapis.com/css?family="+encodeURIComponent(this.fonts[i]+":"+this.style)+"&subset="+encodeURIComponent(this.subset)}).appendTo(n("head")),this.loadedFamilies.push(this.fonts[i]),this.fonts[i]):e},t}),N2D("NextendFontEditor",["NextendFragmentEditor"],function(t,e){function i(){N2Classes.NextendFragmentEditor.prototype.constructor.apply(this,arguments),this.fields={family:{element:t("#n2-font-editorfamily"),events:{"nextendChange.n2-editor":this.changeFamily.bind(this)}},color:{element:t("#n2-font-editorcolor"),events:{"outsideChange.n2-editor":this.changeColor.bind(this)}},size:{element:t("#n2-font-editorsize"),events:{"outsideChange.n2-editor":this.changeSize.bind(this)}},lineHeight:{element:t("#n2-font-editorlineheight"),events:{"outsideChange.n2-editor":this.changeLineHeight.bind(this)}},weight:{element:t("#n2-font-editorweight"),events:{"outsideChange.n2-editor":this.changeWeight.bind(this)}},decoration:{element:t("#n2-font-editordecoration"),events:{"outsideChange.n2-editor":this.changeDecoration.bind(this)}},align:{element:t("#n2-font-editortextalign"),events:{"outsideChange.n2-editor":this.changeAlign.bind(this)}},shadow:{element:t("#n2-font-editortshadow"),events:{"outsideChange.n2-editor":this.changeShadow.bind(this)}},letterSpacing:{element:t("#n2-font-editorletterspacing"),events:{"outsideChange.n2-editor":this.changeLetterSpacing.bind(this)}},wordSpacing:{element:t("#n2-font-editorwordspacing"),events:{"outsideChange.n2-editor":this.changeWordSpacing.bind(this)}},textTransform:{element:t("#n2-font-editortexttransform"),events:{"outsideChange.n2-editor":this.changeTextTransform.bind(this)}},css:{element:t("#n2-font-editorextracss"),events:{"outsideChange.n2-editor":this.changeCSS.bind(this)}}}}return((i.prototype=Object.create(N2Classes.NextendFragmentEditor.prototype)).constructor=i).prototype.load=function(t){this._off();var e=t.afont.split("||");this.fields.family.element.data("field").insideChange(e[0]),this.fields.color.element.data("field").insideChange(t.color),this.fields.size.element.data("field").insideChange(t.size.split("||").join("|*|")),this.fields.lineHeight.element.data("field").insideChange(t.lineheight),this.fields.weight.element.data("field").insideChange(t.weight),this.fields.decoration.element.data("field").insideChange([1==t.italic?"italic":"",1==t.underline?"underline":""].join("||")),this.fields.align.element.data("field").insideChange(t.align),this.fields.shadow.element.data("field").insideChange(t.tshadow.replace(/\|\|px/g,"")),this.fields.letterSpacing.element.data("field").insideChange(t.letterspacing),this.fields.wordSpacing.element.data("field").insideChange(t.wordspacing),this.fields.textTransform.element.data("field").insideChange(t.texttransform),this.fields.css.element.data("field").insideChange(t.extra),this._on()},i.prototype.changeFamily=function(){this.trigger("afont",this.fields.family.element.val())},i.prototype.changeColor=function(){this.trigger("color",this.fields.color.element.val())},i.prototype.changeSize=function(){this.trigger("size",this.fields.size.element.val().replace("|*|","||"))},i.prototype.changeLineHeight=function(){this.trigger("lineheight",this.fields.lineHeight.element.val())},i.prototype.changeWeight=function(){this.trigger("weight",this.fields.weight.element.val())},i.prototype.changeDecoration=function(){var t=this.fields.decoration.element.val(),e=0;-1!=t.indexOf("italic")&&(e=1),this.trigger("italic",e);var i=0;-1!=t.indexOf("underline")&&(i=1),this.trigger("underline",i)},i.prototype.changeAlign=function(){this.trigger("align",this.fields.align.element.val())},i.prototype.changeShadow=function(){this.trigger("tshadow",this.fields.shadow.element.val())},i.prototype.changeLetterSpacing=function(){this.trigger("letterspacing",this.fields.letterSpacing.element.val())},i.prototype.changeWordSpacing=function(){this.trigger("wordspacing",this.fields.wordSpacing.element.val())},i.prototype.changeTextTransform=function(){this.trigger("texttransform",this.fields.textTransform.element.val())},i.prototype.changeCSS=function(){this.trigger("extra",this.fields.css.element.val())},i}),N2D("NextendFontEditorController",["NextendFragmentEditorController"],function($,undefined){function NextendFontEditorController(){this.css=[],N2Classes.NextendFragmentEditorController.prototype.constructor.apply(this,arguments),this.preview=$('<div class="n2_form__table_preview"></div>').css("fontSize",N2Classes.CSSRendererFont.fontSize+"px").appendTo('.n2_form__table[data-field="table-font-preview"]'),this.initBackgroundColor()}return NextendFontEditorController.prototype=Object.create(N2Classes.NextendFragmentEditorController.prototype),NextendFontEditorController.prototype.constructor=NextendFontEditorController,NextendFontEditorController.prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorController.prototype.loadDefaults.call(this),this.type="font",this.preview=null},NextendFontEditorController.prototype.initEditor=function(){return new N2Classes.NextendFontEditor},NextendFontEditorController.prototype.getCleanVisual=function(){return N2Classes.CSSRendererFont.getEmpty()},NextendFontEditorController.prototype.initBackgroundColor=function(){this.$background=$("#n2-font-editorpreview-background").on("nextendChange",function(){this.preview.css("background","#"+this.$background.val())}.bind(this)),this.preview.css("background","#"+this.$background.val())},NextendFontEditorController.prototype.getTabs=function(){return N2Classes.CSSRendererFont.rendererModes[this.mode].tabs},NextendFontEditorController.prototype.renderCSS=function(){this._renderTimeout=!1,this.clearCSS();var t=N2Classes.CSSRendererFont.addCSS("",this.getPreviewCssClass(),this.currentVisual,N2Classes.CSSRendererFont.rendererModes[this.mode]);this.css.push(t)},NextendFontEditorController.prototype.setPreview=function(){var fontClassName=this.getPreviewCssClass(),styleClassName=nextend.fontManager.styleClassName,styleClassName2=nextend.fontManager.styleClassName2,data={fontClassName:fontClassName,styleClassName:styleClassName,styleClassName2:styleClassName2},html="";this.localModePreview[this.mode]!==undefined?(this.preview.html(""),this.preview.append(N2Classes[this.localModePreview[this.mode]].renderFont(nextend.fontManager.fieldID,data))):(html=N2Classes.CSSRendererFont.rendererModes[this.mode].preview,html=html.replace(/\{([^]*?)\}/g,function(match,script){return eval(script)}),this.preview.html(html))},NextendFontEditorController.prototype.getPreviewCssClass=function(){return"n2-"+this.type+"-editor-preview"},NextendFontEditorController.prototype.pause=function(){this.clearCSS()},NextendFontEditorController.prototype.clearCSS=function(){for(var t=0;t<this.css.length;t++)this.css[t].destroy();this.css=[]},NextendFontEditorController}),N2D("NextendFontManager",function(s,i){function t(){this.$=s(this),this.showParameters=!1,this.type="font",this.css=[],this.styleClassName="",this.styleClassName2="",(window.nextend.fontManager=this).lightbox=s("#n2-lightbox-"+this.type),this.lightbox.find(".n2_fullscreen_editor__overlay").on("click",this.hide.bind(this)),this.controller=this.initController(),this.lightbox.find(".n2_fullscreen_editor__cancel").on("click",this.hide.bind(this)),this.saveButton=this.lightbox.find(".n2_fullscreen_editor__save").on("click",this.setVisualAsStatic.bind(this))}return t.prototype.initController=function(){return new N2Classes.NextendFontEditorController},t.prototype.setFieldID=function(t){this.fieldID=t},t.prototype.setConnectedStyle=function(t){var e=s("#"+t).data("field").renderStyle();this.css.push(e),this.styleClassName=e.getBaseClassName()},t.prototype.setConnectedStyle2=function(t){var e=s("#"+t).data("field").renderStyle();this.css.push(e),this.styleClassName2=e.getBaseClassName()},t.prototype.setAndClose=function(t){this.$.trigger("save",[t])},t.prototype.setVisualAsStatic=function(t){t.preventDefault(),this.setAndClose(JSON.stringify({data:this.controller.get("set")})),this.hide(t)},t.prototype.hide=function(t){this.controller.pause();for(var e=0;e<this.css.length;e++)this.css[e].destroy();this.css=[],t!==i&&(t.preventDefault(),N2Classes.Esc.pop()),this.controller.close(),this.$.off("save"),s("body").removeClass("n2_body--fullscreen-editor-visible"),this.lightbox.removeClass("n2_fullscreen_editor--visible"),s(window).off("keydown.visual")},t.prototype.loadDataToController=function(t){this.controller.load(N2Classes.CSSRendererFont.parseRawData(t),!1,this.showParameters)},t.prototype.show=function(t,e,i){N2Classes.Esc.add(function(){return this.hide(),!0}.bind(this)),this.showParameters=s.extend({previewMode:!1,previewHTML:!1},i),s("body").addClass("n2_body--fullscreen-editor-visible"),this.lightbox.addClass("n2_fullscreen_editor--visible"),this.loadDataToController(t),this.controller.show(),this.$.on("save",e),this._show()},t.prototype._show=function(){s(":focus").blur(),s(window).on({"keydown.visual":function(t){"TEXTAREA"===t.target.tagName||"INPUT"===t.target.tagName||t.target.isContentEditable||13===t.keyCode&&this.saveButton.trigger("click")}.bind(this)})},t}),N2D("CSSRendererFont",["CSSRenderer"],function(l,d){function t(){}((t.prototype=Object.create(N2Classes.CSSRenderer.prototype)).constructor=t).prototype.getCSS=function(t,e,i,s,n){if(!1===(i=this.decodeData(i)))return"";if((i=l.extend([],i))[0]=l.extend(N2Classes.CSSRendererFont.getDefault(),i[0]),s.renderOptions.combined)for(var o,r,a=1;a<i.length;a++){i[a]=l.extend({},i[a-1],i[a]),i[a].size===i[0].size?i[a].size="100||%":(o=i[0].size.split("||"),r=i[a].size.split("||"),2===o.length&&2===r.length&&"px"===o[1]&&"px"===r[1]&&(i[a].size=Math.round(r[0]/o[0]*100)+"||%"))}return t===d&&(t=N2Classes.CSSRendererFont.pre),N2Classes.CSSRenderer.prototype.getCSS.call(this,t,e,i,s,n)},t.prototype.makeStylecolor=function(t,e){e.color="#"+t.substr(0,6)+";\ncolor: "+N2Color.hex2rgbaCSS(t)},t.prototype.makeStylesize=function(t,e){var i=t.split("||");"px"===i[1]?e.fontSize=i[0]/N2Classes.CSSRendererFont.fontSize*100+"%":e.fontSize=t.replace("||","")},t.prototype.makeStyletshadow=function(t,e){var i=t.split("|*|");"0"==i[0]&&"0"==i[1]&&"0"==i[2]?e.textShadow="none":e.textShadow=i[0]+"px "+i[1]+"px "+i[2]+"px "+N2Color.hex2rgbaCSS(i[3])},t.prototype.makeStyleafont=function(t,e){for(var i=t.split(","),s=0;s<i.length;s++)i[s]=this.getFamily(i[s].replace(/^\s+|\s+$/gm,"").replace(/"|'/gm,""));e.fontFamily=i.join(",")},t.prototype.getFamily=function(t){var e=l(window).triggerHandler("n2Family",[t]);return e===d&&(e=t),"'"+e+"'"},t.prototype.makeStylelineheight=function(t,e){e.lineHeight=t},t.prototype.makeStyleweight=t.prototype.makeStylebold=function(t,e){e.fontWeight=1==t?"bold":1<t?t:"normal"},t.prototype.makeStyleitalic=function(t,e){e.fontStyle=1==t?"italic":"normal"},t.prototype.makeStyleunderline=function(t,e){e.textDecoration=1==t?"underline":"none"},t.prototype.makeStylealign=function(t,e){e.textAlign=t},t.prototype.makeStyleletterspacing=function(t,e){e.letterSpacing=t},t.prototype.makeStylewordspacing=function(t,e){e.wordSpacing=t},t.prototype.makeStyletexttransform=function(t,e){e.textTransform=t},t.prototype.makeStyleextra=function(t,e){e.raw=t};var e=1,o=new t,i={pre:"",defaultFamily:"Roboto,Arial",fontSize:16,rendererModes:{},getDefault:function(){return{color:"000000ff",size:"14||px",tshadow:"0|*|0|*|0|*|000000ff",afont:i.defaultFamily,lineheight:"1.5",weight:400,italic:0,underline:0,align:"left",letterspacing:"normal",wordspacing:"normal",texttransform:"none",extra:""}},getEmpty:function(){return{extra:""}},getClass:function(){return"n2-font-"+e++},addCSS:function(t,e,i,s,n){return nextend.css.add(e,o.getCSS.call(o,t,"."+e,i,s,n))},fixBold:function(t){for(var e=0;e<t.length;e++)t[e].bold!==d&&(t[e].weight!==d||(1===parseInt(t[e].bold)?t[e].weight=700:0<t[e].bold&&(t[e].weight=t[e].bold)),delete t[e].bold);return t},parseRawData:function(e){if(0<e.length){"{"!==e[0]&&(e=N2Classes.Base64.decode(e));try{var t=JSON.parse(e);if(t.data!==d)return t.data=this.fixBold(t.data),t.data[0]=l.extend({},this.getDefault(),t.data[0]),t.data}catch(t){console.error("Unexpected data",e,t)}}return[this.getDefault()]},transformData:function(t,e){for(var i=this.parseRawData(t),s=this.rendererModes[e].tabs,n=[],o=0;o<i.length;o++)n[o]=l.extend(!0,this.getEmpty(),i[o]);for(o=n.length;o<s.length;o++)n[o]=this.getEmpty();return n}};return i}),N2D("NextendStyleEditor",["NextendFragmentEditor"],function(t,e){function i(){N2Classes.NextendFragmentEditor.prototype.constructor.apply(this,arguments),this.fields={backgroundColor:{element:t("#n2-style-editorbackgroundcolor"),events:{"nextendChange.n2-editor":this.changeBackgroundColor.bind(this)}},opacity:{element:t("#n2-style-editoropacity"),events:{"outsideChange.n2-editor":this.changeOpacity.bind(this)}},padding:{element:t("#n2-style-editorpadding"),events:{"outsideChange.n2-editor":this.changePadding.bind(this)}},boxShadow:{element:t("#n2-style-editorboxshadow"),events:{"outsideChange.n2-editor":this.changeBoxShadow.bind(this)}},border:{element:t("#n2-style-editorborder"),events:{"outsideChange.n2-editor":this.changeBorder.bind(this)}},borderRadius:{element:t("#n2-style-editorborderradius"),events:{"outsideChange.n2-editor":this.changeBorderRadius.bind(this)}},extracss:{element:t("#n2-style-editorextracss"),events:{"outsideChange.n2-editor":this.changeExtraCSS.bind(this)}}}}return((i.prototype=Object.create(N2Classes.NextendFragmentEditor.prototype)).constructor=i).prototype.load=function(t){this._off(),this.fields.backgroundColor.element.data("field").insideChange(t.backgroundcolor),this.fields.opacity.element.data("field").insideChange(t.opacity),this.fields.padding.element.data("field").insideChange(t.padding),this.fields.boxShadow.element.data("field").insideChange(t.boxshadow),this.fields.border.element.data("field").insideChange(t.border),this.fields.borderRadius.element.data("field").insideChange(t.borderradius),this.fields.extracss.element.data("field").insideChange(t.extra),this._on()},i.prototype.changeBackgroundColor=function(){this.trigger("backgroundcolor",this.fields.backgroundColor.element.val())},i.prototype.changeOpacity=function(){this.trigger("opacity",this.fields.opacity.element.val())},i.prototype.changePadding=function(){this.trigger("padding",this.fields.padding.element.val())},i.prototype.changeBoxShadow=function(){this.trigger("boxshadow",this.fields.boxShadow.element.val())},i.prototype.changeBorder=function(){this.trigger("border",this.fields.border.element.val())},i.prototype.changeBorderRadius=function(){this.trigger("borderradius",this.fields.borderRadius.element.val())},i.prototype.changeExtraCSS=function(){this.trigger("extra",this.fields.extracss.element.val())},i}),N2D("NextendStyleEditorController",["NextendFragmentEditorController"],function($,undefined){function NextendStyleEditorController(){this.css=[],N2Classes.NextendFragmentEditorController.prototype.constructor.apply(this,arguments),this.preview=$('<div class="n2_form__table_preview"></div>').css("fontSize","16px").appendTo('.n2_form__table[data-field="table-style-preview"]'),this.initBackgroundColor()}return NextendStyleEditorController.prototype=Object.create(N2Classes.NextendFragmentEditorController.prototype),NextendStyleEditorController.prototype.constructor=NextendStyleEditorController,NextendStyleEditorController.prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorController.prototype.loadDefaults.call(this),this.type="style",this.preview=null},NextendStyleEditorController.prototype.initEditor=function(){return new N2Classes.NextendStyleEditor},NextendStyleEditorController.prototype.getCleanVisual=function(){return N2Classes.CSSRendererStyle.getEmpty()},NextendStyleEditorController.prototype.initBackgroundColor=function(){this.$background=$("#n2-style-editorpreview-background").on("nextendChange",function(){this.preview.css("background","#"+this.$background.val())}.bind(this)),this.preview.css("background","#"+this.$background.val())},NextendStyleEditorController.prototype.getTabs=function(){return N2Classes.CSSRendererStyle.rendererModes[this.mode].tabs},NextendStyleEditorController.prototype.renderCSS=function(){this._renderTimeout=!1,this.clearCSS();var t=N2Classes.CSSRendererStyle.addCSS("",this.getPreviewCssClass(),this.currentVisual,N2Classes.CSSRendererStyle.rendererModes[this.mode]);this.css.push(t)},NextendStyleEditorController.prototype.setPreview=function(){var styleClassName=this.getPreviewCssClass(),fontClassName=nextend.styleManager.fontClassName,fontClassName2=nextend.styleManager.fontClassName2,styleClassName2=nextend.styleManager.styleClassName2,data={styleClassName:styleClassName,fontClassName:fontClassName,fontClassName2:fontClassName2,styleClassName2:styleClassName2},html="";this.localModePreview[this.mode]!==undefined&&""!==this.localModePreview[this.mode]?(this.preview.html(""),this.preview.append(N2Classes[this.localModePreview[this.mode]].renderStyle(nextend.styleManager.fieldID,data))):(html=N2Classes.CSSRendererStyle.rendererModes[this.mode].preview,html=html.replace(/\{([^]*?)\}/g,function(match,script){return eval(script)}),this.preview.html(html))},NextendStyleEditorController.prototype.getPreviewCssClass=function(){return"n2-"+this.type+"-editor-preview"},NextendStyleEditorController.prototype.pause=function(){this.clearCSS()},NextendStyleEditorController.prototype.clearCSS=function(){for(var t=0;t<this.css.length;t++)this.css[t].destroy();this.css=[]},NextendStyleEditorController}),N2D("NextendStyleManager",function(s,i){function t(){this.$=s(this),this.showParameters=!1,this.type="style",this.css=[],this.styleClassName2="",this.fontClassName="",this.fontClassName2="",(window.nextend.styleManager=this).lightbox=s("#n2-lightbox-"+this.type),this.lightbox.find(".n2_fullscreen_editor__overlay").on("click",this.hide.bind(this)),this.controller=this.initController(),this.controller&&(this.renderer=this.controller.renderer),this.lightbox.find(".n2_fullscreen_editor__cancel").on("click",this.hide.bind(this)),this.saveButton=this.lightbox.find(".n2_fullscreen_editor__save").on("click",this.setVisualAsStatic.bind(this))}return t.prototype.initController=function(){return new N2Classes.NextendStyleEditorController},t.prototype.setFieldID=function(t){this.fieldID=t},t.prototype.setConnectedStyle=function(t){var e=s("#"+t).data("field").renderStyle();this.css.push(e),this.styleClassName2=e.getBaseClassName()},t.prototype.setConnectedFont=function(t){var e=s("#"+t).data("field").renderFont();this.css.push(e),this.fontClassName=e.getBaseClassName()},t.prototype.setConnectedFont2=function(t){var e=s("#"+t).data("field").renderFont();this.css.push(e),this.fontClassName2=e.getBaseClassName()},t.prototype.setAndClose=function(t){this.$.trigger("save",[t])},t.prototype.setVisualAsStatic=function(t){t.preventDefault(),this.setAndClose(JSON.stringify({data:this.controller.get("set")})),this.hide(t)},t.prototype.hide=function(t){this.controller.pause();for(var e=0;e<this.css.length;e++)this.css[e].destroy();this.css=[],t!==i&&(t.preventDefault(),N2Classes.Esc.pop()),this.controller.close(),this.$.off("save"),s("body").removeClass("n2_body--fullscreen-editor-visible"),this.lightbox.removeClass("n2_fullscreen_editor--visible"),s(window).off("keydown.visual")},t.prototype.loadDataToController=function(t){this.controller.load(N2Classes.CSSRendererStyle.parseRawData(t),!1,this.showParameters)},t.prototype.show=function(t,e,i){N2Classes.Esc.add(function(){return this.hide(),!0}.bind(this)),this.showParameters=s.extend({previewMode:!1,previewHTML:!1},i),s("body").addClass("n2_body--fullscreen-editor-visible"),this.lightbox.addClass("n2_fullscreen_editor--visible"),this.loadDataToController(t),this.controller.show(),this.$.on("save",e),this._show()},t.prototype._show=function(){s(":focus").blur(),s(window).on({"keydown.visual":function(t){"TEXTAREA"===t.target.tagName||"INPUT"===t.target.tagName||t.target.isContentEditable||13===t.keyCode&&this.saveButton.trigger("click")}.bind(this)})},t}),N2D("CSSRendererStyle",["CSSRenderer"],function(r,o){function t(){}((t.prototype=Object.create(N2Classes.CSSRenderer.prototype)).constructor=t).prototype.getCSS=function(t,e,i,s,n){return!1===(i=this.decodeData(i))?"":(i[0]=r.extend(N2Classes.CSSRendererStyle.getDefault(),i[0]),t===o&&(t=N2Classes.CSSRendererStyle.pre),N2Classes.CSSRenderer.prototype.getCSS.call(this,t,e,i,s,n))},t.prototype.makeStylebackgroundcolor=function(t,e){e.background="#"+t.substr(0,6)+";\n\tbackground: "+N2Color.hex2rgbaCSS(t)},t.prototype.makeStyleopacity=function(t,e){e.opacity=parseInt(t)/100},t.prototype.makeStylepadding=function(t,e){for(var i=t.split("|*|"),s=i.pop(),n=0;n<i.length;n++)i[n]+=s;e.padding=i.join(" ")},t.prototype.makeStyleboxshadow=function(t,e){var i=t.split("|*|");"0"==i[0]&&"0"==i[1]&&"0"==i[2]&&"0"==i[3]?e.boxShadow="none":e.boxShadow=i[0]+"px "+i[1]+"px "+i[2]+"px "+i[3]+"px "+N2Color.hex2rgbaCSS(i[4])},t.prototype.makeStyleborder=function(t,e){var i=t.split("|*|");e.borderWidth=i[0]+"px",e.borderStyle=i[1],e.borderColor="#"+i[2].substr(0,6)+";\n\tborder-color:"+N2Color.hex2rgbaCSS(i[2])},t.prototype.makeStyleborderradius=function(t,e){t.split("|*|").push(""),e.borderRadius=t+"px"},t.prototype.makeStyleextra=function(t,e){e.raw=t};var e=1,a=new t;return{pre:"",rendererModes:{},getDefault:function(){return{backgroundcolor:"ffffff00",opacity:100,padding:"0|*|0|*|0|*|0|*|px",boxshadow:"0|*|0|*|0|*|0|*|000000ff",border:"0|*|solid|*|000000ff",borderradius:"0",extra:""}},getEmpty:function(){return{extra:""}},getClass:function(){return"n2-style-"+e++},addCSS:function(t,e,i,s,n){return nextend.css.add(e,a.getCSS.call(a,t,"."+e,i,s,n))},parseRawData:function(e){if(0<e.length){"{"!==e[0]&&(e=N2Classes.Base64.decode(e));try{var t=JSON.parse(e);if(t.data!==o)return t.data[0]=r.extend({},this.getDefault(),t.data[0]),t.data}catch(t){console.error("Unexpected data",e,t)}}return[this.getDefault()]},transformData:function(t,e){for(var i=this.parseRawData(t),s=this.rendererModes[e].tabs,n=[],o=0;o<i.length;o++)n[o]=r.extend(!0,this.getEmpty(),i[o]);for(o=n.length;o<s.length;o++)n[o]=this.getEmpty();return n}}}),N2D("NextendImageEditorController",["NextendFragmentEditorControllerWithEditor"],function(t,e){function i(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.NextendFragmentEditorControllerWithEditor.prototype)).constructor=i).prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.loadDefaults.call(this),this.type="image",this.currentImage=""},i.prototype.get=function(t){return this.currentVisual},i.prototype.getEmptyVisual=function(){return{desktop:{size:"0|*|0"},"desktop-retina":{image:"",size:"0|*|0"},tablet:{image:"",size:"0|*|0"},"tablet-retina":{image:"",size:"0|*|0"},mobile:{image:"",size:"0|*|0"},"mobile-retina":{image:"",size:"0|*|0"}}},i.prototype._load=function(t,e,i){this.currentImage=t.visual.image,N2Classes.NextendFragmentEditorControllerWithEditor.prototype._load.call(this,t.value,e,i)},i.prototype.loadToEditor=function(){this.currentVisual=t.extend({},this.getEmptyVisual(),this.currentVisual),this.editor.load(this.currentImage,this.currentVisual)},i.prototype.propertyChanged=function(t,e,i,s){this.isChanged=!0,this.currentVisual[e][i]=s},i}),N2D("NextendImage",["NextendVisualCore"],function(t,e){function i(){N2Classes.NextendVisualCore.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.NextendVisualCore.prototype)).constructor=i).prototype.setValue=function(t,e){this.base64=t,this.value=JSON.parse(N2Classes.Base64.decode(t))},i.prototype.activate=function(t){t!==e&&t.preventDefault(),this.visualManager.changeActiveVisual(this),this.visualManager.controller.load(this,!1,this.visualManager.showParameters)},i}),N2D("NextendImageManager",["NextendVisualManagerCore"],function(s,n){function t(){this.referenceKeys={},N2Classes.NextendVisualManagerCore.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.NextendVisualManagerCore.prototype)).constructor=t).prototype.loadDefaults=function(){N2Classes.NextendVisualManagerCore.prototype.loadDefaults.apply(this,arguments),this.type="image",this.labels={visual:"image",visuals:"images"},this.fontClassName=""},t.prototype.initController=function(){return new N2Classes.NextendImageEditorController},t.prototype.createVisual=function(t){return new N2Classes.NextendImage(t,this)},t.prototype.firstLoadVisuals=function(t){for(var e=0;e<t.length;e++)this.referenceKeys[t[e].hash]=this.visuals[t[e].id]=this.createVisual(t[e])},t.prototype.getVisual=function(t){if(""!=t){var e=md5(t);if(this.referenceKeys[e]!==n)return this.referenceKeys[e];if(this.visualLoadDeferreds[e]!==n)return this.visualLoadDeferreds[e];var i=s.Deferred();return this.visualLoadDeferreds[e]=i,this._loadVisualFromServer(t).done(function(){i.resolve(this.referenceKeys[e]),delete this.visualLoadDeferreds[e]}.bind(this)).fail(function(){i.resolve({id:-1,name:n2_("Empty")}),delete this.visualLoadDeferreds[e]}.bind(this)),i}N2Classes.Notification.error(n2_("The image is empty"),{timeout:3})},t.prototype._loadVisualFromServer=function(t){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.parameters.ajaxUrl,{nextendaction:"loadVisualForImage"}),data:{image:t},dataType:"json"}).done(function(t){var e=t.data.visual;this.referenceKeys[e.hash]=this.visuals[e.id]=this.createVisual(e)}.bind(this))},t.prototype.isVisualData=function(t){return""!==t},t.prototype.setVisual=function(e){e.preventDefault(),this.controller.isChanged?this.saveActiveVisual(this.activeVisual.name).done(function(t){s(window).trigger(t.data.visual.hash,this.activeVisual.value),this.hide(e)}.bind(this)):this.hide(e)},t.prototype.getBase64=function(){return N2Classes.Base64.encode(JSON.stringify(this.controller.get("set")))},t.prototype.loadDataToController=function(e){s.when(this.getVisual(e)).done(function(t){0<t.id?t.activate():console.error(e+" visual is not found linked")}.bind(this))},t}),N2D("BrowserCompatibility",function(t,e){var i={firefox:52,edge:18,opera:55,safari:10,chrome:68,safariIOS:604};return function(t){window.location.href.match(/nextendcontroller=(sliders|slider|slides|generator)/)&&!function(){var t=navigator.userAgent,e=t.match(/Firefox\/([0-9]+)/);if(e)return parseInt(e[1])>=i.firefox;if(e=t.match(/Edge\/([0-9]+)/))return parseInt(e[1])>=i.edge;if(e=t.match(/OPR\/([0-9]+)/))return parseInt(e[1])>=i.opera;if(e=t.match(/Version\/([0-9]+)[0-9. ]*?Safari/))return parseInt(e[1])>=i.safari;if(e=t.match(/Chrome\/([0-9]+)/))return parseInt(e[1])>=i.chrome;if(e=t.match(/Safari\/([0-9]+)/))return parseInt(e[1])>=i.safariIOS;return!1}()&&(window.location=t)}}),N2D("ContextMenu",function(l,a){var d,h,c,p,s,i,n,u,o,f;function g(t){h[0]===t.target||l.contains(h[0],t.target)||f&&(f===t.target||l.contains(f,t.target))||y()}function y(){0===d&&(C(),r(),p[0].removeEventListener("mouseover",m,{passive:!0,capture:!0}),p[0].removeEventListener("mouseleave",v,{passive:!0,capture:!0}),h.remove(),n=s=p=h=a,document.removeEventListener("mousedown",g,{passive:!0,capture:!0}),document.removeEventListener("pointerdown",g,{passive:!0,capture:!0}),cancelAnimationFrame(this.frame),window.removeEventListener("scroll",y,{passive:!0,capture:!0}),window.removeEventListener("resize",y),window.removeEventListener("blur",y),u.onClose&&u.onClose.call(window))}function m(t){var e,i=l(t.target);i.hasClass("n2_context_menu__item")||(i=i.closest(".n2_context_menu__item")),s&&i[0]===s[0]||(C(),!(s=i).length||(e=s.data("items"))!==a&&(s.addClass("n2_context_menu__item--active"),(n=s.data("submenu"))||(n=function(t,e){for(var i=e.getBoundingClientRect(),s=l('<div class="n2_context_menu__sub_menu"></div>').appendTo(h),n=0;n<t.length;n++)new("onoff"===t[n].type?S:x)(s,t[n]);var o,r,a=s.width();r=n2const.rtl.isRtl?i.left<a:i.left+i.width+a<window.innerWidth;o=r?Math.round(i.width-3):-Math.round(a-3);return s.css({left:o,top:Math.round(Math.min(i.top,window.innerHeight-s.height()-5)-c.top)}),s[0].addEventListener("mouseover",_,{passive:!0,capture:!0}),s[0].addEventListener("mouseleave",_,{passive:!0,capture:!0}),s}(e,s[0]),s.data("submenu",n)),n.addClass("n2_context_menu__sub_menu--active"))),v(t)}function v(t){var e=l(t.target);e.hasClass("n2_context_menu__item")||(e=e.closest(".n2_context_menu__item")),i&&e[0]===i[0]||(r(),(i=e).length&&i.data("item").onFocus())}function r(){var t;i&&i.length&&((t=i.data("item"))&&t.onBlur(),i=a)}function _(t){var e=l(t.target);e.hasClass("n2_context_menu__item")||(e=e.closest(".n2_context_menu__item")),o&&e[0]===o[0]||(b(),(o=e).length&&o.data("item").onFocus())}function b(){var t;o&&o.length&&((t=o.data("item"))&&t.onBlur(),o=a)}function C(){n!==a&&(b(),n.removeClass("n2_context_menu__sub_menu--active"),o=n=a,s.removeClass("n2_context_menu__item--active"))}function w(t,e){this.$item=l('<div class="n2_context_menu__item"></div>').data("item",this).appendTo(t),e.color!==a&&this.$item.addClass("n2_context_menu__item--color-"+e.color),this.setData(e)}function x(t,e){w.prototype.constructor.call(this,t,e)}function S(t,e){x.prototype.constructor.call(this,t,e),this.$item.addClass("n2_context_menu__item_onoff")}return w.prototype.setData=function(t){this.data=t,this.$item.html(""),this.render(t),t.items!==a&&this.$item.data("items",t.items)},w.prototype.render=function(t){t.render(this.$item)},w.prototype.onClick=function(){!1!==this.data.action.call(window,this)&&y()},w.prototype.onFocus=function(){this.data.focus!==a&&this.data.focus.call()},w.prototype.onBlur=function(){this.data.blur!==a&&this.data.blur.call()},((x.prototype=Object.create(w.prototype)).constructor=x).prototype.render=function(t){this.$icon=l('<i class="n2_context_menu__item_icon '+t.icon+'"></i>').appendTo(this.$item),this.$label=l('<div class="n2_context_menu__item_label"></div>').appendTo(this.$item),"function"==typeof t.label?t.label.call(this,this):this.$label.text(t.label),this.$item.off("click"),t.action!==a?(this.$item.on("click",this.onClick.bind(this)),this.$item.addClass("n2_context_menu__item--has-action")):this.$item.removeClass("n2_context_menu__item--has-action")},((S.prototype=Object.create(x.prototype)).constructor=S).prototype.render=function(t){this.isOn=!!t.isOn.call(this),this.syncClass(),l('<i class="n2_context_menu__item_icon ssi_16"></i>').appendTo(this.$item),this.$label=l('<div class="n2_context_menu__item_label"></div>').appendTo(this.$item),"function"==typeof t.label?t.label.call(this,this.$label):this.$label.text(t.label),this.$item.off("click"),this.$item.on("click",this.toggle.bind(this)),this.$item.addClass("n2_context_menu__item--has-action")},S.prototype.syncClass=function(){this.$item.toggleClass("n2_context_menu__item_onoff--on",this.isOn)},S.prototype.toggle=function(){this.isOn=!this.isOn,this.syncClass(),this.data.action(this.isOn)},function(t,e,i){if(d=0,u=l.extend({x:0,y:0,horizontalAlign:"right",verticalAlign:"bottom",onClose:!1,forceLtr:!1},i),h===a||(y(),f!==t)){h=l('<div class="n2_context_menu"></div>').appendTo("body"),u.forceLtr&&h.attr("dir","ltr"),p=l('<div class="n2_context_menu__inner"></div>').appendTo(h),e.sort(function(t,e){return t.priority-e.priority});for(var s=0;s<e.length;s++)switch(e[s].type){case"raw":new w(p,e[s]);break;case"onoff":new S(p,e[s]);break;default:new x(p,e[s])}var n,o,r={top:"auto",right:"auto",bottom:"auto",left:"auto"};return t instanceof Element?(n=(f=t).getBoundingClientRect(),"right"===u.horizontalAlign?r.left=Math.min(n.left+u.x,window.innerWidth-p.width()-u.x-10):"left"===u.horizontalAlign&&(r.left=n.right-p.width()-u.x),"bottom"===u.verticalAlign?(o=n.top+n.height+u.y)<=window.innerHeight-p.height()-10?r.top=o:r.bottom=window.innerHeight-n.top+u.y:"top"===u.verticalAlign&&(n.top-10>=p.height()?r.bottom=window.innerHeight-n.top+u.y:r.top=n.top+n.height+u.y)):(f=!1,r.left=Math.min(t.clientX+1,window.innerWidth-p.width()-10),r.top=Math.min(t.clientY+1,window.innerHeight-p.height()-10)),h.css(r),c=p[0].getBoundingClientRect(),p[0].addEventListener("mouseover",m,{passive:!0,capture:!0}),p[0].addEventListener("mouseleave",v,{passive:!0,capture:!0}),document.addEventListener("mousedown",g,{passive:!0,capture:!0}),document.addEventListener("pointerdown",g,{passive:!0,capture:!0}),this.frame=requestAnimationFrame(function(){window.addEventListener("scroll",y,{passive:!0,capture:!0})}),window.addEventListener("resize",y),window.addEventListener("blur",y),{lock:function(){d++},unlock:function(){d--,d=Math.max(d,0)}}}}}),N2D("DashboardInfo",function(e,t){function i(){this.isVisible=!1,this.blurInteractionCallback=this.blurInteraction.bind(this),this.blurCallback=this.blur.bind(this),N2R("documentReady",this.onReady.bind(this))}return i.prototype.onReady=function(){this.$info=e(".n2_dashboard_info"),this.$button=this.$info.find("> .n2_button_plain_icon").on("click",this.toggleInfo.bind(this))},i.prototype.toggleInfo=function(t){t.preventDefault(),this.isVisible?this.hideInfo():this.showInfo()},i.prototype.showInfo=function(){this.isVisible||(this.isVisible=!this.isVisible,document.addEventListener("mousedown",this.blurInteractionCallback,{passive:!0,capture:!0}),window.addEventListener("scroll",this.blurCallback,{passive:!0,capture:!0}),this.syncClass())},i.prototype.hideInfo=function(){this.isVisible&&(this.isVisible=!this.isVisible,this.syncClass(),document.removeEventListener("mousedown",this.blurInteractionCallback,{passive:!0,capture:!0}),window.removeEventListener("scroll",this.blurCallback,{passive:!0,capture:!0}))},i.prototype.syncClass=function(){this.$info.toggleClass("n2_dashboard_info--visible",this.isVisible)},i.prototype.blur=function(){this.hideInfo()},i.prototype.blurInteraction=function(t){this.$info[0]===t.target||e.contains(this.$info[0],t.target)||this.hideInfo()},i}),N2D("DeviceChanger",function(n,i){function t(t){this.slider=t,this.activeStates={hover:!1,drag:!1},this.devices={},this.slider.stages.done("ResponsiveStart",this.onResponsiveStart.bind(this))}function s(t,e,i,s){this.deviceChanger=t,this.device=e,this.data=i,this.icon=s,this.$button=n('<div class="n2_device_tester_devices__device" data-device="'+e+'"><i class="ssi_24 '+s+'"></i></div>').on("click",this.activate.bind(this)).appendTo(t.$containerDevices),t.registerDevice(e,this)}function o(t){this.trailSize=160,this.deviceChanger=t;var e=n('<div class="n2_device_tester_zoom"></div>').appendTo(t.$deviceTester);this.$min=n('<div class="n2_device_tester_zoom__min_label">0</div>').appendTo(e),this.mouseMoveDelegate=this.onMouseMove.bind(this),this.mouseUpDelegate=this.onMouseUp.bind(this),this.$zoomInner=n('<div class="n2_device_tester_zoom__inner"></div>').on("mousedown",this.onMouseDown.bind(this)).appendTo(e),this.$max=n('<div class="n2_device_tester_zoom__max_label">3000</div>').appendTo(e),n('<div class="n2_device_tester_zoom__trail"></div>').appendTo(this.$zoomInner),this.$editorSize=n('<div class="n2_device_tester_zoom__editor_size"></div>').appendTo(this.$zoomInner),this.$handle=n('<div class="n2_device_tester_zoom__handle"></div>').appendTo(this.$zoomInner),this.$handleLabel=n('<div class="n2_device_tester_zoom__handle_label"></div>').appendTo(this.$handle)}return t.prototype.registerDevice=function(t,e){this.devices[t]=e},t.prototype.setActiveState=function(t,e){this.activeStates[t]=e,this.$deviceChanger.toggleClass("n2_device_changer--active",this.activeStates.hover||this.activeStates.drag)},t.prototype.onResponsiveStart=function(){var t;this.$deviceChanger=n(".n2_device_changer").on({mouseenter:function(){t&&(clearTimeout(t),t=i),this.setActiveState("hover",!0)}.bind(this),mouseleave:function(){t=setTimeout(function(){this.setActiveState("hover",!1)}.bind(this),500)}.bind(this)}),this.$icon=this.$deviceChanger.find(".n2_device_changer__button .ssi_24"),this.responsive=this.slider.responsive,this.container=this.responsive.containerElement.closest(".n2_slider_preview_area__inner, .n2_slide_editor_slider__editor"),this.$deviceTester=this.$deviceChanger.find(".n2_device_tester"),this.$containerDevices=n('<div class="n2_device_tester_devices"></div>').appendTo(this.$deviceTester),this.resizer=new o(this);var e=this.responsive.parameters.enabledDevices;e.mobilePortrait&&new s(this,"mobilePortrait",this.responsive.parameters.sizes.mobilePortrait,"ssi_24--mobileportrait"),e.tabletPortrait&&new s(this,"tabletPortrait",this.responsive.parameters.sizes.tabletPortrait,"ssi_24--tabletportrait"),new s(this,"desktopPortrait",this.responsive.parameters.sizes.desktopPortrait,"ssi_24--desktop").activate(),this.responsive.identifyDeviceID=this.proxyIdentifyDeviceID.bind(this)},t.prototype.setDevice=function(t,e,i,s){this.device&&(this.devices[this.device].markInActive(),this.$icon.removeClass(this.devices[this.device].icon)),this.device=t,n("body").attr("data-device",t),this.devices[this.device].markActive(),this.$icon.addClass(this.devices[this.device].icon),this.width=e,this.minWidth=i,this.maxWidth=s,this.resizer.setLimits(i,s,e),this.resizer.setValue(this.width),this.container.width(this.width),this.slider.stages.resolved("Resized")&&this.responsive.doResize()},t.prototype.setWidth=function(t){(t=Math.max(Math.min(t,this.maxWidth),this.minWidth))!==this.width&&(this.width=t,this.resizer.setValue(t),this.container.width(this.width),this.responsive.doResize())},t.prototype.proxyIdentifyDeviceID=function(){return N2Classes.SmartSliderResponsive.DeviceMode[this.device]},s.prototype.markActive=function(){this.$button.addClass("n2_device_tester_devices__device--active")},s.prototype.markInActive=function(){this.$button.removeClass("n2_device_tester_devices__device--active")},s.prototype.activate=function(){this.deviceChanger.setDevice(this.device,this.data.width,this.data.min,this.data.max)},o.prototype.setLimits=function(t,e,i){this.min=t,this.$min.text(t),this.max=e,this.$max.text(e),this.editorSize=i,this.onePxToReal=(e-t)/this.trailSize,this.$editorSize.css("left",Math.round((i-t)/(e-t)*this.trailSize))},o.prototype.setValue=function(t){this.$handleLabel.text(t),this.$handle.css("left",Math.round((t-this.min)/(this.max-this.min)*this.trailSize))},o.prototype.onMouseDown=function(t){t.preventDefault(),n("body").addClass("n2_body--resize-editor"),this.resizeContext={clientX:this.$zoomInner[0].getBoundingClientRect().left,width:this.deviceChanger.width},document.addEventListener("mousemove",this.mouseMoveDelegate),document.addEventListener("mouseup",this.mouseUpDelegate),this.deviceChanger.setActiveState("drag",!0),this.onMouseMove(t)},o.prototype.onMouseMove=function(t){var e=Math.round(this.min+(t.clientX-this.resizeContext.clientX)*this.onePxToReal);Math.abs(this.editorSize-e)<2*this.onePxToReal&&(e=this.editorSize),this.deviceChanger.setWidth(e)},o.prototype.onMouseUp=function(t){document.removeEventListener("mousemove",this.mouseMoveDelegate),document.removeEventListener("mouseup",this.mouseUpDelegate),this.deviceChanger.setActiveState("drag",!1),n("body").removeClass("n2_body--resize-editor")},t}),N2D("SliderPreview",["UIDragTooltip"],function(o,e){var i,n=new N2Classes.UIDragTooltip("Resize");function t(){i={desktopPortrait:n2_("Desktop"),desktopLandscape:n2_("Large desktop"),tabletPortrait:n2_("Tablet"),tabletLandscape:n2_("Large tablet"),mobilePortrait:n2_("Mobile"),mobileLandscape:n2_("Large mobile")},this.frameScrollTop=0,this.scale=1,this.activeInfo=!1,this.sliderInfos={},this.isIframeContext=window.parent!==window,this.isIframeContext?(this.$parentDocument=window.parent.N2Classes.$(window.parent.document),document.addEventListener("wheel",function(t){t.preventDefault()}.bind(this),{passive:!1}),window.addEventListener("message",function(t){var e={};try{e=JSON.parse(t.data)}catch(t){}switch(e.action){case"cancel":this.$parentDocument.triggerHandler("n2Close");break;case"scrollTop":this.updateFrameScrollTop(e.data);break;case"device_info":this.updateDeviceInfo(e.data)}}.bind(this),!1),document.addEventListener("keydown",function(t){t.defaultPrevented||27===t.keyCode&&(t.preventDefault(),this.$parentDocument.triggerHandler("n2Close"))}.bind(this)),o(".n2_preview_slider__close").on("click",function(t){t.preventDefault(),this.$parentDocument.triggerHandler("n2Close")}.bind(this))):window.addEventListener("message",function(t){var e={};try{e=JSON.parse(t.data)}catch(t){}switch(e.action){case"scrollTop":this.updateFrameScrollTop(e.data);break;case"device_info":this.updateDeviceInfo(e.data)}}.bind(this),!1),this.init(),this.$frame=o(".n2_preview__device_screen_inner iframe"),o(".n2_preview form").submit()}function s(t){return t.replace(/[^0-9]/gi,"").replace(/^[0]+/gi,"").substr(0,5)}function r(t,e,i,s){this.sliderPreview=t,this.label=e,this.width=i,this.height=s,t.devices.push(this),this.$bar=o('<div class="n2_preview__ruler_device"><div></div></div>').on({mouseenter:function(){this.sliderPreview.setTempLabel(this.getLabel())}.bind(this),mouseleave:function(){this.sliderPreview.resetLabel()}.bind(this),click:function(){this.sliderPreview.setDimensions(this.width,this.height),this.sliderPreview.setCurrentDevice(this)}.bind(this)}).prependTo(t.$ruler),this.refreshScale()}function a(t,e){this.sliderPreview=t,this.id=e,this.top=0,this.$tip=o('<div class="n2_preview__slider_info"></div>').appendTo(this.sliderPreview.$infoState)}return t.prototype.init=function(){this.$fieldWidth=o(".n2_preview_toolbar__width").on("click",function(){"true"!==this.$fieldWidth[0].contentEditable&&new N2Classes.InlineTextEditor(this.$fieldWidth[0],{filter:s,onSave:function(t){(t=parseInt(t))?this.setWidth(t):this.onResize()}.bind(this),onCancel:function(){this.onResize()}.bind(this)})}.bind(this)),this.$fieldHeight=o(".n2_preview_toolbar__height").on("click",function(){"true"!==this.$fieldHeight[0].contentEditable&&new N2Classes.InlineTextEditor(this.$fieldHeight[0],{filter:s,onSave:function(t){(t=parseInt(t))?this.setHeight(t):this.onResize()}.bind(this),onCancel:function(){this.onResize()}.bind(this)})}.bind(this)),this.$fieldScale=o(".n2_preview_toolbar__scale").on("change",function(){this.setScale(this.$fieldScale.val()/100)}.bind(this)),this.devices=[],this.$ruler=o(".n2_preview__ruler"),new r(this,n2_("Mobile")+" S",375,667),new r(this,n2_("Mobile")+" L",425,756),new r(this,n2_("Tablet"),768,1024),new r(this,n2_("Laptop"),1024,768),new r(this,n2_("Laptop")+" L",1440,900),new r(this,"Full HD",1920,1080),new r(this,"4K",2560,1440),this.$label=o(".n2_preview__ruler_label"),this.$infoState=o(".n2_preview__device_info_state"),this.$infoTip=o(".n2_preview__device_info .ssi_16"),this.$screen=o(".n2_preview__device_screen"),this.$notification=o('<div class="n2_preview__notification_scale"></div>').appendTo(this.$screen),this.$screenInner=o(".n2_preview__device_screen_inner"),o(".n2_preview__resize_width").on("mousedown",function(t){t.preventDefault(),n.dragShow(),o("body").addClass("n2_body--resize-horizontal");var i=t.clientX,s=Math.floor(this.$screenInner.width()/this.scale);n.dragUpdate(t,n2_("Width")+": "+Math.max(320,Math.ceil(s))+"px"),o(document).on({"mousemove.resize":function(t){var e=Math.floor(s-2*(i-t.clientX)/this.scale);this.setWidth(e),this.removeCurrentDevice(),n.dragUpdate(t,n2_("Width")+": "+Math.max(320,Math.ceil(e))+"px")}.bind(this),"mouseup.resize":function(){n.dragHide(),o(document).off(".resize"),o("body").removeClass("n2_body--resize-horizontal")},"mouseleave.resize":function(){n.dragHide(),o(document).off(".resize"),o("body").removeClass("n2_body--resize-horizontal")}})}.bind(this)),o(".n2_preview__resize_height").on("mousedown",function(t){t.preventDefault(),n.dragShow(),o("body").addClass("n2_body--resize-vertical");var i=t.clientY,s=Math.floor(this.$screenInner.height()/this.scale);n.dragUpdate(t,n2_("Height")+": "+Math.max(320,s)+"px"),o(document).on({"mousemove.resize":function(t){var e=Math.floor(s-(i-t.clientY)/this.scale);this.setHeight(e),this.removeCurrentDevice(),n.dragUpdate(t,n2_("Height")+": "+Math.max(320,e)+"px")}.bind(this),"mouseup.resize":function(){n.dragHide(),o(document).off(".resize"),o("body").removeClass("n2_body--resize-vertical")}})}.bind(this)),o(".n2_button_preview_orientation").on("click",function(t){t.preventDefault(),this.removeCurrentDevice(),this.setDimensions(this.$screenInner.height()/this.scale,this.$screenInner.width()/this.scale)}.bind(this)),o(".n2_button_preview_reload").on("click",function(t){t.preventDefault(),this.reload()}.bind(this)),o(window).on("resize",this.onResize.bind(this)),this.onResize()},t.prototype.reload=function(){o(".n2_preview form").submit()},t.prototype.onResize=function(){this.$fieldWidth.text(Math.floor(this.$screenInner.width()/this.scale)),this.$fieldHeight.text(Math.floor(this.$screenInner.height()/this.scale))},t.prototype.displayNotification=function(t){this.notificationTimeout&&clearTimeout(this.notificationTimeout),this.$notification.text(t).addClass("n2_preview__notification_scale--visible"),this.notificationTimeout=setTimeout(function(){this.$notification.removeClass("n2_preview__notification_scale--visible"),delete this.notificationTimeout}.bind(this),600)},t.prototype.setScale=function(t){this.displayNotification(100*t+"%");var e=this.scale;this.scale=t,o("body").addClass("n2_body--scale-preview"),setTimeout(function(){o("body").removeClass("n2_body--scale-preview")},1500),this.$screen=o(".n2_preview__device_screen");var i=this.$screenInner.width(),s=this.$screenInner.height();this.$frame.css({transform:"scale("+this.scale+")",width:1/this.scale*100+"%",height:1/this.scale*100+"%",marginLeft:(100-1/this.scale*100)/2+"%",marginRight:(100-1/this.scale*100)/2+"%"});for(var n=0;n<this.devices.length;n++)this.devices[n].refreshScale();this._setDimensions(i/e,s/e),this.onResize()},t.prototype.setDimensions=function(t,e){var i=this.$screen.width(),s=this.$screen.height(),n=Math.max(25,25*Math.floor(100*Math.min(1,i/t,s/e)/25));parseInt(this.$fieldScale.val())!==n&&n<=100&&this.$fieldScale.val(n).trigger("change"),this._setDimensions(t,e)},t.prototype._setDimensions=function(t,e){this.setWidth(t),this.setHeight(e)},t.prototype.setWidth=function(t){t=Math.floor(Math.max(320,t)*this.scale),this.$screenInner.css("maxWidth",t),this.$fieldWidth.text(Math.floor(this.$screenInner.width()/this.scale))},t.prototype.setHeight=function(t){t=Math.floor(Math.max(320,t)*this.scale),this.$screenInner.css("maxHeight",t),this.$fieldHeight.text(Math.floor(this.$screenInner.height()/this.scale))},t.prototype.setCurrentDevice=function(t){this.currentDevice&&this.currentDevice!==t&&this.removeCurrentDevice(),this.currentDevice=t,this.resetLabel()},t.prototype.removeCurrentDevice=function(){this.currentDevice&&(this.currentDevice.deActivate(),delete this.currentDevice,this.resetLabel())},t.prototype.setTempLabel=function(t){this.currentDevice&&this.currentDevice.deActivate(),this.$label.text(t)},t.prototype.resetLabel=function(){this.currentDevice?(this.$label.text(this.currentDevice.getLabel()),this.currentDevice.activate()):this.$label.text("")},t.prototype.setInfo=function(t,e,i,s){this.$infoState.text(t);var n=[];n.push("<b>"+n2_("Orientation")+": </b>"+(e?n2_("Landscape"):n2_("Portrait"))),i<=0?n.push("<b>"+n2_("Size")+": </b>"+n2_sprintf(n2_("Below %s pixels."),s)):1e5<=s?n.push("<b>"+n2_("Size")+": </b>"+n2_sprintf(n2_("Above %s pixels."),i)):n.push("<b>"+n2_("Size")+": </b>"+n2_sprintf(n2_("Between %s and %s pixels."),i,s)),this.$infoTip.data("formTip")?this.$infoTip.data("formTip").setDescription(n.join("<br>")):this.$infoTip.data("tip-description",n.join("<br>"))},t.prototype.updateFrameScrollTop=function(t){this.frameScrollTop=t.scrollTop,this.updateActive()},t.prototype.updateDeviceInfo=function(t){this.sliderInfos[t.id]===e&&(this.sliderInfos[t.id]=new a(this,t.id)),this.sliderInfos[t.id].update(t),this.updateActive()},t.prototype.updateActive=function(){var t=!1,e=Number.POSITIVE_INFINITY;for(var i in this.sliderInfos)this.sliderInfos[i].top<e&&(e=this.sliderInfos[i].top,t=this.sliderInfos[i]);for(var i in this.sliderInfos)this.sliderInfos[i].top<=this.frameScrollTop&&t.top<this.sliderInfos[i].top&&(t=this.sliderInfos[i]);this.activeInfo!==t&&(this.activeInfo=t,this.updateInfo(t))},t.prototype.updateInfo=function(t){this.activeInfo===t&&this.setInfo(this.activeInfo.device,this.activeInfo.isLandscape,this.activeInfo.minScreenWidth,this.activeInfo.maxScreenWidth)},r.prototype.activate=function(){this.$bar.addClass("n2_preview__ruler_device--active")},r.prototype.deActivate=function(){this.$bar.removeClass("n2_preview__ruler_device--active")},r.prototype.getLabel=function(){return this.label+" "+this.width+" x "+this.height+"px"},r.prototype.refreshScale=function(){var t=this.width*this.sliderPreview.scale;this.$bar.css({width:t+"px",marginLeft:-t/2+"px"})},a.prototype.update=function(t){this.device=i[t.device],this.isLandscape=t.isLandscape,this.minScreenWidth=t.minScreenWidth,this.maxScreenWidth=t.maxScreenWidth,this.top=t.top,this.sliderPreview.updateInfo(this)},t}),N2D("TallSlideDetector",function(i,t){function l(t){this.slider=t,this.slider.visible(this.onVisible.bind(this))}return l.threshold=.7,l.prototype.onVisible=function(){this.responsive=this.slider.responsive;for(var t=0;t<this.slider.visibleRealSlides.length;t++)if(this.slider.visibleRealSlides[t].isCurrentlyEdited()){this.editedSlide=this.slider.visibleRealSlides[t];break}this.$noticeMarker=i(".n2_device_changer__button");var e=i(".n2_device_tester");this.$notice=i('<div class="n2_slide_editor_tall_slide_detector"></div>').appendTo(e),this.$label=i('<div class="n2_slide_editor_tall_slide_detector__label"></div>').appendTo(this.$notice),this.$description=i('<div class="n2_slide_editor_tall_slide_detector__description"></div>').appendTo(this.$notice),setTimeout(function(){this.slider.sliderElement.on("SliderResize",NextendDeBounce(this.update.bind(this),300)),this.update()}.bind(this),1e3)},l.prototype.update=function(){var t,e,i,s=this.responsive.minimumSlideHeight,n=Number.POSITIVE_INFINITY,o=[];for(a=0;a<this.slider.visibleRealSlides.length;a++)if((e=this.slider.visibleRealSlides[a])===this.editedSlide){t=Math.max(e.$layer.data("contentHeight"),s);break}for(a=0;a<this.slider.visibleRealSlides.length;a++)(e=this.slider.visibleRealSlides[a])!==this.editedSlide&&(i=Math.max(e.$layer.data("contentHeight"),s),n=Math.min(n,i),t<i*l.threshold&&o.push(e));if(n<t*l.threshold)this.$label.text(n2_("Slide height probably too high")),this.$description.text(n2_("The height of this slide is much higher than others so it will increase the height of the other slides.")),this.$notice.addClass("n2_slide_editor_tall_slide_detector--visible"),this.$noticeMarker.addClass("n2_device_changer__button--marked");else if(o.length){this.$label.text(n2_("Slide height increased"));for(var r=[],a=0;a<o.length;a++)r.push('<a href="'+window.location.href.replace(/slideid=[0-9]+/,"slideid="+o[a].group.$element.data("id"))+'">'+o[a].group.$element.data("title")+"</a>");this.$description.html(n2_sprintf(n2_("The height of this slide increased because the following slides are much higher: %s."),r.join(", "))),this.$notice.addClass("n2_slide_editor_tall_slide_detector--visible"),this.$noticeMarker.addClass("n2_device_changer__button--marked")}else this.$notice.removeClass("n2_slide_editor_tall_slide_detector--visible"),this.$noticeMarker.removeClass("n2_device_changer__button--marked")},l}),N2D("SliderChangeType",function(e,t){function i(t){(nextend.changeSliderType=this).options=e.extend({types:{},currentType:"simple",ajaxUrl:""},t),N2R("documentReady",this.onReady.bind(this))}return i.prototype.onReady=function(){e(".n2_slider_action__change_slider_type").on("click",this.showModal.bind(this))},i.prototype.showModal=function(t){t&&t.preventDefault();var e=new N2Classes.ModalSimple("activate",{destroyOnHide:!0,width:630});e.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--convert","blue")),e.addContent(N2Classes.UI.modalHeading(n2_("Change slider type")));var i=N2Classes.UI.modalFormRow(!0);e.addContent(i),N2Classes.UI.modalNotice(i,n2_("Changing your slider type is irreversible. After changing your slider type, <b>you will lose all slider type related settings</b>."),"notice");var s=N2Classes.UI.modalFormRow(!0);e.addContent(s);var n=N2Classes.UI.modalFieldSelectIcon(s,"slider-type",n2_("Slider type"),this.options.types,this.options.currentType),o=N2Classes.UI.modalButton(n2_("Convert"),"blue");e.addButton(o),o.on("click",function(t){t.preventDefault(),this.convertSliderType(n.val()),e.hide()}.bind(this)),e.show()},i.prototype.convertSliderType=function(t){this.options.currentType!==t&&N2Classes.AjaxHelper.ajax({type:"POST",url:this.options.ajaxUrl,data:{targetSliderType:t},dataType:"json"}).done(function(){window.location.reload()})},i}),N2D("CreateSlider",function(f,t){function e(t,e,i,s,n,o){this.groupID=t,this.ajaxUrl=e,this.userEmail=s,this.shouldSkipLicenseModal=i,this.skipNewsletter=n,this.importUrl=o,f(".n2_slider_manager__new_slider").on("click",this.createProject.bind(this)),"createslider"===window.location.hash.substring(1)&&this.createProject()}return e.prototype.createProject=function(){var e=new N2Classes.ModalSimple("new-project",{destroyOnHide:!0,width:1e3}),t=f('<div class="n2_new_project"></div>');e.addContent(t),f('<div class="n2_new_project__heading"></div>').text(n2_("What do you want to create today?")).appendTo(t),f('<div class="n2_new_project__sub_heading"></div>').text(n2_("Use our powerful visual editor, or simply import one of our existing template.")).appendTo(t);var i=f('<div class="n2_new_project__boxes"></div>').appendTo(t),s=f('<div class="n2_new_project__box"></div>').on("click",function(t){this.createSlider(),e.hide(t)}.bind(this)).appendTo(i);f('<div class="n2_new_project__box_illustration"><img src="'+nextend.imageHelper.fixed("$ss3-admin$/images/sliders/newproject.svg")+'" alt="" width="160" /></div>').appendTo(s),f('<div class="n2_new_project__box_heading"></div>').text(n2_("Create a New Project")).appendTo(s),f('<div class="n2_new_project__box_sub_heading"></div>').text(n2_("Start a new project from scratch and build exactly what you’ve imagined. You can easily customize every pixels and create anything with layers.")).appendTo(s);var n=f('<div class="n2_new_project__box"></div>').on("click",function(t){this.showExampleSlidersWindow(),e.hide(t)}.bind(this)).appendTo(i);f('<div class="n2_new_project__box_illustration"><img src="'+nextend.imageHelper.fixed("$ss3-admin$/images/sliders/template.svg")+'" alt="" width="160" /></div>').appendTo(n),f('<div class="n2_new_project__box_heading"></div>').text(n2_("Start with a Template")).appendTo(n),f('<div class="n2_new_project__box_sub_heading"></div>').text(n2_("Start with a template and make it your own with the innovative drag and drop interface. You can choose from hundreds of premade templates.")).appendTo(n),f('<a class="n2_new_project__import" href="'+this.importUrl+'"></a>').text(n2_("or import your own files")).appendTo(t),e.show()},e.prototype.createSlider=function(){var t=new N2Classes.ModalSimple("create-new-project",{destroyOnHide:!0,width:900}),e=f('<div class="n2_create_new_project"></div>');t.addContent(e),f('<div class="n2_create_new_project__heading"></div>').text(n2_("Create new project")).appendTo(e);function i(){var t=n.val();o.toggleClass("n2_form_element--hidden","block"===t)}var s=N2Classes.UI.modalFormRowLarge().appendTo(e),n=N2Classes.UI.modalFieldSelectIcon(s,"project-type",n2_("Project type"),{slider:{icon:"ssi_64 ssi_64--fullwidthslider",label:n2_("Slider")},block:{icon:"ssi_64 ssi_64--block",label:n2_("Block")}},"slider");n.on("nextendChange",i);var o=N2Classes.UI.modalFormContainer(e,"slider-settings-container"),r=N2Classes.UI.modalFormRowLarge().appendTo(o);N2Classes.UI.modalFieldSelectIcon(r,"slider-type",n2_("Slider type"),{simple:{icon:"ssi_64 ssi_64--slider",label:n2_("Simple")},carousel:{icon:"ssi_64 ssi_64--carousel",label:n2_("Carousel")},showcase:{icon:"ssi_64 ssi_64--showcase",label:n2_("Showcase")}},"simple").on("nextendChange",i),r.find('.n2_field_select_icon__option:not([data-value="simple"])').css({"pointer-events":"none",opacity:.5}).find(".n2_field_select_icon__option_label").append(document.createTextNode(" ("+n2_("Pro")+")")),N2Classes.UI.modalSubHeading(n2_("Settings")).appendTo(e);var a=N2Classes.UI.modalFormRow().appendTo(e),l=N2Classes.UI.modalFieldText(a,"project-name",n2_("Name"),n2_("My project")).css("width",200),d=N2Classes.UI.modalNumber(a,"slider-width",n2_("Width"),1200,{min:200,unit:"px"}),h=N2Classes.UI.modalNumber(a,"slider-height",n2_("Height"),600,{min:100,unit:"px"}),c={boxed:n2_("Boxed"),fullwidth:n2_("Full width"),fullpage:n2_("Full page")},p=N2Classes.UI.modalSelect(a,"slider-responsive-mode",n2_("Layout"),c,"fullwidth");a.find('option[value="fullpage"]').attr("disabled","disabled").text(n2_("Full page")+" ("+n2_("Pro")+")");var u=N2Classes.UI.modalButton(n2_("Create"),"green").on("click",function(t){t.preventDefault();var e={groupID:this.groupID,projectName:l.val(),projectType:n.val(),sliderWidth:parseInt(d.val()),sliderHeight:parseInt(h.val()),responsiveMode:p.val()};N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"create"}),data:e,dataType:"json"}).done(function(t){N2Classes.LoadingScreen.startLoading()}.bind(this))}.bind(this));t.addButton(u),i(),t.show()},e.prototype.showExampleSlidersWindow=function(){var i=this;f("body").css("overflow","hidden");function s(){f("body").css("overflow",""),t.remove(),window.removeEventListener("message",e,!1)}function n(t){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(i.ajaxUrl,{nextendaction:"importDemo"}),data:{groupID:i.groupID,key:N2Classes.Base64.encode(t.replace(/^(http(s)?:)?\/\//,"//"))},dataType:"json"}).fail(function(){})}var t=f('<iframe src="//smartslider3.com/demo-import/?pro=0&version='+N2SS3VERSION+"&utm_campaign="+N2SS3C+"&utm_source=import-slider-frame&utm_medium=smartslider-"+N2PLATFORM+'-free"></iframe>').css({position:"fixed",zIndex:1e5,left:0,top:0,width:"100%",height:"100%"}).appendTo("body"),e=function(t){if("http://smartslider3.com"===t.origin||"https://smartslider3.com"===t.origin){var e=t.data;switch(e.key){case"importSlider":return void(i.skipNewsletter?n(e.data.href):i.joinCommunity(function(){n(e.data.href)}));case"closeWindow":s()}}};N2Classes.Esc.add(function(){return s(),!0}.bind(this)),window.addEventListener("message",e,!1)},e.prototype.joinCommunity=function(e){function i(t,e){N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(N2Classes.AjaxHelper.getAdminUrl("ss3-admin"),{nextendcontroller:"settings",nextendaction:e||"dismissNewsletterSampleSliders"}),dataType:"json"})}this.modal=new N2Classes.ModalSimple("url-modal"),this.modal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--newsletter","purple")),this.modal.addContent(N2Classes.UI.modalHeading(n2_("Join The Smart Slider 3 Community"))),this.modal.addContent(N2Classes.UI.modalParagraph(n2_("Join more than 120,000 subscribers and get access to the latest slider templates, tips, tutorials and other exclusive contents directly to your inbox.")).css("margin-bottom","12px")),this.modal.$modalBody.css("text-align","center");var s=f("<form></form>");s.append(N2Classes.UI.modalInput("EMAIL","email","","example@google.com")),s.append(N2Classes.UI.modalInput(N2PLATFORM.toUpperCase(),"hidden","Yes")),s.append(N2Classes.UI.modalInput("SOURCE","hidden","Smart Slider 3")),this.modal.addContent(s);var t=N2Classes.UI.modalButton(n2_("Subscribe"),"purple");this.modal.addButton(t),t.on("click",function(t){N2Classes.AjaxHelper.ajax({type:"POST",url:"https://secure.nextendweb.com/mailchimp/subscribe.php",data:s.serialize(),dataType:"json"}).done(function(){e()}),i(0,"subscribed")}.bind(this)),this.modal.$modalBodyOuter.find(".n2_modal__close").on("click",function(t){i(),e()}),this.modal.show()},e}),N2D("SliderEdit",function(n,o){function t(t){this.options=n.extend({previewInNewWindow:!1,saveAjaxUrl:"",previewUrl:"",ajaxUrl:"",formData:{}},t),this.url=this.options.ajaxUrl,this.values=this.options.formData,N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((t.prototype=Object.create(N2Classes.Form.prototype)).constructor=t).prototype.onReady=function(){this.setID("#n2-ss-edit-slider-form"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSaveSubmit.bind(this)),this.initPreview()},t.prototype.onKeyDown=function(t){var e=!1;return(t.ctrlKey||t.metaKey)&&49===t.keyCode&&(this.showPreview(),e=!0),e?t.preventDefault():e=N2Classes.Form.prototype.onKeyDown.call(this,t),e},t.prototype.initButtons=function(){this.$saveButton=n(".n2_slider_settings_save").on("click",this.actionSave.bind(this)),n(".n2_slider_settings_back").on("click",this.actionCancel.bind(this))},t.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit()},t.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},t.prototype.onSaveSubmit=function(t){this.$form.attr("target")===o&&(t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.options.saveAjaxUrl,data:this.$form.serialize(),dataType:"json",success:this.onAfterSave.bind(this)}))},t.prototype.onAfterSave=function(t){if(n(".n2_header__heading_primary").text(n("#slidertitle").val()),t&&t.data&&t.data.changedFields){for(var e in t.data.changedFields)t.data.changedFields.hasOwnProperty(e)&&n("#"+e).val(t.data.changedFields[e]);var i,s;t.data.changedFields.slideralias!==o&&(i=t.data.changedFields[e],(s=n('.n2_ss_slider_publish__option_code[data-mode="alias"]')).length||(s=n('<div class="n2_ss_slider_publish__option_code" data-mode="alias"></div>').insertAfter(n('.n2_ss_slider_publish__option_code[data-mode="id"]'))),i?s.text('[smartslider3 alias="'+i+'"]'):s.remove())}this.afterSave()},t.prototype.initPreview=function(){this.options.previewInNewWindow||(this.modal=new N2Classes.ModalIframe("preview-slider")),n(".n2_top_bar_main__preview").on("click",function(t){t.preventDefault(),this.showPreview()}.bind(this))},t.prototype.showPreview=function(){"main"===N2Classes.WindowManager.getCurrentWindow()&&(this.options.previewInNewWindow?N2Classes.PreviewPopup("","preview-slider"):this.modal.show(),this.$form.attr({action:N2Classes.AjaxHelper.makeAjaxUrl(this.options.previewUrl,{nextendaction:this.options.previewInNewWindow?"index":"slider"}),target:"preview-slider"}).submit().attr({action:this.formAction,target:null}))},t}),N2D("SliderImport",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-slider-import"),N2Classes.Form.prototype.onReady.call(this),this.$localImportSwitch=t("#sliderupload_or_local"),this.$localImport=t("#sliderlocal-import-file"),this.$uploadImport=t("#sliderimport-file"),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.onChange=function(){this.hasChange=!1,parseInt(this.$localImportSwitch.val())?""!==this.$localImport.val()&&(this.hasChange=!0):""!==this.$uploadImport.val()&&(this.hasChange=!0),this.$saveButton.toggleClass("n2_button--inactive",!this.hasChange)},i.prototype.initButtons=function(){this.$saveButton=t(".n2_slider_import").on("click",this.actionSave.bind(this)),t(".n2_slider_import_back").on("click",this.actionCancel.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},i.prototype.onSubmit=function(t){t.preventDefault();var e=new FormData(this.$form[0]);N2Classes.AjaxHelper.ajax({type:"POST",contentType:!1,url:this.$form.attr("action"),processData:!1,data:e,dataType:"json"})},i}),N2D("ManageSliders",function(l,t){function e(t,e,i){this.groupID=t,this.exportAllUrl=e.exportAllUrl,this.ajaxUrl=e.ajaxUrl,this.previewUrl=e.previewUrl,this.importUrl=e.importUrl,this.sliders=[],this.sliderPanel=l(".n2_slider_manager"),this.orderBy="ordering"===this.sliderPanel.data("orderby"),this.slidersContainer=this.sliderPanel.find(".n2_slider_manager__content");for(var s=this.slidersContainer.find(".n2_slider_box"),n=0;n<s.length;n++)this.sliders.push(new N2Classes.Slider(this,s.eq(n)));this.changed(),this.initOrderable(),this.create=new N2Classes.CreateSlider(t,this.ajaxUrl,i,e.userEmail,e.skipNewsletter,this.importUrl),this.initBulk()}return e.prototype.changed=function(){l("html").attr("data-sliders",this.sliders.length)},e.prototype.initSliders=function(){for(var t=this.slidersContainer.find(".n2_slider_box"),e=[],i=0;i<t.length;i++){var s=t.eq(i).data("slider");e.push(s)}this.sliders=e,this.changed(),l(window).triggerHandler("SmartSliderSidebarSlidersChanged")},e.prototype.initOrderable=function(){var t;this.orderBy&&(t={helper:"clone",items:"> .n2_slider_box",stop:this.saveOrder.bind(this),placeholder:"n2_slider_manager__sortable_placeholder",distance:10},this.uiSortable=new N2Classes.UISortable(this.slidersContainer,t))},e.prototype.saveOrder=function(t,e){for(var i=this.slidersContainer.find(".n2_slider_box"),s=[],n=[],o=[],r=0;r<i.length;r++){var a=i.eq(r).data("slider");s.push(a),n.push(a.getId())}for(r=0;r<this.sliders.length;r++)o.push(this.sliders[r].getId());JSON.stringify(o)!==JSON.stringify(n)&&(l(window).triggerHandler("SmartSliderSidebarSlidersOrderChanged"),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"order"}),data:{groupID:this.groupID,sliderorder:n,isReversed:"DESC"===this.sliderPanel.data("orderbydirection")?1:0}}),this.sliders=s)},e.prototype.trashSliders=function(t,e){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"trash"}),type:"POST",data:{groupID:this.groupID,sliders:t}}).done(function(){for(var t=0;t<e.length;t++)e[t].remove();this.initSliders(),this.leaveBulk()}.bind(this))},e.prototype.duplicateSliders=function(t,e){for(var i=0;i<this.sliders.length;i++)this.sliders[i].selected&&this.sliders[i].duplicate(l.Event("click",{currentTarget:null}))},e.prototype.exportSliders=function(t,e){window.location.href=N2Classes.N2QueryString.add_query_arg({sliders:t},this.exportAllUrl)},e.prototype.initBulk=function(){this.selection=[],this.isBulkSelection=!1,l("#n2_slider_manager_bulk_actions a[data-action]").on("click",function(t){switch(t.preventDefault(),l(t.currentTarget).data("action")){case"duplicate":this.bulkAction("duplicateSliders",!1);break;case"trash":this.bulkAction("trashSliders",!1);break;case"export":this.bulkAction("exportSliders",!1);break;case"select-all":this.bulkSelect(function(t){t.select()});break;case"select-none":this.bulkSelect(function(t){t.deSelect()})}}.bind(this))},e.prototype.addSelection=function(t){0===this.selection.length&&this.enterBulk(),this.selection.push(t)},e.prototype.removeSelection=function(t){this.selection.splice(this.selection.indexOf(t),1),0===this.selection.length&&this.leaveBulk()},e.prototype.bulkSelect=function(t){for(var e=0;e<this.sliders.length;e++)t(this.sliders[e])},e.prototype.bulkAction=function(t,e){var i=[],s=[];this.bulkSelect(function(t){!t.selected||e&&t.isGroup||(i.push(t),s.push(t.getId()))}),s.length?(this[t](s,i),this.leaveBulk()):e?N2Classes.Notification.notice("Please select one or more sliders for the action!"):N2Classes.Notification.notice("Please select one or more sliders or groups for the action!")},e.prototype.enterBulk=function(){this.isBulkSelection||(this.isBulkSelection=!0,this.orderBy&&this.uiSortable.setOption("disabled",!0),l("body").addClass("n2_body--bulk-select"))},e.prototype.leaveBulk=function(){if(this.isBulkSelection){this.orderBy&&this.uiSortable.setOption("disabled",!1),l("body").removeClass("n2_body--bulk-select");for(var t=0;t<this.sliders.length;t++)this.sliders[t].deSelect();this.selection=[],this.isBulkSelection=!1}},e}),N2D("SelectSlider",function(h,e){var s=!1;function n(){this.cache={},this.ajaxUrl=N2Classes.AjaxHelper.makeAjaxUrl(N2Classes.AjaxHelper.getAdminUrl("ss3-admin"),{nextendcontroller:"sliders",nextendaction:"list"}),this.modal=new N2Classes.ModalLightbox("","select-slider"),this.modal.insertButton=N2Classes.UI.modalButton(n2_("Insert"),"green").addClass("n2_button--inactive"),this.modal.addButton(this.modal.insertButton),this.modal.insertButton.on("click",function(t){this.insertSlider(t)}.bind(this)),this.$content=h('<div class="n2_modal_select_slider"></div>'),this.modal.addContent(this.$content)}return n.prototype.setSkipGroup=function(t){this.skipGroup=t},n.prototype.setTitle=function(t){this.modal.setTitle(t)},n.prototype.displayList=function(t){t===e&&(t=0),this.cache[t]===e?N2Classes.AjaxHelper.ajax({url:this.ajaxUrl,type:"POST",data:{parentID:t}}).done(function(t,e){this.cache[t]=e.data,this.renderResponse(t,e.data)}.bind(this,t)):this.renderResponse(t,this.cache[t])},n.prototype.renderResponse=function(e,t){this.$content.html(""),this.selectedSlider=[0],this.modal.insertButton.addClass("n2_button--inactive"),0<e&&(h('<div class="n2_slider_box__content"></div>').append(h('<div class="n2_modal_select_slider__box n2_slider_box"></div>').append(h('<div class="n2_slider_box__icon n2_slider_box__icon_grey"></div>').append(h('<div class="n2_slider_box__icon_container"><i class="ssi_64 ssi_64--folderup"></i></div>')).append(h('<div class="n2_slider_box__icon_text">'+n2_("Up")+"</div>")))).appendTo(this.$content).on("click",this.displayList.bind(this,0)),this.skipGroup||h('<div class="n2_slider_box__content"></div>').append(h('<div class="n2_modal_select_slider__box n2_slider_box"></div>').append(h('<div class="n2_slider_box__icon n2_slider_box__icon_grey"></div>').append(h('<div class="n2_slider_box__icon_container"><i class="ssi_64 ssi_64--folder"></i></div>')).append(h('<div class="n2_slider_box__icon_text">'+n2_("Insert group")+"</div>")))).appendTo(this.$content).on("click",function(t){this.selectedSlider=[e],this.insertSlider(t)}.bind(this)));for(var i=0;i<t.length;i++){var s=t[i],n=h('<div class="n2_slider_box__slider_identifiers"></div>').append(h('<div class="n2_slider_box__slider_identifier"></div>').text("#"+s.id));s.isGroup&&n.append(h('<div class="n2_slider_box__slider_identifier"></div>').text(n2_("Group"))),s.alias&&n.append(h('<div class="n2_slider_box__slider_identifier"></div>').text(s.alias));var o="ssi_64 ssi_64--image";s.isGroup&&(o="ssi_64 ssi_64--folder");var r=h('<div class="n2_slider_box__icon"><div class="n2_slider_box__icon_container"><i class="'+o+'"></i></div></div>'),a=h('<div class="n2_slider_box__content"></div>').append(n);""===s.thumbnail&&a.append(r);var l=h('<div class="n2_slider_box__footer"></div>');s.isGroup&&l.append(h('<div class="n2_slider_box__footer_icon"><i class="ssi_16 ssi_16--folderclosed"></i></div>'));var d=h('<div class="n2_modal_select_slider__box n2_slider_box"></div>').css("background-image","url("+s.thumbnail+")").append(a).append(l.append(h('<div class="n2_slider_box__footer_title"></div>').text(s.title)).append(h('<div class="n2_slider_box__footer_children_count"></div>').text(s.childrenCount))).appendTo(this.$content);s.isGroup?d.addClass("n2_slider_box--group").on("click",this.displayList.bind(this,s.id)):d.addClass("n2_slider_box--slider").on("click",this.select.bind(this,s.id,s.alias,e))}},n.prototype.select=function(t,e,i,s){this.$content.find(".n2_slider_box--selected").removeClass("n2_slider_box--selected"),h(s.currentTarget).addClass("n2_slider_box--selected"),this.selectedSlider=[t,e,i],this.modal.insertButton.removeClass("n2_button--inactive")},n.prototype.insertSlider=function(t){var e=this.selectedSlider[0],i=this.selectedSlider[1],s=this.selectedSlider[2];0!==e&&(this.callback.call(window,e,i,s),this.modal.hide(t))},n.prototype.show=function(t){this.callback=t,this.displayList(),this.modal.show()},function(t,e,i){!1===s&&(s=new n),s.setSkipGroup(i),s.setTitle(t),s.show(e)}}),N2D("Slider",function(n,t){function o(t,e){this.selected=!1,this.manager=t,this.box=e.data("slider",this),this.isGroup=!!this.box.data("group"),this.editUrl=this.box.find(".n2_slider_box__slider_overlay_edit_button").attr("href"),this.box.on("contextmenu",this.onContextMenu.bind(this)),this.box.find(".n2_slider_box__slider_select_tick").on("click",function(t){t.stopPropagation(),t.preventDefault(),this.invertSelection()}.bind(this)),this.$more=this.box.find(".n2_slider_box__slider_action_more").on("click",this.onMore.bind(this)),this.initRename()}return o.prototype.getId=function(){return this.box.data("sliderid")},o.prototype.onContextMenu=function(t){t.preventDefault(),this.showContextMenu(t)},o.prototype.onMore=function(t){t.preventDefault(),this.showContextMenu(this.$more[0])},o.prototype.showContextMenu=function(t){var e=[];e.push({priority:10,label:n2_("Preview"),icon:"ssi_16 ssi_16--eye",action:this.preview.bind(this)}),e.push({priority:55,label:n2_("Duplicate"),icon:"ssi_16 ssi_16--duplicate",action:this.duplicate.bind(this)}),e.push({priority:1e3,label:n2_("Move to trash"),icon:"ssi_16 ssi_16--delete",action:this.trash.bind(this),color:"red"}),this.box.addClass("n2_slider_box--context-menu"),N2Classes.ContextMenu(t,e,{y:5,horizontalAlign:"left",onClose:function(){this.box.removeClass("n2_slider_box--context-menu")}.bind(this)})},o.prototype.preview=function(){window.open(N2Classes.N2QueryString.add_query_arg({sliderid:this.getId()},this.manager.previewUrl),"_blank")},o.prototype.duplicate=function(){var s=n.Deferred();return N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slider",nextendaction:"duplicate",sliderid:this.getId()})}).done(function(t){var e=n(t.data).insertAfter(this.box),i=new o(this.manager,e);this.manager.initSliders(),s.resolve(i)}.bind(this)),s},o.prototype.trash=function(){this.manager.trashSliders([this.getId()],[this])},o.prototype.remove=function(){this.box.remove()},o.prototype.invertSelection=function(t){t&&t.preventDefault(),this.selected?this.deSelect():this.select()},o.prototype.select=function(){this.selected||(this.selected=!0,this.box.addClass("n2_slider_box--bulk-selected"),this.manager.addSelection(this))},o.prototype.deSelect=function(){this.selected&&(this.selected=!1,this.box.removeClass("n2_slider_box--bulk-selected"),this.manager.removeSelection(this))},o.prototype.initRename=function(){this.dblClickTimeout=!1,this.$label=this.box.find(".n2_slider_box__footer_title").on("click",function(t){"true"!==this.$label[0].contentEditable&&(this.dblClickTimeout?(clearTimeout(this.dblClickTimeout),this.dblClickTimeout=!1,this.editName()):this.dblClickTimeout=setTimeout(function(){window.location=this.editUrl,this.dblClickTimeout=!1}.bind(this),500))}.bind(this)),this.title=this.$label.text().trim(),this.$label.text(this.title)},o.prototype.editName=function(){new N2Classes.InlineTextEditor(this.$label[0],{onSave:function(t){this.title!==t&&N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slider",nextendaction:"rename",sliderid:this.getId(),title:t})}).done(function(){this.title=t}.bind(this)).fail(function(){this.$label.text(this.title)}.bind(this))}.bind(this),onCancel:function(){this.$label.text(this.title)}.bind(this),onTab:function(t){for(var e=n(".n2_slider_box__footer_title"),i=0;i<e.length;i++)if(this.$label.is(e[i])){t.shiftKey?i--:i++;break}i<0?i=e.length-1:i>=e.length&&(i=0),e.eq(i).trigger("click").trigger("click")}.bind(this)})},o}),N2D("SlidersTrash",function(s,t){function e(t){this.options=t,this.$container=s(".n2_slider_trash");for(var e=this.$container.find(".n2_slider_box"),i=0;i<e.length;i++)new n(this,e.eq(i));this.$emptyTrashButton=s(".n2_slider_empty_trash").on("click",this.emptyTrash.bind(this)),this.refreshEmptyTrashStatus()}function n(t,e){this.manager=t,this.$box=e,this.$box.on("contextmenu",this.onContextMenu.bind(this)),this.$box.find(".n2_slider_box__slider_overlay_restore_button").on("click",this.restore.bind(this)),this.$more=this.$box.find(".n2_slider_box__slider_action_more").on("click",this.onMore.bind(this))}return e.prototype.emptyTrash=function(t){t.preventDefault(),this.isEmpty()||N2Classes.ModalDeleteConfirm(n2_("empty the trash"),function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl,{nextendcontroller:"sliders",nextendaction:"emptyTrash"}),type:"POST"}).done(function(){this.$container.find(".n2_slider_box").remove(),this.refreshEmptyTrashStatus()}.bind(this))}.bind(this))},e.prototype.isEmpty=function(){return 0===this.$container.find(".n2_slider_box").length},e.prototype.refreshEmptyTrashStatus=function(){var t=this.isEmpty();this.$container.toggleClass("n2_slider_trash--empty",t),this.$emptyTrashButton.toggleClass("n2_button--inactive",t)},n.prototype.getId=function(){return this.$box.data("sliderid")},n.prototype.onContextMenu=function(t){t.preventDefault(),this.showContextMenu(t)},n.prototype.onMore=function(t){t.preventDefault(),this.showContextMenu(this.$more[0])},n.prototype.showContextMenu=function(t){var e=[];e.push({priority:20,label:n2_("Preview"),icon:"ssi_16 ssi_16--eye",action:this.preview.bind(this)}),e.push({priority:30,label:n2_("Delete permanently"),icon:"ssi_16 ssi_16--delete",action:this.deletePermanently.bind(this),color:"red"}),this.$box.addClass("n2_slider_box--context-menu"),N2Classes.ContextMenu(t,e,{y:5,horizontalAlign:"left",onClose:function(){this.$box.removeClass("n2_slider_box--context-menu"),this.manager.refreshEmptyTrashStatus()}.bind(this)})},n.prototype.restore=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.options.ajaxUrl,{nextendcontroller:"slider",nextendaction:"restore"}),type:"POST",data:{slider:this.getId()}}).done(function(){this.$box.remove(),this.manager.refreshEmptyTrashStatus()}.bind(this))},n.prototype.preview=function(){window.open(N2Classes.N2QueryString.add_query_arg({sliderid:this.getId()},this.manager.options.previewUrl),"_blank")},n.prototype.deletePermanently=function(){N2Classes.ModalDeleteConfirm(n2_("delete this slider"),function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.options.ajaxUrl,{nextendcontroller:"slider",nextendaction:"deletePermanently"}),type:"POST",data:{slider:this.getId()}}).done(function(t){this.$box.remove();for(var e=t.data.sliderIDs,i=0;i<e.length;i++)s('.n2_slider_manager__box[data-sliderid="'+e[i]+'"]').remove();this.manager.refreshEmptyTrashStatus()}.bind(this))}.bind(this))},e}),N2D("FormElementAnimationManager",["FormElement"],function(i,t){function e(t,e){this.element=i("#"+t),this.parent=this.element.parent(),this.managerIdentifier=e,this.parent.find(".n2_field_chooser__choose, .n2_field_chooser__label").on("click",this.show.bind(this)),this.parent.find(".n2_field_chooser__clear").on("click",this.clear.bind(this)),this.$name=this.parent.find(".n2_field_chooser__label"),this.updateName(this.element.val()),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.show=function(t){t.preventDefault(),nextend[this.managerIdentifier].show(this.element.val(),this.save.bind(this))},e.prototype.clear=function(t){t.preventDefault(),t.stopPropagation(),this.val("")},e.prototype.save=function(t,e){this.val(e)},e.prototype.val=function(t){this.element.val(t),this.updateName(t),this.triggerOutsideChange()},e.prototype.insideChange=function(t){this.element.val(t),this.updateName(t),this.triggerInsideChange()},e.prototype.updateName=function(t){var e;this.parent.toggleClass("n2_field_chooser--empty",""===t),e=""===t?n2_("Disabled"):n2_("Enabled"),this.$name.text(e)},e.prototype.isEmpty=function(t){return""===t},e}),N2D("FormElementColumns",["FormElement"],function(a,e){function t(t){this.denominators={1:100,2:100,3:144,4:100,5:100,6:144},this.element=a("#"+t),N2Classes.FormElement.prototype.constructor.call(this),this.$c=a("#"+t).parent(),this.$container=this.$c.find(".n2_field_columns__content"),this.containerWidth=280,this.maxWidth=0,new N2Classes.UISortable(this.$container,{axis:"x",items:".n2_field_columns__column",helper:"clone_hide",start:function(t,e){this.$container.addClass("n2-sortable-currently-sorted"),e.placeholder.css({width:e.item.width(),visibility:"hidden"});var i=this.$container.find(".n2_field_columns__column");e.item.data("index",i.index(e.item))}.bind(this),stop:function(t,e){var i=this.$container.find(".n2_field_columns__column"),s=e.item.data("index"),n=i.index(e.item);s!=n&&(this.currentRow.moveColOrOrder(s,n),e.item.data("index",null)),this.makeResizable(),this.$container.removeClass("n2-sortable-currently-sorted")}.bind(this)}),this.$c.find(".n2_field_columns__add").on({click:function(){this.currentRow.createCol()}.bind(this)})}return((t.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=t).prototype.getDenominator=function(t){return this.denominators[t]===e&&(this.denominators[t]=15*t),this.denominators[t]},t.prototype.setRow=function(t){this.currentRow=t,this.insideChange(t.getColumnsOrdered())},t.prototype.setValue=function(t){},t.prototype.insideChange=function(t){this.start(t)},t.prototype.activateColumn=function(t){var e=this.$container.find(".n2_field_columns__column").index(t.currentTarget);this.currentRow.activateColumn(e,t)},t.prototype.start=function(t){this.percentages=[];for(var e=t.split("+"),i=0;i<e.length;i++)this.percentages.push(new Fraction(e[i]));this.refreshMaxWidth(),this.$container.empty();for(i=0;i<this.percentages.length;i++){var s=a('<div class="n2_field_columns__column">').on("click",this.activateColumn.bind(this)).appendTo(this.$container);nextend.tooltip.addElement(s,n2_("Column")),this.updateColumn(s,this.percentages[i])}this.makeResizable()},t.prototype.refreshMaxWidth=function(){this.maxWidth=this.containerWidth-16*(this.percentages.length-1)},t.prototype.updateColumn=function(t,e){t.css("width",this.maxWidth*e.valueOf()+"px").html(Math.round(100*e.valueOf()*10)/10+"%")},t.prototype.makeResizable=function(){this.handles&&this.handles.remove(),this.$columns=this.$container.find(".n2_field_columns__column"),a('<div class="n2_field_columns__handle"><div class="ssi_16 ssi_16--divide"></div></div>').insertAfter(this.$columns.not(this.$columns.last())),this.handles=this.$container.find(".n2_field_columns__handle").on("mousedown",this._resizeStart.bind(this))},t.prototype._resizeStart=function(t){var e=this.handles.index(t.currentTarget),i=this.$container.offset().left+8;this.resizeContext={index:e,cLeft:i,$currentCol:this.$columns.eq(e),$nextCol:this.$columns.eq(e+1),startX:Math.max(0,Math.min(t.clientX-i,this.containerWidth))},this._resizeMove(t),a("html").off(".resizecol").on({"mousemove.resizecol":this._resizeMove.bind(this),"mouseup.resizecol mouseleave.resizecol":this._resizeStop.bind(this)})},t.prototype._resizeMove=function(t){t.preventDefault();var e=Math.max(0,Math.min(t.clientX-this.resizeContext.cLeft,this.containerWidth)),i=this.getDenominator(this.percentages.length),s=new Fraction(Math.round((e-this.resizeContext.startX)/(this.maxWidth/i)),i);s.compare(this.percentages[this.resizeContext.index].clone().mul(-1))<0&&(s=this.percentages[this.resizeContext.index].clone().mul(-1)),0<s.compare(this.percentages[this.resizeContext.index+1])&&(s=this.percentages[this.resizeContext.index+1].clone());var n=this.percentages[this.resizeContext.index].add(s),o=this.percentages[this.resizeContext.index+1].sub(s);this.updateColumn(this.resizeContext.$currentCol,n),this.updateColumn(this.resizeContext.$nextCol,o);var r=a.extend([],this.percentages);return r[this.resizeContext.index]=n,r[this.resizeContext.index+1]=o,this.onColumnWidthChange(r),[n,o]},t.prototype._resizeStop=function(t){var e=this._resizeMove(t);this.percentages[this.resizeContext.index]=e[0],this.percentages[this.resizeContext.index+1]=e[1],a("html").off(".resizecol"),delete this.resizeContext,this.currentRow.setRealColsWidth(this.percentages)},t.prototype.onColumnWidthChange=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].valueOf());this.currentRow.updateColumnWidth(e)},t}),N2D("FormElementControlTypePicker",["FormElement"],function($,undefined){function FormElementControlTypePicker(t,e){this.options=$.extend({ajaxUrl:"",target:"",originalValue:""},e),this.id=t,this.element=$("#"+t);var i=this.element.parent();this.$items=i.find(".n2_field_control_type_picker__item"),this.target=$("#"+this.options.target),this.form=this.element.closest("form").data("form"),this.element.on("nextendChange",this.loadSubform.bind(this)),this.$items.on("click",function(t){this.selectOption($(t.currentTarget).data("controltype"))}.bind(this)),this.markSelected(this.options.originalValue),N2Classes.FormElement.prototype.constructor.call(this)}return FormElementControlTypePicker.prototype=Object.create(N2Classes.FormElement.prototype),FormElementControlTypePicker.prototype.constructor=FormElementControlTypePicker,FormElementControlTypePicker.prototype.loadSubform=function(){var t=this.element.val(),e=[];t===this.options.originalValue&&(e=this.form.values);var i={values:e,value:t};N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl),data:i,dataType:"json"}).done(this.load.bind(this))},FormElementControlTypePicker.prototype.load=function(response){this.target.html(response.data.html),eval(response.data.scripts),N2Classes.FormTipManager.add(this.target)},FormElementControlTypePicker.prototype.selectOption=function(t){this.setValue(t),this.markSelected(t),this.triggerOutsideChange()},FormElementControlTypePicker.prototype.setValue=function(t){this.element.val(t)},FormElementControlTypePicker.prototype.markSelected=function(t){this.$items.removeClass("n2_field_control_type_picker__item--selected");for(var e=0;e<this.$items.length;e++){this.$items.eq(e).data("controltype")===t&&$(this.$items[e]).addClass("n2_field_control_type_picker__item--selected")}},FormElementControlTypePicker}),N2D("FormElementDatePicker",["FormElement"],function(s,t){function e(t,e){this.element=s("#"+t),this.elements=[],this.elements.push(s("#"+e[0]).on("outsideChange",this.onFieldOnOffChange.bind(this)));for(var i=1;i<e.length;i++)this.elements.push(s("#"+e[i]).on("outsideChange",this.onFieldChange.bind(this)));N2Classes.FormElement.prototype.constructor.call(this),this.syncOnOff(),this.fixDate()}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.getValue=function(){if(1!==parseInt(this.elements[0].val()))return this.getEmptyDate();var t=[this.elements[1].val(),this.pad(this.elements[2].val()),this.pad(this.elements[3].val())],e=[this.pad(this.elements[4].val()),this.pad(this.elements[5].val()),"00"];return t.join("-")+" "+e.join(":")},e.prototype.onFieldOnOffChange=function(){var t,e,i;1===parseInt(this.elements[0].val())&&"0000"===this.elements[1].val()&&(e=[(t=new Date).getFullYear(),this.pad(t.getMonth()+1),this.pad(t.getDate())],i=[this.pad(t.getHours()),this.pad(t.getMinutes()),"00"],this.insideChange(e.join("-")+" "+i.join(":"))),this.onFieldChange()},e.prototype.onFieldChange=function(){this.fixDate()||(this.element.val(this.getValue()),this.triggerOutsideChange())},e.prototype.insideChange=function(t){var e,i,s;this.element.val(t),t===this.getEmptyDate()?this.elements[0].data("field").insideChange(0):(i=(e=t.split(" "))[0].split("-"),s=e[1].split(":"),this.elements[0].data("field").insideChange(1),this.elements[1].data("field").insideChange(i[0]),this.elements[2].data("field").insideChange(i[1]),this.elements[3].data("field").insideChange(i[2]),this.elements[4].data("field").insideChange(s[0]),this.elements[5].data("field").insideChange(s[1]),this.fixDate()),this.triggerInsideChange()},e.prototype.syncOnOff=function(){this.element.val()===this.getEmptyDate()?this.elements[0].data("field").insideChange(0):this.elements[0].data("field").insideChange(1)},e.prototype.getEmptyDate=function(){return"0000-00-00 00:00:00"},e.prototype.pad=function(t,e){e=e||2;for(var i=t+"";i.length<e;)i="0"+i;return i},e.prototype.fixDate=function(){if(1===parseInt(this.elements[0].val())){for(var t=this.elements[1].val(),e=this.elements[2].val(),i=this.elements[3].val(),s=this.elements[3].data("field").select,n=new Date(t,e,0).getDate(),o=s[0].length,r=o;0<r;r--)s[0][r-1].removeAttribute("hidden");for(var a=o;n<a;a--)s[0][a-1].setAttribute("hidden","hidden");if(n<i)return this.elements[3].data("field").insideChange(n),this.onFieldChange(),!0}return!1},e}),function(t){"use strict";var g={s:1,n:0,d:1};function y(t,e){return isNaN(t=parseInt(t,10))&&m(),t*e}function m(){throw"Invalid Param"}var s=function(t,e){var i,s=0,n=1,o=1,r=0,a=0,l=0,d=1,h=1,c=0,p=1,u=1,f=1;if(null!=t)if(void 0!==e)o=(s=t)*(n=e);else switch(typeof t){case"object":"d"in t&&"n"in t?(s=t.n,n=t.d,"s"in t&&(s*=t.s)):0 in t?(s=t[0],1 in t&&(n=t[1])):m(),o=s*n;break;case"number":if(t<0&&(t=-(o=t)),t%1==0)s=t;else if(0<t){for(1<=t&&(t/=h=Math.pow(10,Math.floor(1+Math.log(t)/Math.LN10)));p<=1e7&&f<=1e7;){if(t===(i=(c+u)/(p+f))){n=p+f<=1e7?(s=c+u,p+f):p<f?(s=u,f):(s=c,p);break}i<t?(c+=u,p+=f):(u+=c,f+=p),n=1e7<p?(s=u,f):(s=c,p)}s*=h}else(isNaN(t)||isNaN(e))&&(n=s=NaN);break;case"string":if("-"===(p=t.match(/\d+|./g))[c]?(o=-1,c++):"+"===p[c]&&c++,p.length===c+1?a=y(p[c++],o):"."===p[c+1]||"."===p[c]?("."!==p[c]&&(r=y(p[c++],o)),(++c+1===p.length||"("===p[c+1]&&")"===p[c+3]||"'"===p[c+1]&&"'"===p[c+3])&&(a=y(p[c],o),d=Math.pow(10,p[c].length),c++),("("===p[c]&&")"===p[c+2]||"'"===p[c]&&"'"===p[c+2])&&(l=y(p[c+1],o),h=Math.pow(10,p[c+1].length)-1,c+=3)):"/"===p[c+1]||":"===p[c+1]?(a=y(p[c],o),d=y(p[c+2],1),c+=3):"/"===p[c+3]&&" "===p[c+1]&&(r=y(p[c],o),a=y(p[c+2],o),d=y(p[c+4],1),c+=5),p.length<=c){o=s=l+(n=d*h)*r+h*a;break}default:m()}if(0===n)throw"DIV/0";g.s=o<0?-1:1,g.n=Math.abs(s),g.d=Math.abs(n)},u=function(t,e){if(!t)return e;if(!e)return t;for(;;){if(!(t%=e))return e;if(!(e%=t))return t}};function f(t,e){if(!(this instanceof f))return new f(t,e);s(t,e),t=f.REDUCE?u(g.d,g.n):1,this.s=g.s,this.n=g.n/t,this.d=g.d/t}f.REDUCE=1,f.prototype={s:1,n:0,d:1,abs:function(){return new f(this.n,this.d)},neg:function(){return new f(-this.s*this.n,this.d)},add:function(t,e){return s(t,e),new f(this.s*this.n*g.d+g.s*this.d*g.n,this.d*g.d)},sub:function(t,e){return s(t,e),new f(this.s*this.n*g.d-g.s*this.d*g.n,this.d*g.d)},mul:function(t,e){return s(t,e),new f(this.s*g.s*this.n*g.n,this.d*g.d)},div:function(t,e){return s(t,e),new f(this.s*g.s*this.n*g.d,this.d*g.n)},clone:function(){return new f(this)},mod:function(t,e){return isNaN(this.n)||isNaN(this.d)?new f(NaN):void 0===t?new f(this.s*this.n%this.d,1):(s(t,e),0===g.n&&0===this.d&&f(0,0),new f(this.s*g.d*this.n%(g.n*this.d),g.d*this.d))},gcd:function(t,e){return s(t,e),new f(u(g.n,this.n),g.d*this.d/u(g.d,this.d))},lcm:function(t,e){return s(t,e),0===g.n&&0===this.n?new f:new f(g.n*this.n/u(g.n,this.n),u(g.d,this.d))},ceil:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new f(NaN):new f(Math.ceil(t*this.s*this.n/this.d),t)},floor:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new f(NaN):new f(Math.floor(t*this.s*this.n/this.d),t)},round:function(t){return t=Math.pow(10,t||0),isNaN(this.n)||isNaN(this.d)?new f(NaN):new f(Math.round(t*this.s*this.n/this.d),t)},inverse:function(){return new f(this.s*this.d,this.n)},pow:function(t){return t<0?new f(Math.pow(this.s*this.d,-t),Math.pow(this.n,-t)):new f(Math.pow(this.s*this.n,t),Math.pow(this.d,t))},equals:function(t,e){return s(t,e),this.s*this.n*g.d==g.s*g.n*this.d},compare:function(t,e){s(t,e);var i=this.s*this.n*g.d-g.s*g.n*this.d;return(0<i)-(i<0)},divisible:function(t,e){return s(t,e),!(!(g.n*this.d)||this.n*g.d%(g.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(t){var e,i="",s=this.n,n=this.d;return this.s<0&&(i+="-"),1===n?i+=s:(t&&0<(e=Math.floor(s/n))&&(i+=e,i+=" ",s%=n),i+=s,i+="/",i+=n),i},toLatex:function(t){var e,i="",s=this.n,n=this.d;return this.s<0&&(i+="-"),1===n?i+=s:(t&&0<(e=Math.floor(s/n))&&(i+=e,s%=n),i+="\\frac{",i+=s,i+="}{",i+=n,i+="}"),i},toContinued:function(){for(var t,e=this.n,i=this.d,s=[];s.push(Math.floor(e/i)),t=e%i,e=i,i=t,1!==e;);return s},toString:function(){var t,e=this.n,i=this.d;if(isNaN(e)||isNaN(i))return"NaN";f.REDUCE||(e/=t=u(e,i),i/=t);for(var s=String(e).split(""),n=0,o=[~this.s?"":"-","",""],r="",a=function(t){for(;t%2==0;t/=2);for(;t%5==0;t/=5);if(1===t)return 0;for(var e=10%t,i=1;1!==e;i++)if(e=10*e%t,2e3<i)return 0;return i}(i),l=function(t,e){for(var i=1,s=function(t,e,i){for(var s=1;0<e;t=t*t%i,e>>=1)1&e&&(s=s*t%i);return s}(10,e,t),n=0;n<300;n++){if(i===s)return n;i=10*i%t,s=10*s%t}return 0}(i,a),d=-1,h=1,c=15+a+l+s.length,p=0;p<c;p++,n*=10){if(p<s.length?n+=Number(s[p]):(h=2,d++),0<a)if(d===l)o[h]+=r+"(",r="";else if(d===a+l){o[h]+=r+")";break}i<=n?(o[h]+=r+(n/i|0),r="",n%=i):1<h?r+="0":o[h]&&(o[h]+="0")}return o[0]+=o[1]||"0",o[2]?o[0]+"."+o[2]:o[0]}},t.Fraction=f}(window),N2D("FormElementSliderWidgetArea",["FormElement"],function(i,t){function e(t){this.element=i("#"+t),this.area=this.element.parent(),this.areas=this.area.find(".n2_field_widget_area__area"),this.areas.on("click",this.chooseArea.bind(this)),N2Classes.FormElement.prototype.constructor.call(this)}return((e.prototype=Object.create(N2Classes.FormElement.prototype)).constructor=e).prototype.chooseArea=function(t){var e=parseInt(i(t.target).data("area"));this.element.val(e),this.setSelected(e),this.triggerOutsideChange()},e.prototype.insideChange=function(t){t=parseInt(t),this.element.val(t),this.setSelected(t),this.triggerInsideChange()},e.prototype.setSelected=function(t){this.areas.removeClass("n2_field_widget_area__area--selected"),this.areas.eq(t-1).addClass("n2_field_widget_area__area--selected")},e}),N2D("FormElementWidgetPosition",function(e,i){function t(t){this.id=t,this.$element=e("#"+t),this.$label=this.$element.find(".n2_field_widget_position__label"),this.$positionElement=e("#"+t+"-area").on("nextendChange",this.onPositionChange.bind(this)),this.positionValue=this.$positionElement.val(),this.$offsetElement=e("#"+t+"-offset").on("nextendChange",this.onOffsetChange.bind(this)),this.offsetValue=this.$offsetElement.val(),this.$positionMode=e("#"+t+"-mode").on("nextendChange",this.onModeChange.bind(this)),this.modeValue=this.$positionMode.val(),this.refreshLabel(),this.$element.on("click",this.toggle.bind(this)),this.$element.find(".n2_field_widget_position__popover").on("click",this.stopPropagation.bind(this))}return t.prototype.stopPropagation=function(t){return t.originalEvent["handled"+this.id]!==i||!(t.originalEvent["handled"+this.id]=!0)},t.prototype.toggle=function(t){this.$element.hasClass("n2_field_widget_position--focus")?this.blur(t):this.focus(t)},t.prototype.focus=function(t){this.stopPropagation(t)||(this.$element.addClass("n2_field_widget_position--focus"),e("body").on("click."+this.id,this.blur.bind(this)))},t.prototype.blur=function(t){this.stopPropagation(t)||(this.$element.removeClass("n2_field_widget_position--focus"),e("body").off("click."+this.id))},t.prototype.refreshLabel=function(){var t="";if("advanced"===this.modeValue)t=n2_("Advanced");else{switch(parseInt(this.positionValue)){case 1:t=n2_sprintf(n2_("Outer %s"),n2_("Top"));break;case 2:t=n2_("Top")+" "+n2_("Left");break;case 3:t=n2_("Top")+" "+n2_("Center");break;case 4:t=n2_("Top")+" "+n2_("Right");break;case 5:t=n2_sprintf(n2_("Outer %s"),n2_("Left"));break;case 6:t=n2_("Middle")+" "+n2_("Left");break;case 7:t=n2_("Middle")+" "+n2_("Right");break;case 8:t=n2_sprintf(n2_("Outer %s"),n2_("Right"));break;case 9:t=n2_("Bottom")+" "+n2_("Left");break;case 10:t=n2_("Bottom")+" "+n2_("Center");break;case 11:t=n2_("Bottom")+" "+n2_("Right");break;case 12:t=n2_sprintf(n2_("Outer %s"),n2_("Bottom"))}0!==parseInt(this.offsetValue)&&(t+=" + "+this.offsetValue+"px")}this.$label.text(t)},t.prototype.onPositionChange=function(){this.positionValue=this.$positionElement.val(),this.refreshLabel()},t.prototype.onOffsetChange=function(){this.offsetValue=this.$offsetElement.val(),this.refreshLabel()},t.prototype.onModeChange=function(){this.modeValue=this.$positionMode.val(),this.refreshLabel()},t}),N2D("GeneratorAdd",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-generator-add"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.resetChangeTracker=function(){},i.prototype.initButtons=function(){this.$saveButton=t(".n2_generator_add").on("click",this.actionSave.bind(this)),t(".n2_generator_add_cancel").on("click",this.actionCancel.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("GeneratorConfigure",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-generator-configure"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.initButtons=function(){this.$saveButton=t(".n2_generator_configuration_save").on("click",this.actionSave.bind(this)),t(".n2_generator_configuration_cancel").on("click",this.actionCancel.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("GeneratorEdit",function(e,t){function i(t){N2Classes.Form.prototype.constructor.call(this),this.options=e.extend({previewInNewWindow:!1,previewUrl:""},t),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-generator-edit"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this)),this.initPreview()},i.prototype.initButtons=function(){this.$saveButton=e(".n2_generator_settings_save").on("click",this.actionSave.bind(this)),e(".n2_generator_settings_back").on("click",this.actionCancel.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},i.prototype.onSubmit=function(t){!0!==this.$form.data("preview")&&(t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"}))},i.prototype.initPreview=function(){this.options.previewInNewWindow||(this.modal=new N2Classes.ModalIframe("preview-slider")),e("#n2-ss-preview").on("click",function(t){t.preventDefault(),this.$form.data("preview",!0),this.options.previewInNewWindow?N2Classes.PreviewPopup("","preview-slider"):this.modal.show();var e=this.$form.attr("action");this.$form.attr({action:N2Classes.AjaxHelper.makeAjaxUrl(this.options.previewUrl,{nextendaction:this.options.previewInNewWindow?"index":"generator"}),target:"preview-slider"}).submit().attr({action:e,target:null}),this.$form.data("preview",!1)}.bind(this))},i}),N2D("FieldRecordViewer",function(i,t){function e(t,e){this.ajaxUrl=e,this.$element=i("#"+t).on("click",this.showRecords.bind(this)),this.$form=this.$element.closest("form")}return e.prototype.showRecords=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.ajaxUrl,data:this.$form.serialize(),dataType:"json"}).done(function(t){null!==t.data&&N2Classes.ModalGeneratorRecordViewer(t.data.headings,t.data.rows)})},e}),N2D("SettingsFonts",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-settings-fonts"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.initButtons=function(){this.$saveButton=t(".n2_settings_save").on("click",this.actionSave.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("SettingsFramework",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-settings-framework"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.initButtons=function(){this.$saveButton=t(".n2_settings_save").on("click",this.actionSave.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("SettingsGeneral",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-settings-general"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.initButtons=function(){this.$saveButton=t(".n2_settings_save").on("click",this.actionSave.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("SettingsItemDefaults",function(t,e){function i(t){N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((i.prototype=Object.create(N2Classes.Form.prototype)).constructor=i).prototype.onReady=function(){this.setID("#n2-ss-form-settings-item-defaults"),N2Classes.Form.prototype.onReady.call(this),this.$form.on("submit",this.onSubmit.bind(this))},i.prototype.initButtons=function(){this.$saveButton=t(".n2_settings_save").on("click",this.actionSave.bind(this))},i.prototype.actionSave=function(t){t&&t.preventDefault(),this.skipChangeConfirm=!0,this.$form.submit(),this.afterSave()},i.prototype.onSubmit=function(t){t.preventDefault(),N2Classes.AjaxHelper.ajax({type:"POST",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"json"})},i}),N2D("Slide",function(n,e){function o(t,e){this.selected=!1,this.manager=t,this.box=e.data("slide",this),this.editUrl=this.box.find(".n2_slide_box__slide_overlay_edit_button").attr("href"),this.isEdited=this.box.hasClass("n2_slide_box--currently-edited"),this.box.on("contextmenu",this.onContextMenu.bind(this)),this.box.find(".n2_slide_box__footer_status_published, .n2_slide_box__footer_status_unpublished").on("click",this.switchPublished.bind(this)),this.box.find(".n2_slide_box__slide_select_tick").on("click",function(t){t.preventDefault(),this.invertSelection()}.bind(this)),this.$more=this.box.find(".n2_slide_box__slide_action_more").on("click",this.onMore.bind(this)),this.initRename()}return o.prototype.onContextMenu=function(t){t.preventDefault(),this.showContextMenu(t)},o.prototype.onMore=function(t){t.preventDefault(),this.showContextMenu(this.$more[0])},o.prototype.showContextMenu=function(t){var e=[];e.push({priority:55,label:n2_("Duplicate"),icon:"ssi_16 ssi_16--duplicate",action:this.duplicate.bind(this)}),e.push({priority:55,label:n2_("Copy"),icon:"ssi_16 ssi_16--copy",action:this.copy.bind(this)}),this.box.hasClass("n2_slide_box--published")?e.push({priority:55,label:n2_("Unpublish"),icon:"ssi_16 ssi_16--filledremove",action:this.unpublish.bind(this)}):e.push({priority:55,label:n2_("Publish"),icon:"ssi_16 ssi_16--filledcheck",action:this.publish.bind(this)}),this.box.hasClass("n2_slide_box--has-generator")&&e.push({priority:55,label:n2_("Edit generator"),icon:"ssi_16 ssi_16--cog",action:this.goToEditGenerator.bind(this)}),this.box.hasClass("n2_slide_box--first-slide")||this.box.hasClass("n2_slide_box--static-overlay")||e.push({priority:55,label:n2_("Set as first"),icon:"ssi_16 ssi_16--star",action:function(){this.setFirst()}.bind(this)}),this.box.hasClass("n2_slide_box--static-overlay")&&e.push({priority:55,label:n2_("Convert to slide"),icon:"ssi_16 ssi_16--paste",action:this.convertToSlide.bind(this)}),e.push({priority:1e3,label:n2_("Delete"),icon:"ssi_16 ssi_16--delete",action:function(){this.delete()}.bind(this),color:"red"}),this.box.addClass("n2_slide_box--context-menu"),N2Classes.ContextMenu(t,e,{y:5,horizontalAlign:n2const.isRTL()?"right":"left",onClose:function(){this.box.removeClass("n2_slide_box--context-menu")}.bind(this)})},o.prototype.getSliderId=function(){return this.box.data("sliderid")},o.prototype.getId=function(){return this.box.data("slideid")},o.prototype.setFirst=function(t){t&&t.preventDefault(),N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendaction:"first"}),type:"POST",data:{id:this.getId()}}).done(function(){this.manager.unsetFirst(),this.box.addClass("n2_slide_box--first-slide")}.bind(this))},o.prototype.unsetFirst=function(){this.box.removeClass("n2_slide_box--first-slide")},o.prototype.publish=function(){this.switchPublished()},o.prototype.unpublish=function(){this.switchPublished()},o.prototype.switchPublished=function(t){t&&t.preventDefault(),this.isPublished()?this.manager.unPublishSlides([this.getId()],[this]):this.manager.publishSlides([this.getId()],[this])},o.prototype.isPublished=function(){return this.box.hasClass("n2_slide_box--published")},o.prototype.published=function(){this.box.addClass("n2_slide_box--published")},o.prototype.unPublished=function(){this.box.removeClass("n2_slide_box--published")},o.prototype.duplicate=function(){var s=n.Deferred();return N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slides",nextendaction:"duplicate",sliderid:this.getSliderId(),slideid:this.getId()})}).done(function(t){var e=n(t.data).insertAfter(this.box),i=new o(this.manager,e);this.manager.initSlides(),s.resolve(i),nextend.tooltip.add(e)}.bind(this)),s},o.prototype.delete=function(t){t&&t.preventDefault(),this.manager.deleteSlides([this.getId()],[this])},o.prototype.deleted=function(){this.box.remove()},o.prototype.invertSelection=function(t){t&&t.preventDefault(),this.selected?this.deSelect():this.select()},o.prototype.select=function(){this.selected||(this.selected=!0,this.box.addClass("n2_slide_box--bulk-selected"),this.manager.addSelection(this))},o.prototype.deSelect=function(){this.selected&&(this.selected=!1,this.box.removeClass("n2_slide_box--bulk-selected"),this.manager.removeSelection(this))},o.prototype.goToEditGenerator=function(){window.location=this.box.data("generator-edit")},o.prototype.copy=function(){N2Classes.SelectSlider(n2_("Copy slide to")+" ...",function(t,e,i){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slides",nextendaction:"copy",targetGroupID:i,targetSliderID:t,sliderid:this.getSliderId(),slideid:this.getId()})})}.bind(this),!0)},o.prototype.initRename=function(){this.dblClickTimeout=!1,this.$label=this.box.find(".n2_slide_box__footer_title").on("click",function(t){"true"!==this.$label[0].contentEditable&&(this.dblClickTimeout?(clearTimeout(this.dblClickTimeout),this.dblClickTimeout=!1,this.editName()):this.dblClickTimeout=setTimeout(function(){this.isEdited||(window.location=this.editUrl),this.dblClickTimeout=!1}.bind(this),500))}.bind(this)),this.title=this.$label.text().trim(),this.$label.text(this.title)},o.prototype.editName=function(){new N2Classes.InlineTextEditor(this.$label[0],{onSave:function(t){this.title!==t&&N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slides",nextendaction:"rename",slideid:this.getId(),title:t})}).done(function(){this.title=t,this.isEdited&&(N2Classes.History.get().off(),nextend.currentEditor.fragmentEditor.mainContainer.outsideStoreProperty(e,"title",t,"slideTitleRename"),N2Classes.History.get().on())}.bind(this)).fail(function(){this.$label.text(this.title)}.bind(this))}.bind(this),onCancel:function(){this.$label.text(this.title)}.bind(this),onTab:function(t){for(var e=n(".n2_slide_box__footer_title"),i=0;i<e.length;i++)if(this.$label.is(e[i])){t.shiftKey?i--:i++;break}i<0?i=e.length-1:i>=e.length&&(i=0),e.eq(i).trigger("click").trigger("click")}.bind(this)})},o.prototype.convertToSlide=function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.manager.ajaxUrl,{nextendcontroller:"slides",nextendaction:"convertToSlide",sliderid:this.getSliderId(),slideid:this.getId()})}).done(function(){this.box.removeClass("n2_slide_box--static-overlay"),this.box.find(".n2_slide_box__details_static_slide").remove()}.bind(this))},o}),N2D("SlidesManager",function(d,c){function t(t,e,i,s,n){this.quickPostModal=null,this.parameters=e,this.slides=[],this.options=d.extend({sliderUrl:""},t),this.url=t.url,this.ajaxUrl=t.ajaxUrl,this.contentAjaxUrl=t.contentAjaxUrl,this.$slideManager=d(".n2_slide_manager"),this.slidesContainer=d(".n2_slide_manager__content"),this.initSlidesOrderable();for(var o,r,a=this.slidesContainer.find(".n2_slide_box"),l=0;l<a.length;l++)this.slides.push(new N2Classes.Slide(this,a.eq(l)));document.documentElement.setAttribute("data-slides",this.slides.length),d(".n2_slide_manager__add_slide, .n2_slide_manager__dummy_slide").on("click",function(){this.$slideManager.toggleClass("n2_slide_manager--add-slide")}.bind(this)),d(".n2_slide_manager__add_slide_action[data-action]").on("click",function(t){switch(t.preventDefault(),d(t.currentTarget).data("action")){case"image":this.addQuickImage(t);break;case"empty-slide":t.preventDefault(),this.createSlide("empty-slide");break;case"post":this.addQuickPost(t);break;case"static-overlay":t.preventDefault(),this.createSlide("static-overlay")}}.bind(this)),d(".n2-box-slide-dummy").on("click",this.addQuickImage.bind(this)),d(".n2_slide_manager__block_notice_button").on("click",this.changeSliderType.bind(this)),"changeslidertype"===window.location.hash.substring(1)&&(window.location.hash="",this.changeSliderType()),this.initBulk(),i||(o=[],new N2Classes.UIFileUpload(this.slidesContainer,{url:s,pasteZone:!1,dataType:"json",paramName:"image",dropZone:this.$slideManager,add:function(t,e){e.formData={path:"/"+n},e.submit()}.bind(this),done:function(t,e){var i=e.result;i.data&&i.data.name?o.push({title:i.data.name.replace(/\.[^/.]+$/,""),description:"",image:i.data.url}):N2Classes.AjaxHelper.notification(i)}.bind(this),fail:function(t,e){N2Classes.AjaxHelper.notification(e.jqXHR.responseJSON)}.bind(this),start:function(){N2Classes.LoadingScreen.startLoading()},stop:function(){o.length?this._addQuickImages(o):setTimeout(function(){N2Classes.LoadingScreen.stopLoading()},100),o=[]}.bind(this)}),r=null,this.slidesContainer.on("dragover",function(t){null!==r?(clearTimeout(r),r=null):this.slidesContainer.addClass("n2-drag-over"),r=setTimeout(function(){this.slidesContainer.removeClass("n2-drag-over"),r=null}.bind(this),400)}.bind(this)))}return t.prototype.changed=function(){},t.prototype.initSlidesOrderable=function(){this.uiSortable=new N2Classes.UISortable(this.slidesContainer,{items:".n2_slide_box",stop:this.saveSlideOrder.bind(this),placeholder:"n2_slide_manager__sortable_placeholder",distance:10,helper:"clone"})},t.prototype.saveSlideOrder=function(){for(var t=this.slidesContainer.find(".n2_slide_box"),e=[],i=[],s=[],n=0;n<t.length;n++){var o=t.eq(n).data("slide");e.push(o),i.push(o.getId())}for(n=0;n<this.slides.length;n++)s.push(this.slides[n].getId());JSON.stringify(s)!==JSON.stringify(i)&&(d(window).triggerHandler("SmartSliderSidebarSlidesOrderChanged"),N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendcontroller:"slides",nextendaction:"order"}),data:{slideorder:i}}),this.slides=e,this.changed())},t.prototype.initSlides=function(){for(var t=this.slidesContainer.find(".n2_slide_box"),e=[],i=0;i<t.length;i++){var s=t.eq(i).data("slide");e.push(s)}this.slides=e,this.changed(),d(window).triggerHandler("SmartSliderSidebarSlidesChanged"),document.documentElement.setAttribute("data-slides",this.slides.length)},t.prototype.unsetFirst=function(){for(var t=0;t<this.slides.length;t++)this.slides[t].unsetFirst();this.changed()},t.prototype.addBoxes=function(t){t.appendTo(this.slidesContainer),t.addClass("n2_slide_box--just-added").each(function(t,e){new N2Classes.Slide(this,d(e))}.bind(this)),this.initSlides(),setTimeout(function(){t.removeClass("n2_slide_box--just-added")},200)},t.prototype.createSlide=function(t,e){return N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"create",type:t}),data:e}).done(function(t){this.addBoxes(d(t.data))}.bind(this))},t.prototype.addQuickImage=function(t){t.preventDefault(),nextend.imageHelper.openMultipleLightbox(this._addQuickImages.bind(this))},t.prototype._addQuickImages=function(t){for(var e=[],i=0;i<t.length;i++)t[i].image.match(/\.(mp4)/i)||e.push(t[i]);e.length&&this.createSlide("image",{images:N2Classes.Base64.encode(JSON.stringify(e))})},t.prototype.addQuickPost=function(t){var e,i,s,n,o,r,a,l,d,h;t.preventDefault(),this.quickPostModal||(i={},s=function(t){return i[t]===c&&(i[t]=N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.contentAjaxUrl),data:{keyword:t},dataType:"json"})),i[t]}.bind(e=this),this.quickPostModal=new N2Classes.ModalSimple("create-quick-post"),this.quickPostModal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--post","green")),this.quickPostModal.addContent(N2Classes.UI.modalHeading(n2_("Add post"))),n=N2Classes.UI.modalFormRow(!0),this.quickPostModal.addContent(n),o=N2Classes.UI.modalFieldText(n,"keyword",n2_("Search keyword"),""),r="",a=N2Classes.UI.modalFormRow(!0),this.quickPostModal.addContent(a),l=!1,d=N2Classes.UI.modalSelectList(a,"quick-post",n2_("Posts"),function(t){l=t}),o.on("keyup",function(){r=o.val(),s(r).done(function(t){if(o.val()===r){d.removeOptions();for(var e=t.data,i=0;i<e.length;i++)d.addOption(e[i].title,e[i].info,e[i])}}.bind(this))}.bind(this)).trigger("keyup").focus(),h=N2Classes.UI.modalButton(n2_("Add post"),"green"),this.quickPostModal.addButton(h),h.on("click",function(){l?e._addQuickPost(this.quickPostModal,l):N2Classes.Notification.error(n2_("Please select a Post first!"))}.bind(this))),this.quickPostModal.show()},t.prototype._addQuickPost=function(t,e){e.image||(e.image=""),this.createSlide("post",{post:e}),t&&this.quickPostModal.hide()},t.prototype.initBulk=function(){this.selection=[],this.isBulkSelection=!1,d("#n2_slide_manager_bulk_actions a[data-action]").on("click",function(t){switch(t.preventDefault(),d(t.currentTarget).data("action")){case"duplicate":this.bulkAction("duplicateSlides");break;case"copy":this.bulkAction("copySlides");break;case"delete":this.bulkAction("deleteSlides");break;case"publish":this.bulkAction("publishSlides");break;case"unpublish":this.bulkAction("unPublishSlides");break;case"select-all":this.bulkSelect(function(t){t.select()});break;case"select-none":this.bulkSelect(function(t){t.deSelect()});break;case"select-published":this.bulkSelect(function(t){t.box.hasClass("n2_slide_box--published")?t.select():t.deSelect()});break;case"select-unpublished":this.bulkSelect(function(t){t.box.hasClass("n2_slide_box--published")?t.deSelect():t.select()})}}.bind(this)),d(".n2-bulk-actions a").on("click",function(t){var e=d(t.currentTarget).data("action");e&&(t.preventDefault(),this.bulkAction(e))}.bind(this))},t.prototype.addSelection=function(t){0==this.selection.length&&this.enterBulk(),this.selection.push(t)},t.prototype.removeSelection=function(t){this.selection.splice(this.selection.indexOf(t),1),0==this.selection.length&&this.leaveBulk()},t.prototype.bulkSelect=function(t){for(var e=0;e<this.slides.length;e++)t(this.slides[e])},t.prototype.bulkAction=function(t){var e=[],i=[];this.bulkSelect(function(t){t.selected&&(e.push(t),i.push(t.getId()))}),i.length?this[t](i,e):N2Classes.Notification.notice("Please select one or more slides for the action!")},t.prototype.enterBulk=function(){this.isBulkSelection||(this.isBulkSelection=!0,this.uiSortable.setOption("disabled",!0),d(".n2_slide_manager").addClass("n2_slide_manager--bulk-select"))},t.prototype.leaveBulk=function(){if(this.isBulkSelection){this.uiSortable.setOption("disabled",!1),d(".n2_slide_manager").removeClass("n2_slide_manager--bulk-select");for(var t=0;t<this.slides.length;t++)this.slides[t].deSelect();this.selection=[],this.isBulkSelection=!1}},t.prototype.deleteSlides=function(e,i){var t=1<i.length?n2_("delete these slides"):n2_("delete this slide"),s=parseInt(d(".n2-ss-currently-edited-slide").attr("data-id"));N2Classes.ModalDeleteConfirm(t,function(){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"delete"}),type:"POST",data:{slides:e}}).done(function(){for(var t=0;t<i.length;t++)i[t].deleted();this.initSlides(),this.leaveBulk(),-1!==e.indexOf(s)&&(window.location=this.options.sliderUrl)}.bind(this))}.bind(this))},t.prototype.duplicateSlides=function(t,e){for(var i=0;i<this.slides.length;i++)this.slides[i].selected&&this.slides[i].duplicate(d.Event("click",{currentTarget:null}))},t.prototype.copySlides=function(s){N2Classes.SelectSlider(n2_("Copy slide to")+" ...",function(t,e,i){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"copySlides",targetGroupID:i,targetSliderID:t}),type:"POST",data:{slides:s}})}.bind(this),!0)},t.prototype.publishSlides=function(t,e){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"publish"}),type:"POST",data:{slides:t}}).done(function(){for(var t=0;t<e.length;t++)e[t].published();this.changed()}.bind(this))},t.prototype.unPublishSlides=function(t,e){N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.ajaxUrl,{nextendaction:"unpublish"}),type:"POST",data:{slides:t}}).done(function(){for(var t=0;t<e.length;t++)e[t].unPublished();this.changed()}.bind(this))},t.prototype.changeSliderType=function(t){nextend.changeSliderType!==c&&(t&&t.preventDefault(),nextend.changeSliderType.showModal())},t}),N2D("SmartSliderSlideBackgroundAdmin",["SmartSliderSlideBackground"],function(s,t){function e(t,e,i){this.types={color:"SmartSliderAdminSlideBackgroundColor",image:"SmartSliderAdminSlideBackgroundImage",video:"SmartSliderAdminSlideBackgroundVideo"},this.allowVisualLoad=!1,this.slider=t.slider,N2Classes.SmartSliderSlideBackground.prototype.constructor.call(this,t,e,i)}return((e.prototype=Object.create(N2Classes.SmartSliderSlideBackground.prototype)).constructor=e).prototype.setRelatedSectionSlide=function(t){this.sectionSlide=t},e.prototype.setVisualLoad=function(t){this.allowVisualLoad=t},e.prototype.setType=function(t){"color"===t?(this.elements.color||this.createColorElement(!0),this.elements.image&&(this.elements.image.kill(),this.elements.image=!1)):"image"===t&&(this.elements.color||this.createColorElement(!0),this.elements.image||this.createImageElement())},e.prototype.setMode=function(t){"default"===t&&(t=this.slider.editor.options.slideBackgroundMode),this.element.attr("data-mode",t),this.elements.image&&this.elements.image.updateMode(t,this.mode),this.mode=t},e.prototype.setFocus=function(t,e){this.elements.image&&this.elements.image.updateFocus(t,e)},e.prototype.setImageOpacity=function(t){this.elements.image&&this.elements.image.updateOpacity(t)},e.prototype.setBlur=function(t){this.elements.image&&this.elements.image.updateBlur(t)},e.prototype.createColorElement=function(t){t=t||!1,this.elements.color=new N2Classes[this.types.color](this,s('<div class="n2-ss-slide-background-color"></div>').appendTo(this.$wrapElement)),t&&this.elements.color.update(this.sectionSlide.getProperty("backgroundColor"),this.sectionSlide.getProperty("backgroundGradient"),this.sectionSlide.getProperty("backgroundColorEnd"),this.sectionSlide.getProperty("backgroundColorOverlay"))},e.prototype.updateColor=function(t,e,i,s){this.elements.color||this.createColorElement(),this.elements.color.update(t,e,i,s)},e.prototype.createImageElement=function(){var t,e,i=nextend.currentEditor.generator.fill(this.sectionSlide.getProperty("backgroundImage"));""!==i&&(t=nextend.imageHelper.fixed(i),e=s('<div class="n2-ss-slide-background-image"></div>').css({opacity:this.sectionSlide.getProperty("backgroundImageOpacity")/100,backgroundPosition:nextend.currentEditor.generator.fill(this.sectionSlide.getProperty("backgroundFocusX"))+"% "+nextend.currentEditor.generator.fill(this.sectionSlide.getProperty("backgroundFocusY"))+"%"}).attr({"data-hash":md5(i),"data-desktop":t,"data-blur":this.sectionSlide.getProperty("backgroundImageBlur")}).appendTo(this.$wrapElement),this.elements.image=new N2Classes[this.types.image](this.slide,this.manager,this,e),this.elements.image.preLoadAdmin(i))},e.prototype.setImage=function(t){this.elements.image?this.elements.image.setDesktopSrc(t):""!==t&&(null===t.match(/\.(png|jpg|jpeg|gif|webp|svg)/i)?(N2Classes.Notification.error("The background image format is not correct! The supported image formats are: png, jpg, jpeg, gif, webp, svg."),s("#layerslide-backgroundImage").val("").trigger("change")):"image"===this.sectionSlide.getProperty("background-type")&&this.createImageElement())},e.prototype.setThumbnail=function(t,e){var i=s("#layerslide-thumbnail");""===t||!t.match(/\.(png|jpg|jpeg|gif|webp|svg)/i)||""!==i.val()&&i.val()!==e||i.val(t).trigger("change")},e}),N2D("SlideEdit",function(n,o){function t(t){this.options=n.extend({ajaxUrl:"",slideAsFile:0,nextendAction:"",previewInNewWindow:!1,previewUrl:"",sliderElementID:"",slideEditorOptions:{}},t),this.editor=new N2Classes.EditorSlide(this,this.options.sliderElementID,this.options.slideEditorOptions),N2Classes.Form.prototype.constructor.call(this),N2R("documentReady",this.onReady.bind(this))}return((t.prototype=Object.create(N2Classes.Form.prototype)).constructor=t).prototype.onReady=function(){"create"===this.options.nextendAction&&this.initBackgroundOpen(),this.setID("#n2-ss-form-slide-edit"),N2Classes.Form.prototype.onReady.call(this),this.initPreview()},t.prototype.initBackgroundOpen=function(){N2R("windowLoad",function(t){t(".n2_form__tab_button[data-related-tab=n2_form__tab_slide_slide-background]").trigger("click")})},t.prototype.resetChangeTracker=function(){this.hasChange=!1,document.addEventListener("historyChange",this.onChangeCallback,{passive:!0,capture:!0}),this.$saveButton.addClass("n2_button--inactive")},t.prototype.onChange=function(){this.hasChange=!0,this.$saveButton.removeClass("n2_button--inactive"),document.removeEventListener("historyChange",this.onChangeCallback,{passive:!0,capture:!0})},t.prototype.initButtons=function(){this.$saveButton=n(".n2_slide_settings_save").on("click",this.actionSave.bind(this)),n(".n2_slide_settings_back").on("click",this.actionCancel.bind(this)),n(".n2_slide_generator_static_save").on("click",function(t){this.actionSave(t,!0)}.bind(this))},t.prototype.actionSave=function(t,e){t&&t.preventDefault();var i=this.editor.getFormData();if(!0===e&&(i.generatorStatic="1"),this.options.slideAsFile&&typeof window.FormData!==o&&window.File!==o){var s=new FormData;try{s.append("slide",new Blob([i.slide]),"slide.txt")}catch(t){try{s.append("slide",new Blob([i.slide]))}catch(t){try{s.append("slide",new File([i.slide],"slide.txt"))}catch(t){N2Classes.Notification.notice('Your browser does not support File api, please disable "Send slide as file" option in the global settings.')}}}for(var n in delete i.slide,i)s.append(n,i[n]);N2Classes.AjaxHelper.ajax({url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl),type:"POST",data:s,contentType:!1,processData:!1}).done(this.afterSave.bind(this))}else N2Classes.AjaxHelper.ajax({type:"POST",url:N2Classes.AjaxHelper.makeAjaxUrl(this.options.ajaxUrl),data:i,dataType:"json"}).done(this.afterSave.bind(this))},t.prototype.actionCancel=function(t){t&&t.preventDefault(),window.location=t.currentTarget.href},t.prototype.afterSave=function(){var t=this.editor.fragmentEditor.mainContainer,e=n(".n2_admin_editor__ui_slide_manager .n2_slide_box--currently-edited ");e.find(".n2_slide_box__footer_title").text(t.getProperty("title")),e.find(".n2_slide_box__content").css("background-image","url("+nextend.imageHelper.fixed(this.editor.generator.fill(t.getProperty("thumbnail")||t.getProperty("backgroundImage")||"$ss3-frontend$/images/placeholder/image.png"))+")");var i=[];parseInt(t.getProperty("desktopPortrait"))||i.push(n2_("Desktop")),parseInt(t.getProperty("tabletPortrait"))||i.push(n2_("Tablet")),parseInt(t.getProperty("mobilePortrait"))||i.push(n2_("Mobile"));var s="";i.length&&(s=n2_sprintf(n2_("This slide is hidden on the following devices: %s"),i.join(", "))),e.find(".n2_slide_box__footer_status_hidden").data("n2tip",s),N2Classes.Form.prototype.afterSave.call(this)},t.prototype.initPreview=function(){this.options.previewInNewWindow||(this.modal=new N2Classes.ModalIframe("preview-slider")),n("#n2-ss-preview").on("click",function(t){t.preventDefault(),this.options.previewInNewWindow?N2Classes.PreviewPopup("","preview-slider"):this.modal.show();var e=n('<form style="display:none;"></form>').attr({method:"post",action:N2Classes.AjaxHelper.makeAjaxUrl(this.options.previewUrl,{nextendaction:"slide",frame:this.options.previewInNewWindow?0:1}),target:"preview-slider"}).appendTo("body"),i=this.editor.getFormData();n('<input name="slide" />').val(i.slide).appendTo(e),e.submit()}.bind(this))},t}),N2D("EditorAbstract",function(s,n){function t(t,e){var i;(i=function(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("msie")&&parseInt(t.split("msie")[1])}())&&i<10&&alert(window.ss2lang.The_editor_was_tested_under_Internet_Explorer_10_Firefox_and_Chrome_Please_use_one_of_the_tested_browser),this.readyDeferred=s.Deferred(),this.sliderElementID=t,this.readyDeferred.done(function(){N2D("SSEditor",function(){return this}.bind(this))}.bind(this)),this.options=s.extend({isUploadDisabled:!0,uploadUrl:"",uploadDir:"",settingsGoProUrl:"",sectionLibraryFree:!0,sectionLibraryUrl:"",sectionLibraryGoProUrl:""},e),(nextend.currentEditor=this).frontend=null,this.generator=null,this.fragmentEditor=null,this.$editedElement=null,this.editedInstance=null,N2R("documentReady",function(t){nextend.fontsDeferred!==n?nextend.fontsDeferred.done(this.startEditor.bind(this)):this.startEditor()}.bind(this))}return t.prototype.startEditor=function(){},t.prototype.ready=function(t){this.readyDeferred.done(t)},t.prototype.getSelf=function(){return this},t.prototype.getAvailableDeviceModes=function(){return{desktopPortrait:1,desktopLandscape:0,tabletPortrait:1,tabletLandscape:0,mobilePortrait:1,mobileLandscape:0}},t.prototype.getGeneratorVariables=function(){return this.$editedElement.data("variables")},t.prototype.getMainContainerElement=function(){return this.$editedElement.find(".n2-ss-layers-container").addBack().last()},t}),N2D("EditorSlide",["EditorAbstract"],function(s,t){function e(t,e,i){this.slideEdit=t,N2Classes.EditorAbstract.prototype.constructor.call(this,e,s.extend({slideBackgroundMode:"fill"},i))}return((e.prototype=Object.create(N2Classes.EditorAbstract.prototype)).constructor=e).prototype.startEditor=function(){N2R("#"+this.sliderElementID,function(t,e){this.frontend=e,this.frontend.editor=this,nextend.pre="div#"+this.frontend.elementID+" ",this.frontend.visible(this.sliderStarted.bind(this))}.bind(this))},e.prototype.sliderStarted=function(){s("body").addClass("n2-ss-slider-visible"),this.$editedElement=this.frontend.sliderElement.find(".n2-ss-currently-edited-slide"),this.editedInstance=this.$editedElement.data("slide"),this.generator=new N2Classes.Generator(this),this.generator.registerGlobalField("slide","name","#layerslide-title"),this.generator.registerGlobalField("slide","description","#layerslide-description"),this.getMainContainerElement().on({updateSize:this.updateSize.bind(this),interaction:this.updateSize.bind(this)}),this.fragmentEditor=new N2Classes.FragmentEditor(this,this.getFrontendSlide().$element,this.options),this.getFrontendElement().on({SliderResize:this.fragmentEditor.onResize.bind(this.fragmentEditor),SliderDeviceOrientation:this.fragmentEditor.onChangeDeviceOrientation.bind(this.fragmentEditor)}),this.readyDeferred.resolve()},e.prototype.getFormData=function(){return{guides:N2Classes.Base64.encode(JSON.stringify(this.fragmentEditor.canvasSettings.ruler.toArray())),slide:N2Classes.Base64.encode(nextend.UnicodeToHTMLEntity(JSON.stringify(this.fragmentEditor.getData())))}},e.prototype.getAvailableDeviceModes=function(){return this.frontend.responsive.parameters.enabledDevices},e.prototype.getSlideBackground=function(){return this.$editedElement.data("slideBackground")},e.prototype.getFrontendElement=function(){return this.frontend.sliderElement},e.prototype.getFrontendSlide=function(){return this.editedInstance},e.prototype.getHorizontalRatio=function(){return this.frontend.responsive.ratios.slideW},e.prototype.getVerticalRatio=function(){return this.frontend.responsive.ratios.slideH},e.prototype.updateSize=function(){this.frontend.responsive.resizeStage2Height()},e.prototype.getDeviceMode=function(){return this.frontend.responsive.getNormalizedModeString()},e}),N2D("Generator",["EditorAbstract"],function(d,l){"use strict";function t(t){this.editor=t,this._refreshTimeout=null,this.modal=!1,this.group=0;var e=(this.editor.generator=this).editor.getGeneratorVariables();if(e){for(var i in this.variables=e,this.variables)!isNaN(parseFloat(i))&&isFinite(i)&&(this.group=Math.max(this.group,parseInt(i)+1));this.fill=this.generatorFill,0<this.group&&(this.registerField=this.generatorRegisterField,this.button=d('<div class="n2_field_generator_data_button"><div class="n2_field_generator_data_button_icon"><i class="ssi_16 ssi_16--data"></i></div><div class="n2_field_generator_data_button_label">'+n2_("Data")+"</div></div>").on("click",function(t){this.showModal()}.bind(this)),d("body").addClass("n2_ss_body--dynamic-slide"))}else this.variables=null}return t.prototype.isDynamicSlide=function(){return 0<this.group},t.prototype.splitTokens=function(t){for(var e=[],i="",s=0,n=0;n<t.length;n++){var o=t[n];","===o&&0===s?(e.push(i),i=""):(i+=o,"("===o?s++:")"===o&&s--)}return i.length&&e.push(i),e},t.prototype.fill=function(t){return t},t.prototype.generatorFill=function(t){return"string"==typeof t?t.replace(/{((([a-z]+)\(([^}]+)\))|([a-zA-Z0-9][a-zA-Z0-9_\/]*))}/g,this.parseFunction.bind(this)):t},t.prototype.parseFunction=function(t,e,i,s,n,o){if(o!==l)return this.parseVariable(o);for(var r=this.splitTokens(n),a=0;a<r.length;a++)r[a]=this.parseVariable(r[a]);return"function"==typeof this[s]?this[s].apply(this,r):t},t.prototype.parseVariable=function(t){var e=t.match(/^("|')(.*)("|')$/);if(e)return e[2];var i=t.match(/((([a-z]+)\(([^}]+)\)))/);if(i)return this.parseFunction.apply(this,i);var s=t.match(/([a-zA-Z][0-9a-zA-Z_]*)(\/([0-9a-z]+))?/);if(s){var n,o=s[3];return o===l?o=0:(n=parseInt(o),isNaN(n)||(o=Math.max(o,1)-1)),this.variables[o]!==l&&this.variables[o][s[1]]!==l?this.variables[o][s[1]]:""}return t},t.prototype.fallback=function(t,e){return""==t?e:t},t.prototype.cleanhtml=function(t){return this.stripTags(t,"<p><a><b><br /><br/><i>")},t.prototype.stripTags=function(t,i){i=(((i||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");return t.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,"").replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,function(t,e){return-1<i.indexOf("<"+e.toLowerCase()+">")?t:""})},t.prototype.removehtml=function(t){return d("<div>"+t+"</div>").text()},t.prototype.splitbychars=function(t,e,i){return t.substr(e,i)},t.prototype.splitbywords=function(t,e,i){var s=t,n=s.length,o=Math.max(0,0==e?0:s.indexOf(" ",e)),r=Math.max(0,n<i?n:s.indexOf(" ",i));return 0==r&&i<=n&&(r=n),s.substr(o,r)},t.prototype.findimage=function(t,e){var i,s=t,n=/(<img.*?src=[\'"](.*?)[\'"][^>]*>)|(background(-image)??\s*?:.*?url\((["|\']?)?(.+?)(["|\']?)?\))/gi,o=[];for(e=e!==l?parseInt(e)-1:0;i=n.exec(s);)i[2]!==l?o.push(i[2]):i[6]!==l&&o.push(i[6]);return o.length?o.length>e?o[e]:o[o.length-1]:""},t.prototype.findlink=function(t,e){var i,s=t,n=/href=["\']?([^"\'>]+)["\']?/gi,o=[];for(e=e!==l?parseInt(e)-1:0;i=n.exec(s);)i[1]!==l&&o.push(i[1]);return o.length?o.length>e?o[e]:o[o.length-1]:""},t.prototype.removevarlink=function(t){return String(t).replace(/<a href=\"(.*?)\">(.*?)<\/a>/g,"")},t.prototype.removelinebreaks=function(t){return String(t).replace(/\r?\n|\r/g,"")},t.prototype.registerFields=function(t){for(var e=0;e<t.length;e++)this.registerField(t[e])},t.prototype.registerGlobalField=function(t,e,i){null!==this.variables&&(i=d(i).on("outsideChange",function(){this.variables[t][e]=i.val(),this.refresh()}.bind(this)))},t.prototype.registerField=function(t){},t.prototype.generatorRegisterField=function(t){var e=(t=d(t)).parent();e.on({mouseenter:function(){this.activeField=t,this.button.prependTo(e)}.bind(this)})},t.prototype.getModal=function(){var e,i,s,t,n,o,r,a,l;return this.selectVariableModal||(e={key:"",group:1,filter:"no",split:"no",splitStart:0,splitLength:300,findImage:0,findImageIndex:1,findLink:0,findLinkIndex:1,removeVarLink:0,removelinebreaks:0},i=function(){var t=e.key+"/"+e.group;return 0!=e.findImage&&(t="findimage("+t+","+Math.max(1,e.findImageIndex)+")"),0!=e.findLink&&(t="findlink("+t+","+Math.max(1,e.findLinkIndex)+")"),0!=e.removeVarLink&&(t="removevarlink("+t+")"),0!=e.removelinebreaks&&(t="removelinebreaks("+t+")"),"no"!=e.filter&&(t=e.filter+"("+t+")"),"no"!=e.split&&0<=e.splitStart&&0<e.splitLength&&(t=e.split+"("+t+","+e.splitStart+","+e.splitLength+")"),"{"+t+"}"},s=function(){a.text(this.fill(i()))}.bind(this),this.selectVariableModal=new N2Classes.ModalSimple("generator-insert-variable",{width:760}),this.selectVariableModal.addContent(N2Classes.UI.modalIcon("ssi_48 ssi_48--data","blue")),1<this.group&&N2Classes.UI.modalGeneratorVariableList(this.selectVariableModal,this.group,"Select group","group","Groups",function(t){e.group=t,s()}),N2Classes.UI.modalGeneratorVariableList(this.selectVariableModal,this.variables[0],"Insert variable","variable","Variables",function(t){e.key=t,s()}),e.key=Object.keys(this.variables[0])[0],t=N2Classes.UI.modalFormRow(),this.selectVariableModal.addContent(t),N2Classes.UI.modalSelect(t,"filter-select",n2_("Filter"),{no:n2_("No"),cleanhtml:n2_("Clean HTML"),removehtml:n2_("Remove HTML")},"no").on("nextendChange",function(){e.filter=d(this).val(),s()}),N2Classes.UI.modalSelect(t,"split-select",n2_("Split by Chars"),{no:n2_("No"),splitbychars:n2_("Strict"),splitbywords:n2_("Respect words")},"no").on("nextendChange",function(){e.split=d(this).val(),s()}),N2Classes.UI.modalNumber(t,"split-start","",0,{wide:2,sublabel:"start"}).on("nextendChange",function(){e.splitStart=d(this).val(),s()}),N2Classes.UI.modalNumber(t,"split-length","",300,{wide:3,sublabel:"length"}).on("nextendChange",function(){e.splitLength=d(this).val(),s()}),n=N2Classes.UI.modalFormRow(),this.selectVariableModal.addContent(n),N2Classes.UI.modalOnOff(n,"find-image",n2_("Find image"),0).on("nextendChange",function(){e.findImage=d(this).val(),s()}),N2Classes.UI.modalNumber(n,"find-image-index","",1,{wide:2,sublabel:"index"}).on("nextendChange",function(){e.findImageIndex=d(this).val(),s()}),N2Classes.UI.modalOnOff(n,"find-link",n2_("Find link"),0).on("nextendChange",function(){e.findLink=d(this).val(),s()}),N2Classes.UI.modalNumber(n,"find-link-index","",1,{wide:2,sublabel:"index"}).on("nextendChange",function(){e.findLinkIndex=d(this).val(),s()}),N2Classes.UI.modalOnOff(n,"remove-link",n2_("Remove links"),0).on("nextendChange",function(){e.removeVarLink=d(this).val(),s()}),N2Classes.UI.modalOnOff(n,"remove-line-break",n2_("Remove line breaks"),0).on("nextendChange",function(){e.removelinebreaks=d(this).val(),s()}),o=N2Classes.UI.modalFormRow(!0),this.selectVariableModal.addContent(o),r=N2Classes.UI.modalFieldWrapper(o,"result",n2_("Result")),a=d('<div class="n2_generator_result"></div>').appendTo(r.$element),l=N2Classes.UI.modalButton(n2_("Insert"),"green"),this.selectVariableModal.addButton(l),l.on("click",function(t){t.preventDefault(),this.insert(i()),this.selectVariableModal.hide()}.bind(this)),s()),this.selectVariableModal},t.prototype.showModal=function(){this.getModal().show()},t.prototype.insert=function(t){this.activeField.val(t).trigger("change")},t.prototype.refresh=function(){this._refreshTimeout&&(clearTimeout(this._refreshTimeout),this._refreshTimeout=null),this._refreshTimeout=setTimeout(this._refresh.bind(this),100)},t.prototype._refresh=function(){for(var t=this.editor.fragmentEditor.mainContainer.container.getAllLayers(),e=0;e<t.length;e++)"layer"===t[e].type&&t[e].item.reRender()},t}),N2D("Historical",function(t,e){"use strict";function i(t){for(var e in i.prototype)t.prototype[e]=i.prototype[e]}return i.prototype.setSelf=function(t){t===e&&console.error(t),this.self!==e&&this.self!==this&&this.self.setSelf(t),this.self=t,this.onSelfChange()},i.prototype.getSelf=function(){return this.self===e?this.self=this:this.self!==this&&(this.self=this.self.getSelf()),this.self},i.prototype.onSelfChange=function(){},i}),N2D("History",function(t,e){"use strict";function i(){this.historyStates=50,this.enabled=0!==this.historyStates,this.historyActionInProgress=!1,this.historyAddAllowed=!0,this.isBatched=!1,(this.currentBatch=this).index=-1,this.stackedOff=[],this.tasks=[],this.preventUndoRedo=!1,this.undoBTN=t(".n2_ss_history_action--undo").on({click:this.undo.bind(this)}),this.redoBTN=t(".n2_ss_history_action--redo").on({click:this.redo.bind(this)})}var s;function n(t){this.parent=t,this.tasks=[]}function o(t){"skipForwardUndos"===t&&(this.undo=function(){return!1})}function r(t,e,i,s){this.that=t,this.undoAction=e,this.redoAction=i,this.context=s||[]}function a(){r.prototype.constructor.apply(this,arguments)}return N2R("documentReady",function(){s=new i}),i.get=function(){return s},i.prototype.updateUI=function(){this.undoBTN.toggleClass("n2_ss_history_action--allowed",0!==this.index&&0<this.tasks.length),this.redoBTN.toggleClass("n2_ss_history_action--allowed",-1<this.index&&this.index<this.tasks.length),document.dispatchEvent(new CustomEvent("historyChange",{cancelable:!1,bubbles:!1}))},i.prototype.throttleUndoRedo=function(){return!!this.preventUndoRedo||(this.preventUndoRedo=!0,setTimeout(function(){this.preventUndoRedo=!1}.bind(this),100),!1)},i.prototype.isEnabled=function(){return this.enabled&&this.historyAddAllowed},i.prototype.startBatch=function(){if(this.isEnabled()){var t=new n(this.currentBatch);return this.currentBatch._add(t),this.currentBatch=t}return!1},i.prototype.endBatch=function(){this.isEnabled()&&(this.currentBatch.parent,this.currentBatch=this.currentBatch.parent)},i.prototype.addControl=function(t){return this.currentBatch._add(new o(t))},i.prototype.addSimple=function(t,e,i,s){return!!this.isEnabled()&&this.currentBatch._add(new r(t,e,i,s))},i.prototype.addValue=function(t,e,i){if(this.isEnabled()){if(this.isBatched||this.currentBatch!==this)for(var s=this.getCurrentBatchStack(),n=0;n<s.length;n++)if(s[n].isEqual(t,e,i))return s.push(s.splice(n,1)[0]),s[s.length-1];return this.currentBatch._add(new a(t,e,e,i))}return!1},i.prototype.getCurrentBatchStack=function(){return this.currentBatch!==this?this.currentBatch.tasks:this.tasks[this.tasks.length-1]},i.prototype._add=function(t){return-1!==this.index&&this.tasks.splice(this.index,this.tasks.length),this.index=-1,this.isBatched?this.tasks[this.tasks.length-1].push(t):(this.tasks.push([t]),this.isBatched=!0,setTimeout(function(){this.isBatched=!1}.bind(this),100)),this.tasks.length>this.historyStates&&this.tasks.shift(),this.updateUI(),t},i.prototype.off=function(){this.historyAddAllowed=!1,this.stackedOff.push(1)},i.prototype.on=function(){this.stackedOff.pop(),0===this.stackedOff.length&&(this.historyAddAllowed=!0)},i.prototype.undo=function(t){if(t&&t.preventDefault(),this.throttleUndoRedo())return!1;if(this.historyActionInProgress=!0,this.off(),-1===this.index?this.index=this.tasks.length-1:this.index--,0<=this.index)for(var e=this.tasks[this.index],i=e.length-1;0<=i&&e[i].undo();i--);else this.index=0;return this.on(),this.historyActionInProgress=!1,this.updateUI(),!0},i.prototype.redo=function(t){if(t&&t.preventDefault(),this.throttleUndoRedo())return!1;if(this.historyActionInProgress=!0,this.off(),-1!==this.index&&this.index<this.tasks.length){var e=this.tasks[this.index];this.index++;for(var i=0;i<e.length&&e[i].redo();i++);}return this.on(),this.historyActionInProgress=!1,this.updateUI(),!0},i.prototype.actionInProgress=function(){return this.historyActionInProgress},n.prototype._add=function(t){return this.tasks.push(t),t},n.prototype.undo=function(){for(var t=0;t<this.tasks.length&&this.tasks[t].undo();t++);return!0},n.prototype.redo=function(){for(var t=0;t<this.tasks.length&&this.tasks[t].redo();t++);return!0},n.prototype.isEqual=function(){return!1},o.prototype.undo=function(){return!0},o.prototype.redo=function(){return!0},o.prototype.isEqual=function(){return!1},r.prototype.undo=function(){return this.undoAction.apply(this.that.getSelf(),this.context),!0},r.prototype.redo=function(){return this.redoAction.apply(this.that.getSelf(),this.context),!0},r.prototype.isEqual=function(){return!1},((a.prototype=Object.create(r.prototype)).constructor=a).prototype.setValues=function(t,e){this.undoValue=t,this.redoValue=e},a.prototype.undo=function(){return this.context.unshift(this.undoValue),this.undoAction.apply(this.that.getSelf(),this.context),this.context.shift(),!0},a.prototype.redo=function(){return this.context.unshift(this.redoValue),this.redoAction.apply(this.that.getSelf(),this.context),this.context.shift(),!0},a.prototype.isEqual=function(t,e,i){if(t!==this.that||e!==this.undoAction)return!1;for(var s=0;s<i.length;s++)if(i[s]!==this.context[s])return!1;return this.setValues=function(t,e){this.redoValue=e}.bind(this),!0},i}),N2D("InlineTextEditor",function(i,t){function e(t,e){this.destroyed=!1,(this.el=t).contentEditable=!0,this.options=i.extend({onSave:function(){},onCancel:function(){},onTab:function(t){},filter:!1},e),this.listeners=[],this.selectAll(),this.addListener("blur",this.onBlur.bind(this),window),this.addListener("input",this.onInput.bind(this)),this.addListener("blur",this.onBlur.bind(this)),this.addListener("keydown",this.onKeydown.bind(this)),this.addListener("mousedown",this.stopPropagation.bind(this)),this.addListener("mouseup",this.stopPropagation.bind(this)),this.addListener("click",this.stopPropagation.bind(this))}return e.prototype.addListener=function(t,e,i){(i=i||this.el).addEventListener(t,e),this.listeners.push({el:i,eventName:t,callback:e})},e.prototype.stopPropagation=function(t){t.stopPropagation()},e.prototype.onBlur=function(){this.destroy();var t=this.filterText(this.el.textContent);this.el.scrollLeft=0,this.el.scrollTop=0,this.options.onSave(t)},e.prototype.cancel=function(){this.destroy(),this.options.onCancel()},e.prototype.destroy=function(){this.selectNone();for(var t=0;t<this.listeners.length;t++)this.listeners[t].el.removeEventListener(this.listeners[t].eventName,this.listeners[t].callback);this.el.contentEditable=!1},e.prototype.onKeydown=function(t){t.defaultPrevented||(13===t.keyCode?(this.onBlur(),t.preventDefault()):27===t.keyCode?(this.cancel(),t.preventDefault()):9===t.keyCode&&(this.onBlur(),this.options.onTab(t),t.preventDefault()))},e.prototype.onInput=function(){var t,e,i=this.el.textContent,s=function t(e){for(var i=[],s=0;s<e.childNodes.length;s++)e.childNodes[s].childNodes.length?i.push.apply(i,t(e.childNodes[s])):i.push(e.childNodes[s].textContent);return i}(this.el),n=this.filterText(s.join(" "));this.el.innerHTML!==n&&(t=this.getCaretPosition(),e=i.length,this.el.innerHTML=n.replace(/ /g,"&nbsp;"),this.setCaretPosition(t-(e-n.length)))},e.prototype.filterText=function(t){return t=t.replace(/[\s]/gi," ").replace(/\s+/g," "),this.options.filter&&(t=this.options.filter(t)),t},e.prototype.getCaretPosition=function(){var t=window.getSelection().getRangeAt(0),e=t.toString().length,i=t.cloneRange();return i.selectNodeContents(this.el),i.setEnd(t.endContainer,t.endOffset),i.toString().length-e},e.prototype.setCaretPosition=function(t){t=Math.max(0,Math.min(this.el.textContent.length,t));var e=window.getSelection(),i=document.createRange();i.setStart(this.el.childNodes.length?this.el.childNodes[0]:this.el,t),i.collapse(!0),e.removeAllRanges(),e.addRange(i)},e.prototype.selectAll=function(){var t=this.el;this.el.childNodes.length&&(t=this.el.childNodes[0]);var e=window.getSelection(),i=document.createRange();i.setStart(t,0),i.setEnd(t,this.el.textContent.length),e.removeAllRanges(),e.addRange(i)},e.prototype.selectNone=function(){window.getSelection().removeAllRanges()},e}),N2D("SlideEditorPopup34",function(r,t){var a="ss-slider-editor-popup34";function e(){var e=new N2Classes.ModalSimple("slide-editor-popup34",{destroyOnHide:!0,width:1e3,hasClose:!1}),t=r('<div class="n2_slide_editor_popup34"></div>');e.addContent(t),r('<div class="n2_slide_editor_popup34__heading"></div>').text(n2_("Most important changes in version 3.4")).appendTo(t),r('<div class="n2_slide_editor_popup34__sub_heading"></div>').text(n2_("To help you get started with the new version, we've put together the most important changes.")).appendTo(t);var i=r('<div class="n2_slide_editor_popup34__boxes"></div>').appendTo(t),s=r('<div class="n2_slide_editor_popup34__box"></div>').appendTo(i);r('<img src="'+nextend.imageHelper.fixed("$ss3-admin$/images/popup34/slidebackground.png")+'" alt=""></img>').appendTo(s),r('<div class="n2_slide_editor_popup34__box_heading"></div>').text(n2_("Slide background")).appendTo(s),r('<div class="n2_slide_editor_popup34__box_sub_heading"></div>').text(n2_("You can find the Slide Background option in the Layer Window! Click on the Slide Label at the top of the Canvas to find them.")).appendTo(s),r('<a href="https://www.youtube.com/watch?v=JAX0i5Zl-8I" class="n2_slide_editor_popup34__box_link n2_button n2_button--small n2_button--grey" target="_blank"></a>').text(n2_("Watch video")).appendTo(s);var n=r('<div class="n2_slide_editor_popup34__box"></div>').appendTo(i);r('<img src="'+nextend.imageHelper.fixed("$ss3-admin$/images/popup34/absoluteposition.png")+'" alt=""></img>').appendTo(n),r('<div class="n2_slide_editor_popup34__box_heading"></div>').text(n2_("Absolute position")).appendTo(n),r('<div class="n2_slide_editor_popup34__box_sub_heading"></div>').text(n2_("Canvas layers are now called Absolute! In the Add Panel switch to Absolute before you create the layer.")).appendTo(n),r('<a href="https://smartslider.helpscoutdocs.com/article/1916-slide-editing-in-smart-slider-3#absolute" class="n2_slide_editor_popup34__box_link n2_button n2_button--small n2_button--grey" target="_blank"></a>').text(n2_("Read docs")).appendTo(n);var o=N2Classes.UI.modalButton(n2_("Got it"),"blue").on("click",function(t){e.hide(t),localStorage.setItem(a,1)});e.addButton(o),e.show()}return localStorage.getItem(a)||N2R("windowLoad",function(){r(".n2_admin_editor").length&&new e}),e}),N2D("SmartSliderAdminSlideBackgroundColor",["SmartSliderSlideBackgroundColor"],function(t,e){function i(t,e){N2Classes.SmartSliderSlideBackgroundColor.prototype.constructor.apply(this,arguments)}return((i.prototype=Object.create(N2Classes.SmartSliderSlideBackgroundColor.prototype)).constructor=i).prototype.update=function(t,e,i,s){t=this.fixColor(t),this.$el.css({background:""}),this.$el.attr("data-overlay",parseInt(s)?1:0),"off"!==e?this.updateGradient(t,e,i):this.updateColor(t)},i.prototype.updateColor=function(t){"00"!==t.substr(6,8)&&this.$el.css("background","#"+t.substr(0,6)).css("background",N2Color.hex2rgbaCSS(t))},i.prototype.updateGradient=function(t,e,i){switch(this.$el.css({background:""}),i=this.fixColor(i),e){case"horizontal":this.$el.css("background","linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)");break;case"vertical":this.$el.css("background","linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)");break;case"diagonal1":this.$el.css("background","linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)");break;case"diagonal2":this.$el.css("background","linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)")}},i.prototype.fixColor=function(t){return t.length&&"#"===t.charAt(0)&&6===(t=t.substring(1)).length&&(t+="ff"),t},i}),N2D("SmartSliderAdminSlideBackgroundImage",["SmartSliderSlideBackgroundImage"],function(i,t){function e(t,e,i,s){this.hash=s.data("hash"),N2Classes.SmartSliderSlideBackgroundImage.prototype.constructor.apply(this,arguments),this.loadAllowed=!0,this.listenImageManager()}return((e.prototype=Object.create(N2Classes.SmartSliderSlideBackgroundImage.prototype)).constructor=e).prototype.listenImageManager=function(){""!==this.hash&&i(window).on(this.hash,this.onImageManagerChanged.bind(this))},e.prototype.notListenImageManager=function(){""!==this.hash&&i(window).off(this.hash,null,this.onImageManagerChanged.bind(this))},e.prototype.onImageManagerChanged=function(t,e){this.tabletSrc=e.tablet.image,this.mobileSrc=e.mobile.image,this.updateBackgroundToDevice(this.manager.device)},e.prototype.preLoadAdmin=function(t){this.preLoad()},e.prototype.setDesktopSrc=function(t){var e;this.notListenImageManager(),this.desktopSrc=t,this.hash=md5(t),""!==t&&this.background.allowVisualLoad?((e=new Image).addEventListener("load",function(){i.when(nextend.imageManager.getVisual(t)).done(function(t){this.onImageManagerChanged(null,t.value),this.listenImageManager()}.bind(this))}.bind(this),!1),e.src=nextend.imageHelper.fixed(t)):(this.tabletSrc="",this.mobileSrc="",this.setSrc(nextend.imageHelper.fixed(t)))},e.prototype.setSrc=function(t){N2Classes.SmartSliderSlideBackgroundImage.prototype.setSrc.call(this,nextend.imageHelper.fixed(t))},e.prototype.startFixed=function(){},e.prototype.updateMode=function(t,e){"blurfit"===t&&1===this.$background.length&&(this.$background=this.$background.add(this.$background.clone().insertAfter(this.$background)),this.$background.first().css({margin:"-14px",padding:"14px"}).css(window.n2FilterProperty,"blur(7px)")),"blurfit"===e&&"blurfit"!==t&&(this.$background.eq(1).remove(),this.$background=this.$background.eq(0),this.updateBlur(this.blur))},e.prototype.updateFocus=function(t,e){this.$background.css("background-position",t+"% "+e+"%")},e.prototype.updateOpacity=function(t){this.$background.css("opacity",t/100)},e.prototype.updateBlur=function(t){window.n2FilterProperty&&(0<t?this.$background.last().css({margin:"-"+2*t+"px",padding:2*t+"px"}).css(window.n2FilterProperty,"blur("+t+"px)"):this.$background.last().css({margin:"",padding:""}).css(window.n2FilterProperty,"")),this.blur=t},e.prototype.kill=function(){this.notListenImageManager(),this.$background.remove()},e}),N2D("LayerContainer",function(n,a){"use strict";function t(t){this.component=t,this.$ul=n('<div class="n2_layer_navigation_list_layer__children"></div>').data("container",this),this.childrenSelector="> .n2-ss-layer",this.layerContainerElement=t.layer}return t.prototype.setLayerContainerElement=function(t){this.layerContainerElement=t},t.prototype.startWithExistingNodes=function(t){for(var e=this.layerContainerElement.find(this.childrenSelector),i=0;i<e.length;i++)this._loadNode(e.eq(i),t);this.component.onChildCountChange()},t.prototype._loadNode=function(t,e){var i;switch(t.data("sstype")){case"content":i=new N2Classes.Content(this.component.fragmentEditor,this.component);break;case"layer":i=new N2Classes.Layer(this.component.fragmentEditor,this.component);break;case"row":i=new N2Classes.Row(this.component.fragmentEditor,this.component);break;case"col":i=new N2Classes.Col(this.component.fragmentEditor,this.component)}return!!i&&(i.load(t,e),e||i.sync(),i)},t.prototype.getLayerCount=function(){return this.layerContainerElement.find(this.childrenSelector).length},t.prototype.getLayerIndex=function(t){return this.layerContainerElement.find(this.childrenSelector).index(t)},t.prototype.getSortedLayers=function(){var s=[];return this.layerContainerElement.find(this.childrenSelector).each(function(t,e){var i=n(e).data("layerObject");i!==a&&s.push(i)}),s},t.prototype.append=function(t){t.appendTo(this.layerContainerElement);var e=this._loadNode(t,!1);return this.component.onChildCountChange(),e},t.prototype.insertAt=function(t,e){var i=this.getSortedLayers();e>=i.length?t.appendTo(this.layerContainerElement):t.insertBefore(i[e].layer);var s=this._loadNode(t,!1);return this.component.onChildCountChange(),s},t.prototype.insert=function(t){t.getRootElement().appendTo(this.layerContainerElement)},t.prototype.insertLayerAt=function(t,e){var i=this.getSortedLayers(),s=t.group,n=i.indexOf(t);-1<n&&n<e&&e++,e>=i.length?t.getRootElement().appendTo(this.layerContainerElement):t.getRootElement().insertBefore(i[e].getRootElement()),this.syncLayerRow(t),s!==this.component&&(s.onChildCountChange(),t.layer.triggerHandler("LayerAbsoluteUnavailable")),s.triggerLayerResized(),this.component.triggerLayerResized()},t.prototype.syncLayerRow=function(t){var e="slide"===this.component.type,i=e?t.getRootElement().prevAll(".n2-ss-layer").first().data("layerObject"):t.getRootElement().nextAll(".n2-ss-layer").first().data("layerObject");i!==a?t.layerRow.insertBefore(i.layerRow):this.$ul.append(t.layerRow),t.animations&&t.animations.syncRow(i,e)},t.prototype.getChildLayersRecursive=function(t){for(var e=this.getSortedLayers(),i=[],s=0;s<e.length;s++)t?i.push(e[s].layer[0]):i.push(e[s]),e[s].container&&i.push.apply(i,e[s].container.getChildLayersRecursive(t));return i},t.prototype.moveLayersToGroup=function(t,e){e=e||[];for(var i=[],s=0;s<t.length;s++){var n=t[s],o=n.group,r=n.getIndex();e[s]!==a?this.insertLayerAt(n,e[s]):this.insert(n),n.changeGroup(r,this.component),this!==o&&-1===i.indexOf(o)&&i.push(o)}for(s=0;s<i.length;s++)i[s].update()},t.prototype.activateFirst=function(){var t=this.getSortedLayers();0<t.length&&t[t.length-1].activate()},t.prototype.resetModes=function(t){for(var e=this.getSortedLayers(),i=0;i<e.length;i++)e[i].resetMode(t),e[i].container!==a&&e[i].container.resetModes(t)},t.prototype.copyModes=function(t,e){for(var i=this.getSortedLayers(),s=0;s<i.length;s++)i[s].copyMode(t,e),i[s].container!==a&&i[s].container.copyModes(t,e)},t.prototype.changeEditorModes=function(t){for(var e=this.getSortedLayers(),i=0;i<e.length;i++)e[i].changeEditorMode(t),e[i].container!==a&&e[i].container.changeEditorModes(t)},t.prototype.renderModeProperties=function(){for(var t=this.getSortedLayers(),e=0;e<t.length;e++)t[e].renderModeProperties(),t[e].container!==a&&t[e].container.renderModeProperties()},t.prototype.getAllLayers=function(t){t=t||[];for(var e=this.getSortedLayers(),i=0;i<e.length;i++)t.push(e[i]),e[i].container!==a&&e[i].container.getAllLayers(t);return t},t.prototype.getData=function(t){t=n.extend({layersIncluded:!0,itemsIncluded:!0},t);var e=[],i=this.getSortedLayers();if("slide"===this.component.type)for(var s=i.length-1;0<=s;s--)e.push(i[s].getData(t));else for(s=0;s<i.length;s++)e.push(i[s].getData(t));return e},t.prototype.getHTML=function(t){for(var e=this.getSortedLayers(),i=[],s=0;s<e.length;s++)i.push(e[s].getHTML(t));return i},t.prototype.getDroppables=function(t){for(var e,i=[],s=this.getSortedLayers(),n=0;n<s.length;n++){s[n]!==t&&("object"==typeof(e=s[n].getDroppable())&&i.push(e),"hidden"!==e&&s[n].container&&i.push.apply(i,s[n].container.getDroppables(t)))}return i},t.prototype.getLLDroppables=function(t){var e=[],i=this.component.getLLDroppable(t);i&&e.push(i);for(var s=this.getSortedLayers(),n=0;n<s.length;n++)s[n].container&&s[n]!==t&&e.push.apply(e,s[n].container.getLLDroppables(t));return e},t}),N2D("EditorContextualBarAbstract",function(i,t){function e(t){this.interactionManager=t,this.forceEnabledCounter=0,this.disabledCounter=1,this.component=!1,this.$contextual=i('<div class="n2_layer_contextual"></div>').on({contextmenu:this.interactionManager.handleContextMenu.bind(this.interactionManager)}).appendTo(this.interactionManager.$containerInner);var e=i('<div class="n2_layer_contextual__inner"></div>').appendTo(this.$contextual);this.$contextualLabel=i('<div class="n2_layer_contextual__label"></i></div>').appendTo(e),this.$buttonResponsiveTools=i('<div class="n2_layer_contextual__button n2_layer_contextual__button--responsive-tools"><i class="ssi_16 ssi_16--fontresize"></i></div>').appendTo(e),this.$buttonMore=i('<div class="n2_layer_contextual__button"><i class="ssi_16 ssi_16--more"></i></div>').appendTo(e)}return e.prototype.enableActiveForced=function(){this.forceEnabledCounter++,this._enable()},e.prototype.disableActiveForced=function(){this.forceEnabledCounter=Math.max(0,this.forceEnabledCounter-1),this._disable()},e.prototype.disable=function(){this.disabledCounter++,this._disable()},e.prototype._disable=function(){0===this.forceEnabledCounter&&1===this.disabledCounter&&this.blurComponent()},e.prototype.enable=function(){this.disabledCounter=Math.max(0,this.disabledCounter-1),this._enable()},e.prototype._enable=function(){(0<this.forceEnabledCounter||0===this.disabledCounter)&&this.focusComponent()},e.prototype.refreshPosition=function(){(this.interactionManager.isHover&&0===this.disabledCounter||0<this.forceEnabledCounter)&&this.component&&!this.component.isDeleted&&this.positionBar()},e.prototype.positionBar=function(){var t=this.component.layer[0].getBoundingClientRect(),e={top:t.top-this.interactionManager.innerOffset.top};e.top<28?(e.top+=28,this.$contextual.addClass("n2_layer_contextual--invert")):this.$contextual.removeClass("n2_layer_contextual--invert"),"left"===this.component.contextualBarPosition?e.left=t.left-this.interactionManager.innerOffset.left:"center"===this.component.contextualBarPosition&&(e.left=Math.floor(t.left-this.interactionManager.innerOffset.left+t.width/2-this.$contextual.width()/2)),this.$contextual.css(e)},e.prototype.onProxyMouseDown=function(t){this.component&&(t=t.originalEvent,this.component.layer[0].dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,button:t.button,buttons:t.buttons})))},e}),N2D("EditorContextualBarActive","EditorContextualBarAbstract",function(t,e){"use strict";function i(t){this.contextualMenuActive=!1,this.responsiveToolsActive=!1,N2Classes.EditorContextualBarAbstract.prototype.constructor.call(this,t),this.$contextual.addClass("n2_layer_contextual--active").on("mousedown",this.onProxyMouseDown.bind(this)),this.$contextualLabel.on("click",this.actionDisplayLayerWindow.bind(this)),this.$buttonResponsiveTools.on("click",this.actionResponsiveTools.bind(this)),this.$buttonMore.on("click",this.actionContextualMenu.bind(this))}return((i.prototype=Object.create(N2Classes.EditorContextualBarAbstract.prototype)).constructor=i).prototype.changeActiveComponent=function(t){this.blurComponent(),this.component=t,this.$contextualLabel.text(this.component.getUILabel()),this.$contextual.data("layerObject",this.component).toggleClass("n2_layer_contextual--has-responsive-tools",this.component.hasResponsiveTools()),this.focusComponent(),this.component.hasResponsiveTools()&&this.responsiveToolsActive&&this.showResponsiveTools()},i.prototype.blurComponent=function(){this.component&&!this.component.isDeleteStarted&&(this.$contextual.removeClass("n2_layer_contextual--visible"),this.component.layer.removeClass("n2_layer_contextual_active_layer"),this.component.editorUI.normalSizing&&this.component.editorUI.normalSizing.removeClass("nui-enabled"),this.component.editorUI.margin&&this.component.editorUI.margin.removeClass("nui-enabled"),this.component.editorUI.padding&&this.component.editorUI.padding.removeClass("nui-enabled"),this.component.editorUI.absoluteCC&&this.component.editorUI.absoluteCC.removeClass("nui-enabled"),this.component.editorUI.resize&&this.component.editorUI.resize.removeClass("nui-enabled"),this.component.editorUI.columns&&this.component.editorUI.columns.hideHandles(),this.component.layer.off(".contextualBarActive"))},i.prototype.focusComponent=function(){var t;(0===this.disabledCounter||0<this.forceEnabledCounter)&&!this.component.isDeleted&&(this.positionBar(),t="blue",this.component.isAbsolute()&&(t="purple"),this.$contextual.attr("data-color",t).addClass("n2_layer_contextual--visible"),this.component.layer.addClass("n2_layer_contextual_active_layer"),this.component.editorUI.normalSizing&&this.component.editorUI.normalSizing.addClass("nui-enabled"),this.component.editorUI.margin&&this.component.editorUI.margin.addClass("nui-enabled"),this.component.editorUI.padding&&this.component.editorUI.padding.addClass("nui-enabled"),this.component.editorUI.absoluteCC&&this.component.editorUI.absoluteCC.addClass("nui-enabled"),this.component.editorUI.resize&&this.component.editorUI.resize.addClass("nui-enabled"),this.component.editorUI.columns&&this.component.editorUI.columns.showHandles(),this.component.layer.on({"LayerDeleted.contextualBarActive":this.onLayerDelete.bind(this),"interaction.contextualBarActive":this.onLayerChange.bind(this),"LayerShowChange.contextualBarActive":this.onLayerChange.bind(this)}))},i.prototype.onLayerDelete=function(){this.$contextual.removeClass("n2_layer_contextual--visible")},i.prototype.onLayerChange=function(){this.refreshPosition()},i.prototype.actionDisplayLayerWindow=function(){this.interactionManager.fragmentEditor.layerWindow.show(this.component)},i.prototype.actionResponsiveTools=function(){this.responsiveToolsActive?this.hideResponsiveTools():this.showResponsiveTools()},i.prototype.showResponsiveTools=function(){this.hideResponsiveToolsTimeout&&clearTimeout(this.hideResponsiveToolsTimeout),this.$buttonResponsiveTools.hasClass("n2_layer_contextual__button--active")||(this.responsiveToolsActive=!0,this.$buttonResponsiveTools.addClass("n2_layer_contextual__button--active"),this.component.onContextResponsiveTools(this.$contextual[0],function(){this.$buttonResponsiveTools.removeClass("n2_layer_contextual__button--active"),this.hideResponsiveToolsTimeout=setTimeout(this.hideResponsiveTools.bind(this),300)}.bind(this)))},i.prototype.hideResponsiveTools=function(){this.responsiveToolsActive=!1,this.$buttonResponsiveTools.removeClass("n2_layer_contextual__button--active")},i.prototype.actionContextualMenu=function(){this.contextualMenuActive?this.hideContextualMenu():this.showContextualMenu()},i.prototype.showContextualMenu=function(t){this.hideContextualMenuTimeout&&clearTimeout(this.hideContextualMenuTimeout),!t&&this.$buttonMore.hasClass("n2_layer_contextual__button--active")||(this.contextualMenuActive=!0,this.$buttonMore.addClass("n2_layer_contextual__button--active"),this.component.onContextMenu(this.$contextual[0],{onClose:function(){this.hideContextualMenuTimeout=setTimeout(this.hideContextualMenu.bind(this),300)}.bind(this)}))},i.prototype.hideContextualMenu=function(){this.contextualMenuActive=!1,this.$buttonMore.removeClass("n2_layer_contextual__button--active")},i}),N2D("EditorContextualBarHoverSection","EditorContextualBarHover",function(n,o){"use strict";function t(t){N2Classes.EditorContextualBarHover.prototype.constructor.call(this,t),this.$contextual.addClass("n2_layer_contextual--hover-section")}return((t.prototype=Object.create(N2Classes.EditorContextualBarHover.prototype)).constructor=t).prototype.handleMouseOver=function(t){this.processHoveredElement(this.findRelatedSection(t.target))},t.prototype.processMouseCoordinates=function(t,e){this.processHoveredElement(this.findRelatedSection(document.elementFromPoint(t,e)))},t.prototype.findRelatedSection=function(t){var e,i=n(t);if("slide"===i.attr("data-sstype"))e=i;else if(!(e=i.closest('.n2-ss-layer[data-sstype="slide"]')).length){var s=i.hasClass("n2_layer_contextual")?i:i.closest(".n2_layer_contextual");return s.length?this.findRelatedSection(s.data("layerObject").layer[0]):!!this.component&&this.component}return e!==o&&e.data("layerObject")},t.prototype.blurComponent=function(){this.$contextual.removeClass("n2_layer_contextual--visible")},t.prototype.focusComponent=function(){0===this.disabledCounter&&this.component&&(this.positionBar(),this.refreshActiveState(),this.$contextual.attr("data-color","grey").addClass("n2_layer_contextual--visible"))},t}),N2D("EditorContextualBarHover","EditorContextualBarAbstract",function(t,e){"use strict";function i(t){this.namespace=this.namespace||"contextualBarHover",N2Classes.EditorContextualBarAbstract.prototype.constructor.call(this,t),this.$contextual.addClass("n2_layer_contextual--hover").on("mousedown",this.onProxyMouseDown.bind(this)),this.$contextualLabel.on("click",this.actionActivate.bind(this)),this.$buttonResponsiveTools.on("click",this.actionActivateWithResponsiveTools.bind(this)),this.$buttonMore.on("click",this.actionActivateWithContextualMenu.bind(this)),this.interactionManager.$container[0].addEventListener("mouseover",this.handleMouseOver.bind(this),{passive:!0,capture:!0})}return((i.prototype=Object.create(N2Classes.EditorContextualBarAbstract.prototype)).constructor=i).prototype.handleMouseOver=function(t){this.processHoveredElement(this.interactionManager.findRelatedComponent(t.target))},i.prototype.processMouseCoordinates=function(t,e){this.processHoveredElement(this.interactionManager.findRelatedComponent(document.elementFromPoint(t,e)))},i.prototype.processHoveredElement=function(t){t!==this.component&&(this.blurComponent(),this.component=t,this.component&&(this.$contextualLabel.text(this.component.getUILabel()),this.$contextual.data("layerObject",this.component).toggleClass("n2_layer_contextual--has-responsive-tools",this.component.hasResponsiveTools()),this.focusComponent()))},i.prototype.blurComponent=function(){this.$contextual.removeClass("n2_layer_contextual--visible"),this.component&&!this.component.isDeleteStarted&&(this.component.layer.removeClass("n2_layer_contextual_hover_layer"),this.component.layer.off("interaction."+this.namespace),this.component.markOut())},i.prototype.focusComponent=function(){var t;(0===this.disabledCounter||0<this.forceEnabledCounter)&&this.component&&!this.component.isDeleted&&(this.positionBar(),this.refreshActiveState(),this.component.layer.addClass("n2_layer_contextual_hover_layer"),t="grey",this.component.isAbsolute()&&(t="purple"),this.$contextual.attr("data-color",t).addClass("n2_layer_contextual--visible"),this.component.layer.on("LayerDeleted."+this.namespace,this.onLayerDelete.bind(this)),this.component.layer.on("interaction."+this.namespace,this.onLayerInteraction.bind(this)),this.component.markOver())},i.prototype.onLayerDelete=function(){this.$contextual.removeClass("n2_layer_contextual--visible")},i.prototype.onLayerInteraction=function(){this.refreshPosition()},i.prototype.actionActivate=function(t){this.component.activate(t)},i.prototype.actionActivateWithResponsiveTools=function(t){this.component.activate(!1),this.interactionManager.contextualBarActive.showResponsiveTools()},i.prototype.actionActivateWithContextualMenu=function(t){this.interactionManager.contextualBarActive.responsiveToolsActive&&this.interactionManager.contextualBarActive.hideResponsiveTools(),this.component.activate(!1),this.interactionManager.contextualBarActive.showContextualMenu(!0)},i.prototype.refreshActiveState=function(){this.$contextual.toggleClass("n2_layer_contextual--hover-active",this.interactionManager.activeComponent===this.component)},i}),N2D("LayerDataStorage",function(n,r){"use strict";function t(){this.isDeviceProp={},this.propertyScope={},this.property={},this.deviceProperty={desktopPortrait:{},desktopLandscape:{},tabletPortrait:{},tabletLandscape:{},mobilePortrait:{},mobileLandscape:{}},this.advancedProperties={}}return t.prototype.getMode=function(){return this.fragmentEditor.getMode()},t.prototype.getProperties=function(){var t,e,i={};for(var s in this.property){this.advancedProperties[s]!==r?s===this.advancedProperties[s].getName()&&(t=this.property[s],e=this.advancedProperties[s].getBaseName(),this.property[s]===r&&(t=this.property[e]),i[e]=t):i[s]=this.property[s]}return i},t.prototype.getRawProperty=function(t){if(this.isDeviceProp[t]){var e=this.getMode(),i=this.deviceProperty[e];return i[t]!==r?i[t]:r}return this.property[t]},t.prototype.getProperty=function(t){if(this.isDeviceProp[t]){var e=this.getMode(),i=this.deviceProperty[e],s=this.deviceProperty.desktopPortrait;if(i[t]!==r)return i[t];if(s[t]!==r)return s[t]}return this.property[t]},t.prototype.historyStore=function(t,e,i){this.isDeleteStarted||(this.store(i,e,t,!0,"history"),this.isDeviceProp[e]&&i!==this.getMode()||this.$.trigger("propertyChanged",[e,this.getProperty(e)]))},t.prototype.store=function(t,e,i,s,n){var o,r;t=t||this.getMode(),r=this.isDeviceProp[e]?(o=this.deviceProperty[t][e],this.getProperty(e)):o=this.property[e];var a=N2Classes.History.get().addValue(this,this.historyStore,[e,t]);a&&a.setValues(o,i),this.property[e]=i,this.isDeviceProp[e]&&(this.deviceProperty[t][e]=i),s&&this.render(e,r,n)},t.prototype.render=function(t,e,i){this.propertyScope[t]["_sync"+t]!==r&&this.propertyScope[t]["_sync"+t](e,i)},t.prototype.isDimensionPropertyAccepted=function(t){return(t+"").match(/[0-9]+%/)||"auto"===t},t.prototype.changeEditorMode=function(t){var e=parseInt(this.property[t]);this.layer.triggerHandler("LayerShowChange",[t,e]),this.renderModeProperties(!1)},t.prototype.renderModeProperties=function(t){for(var e in this.isDeviceProp)this.isDeviceProp[e]&&(this.property[e]=this.getProperty(e),this.$.trigger("propertyChanged",[e,this.property[e]]))},t.prototype.historyResetMode=function(t,e){this.deviceProperty[e]=n.extend({},t),e===this.fragmentEditor.getMode()&&this.renderModeProperties(!0)},t.prototype.resetMode=function(t){if("desktopPortrait"!==t){var e=N2Classes.History.get().addValue(this,this.historyResetMode,[t]);for(var i in e&&e.setValues(n.extend({},this.deviceProperty[t]),{}),this.deviceProperty[t])this.deviceProperty[t][i]=void 0;t===this.fragmentEditor.getMode()&&this.renderModeProperties(!0)}},t.prototype.copyMode=function(t,e){var i,s;t!==e&&(i=this.deviceProperty[e],this.deviceProperty[e]=n.extend({},this.deviceProperty[e],this.deviceProperty[t]),(s=N2Classes.History.get().addValue(this,this.historyResetMode,[e]))&&s.setValues(i,this.deviceProperty[e]))},t.prototype._getDefault=function(t,e){return this.originalProperties[t]!==r?this.originalProperties[t]:e},t.prototype.createProperty=function(t,e,i,s){this.isDeviceProp[t]=!1,this.propertyScope[t]=s||this,i?(this.property[t]=i.data(t.toLowerCase()),this.property[t]!==r&&null!==this.property[t]||(this.property[t]=this._getDefault(t,e))):this.property[t]=this._getDefault(t,e)},t.prototype.createAdvancedProperty=function(t,e,i){var s=t.getNames();for(var n in s)this.advancedProperties[n]=t,this.createProperty(n,s[n],e,i)},t.prototype.syncAdvancedField=function(t){var e=this.advancedProperties[t].getName(),i=this.property[e];this.property[e]===r&&(i=this.property[t]),this.fragmentEditor.layerOptions.updateField(t,i)},t.prototype.createDeviceProperty=function(t,e,i,s){var n,o;if(this.isDeviceProp[t]=!0,this.propertyScope[t]=s||this,i){for(n in this.deviceProperty)this.deviceProperty[n][t]=i.data(n.toLowerCase()+t.toLowerCase()),""===this.deviceProperty[n][t]&&(this.deviceProperty[n][t]=r);for(n in this.deviceProperty)this.deviceProperty[n][t]!==r&&""!==this.deviceProperty[n][t]||(o=this._getDefault(n.toLowerCase()+t.toLowerCase()))!==r&&(this.deviceProperty[n][t]=o);for(n in e)this.deviceProperty[n][t]!==r&&""!==this.deviceProperty[n][t]||(this.deviceProperty[n][t]=e[n])}else{for(n in e)this.deviceProperty[n][t]=e[n];for(n in this.deviceProperty)(o=this._getDefault(n.toLowerCase()+t.toLowerCase()))!==r&&(this.deviceProperty[n][t]=o)}this.property[t]=this.deviceProperty.desktopPortrait[t]},t.prototype.removeProperty=function(t){if(delete this.property[t],this.layer.removeData(t.toLowerCase()).removeAttr("data-"+t.toLowerCase()),this.isDeviceProp[t])for(var e in this.deviceProperty)delete this.deviceProperty[e][t],this.layer.removeData(e.toLowerCase()+t.toLowerCase()).removeAttr("data-"+e.toLowerCase()+t.toLowerCase());delete this.isDeviceProp[t],delete this.propertyScope[t]},t.prototype.removeProperties=function(t){for(var e=0;e<t.length;e++)this.removeProperty(t[e])},t.prototype.getPropertiesData=function(t){for(var e={},i=0;i<t.length;i++){var s=t[i];if(this.property[s]!==r&&(e[s]=this.property[s]),this.isDeviceProp[s])for(var n in this.deviceProperty)this.deviceProperty[n][s]!==r&&(e[n.toLowerCase()+s]=this.deviceProperty[n][s])}return e},t.prototype.setProperty=function(t,e,i){this.advancedProperties[t]!==r&&(t=this.advancedProperties[t].getName()),this.propertyScope[t]!==r?"function"==typeof this.propertyScope[t]["setProperty"+t]?this.propertyScope[t]["setProperty"+t](t,e,i):this._setProperty(t,e,i):"function"==typeof this["setProperty"+t]&&this["setProperty"+t](t,e,i)},t.prototype._setProperty=function(t,e,i){this.store(r,t,e,!0,i),"manager"!==i&&this.$.trigger("propertyChanged",[t,this.getProperty(t)])},t.prototype.onSyncFields=function(){},t.prototype.resetStyleMode=function(t){for(var e in this.advancedProperties)this.advancedProperties[e].resetMode(t)},t.prototype.outsideStoreProperty=function(t,e,i,s){this.store(t,e,i,!0,s),t!==r&&t!==this.getMode()||this.$.trigger("propertyChanged",[e,this.getProperty(e)])},t}),N2D("FragmentEditorHotkey",function(f,e){"use strict";var g={97:"left",98:"center",99:"right",100:"left",101:"center",102:"right",103:"left",104:"center",105:"right"},y={97:"bottom",98:"bottom",99:"bottom",100:"middle",101:"middle",102:"middle",103:"top",104:"top",105:"top"};function t(t){this.fragmentEditor=t,this.keysPressed={},this.keyIntervals={},document.addEventListener("keydown",this.onKeyDown.bind(this),{capture:!0}),document.addEventListener("keyup",this.onKeyUp.bind(this),{capture:!0})}return t.prototype.onKeyDown=function(t){if(!t.defaultPrevented){if("TEXTAREA"!==t.target.tagName&&"INPUT"!==t.target.tagName&&!t.target.isContentEditable&&"main"===N2Classes.WindowManager.getCurrentWindow()){var e,i,s,n,o,r,a=this.fragmentEditor.activeLayer,l=t.keyCode,d=!1;if(49<=l&&l<=57&&3===(t.location||t.keyLocation||0)&&(l+=48),t.shiftKey&&!t.ctrlKey&&!t.metaKey)if(69===l){var h=[];t.altKey?(h=["desktopLandscape","tabletLandscape","tabletPortrait","mobileLandscape","mobilePortrait"],N2Classes.Notification.success(n2_("Clear device specific settings")+" - "+n2_("Current layer, all devices"))):(h.push(this.fragmentEditor.getMode()),N2Classes.Notification.success(n2_("Clear device specific settings")+" - "+n2_("Current layer, current device")));for(var c=0;c<h.length;c++)a.resetMode(h[c]);d=!0}else if(82===l){var h=[],p=this.fragmentEditor.mainContainer.container.getAllLayers();p.unshift(this.fragmentEditor.mainContainer),t.altKey?(h=["desktopLandscape","tabletLandscape","tabletPortrait","mobileLandscape","mobilePortrait"],N2Classes.Notification.success(n2_("Clear device specific settings")+" - "+n2_("All layers, all devices"))):(h.push(this.fragmentEditor.getMode()),N2Classes.Notification.success(n2_("Clear device specific settings")+" - "+n2_("All layers, current device")));for(var u=0;u<p.length;u++)for(c=0;c<h.length;c++)p[u].resetMode(h[c]);d=!0}(t.ctrlKey||t.metaKey)&&(90===l?t.shiftKey?N2Classes.History.get().redo()&&(d=!0):N2Classes.History.get().undo()&&(d=!0):67===l?0===window.getSelection().toString().length&&(this.fragmentEditor.clipboard.copy(),d=!0):86===l?(this.fragmentEditor.clipboard.paste(),d=!0):49===l?(f("#n2-ss-preview").trigger("click"),d=!0):50===l?((e=f('.n2_device_tester_devices__device[data-device="desktopPortrait"]')).hasClass("n2_device_tester_devices__device--active")||e.trigger("click"),d=!0):51===l?((i=f('.n2_device_tester_devices__device[data-device="tabletPortrait"]')).hasClass("n2_device_tester_devices__device--active")||i.trigger("click"),d=!0):52===l&&((s=f('.n2_device_tester_devices__device[data-device="mobilePortrait"]')).hasClass("n2_device_tester_devices__device--active")||s.trigger("click"),d=!0)),!d&&a&&(t.ctrlKey||t.metaKey?68===l&&(this.fragmentEditor.duplicate(),d=!0):46===l||8===l?(this.fragmentEditor.delete(),d=!0):16===l?this.keysPressed[l]=1:38===l?"absolute"===a.placement.getType()&&(this.keyIntervals[l]||(this.layerMoveUp(),this.keyIntervals[l]=setInterval(this.layerMoveUp.bind(this),100)),d=!0):40===l?"absolute"===a.placement.getType()&&(this.keyIntervals[l]||(this.layerMoveDown(),this.keyIntervals[l]=setInterval(this.layerMoveDown.bind(this),100)),d=!0):37===l?"absolute"===a.placement.getType()&&(this.keyIntervals[l]||(this.layerMoveLeft(),this.keyIntervals[l]=setInterval(this.layerMoveLeft.bind(this),100)),d=!0):39===l?"absolute"===a.placement.getType()&&(this.keyIntervals[l]||(this.layerMoveRight(),this.keyIntervals[l]=setInterval(this.layerMoveRight.bind(this),100)),d=!0):97<=l&&l<=105&&"absolute"===a.placement.getType()&&(n=g[l],o=y[l],r=!1,this.fragmentEditor.layerOptions.forms.placement.absolute.align.val()===n&&this.fragmentEditor.layerOptions.forms.placement.absolute.valign.val()===o&&(r=!0),this.fragmentEditor.layerOptions.layerFeatures.horizontalAlign(n,r),this.fragmentEditor.layerOptions.layerFeatures.verticalAlign(o,r),d=!0)),d||t.ctrlKey||t.metaKey||(81===l?this.fragmentEditor.addLayer.visible||(a.activate(!0),this.fragmentEditor.layerWindow.tab.displayTab("content"),d=!0):87===l?this.fragmentEditor.addLayer.visible||(a.activate(!0),this.fragmentEditor.layerWindow.tab.displayTab("style"),d=!0):69===l?this.fragmentEditor.addLayer.visible||(a.activate(!0),this.fragmentEditor.layerWindow.tab.displayTab("animations"),d=!0):65===l?(this.fragmentEditor.addLayer.toggleActive(),d=!0):83===l&&(this.fragmentEditor.addLayer.visible||(a.activate(!0),this.fragmentEditor.layerWindow.toggleLayerList(),d=!0))),d&&t.preventDefault()}}},t.prototype.onKeyUp=function(t){this.keyIntervals[t.keyCode]!==e&&(clearInterval(this.keyIntervals[t.keyCode]),delete this.keyIntervals[t.keyCode]),16===t.keyCode&&this.keysPressed[16]!==e&&(this.keysPressed[16]=0)},t.prototype.layerMoveUp=function(){this.fragmentEditor.activeLayer.moveY(-1*(this.keysPressed[16]?10:1))},t.prototype.layerMoveDown=function(){this.fragmentEditor.activeLayer.moveY(this.keysPressed[16]?10:1)},t.prototype.layerMoveLeft=function(){this.fragmentEditor.activeLayer.moveX(-1*(this.keysPressed[16]?10:1))},t.prototype.layerMoveRight=function(){this.fragmentEditor.activeLayer.moveX(this.keysPressed[16]?10:1)},t}),N2D("EditorInteractionManager",function(s,n){"use strict";function t(t){this.fragmentEditor=t,this.isHover=!1,this.state={drag:!1},this.$container=s(".n2_admin_editor__content").on({click:this.handleMouseClick.bind(this)}),this.$containerInner=this.$container.find(".n2_slide_editor_slider__editor_inner").one("mouseover",this.mouseEnter.bind(this)).on({mouseenter:this.mouseEnter.bind(this),mouseleave:this.mouseLeave.bind(this),dblclick:this.handleDoubleClick.bind(this),contextmenu:this.handleContextMenu.bind(this)}),this.storeInnerOffset(),document.addEventListener("mousemove",this.onMouseMove.bind(this),{passive:!0,capture:!0}),this.contextualBarHoverSection=new N2Classes.EditorContextualBarHoverSection(this),this.contextualBarHover=new N2Classes.EditorContextualBarHover(this),this.contextualBarActive=new N2Classes.EditorContextualBarActive(this),window.addEventListener("resize",this.refreshPosition.bind(this),{passive:!0,capture:!0}),document.addEventListener("scroll",this.refreshPosition.bind(this),{passive:!0,capture:!0}),document.addEventListener("EditorInvalidated",this.refreshPosition.bind(this)),this.fragmentEditor.editor.frontend.sliderElement.on("SliderResize",this.refreshPosition.bind(this))}return t.prototype.changeActiveComponent=function(t){this.activeComponent=t,this.contextualBarActive.changeActiveComponent(t),this.contextualBarHoverSection.refreshActiveState(),this.contextualBarHover.refreshActiveState(),this.lastMouseMoveEvent!==n&&(this.contextualBarHoverSection.processMouseCoordinates(this.lastMouseMoveEvent.clientX,this.lastMouseMoveEvent.clientY),this.contextualBarHover.processMouseCoordinates(this.lastMouseMoveEvent.clientX,this.lastMouseMoveEvent.clientY))},t.prototype.onMouseMove=function(t){this.lastMouseMoveEvent=t},t.prototype.refreshPosition=function(){this.storeInnerOffset(),this.contextualBarActive.refreshPosition(),this.contextualBarHover.refreshPosition(),this.contextualBarHoverSection.refreshPosition()},t.prototype.mouseEnter=function(){this.isHover||(this.isHover=!0,this.enable(),this.syncHover())},t.prototype.mouseLeave=function(){this.isHover&&(this.isHover=!1,this.disable(),this.syncHover())},t.prototype.enable=function(){this.contextualBarHoverSection.enable(),this.contextualBarHover.enable(),this.contextualBarActive.enable()},t.prototype.disable=function(){this.contextualBarActive.disable(),this.contextualBarHover.disable(),this.contextualBarHoverSection.disable()},t.prototype.syncHover=function(){this.$container.toggleClass("n2_admin_editor__content--hover",this.isHover)},t.prototype.storeInnerOffset=function(){this.innerOffset=this.$containerInner[0].getBoundingClientRect()},t.prototype.handleMouseClick=function(t){var e;N2Classes.WindowManager.isActionPrevented("ComponentActivate")||((e=this.findRelatedComponent(s(t.target)))?e.activate(t):this.fragmentEditor.layerWindow.requestHide())},t.prototype.handleDoubleClick=function(t){var e,i=s(t.target);!i.closest(".n2-ss-layer").length||(e=this.findRelatedComponent(i))&&e===this.activeComponent&&this.activeComponent.doubleClick(t)},t.prototype.handleContextMenu=function(t){var e=this.findRelatedComponent(s(t.target));e&&(t.preventDefault(),e.onContextMenu(t))},t.prototype.findRelatedComponent=function(t){var e,i=s(t);return i.hasClass("n2-ss-layer")?e=i:(e=i.closest(".n2-ss-layer")).length||(e=i.hasClass("n2_layer_contextual")?i:i.closest(".n2_layer_contextual")),e!==n&&e.data("layerObject")},t}),N2D("FragmentClipboard",function(t,o){"use strict";function e(t){this.fragmentEditor=t}return e.prototype.copy=function(){var t=this.fragmentEditor.activeLayer;this.fragmentEditor.isSectionSlide(t)?this.sectionCopy():this.componentCopy(t)},e.prototype.paste=function(){var t=this.fragmentEditor.activeLayer;this.fragmentEditor.isSectionSlide(t)?this.sectionPaste():this.componentPaste(t)},e.prototype.sectionHasClipboard=function(){return!!localStorage.getItem("clipboardSection")},e.prototype.sectionCopy=function(){var t=this.fragmentEditor.getSectionData();localStorage.setItem("clipboardSection",JSON.stringify(t))},e.prototype.sectionPaste=function(){var t=localStorage.getItem("clipboardSection");t&&(t=JSON.parse(t),this.fragmentEditor.manipulator.sectionReplace(this.fragmentEditor.mainContainer,t))},e.prototype.componentHasClipboard=function(){return!!localStorage.getItem("clipboardLayers")},e.prototype.componentCopy=function(t){var e,i;this.fragmentEditor.isSectionSlide(t)?alert("copy section"):(e=this.fragmentEditor.isCol(t)||this.fragmentEditor.isContent(t)?t.container.getSortedLayers():[t],(i=this.getComponentsData(e)).length&&localStorage.setItem("clipboardLayers",JSON.stringify(i)))},e.prototype.componentPaste=function(t){var e,i,s,n=localStorage.getItem("clipboardLayers");!n||(e=JSON.parse(n)).length&&("normal"===(i=e[0].pm)?(s=t===o?this.fragmentEditor.mainContainer.getTargetGroupDefault():this.fragmentEditor.isCol(t)||this.fragmentEditor.isContent(t)?t:this.fragmentEditor.isRow(t)?t.container.getSortedLayers()[0]:"normal"===t.placement.getType()?t.group:this.fragmentEditor.mainContainer.getTargetGroupDefault(),this.fragmentEditor.manipulator.addLayers(e,s)):"absolute"===i&&(s=t===o?this.fragmentEditor.mainContainer.getTargetGroupAbsolute():t.container?t:t.group,this.fragmentEditor.manipulator.addLayers(e,s)))},e.prototype.getComponentsData=function(t){if(t===o)return[];for(var e=[],i=[],s=0;s<t.length;s++)t[s].getDataWithChildren(e,i);return e},e}),N2D("FragmentEditor",function(o,t){"use strict";function e(t,e,i){this.mode="desktopPortrait",this.editor=t,this.$editedElement=e,this.ready=o.Deferred(),this.$=o(this),t.fragmentEditor=this,o(".n2_slide_editor_slider__editor").attr("dir",o("html").attr("dir")),this.addLayer=new N2Classes.AddLayer(this),this.layerWindow=new N2Classes.LayerWindow(this),this.layerOptions=new N2Classes.ComponentSettings(this),this.layerNavigation=new N2Classes.LayerNavigation(this),this.manipulator=new N2Classes.FragmentManipulator(this),this.clipboard=new N2Classes.FragmentClipboard(this),this.mainContainer=new N2Classes.SectionSlide(this),this.canvasUIManager=new N2Classes.UICanvas(this.mainContainer.layer,this),this.itemEditor=new N2Classes.ItemManager(this,i),this.mainContainer.lateInit(),this._initDeviceModeChange(),this.canvasSettings=new N2Classes.CanvasSettings(this),this.layerOptions.startFeatures(),this.pointerManager=new N2Classes.EditorInteractionManager(this),new N2Classes.FragmentEditorHotkey(this),this.mainContainer.activate(!0)}return e.prototype.getMode=function(){return this.mode},e.prototype.getResponsiveRatioHorizontal=function(){return this.editor.getHorizontalRatio()},e.prototype.getResponsiveRatioVertical=function(){return this.editor.getVerticalRatio()},e.prototype.isRow=function(t){return t instanceof N2Classes.Row},e.prototype.isCol=function(t){return t instanceof N2Classes.Col},e.prototype.isLayer=function(t){return t instanceof N2Classes.Layer},e.prototype.isContent=function(t){return t instanceof N2Classes.Content},e.prototype.isSectionSlide=function(t){return t instanceof N2Classes.SectionSlide},e.prototype._initDeviceModeChange=function(){o("#layer-clear-device-specific-changes, #layer-slide-clear-device-specific-changes").on("click",this.onClearDeviceSpecificChanges.bind(this));var t=this.editor.getAvailableDeviceModes();o("#layershow").data("field").setAvailableDevices(t),this.refreshMode(),this.ready.resolve()},e.prototype.refreshMode=function(){this.mode=this.editor.getDeviceMode(),this.mainContainer.changeEditorMode(this.mode)},e.prototype.onChangeDeviceOrientation=function(){this.refreshMode()},e.prototype.onResize=function(t){this.mainContainer.onResize(t),this.canvasSettings.ruler&&this.canvasSettings.ruler.onResize()},e.prototype.onClearDeviceSpecificChanges=function(){var t;this.activeLayer&&(t=this.getMode(),this.activeLayer.resetMode(t))},e.prototype.copyOrResetMode=function(t){var e=this.getMode();"desktopPortrait"===e?"desktopPortrait"!==t&&this.mainContainer.container.resetModes(t):t===e?this.mainContainer.container.resetModes(t):this.mainContainer.container.copyModes(e,t)},e.prototype.getSnap=function(t,e){var i=o();if(this.canvasSettings.get("n2-ss-snap-to-enabled")){this.mainContainer===t&&(i=i.add(".n2-ruler-user-guide"));for(var s=t.container.getSortedLayers(),n=0;n<s.length;n++)"absolute"===s[n].placement.getType()&&(i=i.add(s[n].layer))}return i.filter(":visible").not(e.layer)},e.prototype.getHTML=function(){for(var t=o("<div></div>"),e=this.mainContainer.container.getAllLayers(),i=0;i<e.length;i++)t.append(e[i].getHTML(!0));return t.html()},e.prototype.getData=function(){return this.mainContainer.getData()},e.prototype.getSectionData=function(){return this.mainContainer.getSectionData()},e.prototype.loadComponentWithNode=function(t,e,i,s){var n=t.container.append(e);return s&&this.refreshMode(),n},e.prototype.insertComponentWithNode=function(t,e,i,s,n){var o=t.container.insertAt(e,i);return n&&this.refreshMode(),o},e.prototype.resetActiveLayer=function(){var t=this.mainContainer.container.getSortedLayers();t.length&&t[t.length-1].activate()},e.prototype.changeActiveLayer=function(s){var t=this.activeLayer;t&&!t.isDeleted&&(t.$.off("propertyChanged.editor").off(".active"),t.deActivate()),this.activeLayer=s,(nextend.activeLayer=s)&&(this.pointerManager.changeActiveComponent(s),this.layerOptions.changeActiveComponent(s,s.type,s.getSubType(),s.placement.getType(),s.getProperties()),s.$.on({"propertyChanged.editor":this.layerOptions.onUpdateField.bind(this.layerOptions),"placementChanged.active":function(t,e,i){this.layerOptions.changeActiveComponentPlacement(e,s.property)}.bind(this)})),this.$.trigger("activeLayerChanged")},e.prototype.getActiveLayer=function(){return this.activeLayer},e.prototype.highlight=function(t){this.pointerManager.contextualBarHover.enableActiveForced(),this.pointerManager.contextualBarHover.processHoveredElement(t),this.hoverZIndexInterval&&clearInterval(this.hoverZIndexInterval),this.hoverZIndexInterval=setInterval(function(){this.toggleClass("n2_layer_layer_list_hover--force-zindex")}.bind(t.layer),800)},e.prototype.deHighlight=function(t){this.pointerManager.contextualBarHover.disableActiveForced(),this.hoverZIndexInterval&&clearInterval(this.hoverZIndexInterval),t.isDeleted||t.layer.removeClass("n2_layer_layer_list_hover--force-zindex")},e.prototype.delete=function(){this.activeLayer.delete()},e.prototype.duplicate=function(){this.activeLayer.duplicate(!0)},e.prototype.getSelf=function(){return this},e}),N2D("FragmentManipulator",function(p,u){function t(t){this.fragmentEditor=t}return t.prototype.deleteLayers=function(){for(var t=this.fragmentEditor.mainContainer.container.getSortedLayers(),e=0;e<t.length;e++)t[e].delete()},t.prototype.sectionReplace=function(t,e){var i=p.extend(!0,{},e),s=t.container;this._idTranslation={};var n=this.dataToLayers(p.extend(!0,[],i.layers).reverse()),o=[];this.deleteLayers(),t.mainContent.remove();for(var r=0;r<n.length;r++)o.push(s.append(n[r]));N2Classes.History.get().startBatch();var a,l={};for(var d in t.removeProperty("padding"),t.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10"}),t.deviceProperty)for(var h in t.isDeviceProp){t.isDeviceProp[h]&&(i[a=d.toLowerCase()+h]!==u?(l[h]=!0,t.outsideStoreProperty(d,h,i[a],!0,"sectionReplace"),delete i[a]):!0===l[h]&&t.outsideStoreProperty(d,h,u,!0,"sectionReplace"))}for(var c in t.property)i[c]!==u&&(t.outsideStoreProperty(u,c,i[c],!0,"sectionReplace"),delete i[c]);return N2Classes.History.get().addSimple(this,this.historyDeleteAll,this.historyReplaceLayers,[t,i,o,s.getAllLayers()]),N2Classes.History.get().endBatch(),this.fragmentEditor.refreshMode(),s.layerContainerElement.n2imagesLoaded().always(this.fragmentEditor.refreshMode.bind(this.fragmentEditor)),this.fragmentEditor.getActiveLayer()||0<o.length&&o[0].activate(),o},t.prototype.historyDeleteAll=function(t,e,i){for(var s=0;s<i.length;s++)i[s].getSelf().delete();t.mainContent.getSelf().remove()},t.prototype.historyReplaceLayers=function(t,e,i,s){this.sectionReplace(t,e);for(var n=t.container.getAllLayers(),o=0;o<s.length;o++)s[o].setSelf(n[o])},t.prototype.addLayers=function(t,e){this._idTranslation={};for(var i=this.dataToLayers(p.extend(!0,[],t)),s=[],n=0;n<i.length;n++)s.push(e.container.append(i[n]));return this.fragmentEditor.refreshMode(),N2Classes.History.get().addSimple(this,this.historyDeleteLayers,this.historyAddLayers,[t,s,e]),s},t.prototype.historyDeleteLayers=function(t,e,i){for(var s=0;s<e.length;s++)e[s].getSelf().delete()},t.prototype.historyAddLayers=function(t,e,i){for(var s=this.addLayers(t,i.getSelf()),n=0;n<e.length;n++)e[n].setSelf(s[n])},t.prototype.dataToLayers=function(t,e){for(var i=[],s=0;s<t.length;s++)switch(t[s].type){case"row":i.push(this.buildRowNode(t[s],e));break;case"col":i.push(this.buildColNode(t[s],e));break;case"content":i.push(this.buildContentNode(t[s],e));break;case"layer":default:i.push(this.buildLayerNode(t[s],e))}return i},t.prototype._buildNodePrepareID=function(t,e){var i,s;if(e.id&&(i=p.fn.uid(),s=!1,"object"==typeof this._idTranslation[e.id]&&(s=this._idTranslation[e.id]),this._idTranslation[e.id]=i,e.id=i,t.attr("id",i),s&&s.resolve(e.id,i)),e.parentid)switch(typeof this._idTranslation[e.parentid]){case"string":e.parentid=this._idTranslation[e.parentid];break;case"undefined":this._idTranslation[e.parentid]=p.Deferred();case"object":this._idTranslation[e.parentid].done(function(t,e,i){t.data("parentid",i)}.bind(this,t));break;default:e.parentid=""}},t.prototype.buildContentNode=function(t,e){var i=p("<div class='n2-ss-layer' data-sstype='content'></div>"),s=p("<div class='n2-ss-section-main-content n2-ss-layer-content'></div>").appendTo(i);for(var n in t)i.data(n,t[n]);return e!==u&&i.appendTo(e),this.dataToLayers(t.layers,s),i},t.prototype.buildRowNode=function(t,e){var i=p("<div class='n2-ss-layer' data-sstype='row'></div>"),s=p("<div class='n2-ss-layer-row'></div>").appendTo(i);for(var n in this._buildNodePrepareID(i,t),t)i.data(n,t[n]);return e!==u&&i.appendTo(e),this.dataToLayers(t.cols,s),i},t.prototype.buildColNode=function(t,e){var i=p("<div class='n2-ss-layer' data-sstype='col'></div>"),s=p("<div class='n2-ss-layer-col n2-ss-layer-content'></div>").appendTo(i);for(var n in t)i.data(n,t[n]);return e!==u&&i.appendTo(e),this.dataToLayers(t.layers,s),i},t.prototype.buildLayerNode=function(t,e){var i=p("<div class='n2-ss-layer' data-sstype='layer'></div>").attr("style",t.style);for(var s in this._buildNodePrepareID(i,t),t.items!==u&&(t.item=t.items[0],delete t.items),p('<div class="n2-ss-item n2-ss-item-'+t.item.type+'"></div>').data("item",t.item.type).data("itemvalues",t.item.values).appendTo(i),delete t.style,delete t.item,t)i.data(s,t[s]);return e!==u&&i.appendTo(e),i},t.prototype.getSelf=function(){return this},t}),N2D("AddLayer",function(h,e){function t(t){this.fragmentEditor=t,this.sectionLibraryFree=t.editor.options.sectionLibraryFree,this.sectionLibraryUrl=t.editor.options.sectionLibraryUrl,this.sectionLibraryGoProUrl=t.editor.options.sectionLibraryGoProUrl;try{localStorage.removeItem("SectionFreeThemeorion_dark"),localStorage.removeItem("SectionFreeThemeorion_darkMetaDate"),localStorage.removeItem("SectionFreeThemeorion_light"),localStorage.removeItem("SectionFreeThemeorion_lightMetaDate"),localStorage.removeItem("SectionFreeThemes"),localStorage.removeItem("SectionFreeThemesMetaDate"),localStorage.removeItem("SectionProThemeorion_dark"),localStorage.removeItem("SectionProThemeorion_darkMetaDate"),localStorage.removeItem("SectionProThemeorion_light"),localStorage.removeItem("SectionProThemeorion_lightMetaDate"),localStorage.removeItem("SectionProThemes"),localStorage.removeItem("SectionProThemesMetaDate")}catch(t){}this.visible=!1,this.$editor=h(".n2_admin_editor"),this.$editorOverlay=h(".n2_admin_editor_overlay"),this.$addLayer=h(".n2_add_layer"),h(".n2_add_layer__bar_button_add").on("click",function(t){t.preventDefault(),this.toggleActive()}.bind(this)),this.$addLayer.find(".n2_add_layer_box"),this.hideInteractionCallback=this.hideInteraction.bind(this),this.onKeyDownCallback=this.onKeyDown.bind(this),this.initTabs(),this.initPositionChanger()}return t.prototype.hide=function(){this.visible=!0,this.toggleActive()},t.prototype.hideInteraction=function(t){h.contains(this.$addLayer[0],t.target)||this.$addLayer.is(t.target)||this.hide()},t.prototype.onKeyDown=function(t){27===t.keyCode&&(t.stopImmediatePropagation(),t.preventDefault(),this.hide())},t.prototype.toggleActive=function(){this.visible=!this.visible,h("body").toggleClass("n2_body--show-add-more",this.visible),this.$editorOverlay.toggleClass("n2_admin_editor_overlay--show-add-more",this.visible),this.visible?(this.$editor[0].addEventListener("click",this.hideInteractionCallback,{capture:!0}),document.addEventListener("keydown",this.onKeyDownCallback,{capture:!0})):(this.$editor[0].removeEventListener("click",this.hideInteractionCallback,{capture:!0}),document.removeEventListener("keydown",this.onKeyDownCallback,{capture:!0}),this.setPosition("default"))},t.prototype.initTabs=function(){this.$buttons=h(".n2_add_layer__more_tab_button").on("click"),this.$tabs=h(".n2_add_layer__more_tab"),this.valuesDict={};for(var t=0;t<this.$buttons.length;t++){var e=this.$buttons.eq(t),i=e.data("related-tab");this.valuesDict[i]={index:t,$button:e,$tab:this.$tabs.filter('[data-tab="'+i+'"]')},e.on("click",this.displayTab.bind(this,i))}this.displayTab("layers")},t.prototype.displayTab=function(t,e){e&&e.preventDefault(),this.activeTabName!==t&&(this.activeTabName=t,this.$buttons.removeClass("n2_add_layer__more_tab_button--active"),this.$tabs.removeClass("n2_add_layer__more_tab--active"),this.valuesDict[t].$button.addClass("n2_add_layer__more_tab_button--active"),this.valuesDict[t].$tab.addClass("n2_add_layer__more_tab--active"),"library"===t&&this.initLibrary())},t.prototype.initPositionChanger=function(){this.currentPosition="default",this.$position=this.$addLayer.find(".n2_add_layer_position"),this.$position.find(".n2_add_layer_position__default_label").on("click",this.setPosition.bind(this,"default")),this.$position.find(".n2_add_layer_position__absolute_label").on("click",this.setPosition.bind(this,"absolute")),this.$position.find(".n2_add_layer_position__switch").on("click",this.togglePosition.bind(this))},t.prototype.setPosition=function(t){this.currentPosition=t,this.$position.attr("data-position",t)},t.prototype.togglePosition=function(){this.setPosition("default"===this.currentPosition?"absolute":"default")},t.prototype.getPosition=function(){return this.currentPosition},t.prototype.initLibrary=function(){this.initLibrary=function(){},this.activeThemeID=!1,this.themes={},this.$themesTitle=h('<div class="n2_add_layer_library__title"></div>').appendTo(this.valuesDict.library.$tab),h('<div class="n2_add_layer_library__title_label"></div>').text(n2_("Theme")).appendTo(this.$themesTitle),this.displayThemes()},t.prototype.displayThemes=function(){N2Classes.AjaxHelper.ajax({type:"GET",url:this.sectionLibraryUrl+"/themes/",dataType:"json"}).done(function(t){this.onThemesLoaded(t.themes)}.bind(this))},t.prototype.onThemesLoaded=function(t){for(var e=h('<div class="n2_field_select"></div>').appendTo(this.$themesTitle),i=h('<select name="library-theme" autocomplete="off"></select>').appendTo(e),s=0;s<t.length;s++)i.append('<option value="'+t[s].id+'">'+t[s].label+"</option>");this.displayTheme(t[0].id),i.on("change",function(){this.displayTheme(i.val())}.bind(this))},t.prototype.displayTheme=function(t){this.activeThemeID!==t&&(this.activeThemeID&&this.themes[this.activeThemeID].removeClass("n2_add_layer_library__theme--active"),this.activeThemeID=t,this.themes[t]===e?N2Classes.AjaxHelper.ajax({type:"GET",url:this.sectionLibraryUrl+"/theme/"+t,dataType:"json"}).done(function(t,e){this.onThemeLoaded(e.theme)}.bind(this,t)):this.themes[t].addClass("n2_add_layer_library__theme--active"))},t.prototype.onThemeLoaded=function(t){if(function(t,e){t=t.split("."),e=e.split(".");for(var i=Math.min(t.length,e.length),s=0;s<i;++s){if(t[s]=parseInt(t[s],10),e[s]=parseInt(e[s],10),t[s]>e[s])return 1;if(t[s]<e[s])return}return t.length===e.length||t.length>=e.length}(N2SS3VERSION,t.version)){var e=h('<div class="n2_add_layer_library__theme n2_add_layer_library__theme--active"></div>').appendTo(this.valuesDict.library.$tab);this.themes[t.id]=e;for(var i=0;i<t.categories.length;i++){var s=t.categories[i],n=h('<div class="n2_add_layer_library_tag"></div>').appendTo(e),o=h('<div class="n2_add_layer_library_tag__title"></div>').on("click",function(t){t.toggleClass("n2_add_layer_library_tag--active")}.bind(this,n)).appendTo(n);h('<div class="n2_add_layer_library_tag__title_label"></div>').text(s.label).appendTo(o),h('<div class="n2_add_layer_library_tag__title_opener"><i class="ssi_16 ssi_16--buttonarrow"></i></div>').appendTo(o);for(var r=h('<div class="n2_add_layer_library_tag__sections"></div>').appendTo(n),a=0;a<s.sections.length;a++){var l=s.sections[a],d=h('<div class="n2_add_layer_library_tag__section"><img src="'+l.thumbnail+'" alt=""/></div>').appendTo(r);l.isPro&&d.append('<div class="n2_add_layer_library_tag__section_pro">Pro</div>'),!l.isPro||l.isPro&&!this.sectionLibraryFree?d.addClass("n2_add_layer_library_tag__section--available").on("click",this.insertSection.bind(this,l.data)):d.append('<div class="n2_add_layer_library_tag__section_overlay"><div>'+n2_sprintf(n2_("This block is not available in the free version. %s"),'<a href="'+this.sectionLibraryGoProUrl+'" target="_blank">'+n2_("Go Pro")+"!</a>")+"</div></div>")}}}else this.activeThemeID=!1,N2Classes.Notification.error(n2_sprintf(n2_("%s or newer required for this feature."),"Smart Slider "+t.version))},t.prototype.insertSection=function(t){this.fragmentEditor.manipulator.sectionReplace(this.fragmentEditor.mainContainer,t)},t}),N2D("LayerFeatures",function(t,e){"use strict";var i={left:0,center:1,right:2,top:0,middle:1,bottom:2};function s(t,e){this.fields=t,this.fragmentEditor=e,this.layerDefault={align:null,valign:null}}return s.prototype.horizontalAlign=function(t,e){this.fields.align.val()!=t?this.fields.align.data("field").options.eq(i[t]).trigger("click"):e&&this.fields.left.val(0).trigger("change"),nextend.activeLayer.layer.trigger("interaction")},s.prototype.verticalAlign=function(t,e){this.fields.valign.val()!=t?this.fields.valign.data("field").options.eq(i[t]).trigger("click"):e&&this.fields.top.val(0).trigger("change"),nextend.activeLayer.layer.trigger("interaction")},s}),N2D("LayerNavigation",function(i,e){"use strict";function t(t){this.fragmentEditor=t,this.forceOpened=[],this.scrollBarHeight=0,this.visible=!1,this.tlHeight=parseInt(localStorage.getItem("ssLayersHeight")||200),this.$editorContent=i(".n2_admin_editor__content"),this.$editorOverlay=i(".n2_admin_editor_overlay"),this.$layerNavigation=this.$container=i('<div class="n2_layer_navigation" dir="ltr"></div>').appendTo(this.$editorOverlay),this.$scrollPanes=i('<div class="n2_layer_navigation_list"></div>').appendTo(this.$layerNavigation),this.$layerListContainer=i('<div class="n2_layer_navigation_list_layers"></div>').appendTo(this.$scrollPanes),this.fixScroll(),this.topBar=i(".n2_layer_navigation_list_title"),i(".n2_layer_navigation_list_title__label").on("mousedown",this.resizeStart.bind(this)),this.interaction=new N2Classes.LayerNavigationInteraction(this,this.fragmentEditor,this.$layerNavigation)}return t.prototype.onAttach=function(t){this.attachedToLayerWindow=t,this.scrollToActiveLayer()},t.prototype.onDetach=function(){delete this.attachedToLayerWindow,this.scrollToActiveLayer()},t.prototype.addScrollPane=function(t){this.$scrollPanes=this.$scrollPanes.add(t)},t.prototype.setScrollTop=function(t){this.$scrollPanes.each(function(){this.scrollTop=t})},t.prototype.scrollToActiveLayer=function(){this.onActivateLayer(this.fragmentEditor.activeLayer)},t.prototype.onActivateLayer=function(t){if(this.forceOpened.length)for(var e=0;e<this.forceOpened.length;e++)this.forceOpened[e].removeForceOpen();this.forceOpened=[];for(var i=t.group;i;)"row"!==i.type&&"col"!==i.type&&"content"!==i.type||(this.forceOpened.push(i),i.forceOpen()),i=i.group;for(var s=this.$scrollPanes.scrollTop(),n=0,o=t;n+=o.layerRow.get(0).offsetTop,o=o.group;);(n<s||n>s+this.$scrollPanes.height()-66-this.scrollBarHeight)&&this.setScrollTop(n)},t.prototype.fixScroll=function(){0<this.scrollBarHeight&&this.$layerListContainer.css("padding-bottom",this.scrollBarHeight),this.$scrollPanes.on({wheel:this.onWheel.bind(this),scroll:this.onScroll.bind(this)})},t.prototype.onScroll=function(t){t.preventDefault(),this.setScrollTop(i(t.currentTarget).scrollTop())},t.prototype.onWheel=function(t){var e;t.shiftKey||(t.preventDefault(),e=this.$scrollPanes.scrollTop(),0<t.originalEvent.deltaY?e+=33:e-=33,e=33*Math.round(e/33),this.setScrollTop(e))},t.prototype.resizeStart=function(t){t.preventDefault(),this.startY=t.clientY,this.height=this.$layerNavigation.height(),i("body").on({"mousemove.n2-ss-tl-resize":this.resizeMove.bind(this),"mouseup.n2-ss-tl-resize":this.resizeStop.bind(this),"mouseleave.n2-ss-tl-resize":this.resizeStop.bind(this)})},t.prototype.resizeMove=function(t){t.preventDefault(),this.setLayerNavigationHeight(this._calculateDesiredHeight(t))},t.prototype.resizeStop=function(t){t.preventDefault(),i("body").off(".n2-ss-tl-resize");var e=this._calculateDesiredHeight(t);this.setLayerNavigationHeight(e),this.tlHeight=e,localStorage.setItem("ssLayersHeight",e+""),i("#n2-admin").triggerHandler("resize")},t.prototype._calculateDesiredHeight=function(t){var e=this.startY-t.clientY+this.height-24;return this.__calculateDesiredHeight(e)},t.prototype.__calculateDesiredHeight=function(t){var e=Math.max(1,Math.round(Math.min(t,window.innerHeight/2)/33)-1);return this.scrollBarHeight+33*e+48},t.prototype.setLayerNavigationHeight=function(t){t=Math.max(48,t),this.$layerNavigation.height(t),this.$editorContent.css("paddingBottom",t),this.layerNavigationTimeline!==e&&this.layerNavigationTimeline.onResize(),nextend.triggerResize()},t}),N2D("LayerNavigationInteraction",function(s,t){"use strict";function e(t,e,i){this.hoveredComponent=!1,this.layerNavigation=t,this.fragmentEditor=e,this.$container=i.on({click:this.handleMouseClick.bind(this),mouseleave:this.handleMouseLeave.bind(this),contextmenu:this.handleContextMenu.bind(this)}),i[0].addEventListener("mouseover",this.handleMouseOver.bind(this),{passive:!0,capture:!0})}return e.prototype.handleMouseClick=function(t){var e;N2Classes.WindowManager.isActionPrevented("ComponentRowActivate")||(e=this.findRelatedComponent(t.target))&&(e.activate(t),this.detachFromLayerWindow())},e.prototype.detachFromLayerWindow=function(){this.layerNavigation.attachedToLayerWindow&&this.layerNavigation.attachedToLayerWindow.detachLayerList()},e.prototype.handleMouseLeave=function(){this.hoveredComponent&&(this.fragmentEditor.deHighlight(this.hoveredComponent),this.hoveredComponent=!1)},e.prototype.handleMouseOver=function(t){this.hoveredComponent&&this.fragmentEditor.deHighlight(this.hoveredComponent),this.hoveredComponent=this.findRelatedComponent(t.target),this.hoveredComponent&&this.fragmentEditor.highlight(this.hoveredComponent)},e.prototype.handleContextMenu=function(t){var e=this.findRelatedComponent(t.target);e&&(t.preventDefault(),e.onContextMenu(t))},e.prototype.findRelatedComponent=function(t){var e,i=s(t);if(i.hasClass("n2_layer_navigation_list_layer"))e=i;else if(!(e=i.closest(".n2_layer_navigation_list_layer")).length)if(i.hasClass("n2_timeline_layer__animations"))e=i;else if(!(e=i.closest(".n2_timeline_layer__animations")).length)return!1;return e.data("layer")},e}),N2D("LayerWindow",function(a,t){"use strict";function e(t){this.admin=a("#n2-admin"),this.$editorOverlay=a(".n2_admin_editor_overlay"),this.sidebar=a("#n2-ss-layer-window"),this.title=this.sidebar.find(".n2_ss_layer_window__title_inner"),this.$inner=this.sidebar.find(".n2_ss_layer_window__crop"),this.fragmentEditor=t,this.tab=new N2Classes.LayerWindowTab(this),this.initLayerList();var e=this.sidebar.find(".n2_ss_layer_window__title_nav_right");a('<div class="n2_ss_layer_window__title_nav_button"><i class="ssi_16 ssi_16--remove"></i></div>').on("click",function(t){this.hide()}.bind(this)).appendTo(e),new N2Classes.UILayerWindow(this.sidebar),this.initDeviceSwitcherShortcut()}return e.prototype.show=function(t){this.cancelHideRequest(),this.setTitle(t),a("body").addClass("n2_body--layer-window-visible")},e.prototype.requestHide=function(){this.cancelHideRequest(),this.hideRequestID=requestAnimationFrame(this.hide.bind(this))},e.prototype.cancelHideRequest=function(){this.hideRequestID!==t&&(cancelAnimationFrame(this.hideRequestID),delete this.hideRequestID)},e.prototype.hide=function(){delete this.hideRequestID,a("body").removeClass("n2_body--layer-window-visible")},e.prototype.setTitle=function(t){this.title.html(t.getName())},e.prototype.initLayerList=function(){this.isLayerListAttached=!1;var t=this.sidebar.find(".n2_ss_layer_window__title_nav_left");a('<div class="n2_ss_layer_window__title_nav_button n2_ss_layer_window__title_nav_button_layer_list"><i class="ssi_16 ssi_16--layer"></i></div>').attr("data-n2tip",n2_("Layer List")).on("click",this.toggleLayerList.bind(this)).appendTo(t),nextend.tooltip.add(t),this.detachLayerListClickCallback=this.detachLayerListClick.bind(this)},e.prototype.toggleLayerList=function(t){this.isLayerListAttached?this.detachLayerList():this.attachLayerList()},e.prototype.attachLayerList=function(){a("body").addClass("n2_body--attached-layer-list"),this.$editorOverlay.addClass("n2_admin_editor_overlay--attached-layer-list"),this.fragmentEditor.layerNavigation.$container.appendTo(this.$inner),this.fragmentEditor.layerNavigation.onAttach(this),document.addEventListener("click",this.detachLayerListClickCallback,{passive:!0,capture:!0}),this.isLayerListAttached=!0},e.prototype.detachLayerList=function(){this.fragmentEditor.layerNavigation.$container[0].dispatchEvent(new MouseEvent("mouseover",{view:window})),this.$editorOverlay.removeClass("n2_admin_editor_overlay--attached-layer-list"),a("body").removeClass("n2_body--attached-layer-list"),this.fragmentEditor.layerNavigation.$container.insertAfter(this.sidebar),this.fragmentEditor.layerNavigation.onDetach(),document.removeEventListener("click",this.detachLayerListClickCallback,{passive:!0,capture:!0}),this.isLayerListAttached=!1},e.prototype.detachLayerListClick=function(t){a.contains(this.sidebar[0],t.target)||this.sidebar.is(t.target)||a(t.target).closest(".n2_context_menu").length||this.detachLayerList()},e.prototype.initDeviceSwitcherShortcut=function(){var e=a('<div id="n2-ss-devicespecific-settings"></div>'),t=this.fragmentEditor.editor.getAvailableDeviceModes(),i={desktopLandscape:"ssi_16--desktoplandscape",desktopPortrait:"ssi_16--desktopportrait",tabletLandscape:"ssi_16--tabletportraitlarge",tabletPortrait:"ssi_16--tabletportrait",mobileLandscape:"ssi_16--mobileportraitlarge",mobilePortrait:"ssi_16--mobileportrait"};for(var s in t)t[s]&&e.append('<i class="ssi_16 '+i[s]+'" data-device="'+s+'"></i>');var n={mouseenter:function(t){e.appendTo(t.currentTarget)}.bind(this),mouseleave:function(t){e.detach()}.bind(this)},o=this.sidebar.find("[data-devicespecific] label").parent(),r=a('<div class="n2_field__label_modifier ssi_16 ssi_16--minidesktopportrait"></div>').on(n);o.prepend(r),e.find(".ssi_16").on({click:function(t){t.preventDefault();var e=a(t.currentTarget);a('.n2_device_tester_devices__device[data-device="'+e.data("device")+'"]').trigger("click")}.bind(this)})},e}),N2D("LayerWindowTab",function(r,a){"use strict";function t(t){this.layerWindow=t,this.activeTabName="",this.activePanelNames=[],this.$buttons=r(".n2_ss_layer_window__tab_button"),this.$buttonsContainer=this.$buttons.parent(),this.$scrollable=r(".n2_ss_layer_window__tab_container"),this.$tabs=r(".n2_ss_layer_window__tab"),this.valuesDict={};for(var e=0;e<this.$buttons.length;e++){var i=this.$buttons.eq(e),s=i.data("related-tab");this.valuesDict[s]={index:e,$button:i,$tab:this.$tabs.filter('[data-tab="'+s+'"]')},i.on("click",this.displayTab.bind(this,s))}this.panels={};for(var n=this.$tabs.find(".n2_ss_layer_window__tab_panel"),e=0;e<n.length;e++){var o=n.eq(e).data("panel");this.panels[o]===a?this.panels[o]=n.eq(e):this.panels[o]=this.panels[o].add(n[e])}}return t.prototype.displayTab=function(t,e){e&&e.preventDefault(),nextend.basicCSS.deActivate(),this.activeTabName!==t&&this.valuesDict[t]&&this.valuesDict[t].$tab.hasClass("n2_ss_layer_window__tab--allowed")&&(this.$buttons.removeClass("n2_ss_layer_window__tab_button--active"),this.$tabs.removeClass("n2_ss_layer_window__tab--active"),this.valuesDict[t].$button.addClass("n2_ss_layer_window__tab_button--active"),this.valuesDict[t].$tab.addClass("n2_ss_layer_window__tab--active"),this.activeTabName=t,this.$scrollable.scrollTop(0))},t.prototype.setPanel=function(t,e){for(var i=0;i<this.activePanelNames.length;i++)this.panels[this.activePanelNames[i]].removeClass("n2_ss_layer_window__tab_panel--active");for(this.activePanelNames=t,i=0;i<this.activePanelNames.length;i++)this.panels[this.activePanelNames[i]].addClass("n2_ss_layer_window__tab_panel--active");this.setAllowedTabs(e)},t.prototype.setAllowedTabs=function(t){for(var e in this.$buttons.removeClass("n2_ss_layer_window__tab_button--allowed"),this.valuesDict)this.valuesDict[e].$tab.removeClass("n2_ss_layer_window__tab--allowed");for(var i=!1,s=0;s<t.length;s++){var n=t[s];this.valuesDict[n]!==a&&(n===this.activeTabName&&(i=!0),this.valuesDict[n].$button.addClass("n2_ss_layer_window__tab_button--allowed"),this.valuesDict[n].$tab.addClass("n2_ss_layer_window__tab--allowed"))}i||this.valuesDict[t[0]].$button.trigger("click"),this.$buttonsContainer.attr("data-visible-tabs",t.length)},t.prototype.getActiveTabName=function(){return this.activeTabName},t}),N2D("PositionDisplay",function(t,s){"use strict";function e(){this.currentSource="",t(window).ready(this._ready.bind(this))}return e.prototype._ready=function(){this.$body=t("body"),this.$el=t('<div class="n2_tooltip n2_tooltip_position"></div>').appendTo(".n2_admin_editor_overlay,.n2_admin")},e.prototype.show=function(t){""===this.currentSource&&(this.currentSource=t,this.$el.addClass("n2_tooltip--active"),this.$body.addClass("n2_body--tooltip-position-active"))},e.prototype.update=function(t,e,i){this.currentSource===e&&(i!==s&&this.$el.html(i),this.$el.css({left:t.clientX+10,top:t.clientY+10}))},e.prototype.hide=function(t){this.currentSource!==t&&t!==s||(this.$body.removeClass("n2_body--tooltip-position-active"),this.$el.removeClass("n2_tooltip--active"),this.currentSource="")},e.get=function(){var t=new e;return e.get=function(){return t},t},e}),N2D("Ruler",function(a,l){"use strict";function t(t,e){this.editor=t,this.showGuides=1,this.guides=[],this.scale=10,this.$scrollArea=a(".n2_admin_editor__content_inner"),a('<div class="n2_ruler_corner"></div>').on("click",function(){this.editor.fragmentEditor.canvasSettings.toggle("n2-ss-ruler-enabled")}.bind(this)).appendTo(".n2_admin_editor_overlay__middle_center");function s(){return i===l&&(i={top:o.scrollTop,left:o.scrollLeft,behavior:"auto"}),n&&clearTimeout(n),n=setTimeout(function(){i=l},500),i}var i,n,o=this.$scrollArea[0];this.vertical=a('<div class="n2_ruler n2_ruler--vertical"></div>').on("wheel",function(t){t.preventDefault();var e=1;1!==t.originalEvent.deltaMode&&2!==t.originalEvent.deltaMode||(e=40);var i=s();t.originalEvent.deltaY&&(t.originalEvent.shiftKey?i.left+=t.originalEvent.deltaY*e:i.top+=t.originalEvent.deltaY*e),t.originalEvent.deltaX&&(i.left+=t.originalEvent.deltaX*e),i.left=Math.min(Math.max(0,i.left),o.scrollWidth-o.clientWidth),i.top=Math.min(Math.max(0,i.top),o.scrollHeight-o.clientHeight),o.scrollTo(i)}.bind(this)).appendTo(".n2_admin_editor_overlay__middle_center"),this.$verticalInner=a('<div class="n2_ruler__inner"></div>').prependTo(this.vertical),this.horizontal=a('<div class="n2_ruler n2_ruler--horizontal"></div>').on("wheel",function(t){t.preventDefault();var e=1;1!==t.originalEvent.deltaMode&&2!==t.originalEvent.deltaMode||(e=40);var i=s();t.originalEvent.deltaY&&(t.originalEvent.shiftKey?i.left+=t.originalEvent.deltaY*e:i.top+=t.originalEvent.deltaY*e),t.originalEvent.deltaX&&(i.left+=t.originalEvent.deltaX*e),i.left=Math.min(Math.max(0,i.left),o.scrollWidth-o.clientWidth),i.top=Math.min(Math.max(0,i.top),o.scrollHeight-o.clientHeight),o.scrollTo(i)}.bind(this)).appendTo(".n2_admin_editor_overlay__middle_center"),this.$horizontalInner=a('<div class="n2_ruler__inner"></div>').prependTo(this.horizontal),this.verticalMarks=a(),this.horizontalMarks=a(),this.onResize(),a(window).on("resize",this.onResize.bind(this)),this.$scrollArea.on("scroll",this.syncScroll.bind(this)),this.syncScroll(),this.$horizontalInner.on("mousedown",function(t){this.showGuides&&new d(this,this.horizontal,this.$horizontalInner,t)}.bind(this)),this.$verticalInner.on("mousedown",function(t){this.showGuides&&new h(this,this.vertical,this.$verticalInner,t)}.bind(this));try{e=a.extend({vertical:[],horizontal:[]},JSON.parse(N2Classes.Base64.decode(e)));for(var r=0;r<e.horizontal.length;r++){new d(this,this.horizontal,this.$horizontalInner).setPosition(e.horizontal[r])}for(r=0;r<e.vertical.length;r++){new h(this,this.vertical,this.$verticalInner).setPosition(e.vertical[r])}}catch(t){}this.measureToolVertical(),this.measureToolHorizontal()}function e(t,e,i,s){this.ruler=t,this.container=e,this.containerInner=i,this.position=0,this.guide=a('<div class="n2_ruler__guide n2-ruler-user-guide"><div class="n2_ruler__guide_border"></div></div>').appendTo(e),a('<div class="n2_ruler__guide_handle"><i class="ssi_missing ssi_16 ssi_16--remove"></i></div>').on("mousedown",function(t){t.preventDefault(),t.stopPropagation(),this.delete()}.bind(this)).appendTo(this.guide),this.ruler.addGuide(this),s&&this.create(s)}function d(){e.prototype.constructor.apply(this,arguments)}function h(){e.prototype.constructor.apply(this,arguments)}return t.prototype.addGuide=function(t){this.guides.push(t)},t.prototype.removeGuide=function(t){this.guides.splice(this.guides.indexOf(t),1)},t.prototype.clearGuides=function(){for(var t=this.guides.length-1;0<=t;t--)this.guides[t].delete()},t.prototype.syncScroll=function(){this.horizontal[0].scrollLeft=this.$scrollArea[0].scrollLeft,this.vertical[0].scrollTop=this.$scrollArea[0].scrollTop},t.prototype.onResize=function(){for(var t=this.$scrollArea[0].scrollWidth,e=this.$scrollArea[0].scrollHeight,i=Math.round(Math.max(t+100,this.$scrollArea.width()-this.vertical.width()-30)/this.scale),s=this.horizontalMarks.length;s<i;s++){var n=a('<div class="n2_ruler_mark"></div>').appendTo(this.$horizontalInner);s%10==0?n.addClass("n2_ruler_mark--large").append('<div class="n2_ruler_mark__label">'+s/10*100+"</div>"):n.addClass("n2_ruler_mark--small")}for(s=i;s<this.horizontalMarks.length;s++)this.horizontalMarks.eq(s).remove();this.horizontalMarks=this.$horizontalInner.find(".n2_ruler_mark");for(var o=Math.round((e+100)/this.scale),s=this.verticalMarks.length;s<o;s++){n=a('<div class="n2_ruler_mark"></div>').appendTo(this.$verticalInner);s%10==0?n.addClass("n2_ruler_mark--large").append('<div class="n2_ruler_mark__label">'+s/10*100+"</div>"):n.addClass("n2_ruler_mark--small")}for(s=o;s<this.verticalMarks.length;s++)this.verticalMarks.eq(s).remove();this.verticalMarks=this.$verticalInner.find(".n2_ruler_mark")},t.prototype.toArray=function(){for(var t={horizontal:[],vertical:[]},e=0;e<this.guides.length;e++)this.guides[e]instanceof d?t.horizontal.push(this.guides[e].position):this.guides[e]instanceof h&&t.vertical.push(this.guides[e].position);return t},t.prototype.measureToolVertical=function(){var i,s=a('<div class="n2_ruler__guide n2_ruler__guide--measure"><div class="n2_ruler__guide_border"></div></div>').css("display","none").appendTo(this.vertical),t=!1,e=function(){t||(t=!0,s.css("display",""),N2Classes.PositionDisplay.get().show("Guide"))}.bind(this),n=function(){t&&(t=!1,s.css("display","none"),N2Classes.PositionDisplay.get().hide("Guide"))}.bind(this),o=function(t){i=t;var e=Math.max(t.pageY-this.$verticalInner[0].getBoundingClientRect().top,0);s.css("top",e),N2Classes.PositionDisplay.get().update(t,"Guide",e+"px")}.bind(this);this.vertical.on({mouseenter:function(t){this.showGuides&&(e(),this.vertical.on({"mousemove.n2-ruler-measure-tool":o,"scroll.n2-ruler-measure-tool":function(){o(i)}}))}.bind(this),mouseleave:function(){this.vertical.off(".n2-ruler-measure-tool"),n()}.bind(this)})},t.prototype.measureToolHorizontal=function(){var i,s=a('<div class="n2_ruler__guide n2_ruler__guide--measure"><div class="n2_ruler__guide_border"></div></div>').css("display","none").appendTo(this.horizontal),t=!1,e=function(){t||(t=!0,s.css("display",""),N2Classes.PositionDisplay.get().show("Guide"))}.bind(this),n=function(){t&&(t=!1,s.css("display","none"),N2Classes.PositionDisplay.get().hide("Guide"))}.bind(this),o=function(t){i=t;var e=Math.max(t.pageX-this.$horizontalInner[0].getBoundingClientRect().left,0);s.css("left",e),N2Classes.PositionDisplay.get().update(t,"Guide",e+"px")}.bind(this);this.horizontal.on({mouseenter:function(t){this.showGuides&&(e(),this.horizontal.on({"mousemove.n2-ruler-measure-tool":o,"scroll.n2-ruler-measure-tool":function(){o(i)}}))}.bind(this),mouseleave:function(){this.horizontal.off(".n2-ruler-measure-tool"),n()}.bind(this)})},e.prototype._position=function(t,e){return Math.max(0,t)},e.prototype.setPosition=function(t){this.position=t,this.positionRender(this.position)},e.prototype.delete=function(){this.ruler.removeGuide(this),this.guide.remove()},e.prototype.create=function(t){},((d.prototype=Object.create(e.prototype)).constructor=d).prototype.create=function(t){this.position=this._position(t.pageX-this.containerInner[0].getBoundingClientRect().left,t),this.positionRender(this.position)},d.prototype.rawPositionRender=function(t){this.guide.css("left",Math.max(0,t))},d.prototype.positionRender=function(t){this.guide.css("left",Math.max(0,t))},((h.prototype=Object.create(e.prototype)).constructor=h).prototype.create=function(t){this.position=this._position(t.pageY-this.containerInner[0].getBoundingClientRect().top,t),this.positionRender(this.position)},h.prototype.rawPositionRender=function(t){this.guide.css("top",Math.max(0,t))},h.prototype.positionRender=function(t){this.guide.css("top",Math.max(0,t))},t}),N2D("CanvasSettings",function(e,t){"use strict";function i(t){this.$button=e('<a class="n2_button_plain_icon n2_button_plain_icon--medium" href="#"><i class="ssi_24 ssi_24--more"></i></a>').on("click",this.onContextMenu.bind(this)).prependTo(".n2_add_layer__bar_bottom"),nextend.tooltip.addElement(this.$button,n2_("Editor settings"),10,-20),this.fragmentEditor=t,this.settings={},this.callbacks={},this.guideSubItems=[],this.snapTo(),this.roundTo(),this.startRuler()}return i.prototype.onContextMenu=function(t){t.preventDefault(),this.$button.addClass("n2_button_plain_icon--active");var e=[];e.push({priority:10,label:n2_("Upgrade to Pro"),icon:"ssi_16 ssi_16--smart",action:function(t){window.open(t,"_blank")}.bind(this,this.fragmentEditor.editor.options.settingsGoProUrl)}),e.push({priority:30,label:n2_("Guide settings"),icon:"ssi_16 ssi_16--grid",items:this.guideSubItems}),e.push({priority:50,label:n2_("Keyboard shortcuts"),icon:"ssi_16 ssi_16--keyboard",action:function(){N2Classes.ModalHotkey.show()}}),N2Classes.ContextMenu(this.$button[0],e,{verticalAlign:"bottom",x:35,y:-30,onClose:function(){this.$button.removeClass("n2_button_plain_icon--active")}.bind(this)})},i.prototype._addSettings=function(t,e,i,s){this.settings[t]=parseInt(localStorage.getItem(t)||i),this.callbacks[t]=s,this.guideSubItems.push({type:"onoff",label:e,isOn:function(t){return this.settings[t]}.bind(this,t),action:function(t,e){this.set(t,e)}.bind(this,t)}),s(this.settings[t],!0)},i.prototype._addAction=function(t,e,i,s){this.guideSubItems.push({label:e,icon:i,action:s})},i.prototype.set=function(t,e){e=e?1:0,this.settings[t]=e,localStorage.setItem(t,e),this.callbacks[t].call(this,e,!1)},i.prototype.toggle=function(t){this.set(t,!this.settings[t])},i.prototype.get=function(t){return this.settings[t]},i.prototype.snapTo=function(){this._addSettings("n2-ss-snap-to-enabled",n2_("Smart snap"),1,function(t){})},i.prototype.roundTo=function(){this._addSettings("n2-ss-round-to-enabled",n2_("Round to 5px"),1,function(t){nextend.roundTo=1===t?5:1})},i.prototype.startRuler=function(){this.ruler=new N2Classes.Ruler(this.fragmentEditor.editor,e("#slideguides").val()),this._addSettings("n2-ss-ruler-enabled",n2_("Ruler"),1,function(t){e("body").toggleClass("n2_body--ruler",1===t)}.bind(this)),this._addAction("n2-ss-clear-guides",n2_("Clear guides"),"ssi_16 ssi_16--delete",function(){this.ruler.clearGuides()}.bind(this))},i}),N2D("UICanvasItem",["UIMouse"],function(i,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UICanvasItem",this.widgetEventPrefix="canvasItem",this.options=i.extend({canvasUIManager:null,layer:!1,$layer:null,distance:5},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){"function"==typeof this.options.$layer&&(this.options.$layer=this.options.$layer.call(this,this)),this._mouseInit()},e.prototype._mouseCapture=function(t,e){return this.options.canvasUIManager._mouseCapture(t,e)},e.prototype._mouseStart=function(t,e,i){var s=this.options.canvasUIManager._mouseStart(t,this.options.$layer,this.options.layer);return this._trigger("start"),s},e.prototype._mouseDrag=function(t){return this.options.canvasUIManager._mouseDrag(t)},e.prototype._mouseStop=function(t,e){this._trigger("end");var i=this.options.canvasUIManager._mouseStop(t,e);return N2Classes.WindowManager.actionPrevent("ComponentActivate"),i},e.prototype.destroy=function(){return this._mouseDestroy(),this},e}),N2D("UICanvas",["UIWidgetBase"],function(a,r){"use strict";function t(t,e){this.element=t,this.fragmentEditor=e,this.widgetName=this.widgetName||"UICanvas",a(this.element).data("UICanvas",this),this.widgetEventPrefix="canvas",this._scrollCallback=this._scroll.bind(this),N2Classes.UIWidgetBase.prototype.constructor.apply(this,arguments)}function s(t,e,i,s,n){this.uiCanvas=t,this.fragmentEditor=t.fragmentEditor,this.onKeyDownCallback=this.onKeyDown.bind(this),this.fragmentEditor.pointerManager.disable(),this.context={action:"move",placement:"default",placeholder:a('<div class="n2-ss-layer-placeholder"></div>'),scroll:this.uiCanvas.getScrollOffset(),scrollOffsetModifier:{left:0,top:0},mouse:{offset:{left:e.pageX,top:e.pageY}},$layer:i,layer:s};var o={position:"absolute",right:"auto",bottom:"auto"};if(s?("absolute"===s.placement.getType()?(this.context.placement="absolute",this.context.relativeToGroup=s.group,this.context.$relativeToParent=i.parent()):(this.context.relativeToGroup=n,this.context.$relativeToParent=this.context.relativeToGroup.layer),i.addClass("n2_layer_drag__dragging"),this.context.layerOffset=i.offset(),this.context.originalIndex=s.getIndex(),"default"===this.context.placement&&(o.width=i.width()+1,this.context.$clone=a('<div class="n2-ss-layer-clone"></div>').height(i.outerHeight(!0)).insertAfter(i),i.appendTo(n.layer))):(this.context.action="create",this.context.placement=e.ctrlKey||e.metaKey?"absolute":this.fragmentEditor.addLayer.getPosition(),this.context.relativeToGroup=n,this.context.$relativeToParent=this.context.relativeToGroup.layer,this.context.layerOffset={left:0,top:0},i.appendTo("body")),this.context.canvas={offset:this.context.$relativeToParent.offset(),size:{width:this.context.$relativeToParent.outerWidth(),height:this.context.$relativeToParent.outerHeight()}},i.addClass("n2-ss-layer--drag").css(o),this.margins={left:parseInt(i.css("marginLeft"),10)||0,top:parseInt(i.css("marginTop"),10)||0},this.context.size={width:i.outerWidth(),height:i.outerHeight()},this.context.droppables=n.getDroppables(this.context.placement,s),"default"===this.context.placement)for(var r=0;r<this.context.droppables.length;r++)this.context.droppables[r].layer.layer.addClass("n2_layer_drag_target_groups");this._cacheContainers(),this.snapStart(),document.addEventListener("keydown",this.onKeyDownCallback,{capture:!0})}((t.prototype=Object.create(N2Classes.UIWidgetBase.prototype)).constructor=t).prototype.getScrollOffset=function(){return this.getScrollOffsetRecursive(this.element[0],{top:0,left:0})},t.prototype.getScrollOffsetRecursive=function(t,e){return null===t||t.scrollTop===r||t.scrollLeft===r?e:(e.top+=t.scrollTop,e.left+=t.scrollLeft,this.getScrollOffsetRecursive(t.parentNode,e))},t.prototype._scroll=function(){var t=this.getScrollOffset();this.interaction.setScrollOffset(t.top,t.left)},t.prototype._mouseCapture=function(t){return 0===a(t.target).closest(".nui_resize_absolute__handle, .nui_resize_normal__handle, .nui_spacing__handle").length},t.prototype._mouseStart=function(t,e,i){document.addEventListener("scroll",this._scrollCallback,{passive:!0,capture:!0}),a("body").addClass("n2_body--drag-layer"),this.interaction=new s(this,t,e,i,this.fragmentEditor.mainContainer),this.interaction.drag(t)},t.prototype._mouseDrag=function(t){this.interaction&&this.interaction.drag(t)},t.prototype._mouseStop=function(t){document.removeEventListener("scroll",this._scrollCallback,{passive:!0,capture:!0}),this.interaction&&this.interaction.stop(t),a("body").removeClass("n2_body--drag-layer"),delete this.interaction},t.prototype.cancel=function(){delete this.interaction},s.prototype.drag=function(t){var e,i={x:(this.lastEvent=t).pageX-this.context.scrollOffsetModifier.left,y:t.pageY-this.context.scrollOffsetModifier.top},s="create"===this.context.action?{top:t.pageY-this.context.canvas.offset.top-20,left:t.pageX-this.context.canvas.offset.left-20}:{top:this.context.layerOffset.top-this.context.canvas.offset.top+t.pageY-this.context.mouse.offset.top-this.context.scrollOffsetModifier.top-this.margins.top,left:this.context.layerOffset.left-this.context.canvas.offset.left+t.pageX-this.context.mouse.offset.left-this.context.scrollOffsetModifier.left-this.margins.left},n=this._findInnerContainer(i.x,i.y);!1===n&&"move"===this.context.action&&(n=this.context.droppables[0]),n&&"normal"===n.placement?(n.layers===r&&(n.layers=this._cacheContainerLayers(n)),0<(e=this._findNormalIndex(i,n))?(this.context.placeholder.css("order",n.layers[e-1].layer.layer.css("order")),this.context.placeholder.insertAfter(n.layers[e-1].layer.layer)):(this.context.placeholder.css("order",0),this.context.placeholder.prependTo(n.$container)),this.context.targetIndex=e):this.context.placeholder.detach(),this.context.targetContainer&&this.context.targetContainer!==n&&this.context.targetContainer.layer.layer.removeClass("n2_layer_drag_target_group"),(this.context.targetContainer=n)&&n.layer.layer.addClass("n2_layer_drag_target_group"),this.context.layer&&"absolute"===this.context.placement&&this.context.layer.placement.current.triggerLayerResized(),"create"===this.context.action&&(s.left+=this.context.canvas.offset.left,s.top+=this.context.canvas.offset.top),this.snapDrag(t,{left:s.left+this.context.canvas.offset.left,top:s.top+this.context.canvas.offset.top},s),s.left=Math.round(s.left),s.top=Math.round(s.top),this.context.$layer.css(s),this.displayPosition(t,s)},s.prototype.stop=function(t){var e=a.Deferred();this.ended(e);var i=this.context.targetIndex,s=this.context.targetContainer;if("create"===this.context.action)s?this.fragmentEditor.itemEditor.createWithDrag(t,e,this.context.placement,this.context.$layer,s,i):e.resolve(),this.context.$layer.detach();else if("move"===this.context.action){if(s===r&&(s=this.fragmentEditor.mainContainer.layer),"absolute"===this.context.placement){var n=parseInt(this.context.$layer.css("left")),o=parseInt(this.context.$layer.css("top"));this.context.$layer.css({position:"",right:"",bottom:""}),this.context.layer.placement.current.setPosition(n,o)}else if("default"===this.context.placement)switch(this.context.$layer.css({position:"relative",width:"",left:"",top:""}),s.layer.type){case"content":case"col":0<i?this.context.$layer.insertAfter(s.layers[i-1].layer.layer):this.context.$layer.prependTo(s.$container),this.context.layer.onCanvasUpdate(this.context.originalIndex,s.layer,i)}e.resolve()}this.context.layer&&this.context.layer.placement.current.triggerLayerResized()},s.prototype.ended=function(t){if(document.removeEventListener("keydown",this.onKeyDownCallback,{capture:!0}),this.context.placeholder.remove(),"default"===this.context.placement){for(var e=0;e<this.context.droppables.length;e++)this.context.droppables[e].layer.layer.removeClass("n2_layer_drag_target_groups");"move"===this.context.action&&this.context.$clone.remove()}this.context.targetContainer&&this.context.targetContainer.layer.layer.removeClass("n2_layer_drag_target_group"),this.context.$layer.removeClass("n2-ss-layer--drag"),this.context.$layer.removeClass("n2_layer_drag__dragging"),this.snapStop(),this.hidePosition(),t!==r?t.done(function(){this.fragmentEditor.pointerManager.enable()}.bind(this)):(this.fragmentEditor.pointerManager.enable(),this.uiCanvas.cancel())},s.prototype.refresh=function(){this.drag(this.lastEvent)},s.prototype.setScrollOffset=function(t,e){this.context.scrollOffsetModifier.top=this.context.scroll.top-t,this.context.scrollOffsetModifier.left=this.context.scroll.left-e,this.refresh()},s.prototype.displayPosition=function(t,e){this.context.targetContainer&&"absolute"===this.context.targetContainer.placement?(N2Classes.PositionDisplay.get().show("Canvas"),"create"===this.context.action&&(e.left-=this.context.canvas.offset.left,e.top-=this.context.canvas.offset.top),N2Classes.PositionDisplay.get().update(t,"Canvas","L: "+(parseInt(e.left)||0)+"px<br />T: "+(parseInt(e.top)||0)+"px")):this.hidePosition()},s.prototype.hidePosition=function(){N2Classes.PositionDisplay.get().hide("Canvas")},s.prototype._cacheContainers=function(){for(var t=0;t<this.context.droppables.length;t++){var e=this.context.droppables[t];e.offset=e.$container.offset(),e.size={width:e.$container.outerWidth(),height:e.$container.outerHeight()},e.offset.right=e.offset.left+e.size.width,e.offset.bottom=e.offset.top+e.size.height}},s.prototype._findInnerContainer=function(t,e){for(var i=this.context.droppables.length-1;0<=i;i--){var s=this.context.droppables[i];if(s.offset.left<=t&&s.offset.right>=t&&s.offset.top<=e&&s.offset.bottom>=e)return s}return!1},s.prototype._cacheContainerLayers=function(t){for(var e=[],i=t.layer.container.getSortedLayers(),s=0;s<i.length;s++){var n={layer:i[s]};n.offset=n.layer.layer.offset(),n.size={width:n.layer.layer.outerWidth(),height:n.layer.layer.outerHeight()},n.offset.right=n.offset.left+n.size.width/2,n.offset.bottom=n.offset.top+n.size.height/2,e.push(n)}return e},s.prototype._findNormalIndex=function(t,e){var i=-1;switch(e.axis){case"y":for(var s=0;s<e.layers.length;s++){var n=e.layers[s];if(t.y<=n.offset.bottom){i=s;break}}break;case"x":for(s=0;s<e.layers.length;s++){n=e.layers[s];if(t.x<=n.offset.right){i=s;break}}}return-1===i&&(i=e.layers.length),i},s.prototype.onKeyDown=function(t){27===t.keyCode&&(t.stopImmediatePropagation(),t.preventDefault(),"move"===this.context.action&&("absolute"===this.context.placement?this.context.layer.placement.updatePosition():"default"===this.context.placement&&this.context.$layer.css({position:"relative",width:"",left:"",top:""}).insertAfter(this.context.$clone)),this.ended())},s.prototype.snapStart=function(){var t,e,i;"move"===this.context.action&&"absolute"===this.context.placement&&(this.$gridHorizontal=a('<div class="n2_smartguide n2_smartguide--vertical"></div>').appendTo(this.context.$relativeToParent),this.$gridVertical=a('<div class="n2_smartguide n2_smartguide--horizontal"></div>').appendTo(this.context.$relativeToParent),this.elements=[],this.$snapLayers=a(),(t=this.fragmentEditor.getSnap(this.context.relativeToGroup,this.context.layer))&&t.length&&t.each(function(t,e){var i=a(e),s=i.offset();this.elements.push({item:e,width:i.outerWidth(),height:i.outerHeight(),top:Math.round(s.top),left:Math.round(s.left),backgroundColor:""}),i.hasClass("n2-ss-layer")&&(this.$snapLayers=this.$snapLayers.add(i))}.bind(this)),this.$snapLayers.addClass("n2_layer_drag_snap_to"),e=this.context.$relativeToParent.offset(),i=this.context.$relativeToParent[0].getBoundingClientRect(),this.elements.push({width:i.width,height:i.height,top:Math.round(e.top),left:Math.round(e.left),backgroundColor:"#ff4aff"}))};return s.prototype.snapDrag=function(t,e,i){if("move"===this.context.action&&"absolute"===this.context.placement){var s=!1,n=!1,o=5,r=5;if(this.$gridVertical.css({display:"none"}),this.$gridHorizontal.css({display:"none"}),this.context.targetContainer&&"absolute"===this.context.targetContainer.placement){var a=t.ctrlKey||t.metaKey,l=t.altKey;if(a&&l)return;a?s=!0:l&&(n=!0);var d=e.left,h=d+this.context.size.width,c=e.top,p=c+this.context.size.height,u=(d+h)/2,f=(c+p)/2;if(!s)for(var g=this.elements.length-1;0<=g&&0!==o;g--){var y=this.elements[g].left,m=y+this.elements[g].width,v=(y+m)/2,_=!0;(b=Math.abs(y-h))<o?(i.left=y-this.context.size.width-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left+this.context.size.width)):(b=Math.abs(y-d))<o?(i.left=y-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left)):(b=Math.abs(m-d))<o?(i.left=m-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left)):(b=Math.abs(m-h))<o?(i.left=m-this.context.size.width-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left+this.context.size.width)):(b=Math.abs(v-h))<o?(i.left=v-this.context.size.width-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left+this.context.size.width)):(b=Math.abs(v-d))<o?(i.left=v-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left)):(b=Math.abs(v-u))<o?(i.left=v-this.context.size.width/2-this.context.canvas.offset.left,this.setSnapHorizontalLine(i.left+this.context.size.width/2)):_=!1,_&&(s=this.elements[g],o=Math.min(b,o))}if(!n)for(g=this.elements.length-1;0<=g&&0!==r;g--){var b,C=this.elements[g].top,w=C+this.elements[g].height,x=(C+w)/2,S=!0;(b=Math.abs(C-p))<r?(i.top=C-this.context.size.height-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top+this.context.size.height)):(b=Math.abs(C-c))<r?(i.top=C-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top)):(b=Math.abs(w-c))<r?(i.top=w-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top)):(b=Math.abs(w-p))<r?(i.top=w-this.context.size.height-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top+this.context.size.height)):(b=Math.abs(x-p))<r?(i.top=x-this.context.size.height-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top+this.context.size.height)):(b=Math.abs(x-c))<r?(i.top=x-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top)):(b=Math.abs(x-f))<r?(i.top=x-this.context.size.height/2-this.context.canvas.offset.top,this.setSnapVerticalLine(i.top+this.context.size.height/2)):S=!1,S&&(n=this.elements[g],r=Math.min(b,r))}s&&!0!==s&&this.$gridHorizontal.css("backgroundColor",s.backgroundColor),n&&!0!==n&&this.$gridVertical.css("backgroundColor",n.backgroundColor)}}},s.prototype.setSnapHorizontalLine=function(t){this.$gridHorizontal.css({left:t,display:"block"})},s.prototype.setSnapVerticalLine=function(t){this.$gridVertical.css({top:t,display:"block"})},s.prototype.snapStop=function(){"move"===this.context.action&&"absolute"===this.context.placement&&(this.$snapLayers.removeClass("n2_layer_drag_snap_to"),this.$gridVertical.remove(),this.$gridHorizontal.remove())},t}),N2D("UIColumns",["UIMouse"],function(o,e){"use strict";function t(t,e,i){this.element=t,this.fragmentEditor=e,this.active=0,this.created=!1,this.invalidated=!1,this.isHandlesVisible=!1,this.widgetName=this.widgetName||"UIColumns",this.widgetEventPrefix="columns",this.options=o.extend({columns:"1",gutter:0,denominators:{1:100,2:100,3:144,4:100,5:100,6:144},drag:null,start:null,stop:null},this.options,i),N2Classes.UIMouse.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=t).prototype.showHandles=function(){this.isHandlesVisible=!0,this.handles&&this.handles.addClass("ui-column-width-handle--visible")},t.prototype.hideHandles=function(){this.isHandlesVisible=!1,this.handles&&this.handles.removeClass("ui-column-width-handle--visible")},t.prototype.create=function(){this.created||(this.created=!0,this._setupHandles(),o(window).on("resize",this._resize.bind(this)),this._mouseInit())},t.prototype.destroy=function(){return this._mouseDestroy(),this.element.removeData("uiNextendColumns").off(".columns").find("> .ui-column-width-handle").remove(),this},t.prototype.getDenominator=function(t){return this.options.denominators[t]===e&&(this.options.denominators[t]=15*t),this.options.denominators[t]},t.prototype._setupHandles=function(){var t,e=this.options;this.fractions=[];for(var i=e.columns.split("+"),s=0;s<i.length;s++)this.fractions.push(new Fraction(i[s]));this.currentDenominator=this.getDenominator(this.fractions.length);var n=0;for(s=0;s<this.fractions.length-1;s++)t=o("<div class='ui-column-width-handle'>"),n+=100*this.fractions[s].valueOf(),t.data("i",s).data("percent",n).appendTo(this.element).on("mousedown",this._mouseDown.bind(this));this.handles=this.element.find("> .ui-column-width-handle"),this.handles.toggleClass("ui-column-width-handle--visible",this.isHandlesVisible),this._resize()},t.prototype._resize=function(){if(this.active){this.paddingLeft=parseInt(this.element.css("paddingLeft")),this.paddingRight=parseInt(this.element.css("paddingRight"));var t=this.element.width();this.outerWidth=t+this.paddingLeft+this.paddingRight,this.innerWidth=t-this.handles.length*this.options.gutter;for(var e=0;e<this.handles.length;e++){var i=this.handles.eq(e).data("percent");this._updateResizer(e,i)}}else this.invalidated=!0},t.prototype._updateResizer=function(t,e){this.handles.eq(t).css({left:e+"%",marginLeft:-2+this.paddingLeft+(t+.5)*this.options.gutter+(this.innerWidth-this.outerWidth)*e/100})},t.prototype._removeHandles=function(){this.handles.remove()},t.prototype.setOption=function(t,e){switch(N2Classes.UIWidgetBase.prototype.setOption.apply(this,arguments),t){case"active":this.active=e,this.active&&(this.create(),this.invalidated&&this._resize());break;case"columns":this.created&&(this._removeHandles(),this._setupHandles());break;case"gutter":this._resize()}},t.prototype._mouseCapture=function(t){for(var e=!1,i=0;i<this.handles.length;i++)this.handles[i]===t.target&&(e=!0);return!this.options.disabled&&e},t.prototype._mouseStart=function(t){this.fragmentEditor.pointerManager.contextualBarHover.disable();var e=o(t.target).data("i"),i=this.element.offset().left+10,s=this.element.width()-20;this.resizeContext={index:e,cLeft:i,containerWidth:s,startX:Math.max(0,Math.min(t.clientX-i,s))},this.currentFractions=[],this.currentPercent=[];for(var n=0;n<this.fractions.length;n++)this.currentFractions.push(this.fractions[n].clone()),this.currentPercent.push(this.fractions[n].valueOf());return this.resizing=!0,o("body").css("cursor","ew-resize"),this.element.addClass("ui-column-width-resizing"),this._trigger("start",t,this.ui()),!0},t.prototype._mouseDrag=function(t){var e=Math.max(0,Math.min(t.clientX-this.resizeContext.cLeft,this.resizeContext.containerWidth)),i=new Fraction(Math.round((e-this.resizeContext.startX)/(this.resizeContext.containerWidth/this.currentDenominator)),this.currentDenominator);i.compare(this.fractions[this.resizeContext.index].clone().mul(-1))<0&&(i=this.fractions[this.resizeContext.index].clone().mul(-1)),0<i.compare(this.fractions[this.resizeContext.index+1])&&(i=this.fractions[this.resizeContext.index+1].clone()),this.currentFractions[this.resizeContext.index]=this.fractions[this.resizeContext.index].add(i),this.currentFractions[this.resizeContext.index+1]=this.fractions[this.resizeContext.index+1].sub(i);var s=0;this.currentPercent=[];for(var n=0;n<this.currentFractions.length;n++){var o=this.currentFractions[n].valueOf();this.currentPercent.push(o),s+=100*o,this._updateResizer(n,s)}this._trigger("colwidth",t,this.ui()),this._triggerInteraction()},t.prototype._mouseStop=function(t){return this.resizing=!1,o("body").css("cursor","auto"),this._trigger("stop",t,this.ui()),this.fractions=this.currentFractions,this._triggerInteraction(),this.fragmentEditor.pointerManager.contextualBarHover.enable(),N2Classes.WindowManager.actionPrevent("ComponentActivate"),!1},t.prototype.ui=function(){return{element:this.element,originalFractions:this.fractions,currentFractions:this.currentFractions,currentPercent:this.currentPercent,index:this.resizeContext.index}},t}),N2D("UILayerListItem",["UIMouse"],function(i,t){"use strict";function e(t,e){this.element=t,this.widgetName=this.widgetName||"UILayerListItem",this.widgetEventPrefix="layerListItem",this.options=i.extend({UIManager:null,layer:!1,$layer:null,distance:2},this.options,e),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){this._mouseInit()},e.prototype._mouseCapture=function(t,e){return this.options.UIManager._mouseCapture(this.options,t,e)},e.prototype._mouseStart=function(t,e,i){return this._trigger("start"),this.options.UIManager._mouseStart(this.options,t,e,i)},e.prototype._mouseDrag=function(t){return this.options.UIManager._mouseDrag(this.options,t)},e.prototype._mouseStop=function(t,e){return this.options.UIManager._mouseStop(this.options,t,e)},e.prototype.destroy=function(){return this._mouseDestroy(),this},e}),N2D("UILayerList",["UIWidgetBase"],function(n,o){"use strict";function t(t,e){this.element=t,this.widgetName=this.widgetName||"UILayerList",this.widgetEventPrefix="layerList",this.options=n.extend({mainContainer:null,$scrolled:null},this.options,e),this.interaction=!1,this.onKeyDownCallback=this.onKeyDown.bind(this),N2Classes.UIWidgetBase.prototype.constructor.apply(this,arguments),this.create()}return((t.prototype=Object.create(N2Classes.UIWidgetBase.prototype)).constructor=t).prototype.create=function(){this.scrollTimeout=null},t.prototype._mouseCapture=function(t,e,i){return t.$item[0]!==this.options.mainContainer.layerRow[0]},t.prototype._mouseStart=function(t,e,i,s){this.interaction=!0,this.scrolledTop=this.options.$scrolled.offset().top,this.scrolledHeight=this.options.$scrolled.height(),this.scrolledScroll=this.options.$scrolled.scrollTop(),this.scrolledMaxHeight=this.options.$scrolled[0].scrollHeight-this.scrolledHeight,this.context={placeholder:n('<div class="n2_layer_navigation_list_layers__sortable_placeholder"></div>'),mouse:{y:e.pageY,topModifier:t.$item.offset().top-e.pageY},$item:t.$item,$clone:t.$item.clone()},this.context.$clone.addClass("n2_layer_navigation_list_layer--sorted").appendTo(this.options.$scrolled),this.context.droppables=this.options.mainContainer.getLLDroppables(t.layer),this._cacheContainers(),document.addEventListener("keydown",this.onKeyDownCallback,{capture:!0}),this._trigger("start",e),this._mouseDrag(t,e)},t.prototype._scrollUp=function(){0<this.scrolledTop&&null===this.scrollTimeout&&(this.scrollTimeout=setInterval(function(){this.scrolledScroll-=33,this.options.$scrolled.scrollTop(this.scrolledScroll)}.bind(this),150),this.scrolledScroll-=33,this.options.$scrolled.scrollTop(this.scrolledScroll))},t.prototype._scrollDown=function(){null===this.scrollTimeout&&(this.scrollTimeout=setInterval(function(){this.scrolledScroll+=33,this.options.$scrolled.scrollTop(Math.min(this.scrolledScroll,this.scrolledMaxHeight))}.bind(this),150),this.scrolledScroll+=33,this.options.$scrolled.scrollTop(Math.min(this.scrolledScroll,this.scrolledMaxHeight)))},t.prototype._mouseDrag=function(t,e){var i,s,n;this.interaction&&(this.scrolledTop=this.options.$scrolled.offset().top,140<this.scrolledHeight&&(e.pageY<this.scrolledTop+33+48?this._scrollUp():e.pageY>this.scrolledTop+this.scrolledHeight-33?this._scrollDown():(clearInterval(this.scrollTimeout),this.scrollTimeout=null)),this.scrolledScroll=this.options.$scrolled.scrollTop(),i=e.pageY-this.scrolledTop+this.scrolledScroll,!1===(s=this._findInnerContainer(i))&&(s=this.context.droppables[0]),s.layers===o&&(s.layers=this._cacheContainerLayers(s)),0<(n=this._findNormalIndex(i,s))?this.context.placeholder.insertAfter(s.layers[n-1].layer.layerRow):this.context.placeholder.prependTo(s.$container),this.context.targetIndex=n,this.context.targetContainer&&this.context.targetContainer!==s&&this.context.targetContainer.layer.layerRow.removeClass("n2_layer_navigation_list_layer--drop"),this.context.targetContainer=s,this.context.targetContainer.layer.layerRow.addClass("n2_layer_navigation_list_layer--drop"),this.context.$clone.css({top:i+this.context.mouse.topModifier}))},t.prototype._mouseStop=function(t,e,i){var s,n,o,r,a,l;this.interaction&&(this.ended(!0),s=this.context.targetIndex,n=this.context.targetContainer,o=-1,0===this.context.targetContainer.layers.length?o=0:(a=r=!1,this.context.targetContainer.layers[s]&&(r=this.context.targetContainer.layers[s].layer),this.context.targetContainer.layers[s-1]&&(a=this.context.targetContainer.layers[s-1].layer),r===t.layer||a===t.layer?o=-1:"slide"===n.layer.type?r?o=r.getIndex()+1:a&&(o=a.getIndex()):a?o=a.getIndex()+1:r&&(o=r.getIndex())),0<=o&&(l=t.layer.getIndex(),n.layer===t.layer.group&&l<o&&o--,"col"===t.layer.type?n.layer.moveCol(l,o):(n.layer.container.insertLayerAt(t.layer,o),t.layer.onCanvasUpdate(l,n.layer,o))),delete this.context,this._trigger("stop",e)),N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.interaction=!1},t.prototype.cancel=function(){this.interaction=!1,delete this.context},t.prototype.ended=function(t){document.removeEventListener("keydown",this.onKeyDownCallback,{capture:!0}),null!==this.scrollTimeout&&(clearInterval(this.scrollTimeout),this.scrollTimeout=null),this.context.placeholder.remove(),this.context.$clone.remove(),this.context.targetContainer.layer.layerRow.removeClass("n2_layer_navigation_list_layer--drop"),t||this.cancel()},t.prototype.onKeyDown=function(t){27===t.keyCode&&(t.stopImmediatePropagation(),t.preventDefault(),this.ended())},t.prototype._cacheContainers=function(){for(var t=0;t<this.context.droppables.length;t++){var e=this.context.droppables[t];e.top=e.$container.offset().top-this.scrolledTop+this.scrolledScroll-15,e.height=e.$container.outerHeight(),e.bottom=e.top+e.height+15}},t.prototype._findInnerContainer=function(t){for(var e=this.context.droppables.length-1;0<=e;e--){var i=this.context.droppables[e];if(i.top<=t&&i.bottom>=t)return i}return!1},t.prototype._cacheContainerLayers=function(t){for(var e=[],i=t.layer.container.getSortedLayers(),s=0;s<i.length;s++){var n={layer:i[s]};n.top=n.layer.layerRow.offset().top-this.scrolledTop+this.scrolledScroll,n.height=n.layer.layerRow.outerHeight(),n.bottom=n.top+n.height/2,n.index=s,e.push(n)}return"slide"===t.layer.type&&e.reverse(),e},t.prototype._findNormalIndex=function(t,e){for(var i=0;i<e.layers.length;i++){if(t<=e.layers[i].bottom)return i}return e.layers.length},t}),N2D("UIDragTooltip",function(t,e){"use strict";function i(t){this.name=t,this.isShown=!1,this.isShownForHover=!1,this.isShownForDrag=!1,this.e=null,this.hoverTipCallback=null,this.tip=N2Classes.PositionDisplay.get()}return i.prototype.hoverShow=function(t,e){this.e=t,this.hoverTipCallback=e,this.isShownForHover=!0,this.show()},i.prototype.hoverUpdatePosition=function(t){this.isShownForHover&&!this.isShownForDrag&&(this.e=t,this.tip.update(this.e,this.name))},i.prototype.hoverHide=function(){this.isShownForHover=!1,this.hide()},i.prototype.dragShow=function(){this.isShownForDrag=!0,this.show()},i.prototype.dragUpdate=function(t,e){this.e=t,this.tip.update(t,this.name,e)},i.prototype.dragHide=function(){this.isShownForDrag=!1,this.hide(),this.isShownForHover&&this.tip.update(this.e,this.name,this.hoverTipCallback.call())},i.prototype.show=function(){this.isShown||(this.tip.show(this.name),this.isShownForDrag||this.tip.update(this.e,this.name,this.hoverTipCallback.call()),this.isShown=!0)},i.prototype.hide=function(){!this.isShown||this.isShownForHover||this.isShownForDrag||(this.tip.hide(this.name),this.isShown=!1)},i}),N2D("UIResizeAbsolute",["UIMouse"],function(x,t){"use strict";function e(t,e,i){this.element=t,this.fragmentEditor=e,this.widgetName=this.widgetName||"UIResizeAbsolute",x(this.element).data("UIResizeAbsolute",this),this.widgetEventPrefix="resize",this.options=x.extend({alsoResize:!1,containment:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,resize:null,start:null,stop:null},this.options,i),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).plugins={},e.prototype._num=function(t){return parseFloat(t)||0},e.prototype._isNumber=function(t){return!isNaN(parseFloat(t))},e.prototype.create=function(){this.element.addClass("nui_resize_absolute"),this._setupHandles(),this._mouseInit(),this._trigger("create",null,{})},e.prototype._setupHandles=function(){this.options;var t,e,i,s=["n","e","s","w","se","sw","ne","nw"],n=this;this.$handles=x(),this.handles={};for(var o=0;o<s.length;o++)e="nui_resize_absolute__handle--"+(t=s[o]),i=x("<div>").addClass("nui_resize_absolute__handle "+e).attr("data-handle",t).on("mousedown",this._mouseDown.bind(this)),this.handles[t]=i,this.$handles=this.$handles.add(i),this.element.append(i);this.$handles.on("mouseover",function(){n.resizing||(this.className&&(i=this.className.match(/nui_resize_absolute__handle--(se|sw|ne|nw|n|e|s|w)/i)),n.axis=i&&i[1]?i[1]:"se")})},e.prototype._mouseCapture=function(t){var e,i,s=!1;for(e in this.handles)(i=this.handles[e][0])!==t.target&&!x.contains(i,t.target)||(s=!0);return!this.options.disabled&&s},e.prototype._removeHandles=function(){this.$handles.remove()},e.prototype._mouseStart=function(t){x("body").addClass("n2_body--resize-absolute").css("cursor",this.axis+"-resize").addClass("n2_body--inherit-cursor"),this.element.addClass("nui_resize_absolute--resizing"),this.fragmentEditor.pointerManager.disable();var e=this.element.position();this.element.css({left:e.left,top:e.top,right:"auto",bottom:"auto"});var i,s,n,o=this.options,r=this.element;return this.resizing=!0,this.helper=this.element,i=this._num(this.helper.css("left")),s=this._num(this.helper.css("top")),o.containment&&(i+=x(o.containment).scrollLeft()||0,s+=x(o.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:i,top:s},this.size={width:r.width(),height:r.height()},this.originalSize={width:r.width(),height:r.height()},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalPosition={left:i,top:s},this.originalMousePosition={left:t.pageX,top:t.pageY},n=this.handles[this.axis].css("cursor"),x("body").css("cursor","auto"===n?this.axis+"-resize":n),this._propagate("start",t),!0},e.prototype._mouseDrag=function(t){var e,i,s=this.originalMousePosition,n=this.axis,o=t.pageX-s.left||0,r=t.pageY-s.top||0,a=this._change[n];return this._updatePrevProperties(),a&&(e=a.apply(this,[t,o,r]),this._updateVirtualBoundaries(),e=this._respectSize(e,t),this._updateCache(e),this._propagate("resize",t),i=this._applyChanges(),x.isEmptyObject(i)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges())),!1},e.prototype._mouseStop=function(t){return this.resizing=!1,this._propagate("stop",t),this.fragmentEditor.pointerManager.enable(),this.element.removeClass("nui_resize_absolute--resizing"),x("body").removeClass("n2_body--resize-absolute").css("cursor","").removeClass("n2_body--inherit-cursor"),N2Classes.WindowManager.actionPrevent("ComponentActivate"),!1},e.prototype._updatePrevProperties=function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},e.prototype._applyChanges=function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px"),this.helper.css(t),t},e.prototype._updateVirtualBoundaries=function(){var t=this.options,e={minWidth:this._isNumber(t.minWidth)?t.minWidth:0,maxWidth:this._isNumber(t.maxWidth)?t.maxWidth:1/0,minHeight:this._isNumber(t.minHeight)?t.minHeight:0,maxHeight:this._isNumber(t.maxHeight)?t.maxHeight:1/0};this._vBoundaries=e},e.prototype._updateCache=function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},e.prototype._respectSize=function(t){var e=this._vBoundaries,i=this.axis,s=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,n=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,r=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,a=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,d=/sw|nw|w/.test(i),h=/nw|ne|n/.test(i);return o&&(t.width=e.minWidth),r&&(t.height=e.minHeight),s&&(t.width=e.maxWidth),n&&(t.height=e.maxHeight),o&&d&&(t.left=a-e.minWidth),s&&d&&(t.left=a-e.maxWidth),r&&h&&(t.top=l-e.minHeight),n&&h&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},e.prototype._change={e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize;return{left:this.originalPosition.left+e,width:i.width-e}},n:function(t,e,i){var s=this.originalSize;return{top:this.originalPosition.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(t,e,i){return x.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},sw:function(t,e,i){return x.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,e,i]))},ne:function(t,e,i){return x.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},nw:function(t,e,i){return x.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,e,i]))}},e.prototype._propagate=function(t,e){this.callPlugin(t,[e,this.ui()]),"resize"!==t&&this._trigger(t,e,this.ui())},e.prototype.ui=function(){return{element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition,axis:this.axis}},e.prototype.destroy=function(){for(var t in this._mouseDestroy(),this.element.removeClass("nui_resize_absolute").removeData(this.widgetName),this.handles)this.handles[t].remove();return this},N2Classes.UIWidgetBase.addPlugin(e,"smartguides",{start:function(t,e){var i,s,n,o=x(this).data("UIResizeAbsolute"),r=o.options;o.gridH=x('<div class="n2_smartguide n2_smartguide--horizontal"></div>').appendTo(r._containment),o.gridV=x('<div class="n2_smartguide n2_smartguide--vertical"></div>').appendTo(r._containment),o.gridH2=x('<div class="n2_smartguide n2_smartguide--horizontal"></div>').appendTo(r._containment),o.gridV2=x('<div class="n2_smartguide n2_smartguide--vertical"></div>').appendTo(r._containment),o.elements=[],o.$snapLayers=x(),"function"!=typeof r.smartguides||(i=r.smartguides())&&(s=r._containment.offset(),i.each(function(){var t=x(this),e=t.offset();this!==o.element[0]&&(o.elements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:Math.round(e.top-s.top),left:Math.round(e.left-s.left)}),t.hasClass("n2-ss-layer")&&(o.$snapLayers=o.$snapLayers.add(t)))}),o.$snapLayers.addClass("n2_layer_resize_snap_to"),n=r._containment[0].getBoundingClientRect(),o.elements.push({item:r._containment,width:n.width,height:n.height,top:0,left:0}))},stop:function(t,e){var i=x(this).data("UIResizeAbsolute");i.$snapLayers.removeClass("n2_layer_resize_snap_to"),i.gridH.remove(),i.gridV.remove(),i.gridH2.remove(),i.gridV2.remove()},resize:function(t,e){var i=x(this).data("UIResizeAbsolute"),s=i.options.tolerance;i.gridV.css({display:"none"}),i.gridH.css({display:"none"}),i.gridV2.css({display:"none"}),i.gridH2.css({display:"none"});var n=i.elements[i.elements.length-1];function o(t){i.gridV.css({left:Math.min(t,n.width-1),display:"block"})}function r(t){i.gridV2.css({left:Math.min(t,n.width-1),display:"block"})}function a(t){i.gridH.css({top:Math.min(t,n.height-1),display:"block"})}function l(t){i.gridH2.css({top:Math.min(t,n.height-1),display:"block"})}var d=t.ctrlKey||t.metaKey,h=t.altKey;if(!d||!h){for(var c=e.position.left,p=c+e.size.width,u=e.position.top,f=u+e.size.height,g=i.elements.length-1;0<=g;g--){var y,m,v,_=i.elements[g].left,b=_+i.elements[g].width,C=i.elements[g].top,w=C+i.elements[g].height;d||(y=(_+b)/2,Math.abs(_-p)<=s?(e.size.width=_-e.position.left,o(e.position.left+e.size.width)):Math.abs(_-c)<=s?(v=e.position.left-_,e.position.left=_,e.size.width+=v,o(e.position.left)):Math.abs(y-c)<=s&&(v=e.position.left-y,e.position.left=y,e.size.width+=v,o(e.position.left)),Math.abs(b-c)<=s?(v=e.position.left-b,e.position.left=b,e.size.width+=v,r(e.position.left)):Math.abs(b-p)<=s?(e.size.width=b-e.position.left,r(e.position.left+e.size.width)):Math.abs(y-p)<=s&&(e.size.width=y-e.position.left,r(e.position.left+e.size.width))),h||(m=(C+w)/2,Math.abs(C-f)<=s?(e.size.height=C-e.position.top,a(C)):Math.abs(C-u)<=s?(v=e.position.top-C,e.position.top=C,e.size.height+=v,a(e.position.top)):Math.abs(m-u)<=s&&(v=e.position.top-m,e.position.top=m,e.size.height+=v,a(e.position.top)),Math.abs(w-u)<=s?(v=e.position.top-w,e.position.top=w,e.size.height+=v,l(e.position.top)):Math.abs(w-f)<=s?(e.size.height=w-e.position.top,l(e.position.top+e.size.height)):Math.abs(m-f)<=s&&(e.size.height=m-e.position.top,l(e.position.top+e.size.height)))}e.size.width=Math.round(e.size.width),e.size.height=Math.round(e.size.height)}}}),e}),N2D("UIResizeNormal",["UIMouse","UIDragTooltip"],function(o,t){"use strict";var s=new N2Classes.UIDragTooltip("NormalSizing");function e(t,e,i){this.element=t,this.fragmentEditor=e,this.widgetName=this.widgetName||"UIResizeNormal",this.widgetEventPrefix="normalsizing",this.multiplier=1,this.options=o.extend({maxWidth:!0,height:!1,syncWidth:!1,start:null,resizeMaxWidth:null,resizeHeight:null,stopMaxWidth:null,stopHeight:null},this.options,i),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.setMaxWidth=function(t){this.handles.e.toggleClass("nui_resize_normal__handle--none",t<0),this.handles.w.toggleClass("nui_resize_normal__handle--none",t<0)},e.prototype.create=function(){this._setupHandles(),this._mouseInit()},e.prototype.destroy=function(){for(var t in this._mouseDestroy(),this.element.removeData(this.widgetName),this.handles)this.handles[t].remove();return this},e.prototype._setupHandles=function(){var t,e=this.options,i=[];for(e.maxWidth&&(i.push("w"),i.push("e")),e.height&&i.push("s"),this.handles={},this.$handles=o(),t=0;t<i.length;t++){var s=i[t],n=o('<div class="nui_resize_normal__handle nui_resize_normal__handle--'+s+'">').on("mouseenter",this.onMouseEnter.bind(this,s));this.handles[s]=n,this.$handles=this.$handles.add(n),this.element.append(n)}},e.prototype.onMouseEnter=function(e,t){var i=t;this.timeout=setTimeout(function(){delete this.timeout,s.hoverShow(i,function(){if("e"===e||"w"===e){var t=this.element.css("maxWidth");return"Max width: "+("px"===t.substr(-2)?t:"none")}if("s"===e)return"Height: "+this.element.height()+"px"}.bind(this))}.bind(this),500),this.handles[e].on({"mousemove.tooltip":function(t){i=t,s.hoverUpdatePosition(t)},"mouseleave.tooltip":function(){this.timeout&&(clearTimeout(this.timeout),delete this.timeout),this.handles[e].off(".tooltip"),s.hoverHide()}.bind(this)})},e.prototype._removeHandles=function(){this.$handles.remove()},e.prototype._mouseCapture=function(t){for(var e in this.handles)if(this.handles[e][0]===t.target)return this.currentHandle=e,!this.options.disabled;return!1},e.prototype._mouseStart=function(t){switch(this.fragmentEditor.pointerManager.contextualBarHover.disable(),s.dragShow(),this.originalMousePosition={left:t.pageX,top:t.pageY},this.currentHandle){case"w":case"e":this.originalValue=this.element.width(),this.maxWidth=this.element.parent().width(),this._trigger("start",t,"maxwidth"),"center"===this.element.css("align-self")?this.multiplier=2:this.multiplier=1,o("body").css("cursor",this.currentHandle+"-resize").addClass("n2_body--inherit-cursor");break;case"s":this.originalValue=this.element.height(),this._trigger("start",t,"height"),o("body").css("cursor","s-resize").addClass("n2_body--inherit-cursor")}return!0},e.prototype._parse_movement_s=function(t){return t.pageY-this.originalMousePosition.top},e.prototype._parse_movement_e=function(t){return(t.pageX-this.originalMousePosition.left)*this.multiplier},e.prototype._parse_movement_w=function(t){return(this.originalMousePosition.left-t.pageX)*this.multiplier},e.prototype._mouseDrag=function(t){var e=this.options;switch(this.currentValue=nextend.roundHelper(this.originalValue+this["_parse_movement_"+this.currentHandle].call(this,t)),this.currentHandle){case"w":case"e":this.currentValue<=this.maxWidth?(this.element.css("maxWidth",this.currentValue+"px"),e.syncWidth&&this.element.css("width",this.currentValue+"px"),this.setMaxWidth(this.currentValue)):(this.element.css("maxWidth","none"),e.syncWidth&&this.element.css("width",""),this.currentValue=0,this.setMaxWidth(-1)),s.dragUpdate(t,"Max width: "+(0===this.currentValue?"none":this.currentValue+"px"));break;case"s":this.currentValue=Math.max(1,this.currentValue),this.element.height(this.currentValue),s.dragUpdate(t,"Height: "+this.currentValue+"px")}this._triggerInteraction()},e.prototype._mouseStop=function(t){var e=this.options;switch(this.currentValue=nextend.roundHelper(this.originalValue+this["_parse_movement_"+this.currentHandle].call(this,t)),s.dragHide(),this.currentHandle){case"w":case"e":this.currentValue<=this.maxWidth?(this.element.css("maxWidth",this.currentValue+"px"),e.syncWidth&&this.element.css("width",""),this.setMaxWidth(this.currentValue)):(this.element.css("maxWidth","none"),e.syncWidth&&this.element.css("width",""),this.currentValue=0,this.setMaxWidth(-1)),this._trigger("stopMaxWidth",t,{value:this.currentValue});break;case"s":this.currentValue=Math.max(1,this.currentValue),this.element.height(this.currentValue),this._trigger("stopHeight",t,{value:this.currentValue})}return o("body").css("cursor","").removeClass("n2_body--inherit-cursor"),this._triggerInteraction(),this.fragmentEditor.pointerManager.contextualBarHover.enable(),N2Classes.WindowManager.actionPrevent("ComponentActivate"),!1},e}),N2D("UISpacingMargin",["UISpacing"],function(s,t){"use strict";function e(t,e,i){this.options=s.extend({mode:"margin",label:"Margin",sync:{n:"margin-top",e:"margin-right",s:"margin-bottom",w:"margin-left"}},i),N2Classes.UISpacing.prototype.constructor.call(this,t,e)}return(e.prototype=Object.create(N2Classes.UISpacing.prototype)).constructor=e}),N2D("UISpacingPadding",["UISpacing"],function(s,t){"use strict";function e(t,e,i){this.options=s.extend({mode:"padding",label:"Padding",sync:{n:"padding-top",e:"padding-right",s:"padding-bottom",w:"padding-left"}},i),N2Classes.UISpacing.prototype.constructor.call(this,t,e)}return((e.prototype=Object.create(N2Classes.UISpacing.prototype)).constructor=e).prototype.limitValue=function(t){return Math.max(0,t)},e}),N2D("UISpacing",["UIMouse","UIDragTooltip"],function(n,t){"use strict";var s=new N2Classes.UIDragTooltip("Spacing");function e(t,e){this.element=t,this.fragmentEditor=e,this.widgetName=this.widgetName||"UISpacing",this.widgetEventPrefix="spacing",this.options=n.extend({syncInv:{n:"s",e:"w",s:"n",w:"e"},side:{n:"top",e:"right",s:"bottom",w:"left"},size:{n:"height",e:"width",s:"height",w:"width"},drag:null,start:null,stop:null},this.options),N2Classes.UIMouse.prototype.constructor.apply(this,arguments),this.create()}return((e.prototype=Object.create(N2Classes.UIMouse.prototype)).constructor=e).prototype.create=function(){this._setupHandles(),this._mouseInit()},e.prototype.destroy=function(){for(var t in this._mouseDestroy(),this.element.removeData(this.widgetName),this.handles)this.handles[t].remove();return this},e.prototype._setupHandles=function(){var t=["n","e","s","w"];this.handles={},this.$handles=n();for(var e=0;e<t.length;e++){var i=t[e],s=n("<div>").addClass("nui_spacing__handle nui_spacing__handle--"+this.options.mode+" nui_spacing__handle--"+i).on("mouseenter",this.onMouseEnter.bind(this,i)).on("mousedown",this._mouseDown.bind(this)).appendTo(this.element);this.handles[i]=s,this.$handles=this.$handles.add(s)}},e.prototype.onMouseEnter=function(t,e){var i=e;this.timeout=setTimeout(function(){delete this.timeout,s.hoverShow(i,function(){return this.options.label+" "+this.options.side[t]+": "+this.element.css(this.options.sync[t])}.bind(this))}.bind(this),500),this.handles[t].on({"mousemove.tooltip":function(t){i=t,s.hoverUpdatePosition(t)},"mouseleave.tooltip":function(){this.timeout&&(clearTimeout(this.timeout),delete this.timeout),this.handles[t].off(".tooltip"),s.hoverHide()}.bind(this)})},e.prototype._removeHandles=function(){this.$handles.remove()},e.prototype._parse_movement_n=function(t){return t.pageY-this.originalMousePosition.top},e.prototype._parse_movement_w=function(t){return t.pageX-this.originalMousePosition.left},e.prototype._parse_movement_s=function(t){return t.pageY-this.originalMousePosition.top},e.prototype._parse_movement_e=function(t){return this.originalMousePosition.left-t.pageX},e.prototype._mouseCapture=function(t){var e,i=!1;for(var s in this.handles)((e=this.handles[s][0])===t.target||n.contains(e,t.target))&&n(e).hasClass("nui-enabled")&&(i=!0);return!this.options.disabled&&i},e.prototype.updatePositionDisplay=function(t){var e=this.options.label+" "+this.options.side[this.direction]+": "+this.currentValue+"px<br>";this.wasShiftPressed&&(e+=this.options.label+" "+this.options.side[this.options.syncInv[this.direction]]+": "+this.currentValue+"px<br>"),s.dragUpdate(t,e)},e.prototype._mouseStart=function(t){var e;for(var i in this.fragmentEditor.pointerManager.contextualBarActive.enableActiveForced(),this.fragmentEditor.pointerManager.contextualBarHover.disable(),s.dragShow(),this.wasShiftPressed=!1,this.handles)if((e=this.handles[i][0])===t.target||n.contains(e,t.target)){this.direction=i;break}return this.syncProperty=this.options.sync[this.direction],this.originalValue=parseInt(this.element.css(this.syncProperty)),this.invSyncProperty=this.options.sync[this.options.syncInv[this.direction]],this.invOriginalValue=parseInt(this.element.css(this.invSyncProperty)),this.resizing=!0,this.originalMousePosition={left:t.pageX,top:t.pageY},this.currentValue=this.originalValue,this.handles[this.direction].addClass("nui_spacing__handle--spacing"),n("body").css("cursor",this.direction+"-resize").addClass("n2_body--inherit-cursor"),n("body").on("keydown."+this.widgetEventPrefix,this._keyDown.bind(this)).on("keyup."+this.widgetEventPrefix,this._keyUp.bind(this)),this._trigger("start",t,this.ui()),!0},e.prototype._keyDown=function(t){t.shiftKey&&!this.wasShiftPressed&&(this.wasShiftPressed=!0,this.element.css(this.invSyncProperty,this.currentValue),this.setSize(this.options.syncInv[this.direction],this.currentValue),this._trigger("spacing",t,this.ui()),this.updatePositionDisplay(t),this._triggerInteraction())},e.prototype._keyUp=function(t){!t.shiftKey&&this.wasShiftPressed&&(this.wasShiftPressed=!1,this.element.css(this.invSyncProperty,this.invOriginalValue),this.setSize(this.options.syncInv[this.direction],this.invOriginalValue),this._trigger("spacing",t,this.ui()),this.updatePositionDisplay(t),this._triggerInteraction())},e.prototype._mouseDrag=function(t){this.movement=this["_parse_movement_"+this.direction].call(this,t),this.currentValue=this.limitValue(nextend.roundHelper(this.originalValue+this.movement)),this.element.css(this.syncProperty,this.currentValue),this.setSize(this.direction,this.currentValue),t.shiftKey?(this.wasShiftPressed=!0,this.element.css(this.invSyncProperty,this.currentValue),this.setSize(this.options.syncInv[this.direction],this.currentValue)):this.wasShiftPressed&&(this.wasShiftPressed=!1,this.element.css(this.invSyncProperty,this.invOriginalValue),this.setSize(this.options.syncInv[this.direction],this.invOriginalValue)),this._trigger("spacing",t,this.ui()),this._triggerInteraction(),this.updatePositionDisplay(t)},e.prototype._mouseStop=function(t){return this.movement=this["_parse_movement_"+this.direction].call(this,t),this.currentValue=this.limitValue(nextend.roundHelper(this.originalValue+this.movement)),this.element.css(this.syncProperty,this.currentValue),t.shiftKey?this.element.css(this.invSyncProperty,this.currentValue):this.wasShiftPressed&&this.element.css(this.invSyncProperty,this.invOriginalValue),this.resizing=!1,n("body").off("."+this.widgetEventPrefix),this.handles[this.direction].removeClass("nui_spacing__handle--spacing"),n("body").css("cursor","").removeClass("n2_body--inherit-cursor"),this._trigger("stop",t,this.ui()),s.dragHide(),this._triggerInteraction(),this.fragmentEditor.pointerManager.contextualBarActive.disableActiveForced(),this.fragmentEditor.pointerManager.contextualBarHover.enable(),N2Classes.WindowManager.actionPrevent("ComponentActivate"),!1},e.prototype.limitValue=function(t){return t},e.prototype.ui=function(){var t={};return t[this.options.side[this.direction]]=this.currentValue,this.wasShiftPressed&&(t[this.options.side[this.options.syncInv[this.direction]]]=this.currentValue),{element:this.element,changed:t}},e.prototype.setOption=function(t,e){var i;N2Classes.UIWidgetBase.prototype.setOption.apply(this,arguments),"current"===t&&(i=e.split(" "),this.setSize("n",i[0]),this.setSize("e",i[1]),this.setSize("s",i[2]),this.setSize("w",i[3]))},e.prototype.setSize=function(t,e){var i=!1;"number"==typeof e?e<0&&(i=!0,e*=-1):"-"===e.substr(0,1)&&(i=!0,e=e.substr(1)),this.handles[t].css(this.options.size[t],e),this.handles[t].toggleClass("nui_spacing__handle--negative",i),this.handles[t].toggleClass("nui_spacing__handle--zero",0===parseFloat(e))},e}),N2D("PlacementAbsolute",["PlacementAbstract"],function(n,d){"use strict";var o={raf:!1,ratios:null,isThrottled:!1,layers:[]};function t(t,e,i){this.type="absolute",this.transferredProperties={},N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments),this.doThrottledTheResize=this.doTheResize,this.parentIsVisible=!0}return((t.prototype=Object.create(N2Classes.PlacementAbstract.prototype)).constructor=t).getRegistryDataToFields=function(t){return{parentid:n("#layerparentid"),parentalign:n("#layerparentalign"),parentvalign:n("#layerparentvalign"),left:n("#layerleft"),top:n("#layertop"),responsiveposition:n("#layerresponsive-position"),width:n("#layerwidth"),height:n("#layerheight"),responsivesize:n("#layerresponsive-size"),align:n("#layeralign"),valign:n("#layervalign")}},t.prototype.start=function(){this.$layer=this.layer.layer,this.$layerRow=this.layer.layerRow},t.prototype.preActivation=function(t){var e;"normal"!==t.type||0<(e=this.layer.getProperty("height"))&&(this.transferredProperties.height=e)},t.prototype.activated=function(t){var e=this.$layer.data("parentid");e?0<n("#"+e).length?this.activatedAfterParentReady(t):setTimeout(function(){this.activatedAfterParentReady(t)}.bind(this),300):this._activated(t)},t.prototype.activatedAfterParentReady=function(i){var t,e,s=this.$layer.data("parentid");s?0<(t=n("#"+s)).length?(e=t.data("layerObject"))?e.readyDeferred.done(this._activated.bind(this,i)):t.on("layerStarted",function(t,e){e.readyDeferred.done(this._activated.bind(this,i))}.bind(this)):(this.$layer.data("parentid",""),this._activated(i)):this._activated(i)},t.prototype._activated=function(t){this.loadProperties(n.extend(t,this.transferredProperties)),this.transferredProperties={},this.___makeLayerAlign(),this.___makeLayerResizeable(),this.layer.layerRow.addClass("n2_layer_navigation_list_layer--absolute"),n('<div class="n2_layer_navigation_list_layer__title_action"><div class="n2_layer_navigation_list_layer__title_absolute_marker" data-n2tip="Absolute">A</div></div>').prependTo(this.layer.layerTitle.find(".n2_layer_navigation_list_layer__title_actions"))},t.cleanLayer=function(t){var e=["desktopPortrait","desktopLandscape","tabletPortrait","tabletLandscape","mobilePortrait","mobileLandscape"];t.removeAttr("data-align").removeAttr("data-valign").css({left:"",top:"",right:"",bottom:"",width:"",height:"","text-align":""});for(var i=["parentid","responsiveposition","responsivesize","parentalign","parentvalign","align","valign","left","top","width","height"],s={},n=0;n<i.length;n++){var o=i[n].toLowerCase();s[o]=t.data(o),t.removeAttr(o),t.removeData(o);for(var r=0;r<e.length;r++){var a=e[r].toLowerCase();s[a+o]=t.data(a+o),t.removeAttr(a+o),t.removeData(a+o)}}return s},t.prototype.deActivated=function(t){this.layer.layerRow.removeClass("n2_layer_navigation_list_layer--absolute"),this.layer.layerTitle.find(".n2_layer_navigation_list_layer__title_absolute_marker").remove();var e=this.layer.getProperty("parentid");e&&""!=e&&(this.$layer.removeAttr("data-parentid"),this.unSubscribeParent()),this.$layer.removeAttr("data-align").removeAttr("data-valign").css({left:"",top:"",right:"",bottom:"",width:"",height:"","text-align":""}),this.alignMarker.remove(),this.uiResizeAbsolute.destroy(),this.$layer.off(".n2-ss-absolute"),this.$layer.triggerHandler("LayerAbsoluteUnavailable");var i=["parentid","responsiveposition","responsivesize","parentalign","parentvalign","align","valign","left","top","width","height"],s=this.layer.getPropertiesData(i);return this.layer.removeProperties(i),s},t.prototype.loadProperties=function(t){this.layer.createProperty("parentid",null,this.layer.layer,this),this.layer.createProperty("responsiveposition",1,this.layer.layer,this),this.layer.createProperty("responsivesize",1,this.layer.layer,this),this.layer.createDeviceProperty("parentalign",{desktopPortrait:"center"},this.layer.layer,this),this.layer.createDeviceProperty("parentvalign",{desktopPortrait:"middle"},this.layer.layer,this),this.layer.createDeviceProperty("align",{desktopPortrait:t.align||"center"},this.layer.layer,this),this.layer.createDeviceProperty("valign",{desktopPortrait:t.valign||"middle"},this.layer.layer,this),this.layer.createDeviceProperty("left",{desktopPortrait:t.left||0},this.layer.layer,this),this.layer.createDeviceProperty("top",{desktopPortrait:t.top||0},this.layer.layer,this),this.layer.createDeviceProperty("width",{desktopPortrait:t.width||"auto"},this.layer.layer,this),this.layer.createDeviceProperty("height",{desktopPortrait:t.height||"auto"},this.layer.layer,this);var e=this.layer.layer;this.subscribeParentCallbacks={},this.layer.getProperty("parentid")&&this.subscribeParent(),e.attr({"data-align":this.layer.getProperty("align"),"data-valign":this.layer.getProperty("valign")})},t.prototype.___makeLayerAlign=function(){this.alignMarker=n('<div class="n2-ss-layer-cc"></div>').attr("data-handle","cc").appendTo(this.$layer),this.layer.editorUI.absoluteCC=this.alignMarker},t.prototype.___makeLayerResizeable=function(){this._resizableJustClick=!1,this.uiResizeAbsolute=new N2Classes.UIResizeAbsolute(this.$layer,this.layer.fragmentEditor,{_containment:this.fragmentEditor.mainContainer.layer,start:this.____makeLayerResizeableStart.bind(this),resize:this.____makeLayerResizeableResize.bind(this),stop:this.____makeLayerResizeableStop.bind(this),create:function(){this.$layer.find(".nui_resize_absolute__handle, .n2-ss-layer-cc").on({mousedown:function(t){this._resizableJustClick=[t.clientX,t.clientY]}.bind(this),mouseup:function(t){if(this._resizableJustClick&&Math.abs(Math.sqrt(Math.pow(this._resizableJustClick[0]-t.clientX,2)+Math.pow(this._resizableJustClick[1]-t.clientY,2)))<1){var e=n(t.currentTarget),i=this.fragmentEditor.layerOptions.layerFeatures;switch(e.data("handle")){case"nw":i.horizontalAlign("left",!1),i.verticalAlign("top",!1);break;case"w":i.horizontalAlign("left",!1),i.verticalAlign("middle",!1);break;case"sw":i.horizontalAlign("left",!1),i.verticalAlign("bottom",!1);break;case"n":i.horizontalAlign("center",!1),i.verticalAlign("top",!1);break;case"cc":i.horizontalAlign("center",!1),i.verticalAlign("middle",!1);break;case"s":i.horizontalAlign("center",!1),i.verticalAlign("bottom",!1);break;case"ne":i.horizontalAlign("right",!1),i.verticalAlign("top",!1);break;case"e":i.horizontalAlign("right",!1),i.verticalAlign("middle",!1);break;case"se":i.horizontalAlign("right",!1),i.verticalAlign("bottom",!1)}}this._resizableJustClick=!1}.bind(this)})}.bind(this),smartguides:function(){return this.fragmentEditor.getSnap(this.layer.group,this.layer)}.bind(this),tolerance:5}),this.layer.editorUI.resize=this.uiResizeAbsolute.$handles,this.$layer.on({"mousedown.n2-ss-absolute":function(t){0===t.button&&0===n(t.target).closest(".nui_resize_absolute__handle, .nui_resize_normal__handle, .nui_spacing__handle").length&&(N2Classes.PositionDisplay.get().show("Canvas"),N2Classes.PositionDisplay.get().update(t,"Canvas","W: "+parseInt(this.$layer.width())+"px<br />H: "+parseInt(this.$layer.height())+"px"),document.activeElement&&document.activeElement.blur(),document.addEventListener("mouseup",function(){N2Classes.PositionDisplay.get().hide("Canvas")},{capture:!0,once:!0}))}.bind(this)})},t.prototype.____makeLayerResizeableStart=function(t,e){this._resizableJustClick&&(this._resizableJustClick=!1),this.____makeLayerResizeableResize(t,e),N2Classes.PositionDisplay.get().show("Canvas")},t.prototype.____makeLayerResizeableResize=function(t,e){N2Classes.PositionDisplay.get().update(t,"Canvas","W: "+e.size.width+"px<br />H: "+e.size.height+"px"),this.triggerLayerResized()},t.prototype.____makeLayerResizeableStop=function(t,e){var i=!1;"n"!==e.axis&&"s"!==e.axis&&e.originalSize.width!=e.size.width||(s=this.layer.getProperty("width"),this.layer.isDimensionPropertyAccepted(s)&&(i=!0,this._syncwidth()));var s,n=!1;"e"!==e.axis&&"w"!==e.axis&&e.originalSize.height!=e.size.height||(s=this.layer.getProperty("height"),this.layer.isDimensionPropertyAccepted(s)&&(n=!0,this._syncheight()));var o=this.fragmentEditor.getResponsiveRatioHorizontal(),r=this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical();parseInt(this.layer.getProperty("responsivesize"))||(o=r=1);var a=null;i||(a=Math.round(e.size.width*(1/o)));var l=null;n||(l=Math.round(e.size.height*(1/r))),this._setPosition(null,null,e.position.left,e.position.top,a,l,!0),this.triggerLayerResized(),N2Classes.PositionDisplay.get().hide("Canvas")},t.prototype._setPosition=function(t,e,i,s,n,o,r){var a=this.layer.getMode();null===t&&(t=this.layer.getProperty("align")),null===e&&(e=this.layer.getProperty("valign")),null===i?i=this.layer.getProperty("left"):r&&(i=this.calculatePositionLeft(t,i)),null===s?s=this.layer.getProperty("top"):r&&(s=this.calculatePositionTop(e,s)),null===n&&(n=this.layer.getProperty("width")),null===o&&(o=this.layer.getProperty("height"));var l=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStorePosition",a]);l&&l.setValues({align:this.layer.getRawProperty("align"),valign:this.layer.getRawProperty("valign"),left:this.layer.getRawProperty("left"),top:this.layer.getRawProperty("top"),width:this.layer.getRawProperty("width"),height:this.layer.getRawProperty("height")},{align:t,valign:e,left:i,top:s,width:n,height:o}),N2Classes.History.get().off(),this.layer.store(d,"width",n,!0,"layer"),this.layer.$.trigger("propertyChanged",["width",n]),this.layer.store(d,"height",o,!0,"layer"),this.layer.$.trigger("propertyChanged",["height",o]),this.layer.store(d,"align",t,!0,"layer"),this.layer.$.trigger("propertyChanged",["align",t]),this.layer.store(d,"valign",e,!0,"layer"),this.layer.$.trigger("propertyChanged",["valign",e]),this.layer.store(d,"left",i,!0,"layer"),this.layer.$.trigger("propertyChanged",["left",i]),this.layer.store(d,"top",s,!0,"layer"),this.layer.$.trigger("propertyChanged",["top",s]),N2Classes.History.get().on()},t.prototype.historyStorePosition=function(t,e){this.layer.historyStore(t.align,"align",e),this.layer.historyStore(t.valign,"valign",e),this.layer.historyStore(t.width,"width",e),this.layer.historyStore(t.height,"height",e),this.layer.historyStore(t.left,"left",e),this.layer.historyStore(t.top,"top",e),this.triggerLayerResized()},t.prototype.calculatePositionLeft=function(t,e){var i=this.fragmentEditor.getResponsiveRatioHorizontal();parseInt(this.layer.getProperty("responsiveposition"))||(i=1);var s={left:0,leftMultiplier:1};if(this.parent&&this.parent.layer.is(":visible")){var n=this.parent.layer.position();switch(this.layer.getProperty("parentalign")){case"right":s.left=n.left+this.parent.layer[0].offsetWidth;break;case"center":s.left=n.left+Math.round(this.parent.layer[0].offsetWidth/2);break;default:s.left=n.left}s.left+=parseInt(this.parent.layer.css("marginLeft"))}else{var o=this.$layer.parent();switch(t){case"center":s.left+=Math.round(o[0].offsetWidth/2);break;case"right":s.left+=o[0].offsetWidth}}switch(t){case"left":e=-Math.round((s.left-e)*(1/i));break;case"center":e=-Math.round((s.left-e-this.$layer.width()/2)*(1/i));break;case"right":e=-Math.round((s.left-e-this.$layer.width())*(1/i))}return e},t.prototype.calculatePositionTop=function(t,e){var i=this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical();parseInt(this.layer.getProperty("responsiveposition"))||(i=1);var s={top:0,topMultiplier:1};if(this.parent&&this.parent.layer.is(":visible")){var n=this.parent.layer.position();switch(this.layer.getProperty("parentvalign")){case"bottom":s.top=n.top+this.parent.layer[0].offsetHeight;break;case"middle":s.top=n.top+Math.round(this.parent.layer[0].offsetHeight/2);break;default:s.top=n.top}s.top+=parseInt(this.parent.layer.css("marginTop"))}else{var o=this.$layer.parent();switch(t){case"middle":s.top+=Math.round(o[0].offsetHeight/2);break;case"bottom":s.top+=o[0].offsetHeight}}switch(t){case"top":e=-Math.round((s.top-e)*(1/i));break;case"middle":e=-Math.round((s.top-e-this.$layer.height()/2)*(1/i));break;case"bottom":e=-Math.round((s.top-e-this.$layer.height())*(1/i))}return e},t.prototype.moveX=function(t){this._setPosition(null,null,this.layer.getProperty("left")+t,null,null,null,!1)},t.prototype.moveY=function(t){this._setPosition(null,null,null,this.layer.getProperty("top")+t,null,null,!1)},t.prototype.setPositionLeft=function(t){t=this.calculatePositionLeft(this.layer.getProperty("align"),t),this.layer.store(d,"left",t,!0),this.layer.$.trigger("propertyChanged",["left",t])},t.prototype.setPositionTop=function(t){t=this.calculatePositionTop(this.layer.getProperty("valign"),t),this.layer.store(d,"top",t,!0),this.layer.$.trigger("propertyChanged",["top",t])},t.prototype.setPosition=function(t,e){this.setPositionLeft(t),this.setPositionTop(e)},t.prototype.setDeviceBasedAlign=function(){var t=this.layer.getMode();this.layer.deviceProperty[t].align===d&&this.layer.setProperty("align",this.layer.getProperty("align"),"layer"),this.layer.deviceProperty[t].valign===d&&this.layer.setProperty("valign",this.layer.getProperty("valign"),"layer")},t.prototype.setPropertyresponsiveposition=t.prototype.setPropertyresponsivesize=function(t,e,i){this.layer._setProperty(t,parseInt(e),i)},t.prototype.setPropertywidth=t.prototype.setPropertyheight=function(t,e,i){var s=e;this.layer.isDimensionPropertyAccepted(e)||(s=~~e)!=e&&this.layer.$.trigger("propertyChanged",[t,s]),setTimeout(function(){this.onResize(!1)}.bind(this),50),this.layer._setProperty(t,s,i)},t.prototype.setPropertyleft=t.prototype.setPropertytop=function(t,e,i){var s=~~e;s!=e&&this.layer.$.trigger("propertyChanged",[t,s]),this.layer._setProperty(t,s,i)},t.prototype.render=function(t){this["_sync"+t]()},t.prototype.renderWithModifier=function(e,t,i){try{"width"!=e&&"height"!=e||!this.layer.isDimensionPropertyAccepted(t)?this["_sync"+e](Math.round(t*i)):this["_sync"+e](t)}catch(t){console.error("_sync"+e)}},t.prototype.startResize=function(){this.doTheResize({slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()},!0,!0)},t.prototype.onResize=function(t){this.resize({slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()},t)},t.prototype.resize=function(t,e){this.parent&&!e||this.addToResizeCollection(this,t,!1)},t.prototype.addToResizeCollection=function(t,e,i){o.ratios=e,o.isThrottled=i;for(var s=0;s<o.layers.length;s++)if(o.layers[s]===this){o.layers.splice(s,1);break}o.layers.push(t),!1===o.raf&&(o.raf=!0,requestAnimationFrame(function(){var t=o;o={raf:!1,ratios:null,isThrottled:!1,layers:[]};for(var e=0;e<t.layers.length;e++)t.layers[e].isDeleted||t.layers[e].doTheResize(t.ratios,!0,t.isThrottled)})),this.triggerLayerResized(i,e)},t.prototype._syncresponsiveposition=function(){this.onResize(!0)},t.prototype._syncwidth=function(){var t=this.layer.getProperty("width");this.layer.isDimensionPropertyAccepted(t)||(parseInt(this.layer.getProperty("responsivesize"))&&(t*=this.fragmentEditor.getResponsiveRatioHorizontal()),t+="px"),this.$layer.css("width",t)},t.prototype._syncheight=function(){var t=this.layer.getProperty("height");this.layer.isDimensionPropertyAccepted(t)||(parseInt(this.layer.getProperty("responsivesize"))&&(t*=this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()),t+="px"),this.$layer.css("height",t)},t.prototype._syncparentalign=function(){var t=this.layer.getProperty("parentalign");this.$layer.data("parentalign",t);var e=this.getParent();e&&e.placement.current.onResize(!1)},t.prototype._syncparentvalign=function(){var t=this.layer.getProperty("parentvalign");this.$layer.data("parentvalign",t);var e=this.getParent();e&&e.placement.current.onResize(!1)},t.prototype._syncleft=function(){var t=this.layer.getProperty("left");if(parseInt(this.layer.getProperty("responsiveposition"))&&(t*=this.fragmentEditor.getResponsiveRatioHorizontal()),this.parent&&this.parentIsVisible){var e=this.parent.layer.position(),i=this.layer.getProperty("align"),s=0;switch(this.layer.getProperty("parentalign")){case"right":s=e.left+this.parent.layer[0].offsetWidth;break;case"center":s=e.left+Math.round(this.parent.layer[0].offsetWidth/2);break;default:s=e.left}switch(s+=parseInt(this.parent.layer.css("marginLeft")),i){case"right":this.$layer.css({left:"auto",right:this.$layer.parent()[0].offsetWidth-s-t+"px"});break;case"center":this.$layer.css({left:Math.round(s+t-this.$layer.width()/2)+"px",right:"auto"});break;default:this.$layer.css({left:s+t+"px",right:"auto"})}}else switch(this.layer.getProperty("align")){case"right":this.$layer.css({left:"auto",right:-t+"px"});break;case"center":this.$layer.css({left:Math.round(this.$layer.parent()[0].offsetWidth/2+t-this.$layer.width()/2)+"px",right:"auto"});break;default:this.$layer.css({left:t+"px",right:"auto"})}this.triggerLayerResized()},t.prototype._synctop=function(){var t=this.layer.getProperty("top");if(parseInt(this.layer.getProperty("responsiveposition"))&&(t*=this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()),this.parent&&this.parentIsVisible){var e=this.parent.layer.position(),i=this.layer.getProperty("valign"),s=0;switch(this.layer.getProperty("parentvalign")){case"bottom":s=e.top+this.parent.layer[0].offsetHeight;break;case"middle":s=e.top+Math.round(this.parent.layer[0].offsetHeight/2);break;default:s=e.top}switch(s+=parseInt(this.parent.layer.css("marginTop")),i){case"bottom":this.$layer.css({top:"auto",bottom:this.$layer.parent()[0].offsetHeight-s-t+"px"});break;case"middle":this.$layer.css({top:Math.round(s+t-this.$layer.height()/2)+"px",bottom:"auto"});break;default:this.$layer.css({top:s+t+"px",bottom:"auto"})}}else switch(this.layer.getProperty("valign")){case"bottom":this.$layer.css({top:"auto",bottom:-t+"px"});break;case"middle":this.$layer.css({top:Math.round(this.$layer.parent()[0].offsetHeight/2+t-this.$layer.height()/2)+"px",bottom:"auto"});break;default:this.$layer.css({top:t+"px",bottom:"auto"})}this.triggerLayerResized()},t.prototype._syncresponsivesize=function(){this.onResize(!0)},t.prototype.historyStoreDoubleProp=function(t,e,i,s){e==this.layer.getMode()?(this.layer._setProperty(i,t.value,"history"),this.layer._setProperty(s,t.value2,"history")):(this.layer.deviceProperty[e][i]=t.value,this.layer.deviceProperty[e][s]=t.value2,this.layer.$.trigger("propertyChanged",[i,this.layer.getProperty(i)]),this.layer.$.trigger("propertyChanged",[s,this.layer.getProperty(s)]),this.layer.render(i,null,"history"),this.layer.render(s,null,"history"))},t.prototype.setPropertyalign=function(t,e,i){var s=this.layer.getProperty(t),n=this.layer.getRawProperty("left");N2Classes.History.get().off(),this.layer._setProperty(t,e,i),N2Classes.History.get().on();var o=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStoreDoubleProp",this.layer.getMode(),"align","left"]);o&&o.setValues({value:s,value2:n},{value:e,value2:this.layer.getRawProperty("left")})},t.prototype.setPropertyvalign=function(t,e,i){var s=this.layer.getProperty(t),n=this.layer.getRawProperty("top");N2Classes.History.get().off(),this.layer._setProperty(t,e,i),N2Classes.History.get().on();var o=N2Classes.History.get().addValue(this.layer,this.layer.historyStoreOnPlacement,["historyStoreDoubleProp",this.layer.getMode(),"valign","top"]);o&&o.setValues({value:s,value2:n},{value:e,value2:this.layer.getRawProperty("top")})},t.prototype._syncalign=function(t,e){var i=this.layer.getProperty("align");this.$layer.attr("data-align",i),"history"!==e&&i!=t&&this.setPositionLeft(this.$layer.position().left)},t.prototype._syncvalign=function(t,e){var i=this.layer.getProperty("valign");this.$layer.attr("data-valign",i),"history"!==e&&i!=t&&this.setPositionTop(this.$layer.position().top)},t.prototype.fit=function(){var t,e,i=this.$layer.get(0);this.$layer.position();0<i.scrollWidth&&0<i.scrollHeight&&(t=!1,this.layer.item&&(t=this.layer.item.fitLayer()),t||(this.layer.setProperty("width","auto","layer"),this.layer.setProperty("height","auto","layer"),e=this.$layer.width(),Math.abs(this.fragmentEditor.mainContainer.layer.width()-this.$layer.position().left-e)<2&&this.layer.setProperty("width",e,"layer")))},t.prototype.hide=function(t){this.layer.store(d,t||this.layer.getMode(),0,!0)},t.prototype.show=function(t){this.layer.store(d,t||this.layer.getMode(),1,!0)},t.prototype.changeStatus=function(t,e){},t.prototype.getParent=function(){return!!this.layer.getProperty("parentid")&&n("#"+this.layer.getProperty("parentid")).data("layerObject")},t.prototype.subscribeParent=function(){var t=n("#"+this.layer.property.parentid);this.parent&&!t.is(this.parent.layer)&&(this.parent.layer.off(this.subscribeParentCallbacks),this.parent=!1),this.parent||(this.subscribeParentCallbacks={LayerResized:function(){this.resizeParent.apply(this,arguments)}.bind(this),LayerDeleted:function(t){this.layer.setProperty("parentid","","layer")}.bind(this),LayerAbsoluteUnavailable:function(){this.onLayerAbsoluteUnavailable()}.bind(this),LayerShowChange:function(t,e,i){this.layer.getMode()===e&&(this.parentIsVisible=i)}.bind(this),"n2-ss-activate":function(){this.$layerRow.addClass("n2-parent-active")}.bind(this),"n2-ss-deactivate":function(){this.$layerRow.removeClass("n2-parent-active")}.bind(this),LayerGetDataWithChildren:function(t,e,i){this.layer.getDataWithChildren(e,i)}.bind(this)},this.parent=t.data("layerObject"),this.parent.layer.on(this.subscribeParentCallbacks),this.$layer.on("LayerAbsoluteUnavailable.absolute",this.onLayerAbsoluteUnavailable.bind(this)),this.$layer.addClass("n2-ss-layer-has-parent"))},t.prototype.onLayerAbsoluteUnavailable=function(){this.layer.setProperty("parentid","","layer")},t.prototype.unSubscribeParent=function(t){var e;this.$layerRow.removeClass("n2-parent-active"),this.$layer.removeClass("n2-ss-layer-has-parent"),this.parent&&(this.$layer.off("LayerAbsoluteUnavailable.absolute"),this.parent.layer.off(this.subscribeParentCallbacks),this.parent=!1,this.subscribeParentCallbacks={},"delete"!==t&&(e=this.$layer.position(),this._setPosition(null,null,e.left,e.top,null,null,!0)))},t.prototype.unlink=function(t){t&&t.preventDefault(),this.layer.setProperty("parentid","","layer")},t.prototype.parentPicked=function(t,e,i,s,n){var o;for(var r in this.layer.setProperty("parentid","","layer"),this.layer.setProperty("align",s,"layer"),this.layer.setProperty("valign",n,"layer"),this.layer.setProperty("parentalign",e,"layer"),this.layer.setProperty("parentvalign",i,"layer"),this.layer.setProperty("parentid",t.requestID(),"layer"),this.layer.deviceProperty)"desktopPortrait"!==r&&(this.layer.deviceProperty[r].left=o,this.layer.deviceProperty[r].top=o,this.layer.deviceProperty[r].valign=o,this.layer.deviceProperty[r].align=o)},t.prototype._syncparentid=function(){var t=this.layer.getProperty("parentid");t&&""!==t?N2Classes.History.get().actionInProgress()?setTimeout(this._linkToParentID.bind(this,t,!0),100):this._linkToParentID(t,!1):(this.$layer.removeAttr("data-parentid"),this.unSubscribeParent())},t.prototype._linkToParentID=function(t,e){var i;0===n("#"+t).length?this.layer.setProperty("parentid","","layer"):(this.$layer.attr("data-parentid",t).addClass("n2-ss-layer-has-parent"),this.subscribeParent(),e?(N2Classes.History.get().off(),this._setPosition(null,null,null,null,null,null,!0),N2Classes.History.get().on()):(i=this.$layer.position(),this._setPosition(null,null,i.left,i.top,null,null,!0)))},t.prototype._renderModeProperties=function(t){this.$layer.attr("data-align",this.layer.property.align),this.$layer.attr("data-valign",this.layer.property.valign),t&&this.onResize(!0)},t.prototype.doLinearResize=function(t){this.doThrottledTheResize(t,!0)},t.prototype.doTheResize=function(t,e,i){this.render("width"),this.render("height"),this.render("left"),this.render("top"),e||this.triggerLayerResized(i,t)},t.prototype.resizeParent=function(t,e,i){this.addToResizeCollection(this,e,i)},t.prototype.resizeParentLocal=function(){this.resizeParent(d,{slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()},!1)},t.prototype.updatePosition=function(){var t,e,i;"center"===this.layer.getProperty("align")&&(t=0,t=this.parent?this.parent.layer.position().left+this.parent.layer[0].offsetWidth/2:this.$layer.parent()[0].offsetWidth/2,i=this.fragmentEditor.getResponsiveRatioHorizontal(),parseInt(this.layer.getProperty("responsiveposition"))||(i=1),this.$layer.css("left",Math.round(t-this.$layer.width()/2+this.layer.getProperty("left")*i))),"middle"===this.layer.getProperty("valign")&&(e=0,e=this.parent?this.parent.layer.position().top+this.parent.layer[0].offsetHeight/2:this.$layer.parent()[0].offsetHeight/2,i=this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical(),parseInt(this.layer.getProperty("responsiveposition"))||(i=1),this.$layer.css("top",Math.round(e-this.$layer.height()/2+this.layer.getProperty("top")*i))),this.triggerLayerResized()},t.prototype.sync=function(){this._syncalign(null,"history"),this._syncvalign(null,"history"),this._syncwidth(),this._syncheight(),this._synctop(),this._syncleft(),this._syncparentid()},t.prototype.delete=function(){this.layer.getProperty("parentid")&&this.unSubscribeParent("delete")},t}),N2D("PlacementContent",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="content",N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return(i.prototype=Object.create(N2Classes.PlacementAbstract.prototype)).constructor=i}),N2D("PlacementDefault",["PlacementAbstract"],function(t,e){"use strict";function i(t,e,i){this.type="default",N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return(i.prototype=Object.create(N2Classes.PlacementAbstract.prototype)).constructor=i}),N2D("PlacementNormal",["PlacementAbstract"],function(a,t){"use strict";function e(t,e,i){this.type="normal",this.transferredProperties={},N2Classes.PlacementAbstract.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.PlacementAbstract.prototype)).constructor=e).getRegistryDataToFields=function(t){return{margin:a("#layernormal-margin"),height:a("#layernormal-height"),maxwidth:a("#layernormal-maxwidth"),selfalign:a("#layernormal-selfalign")}},e.prototype.preActivation=function(t){var e;"absolute"===t.type&&this.layer.item&&this.layer.item.needHeight&&((e=this.layer.getProperty("height")).match&&e.match(/[0-9]+%$/)?this.transferredProperties.height=Math.max(100,parseInt(this.$layer.parent()[0].offsetHeight*parseInt(e)/100)):0<e&&(this.transferredProperties.height=e))},e.prototype.activated=function(t){this.loadProperties(a.extend(t,this.transferredProperties)),this.transferredProperties={},this.layer.$.on("baseSizeUpdated.placementnormal",this._syncmargin.bind(this)),this.layer.$.on("baseSizeUpdated.placementnormal",this._syncheight.bind(this)),this.startUISpacing(),this.startUISizing(),this.$layer.on({mousedown:function(t){t.stopPropagation()}})},e.prototype.loadProperties=function(t){this.layer.createDeviceProperty("margin",{desktopPortrait:"0|*|0|*|0|*|0|*|px+"},this.layer.layer,this),this.layer.createDeviceProperty("height",{desktopPortrait:t.height||0},this.layer.layer,this),this.layer.createDeviceProperty("maxwidth",{desktopPortrait:0},this.layer.layer,this),this.layer.createDeviceProperty("selfalign",{desktopPortrait:"inherit"},this.layer.layer,this)},e.cleanLayer=function(t){var e=["desktopPortrait","desktopLandscape","tabletPortrait","tabletLandscape","mobilePortrait","mobileLandscape"];t.attr("data-has-maxwidth","0").removeAttr("data-cssselfalign").css({position:"",margin:"",height:"",maxWidth:""});for(var i=["margin","height","maxwidth","selfalign"],s={},n=0;n<i.length;n++){var o=i[n].toLowerCase();s[o]=t.data(o),t.removeAttr(o),t.removeData(o);for(var r=0;r<e.length;r++){var a=e[r].toLowerCase();s[o]=t.data(a+o),t.removeAttr(a+o),t.removeData(a+o)}}return s},e.prototype.deActivated=function(t){this.layer.$.off(".placementnormal"),this.uiSpacing.destroy(),delete this.layer.editorUI.normalSizing,this.uiResizeNormal.destroy(),this.layer.layer.attr("data-has-maxwidth","0"),this.layer.layer.removeAttr("data-cssselfalign"),this.layer.layer.removeAttr("data-custom-height");var e=["margin","height","maxwidth","selfalign"],i=this.layer.getPropertiesData(e);return this.layer.removeProperties(e),this.layer.layer.css({position:"",margin:"",height:"",maxWidth:""}),i},e.prototype._renderModeProperties=function(t){this._syncmargin(),this._syncheight(),this._syncmaxwidth(),this._syncselfalign()},e.prototype._syncmargin=function(){var t=(s=this.layer.getProperty("margin").split("|*|")).pop(),e=this.layer.baseSize;if("px+"==t&&0<e){t="em";for(var i=0;i<s.length;i++)s[i]=parseInt(s[i])/e}var s=s.join(t+" ")+t;this.layer.layer.css("margin",s),this.layer.update(),this.uiSpacing.setOption("current",s)},e.prototype.startUISpacing=function(){this.uiSpacing=new N2Classes.UISpacingMargin(this.$layer,this.layer.fragmentEditor,{stop:this.onSpacingStop.bind(this)}),this.layer.editorUI.margin=this.uiSpacing.$handles},e.prototype.onSpacingStop=function(t,e){var i=this.layer.getProperty("margin").split("|*|"),s=1,n=1;for(var o in"px+"==i[i.length-1]&&1<Math.abs(parseFloat(this.$layer.css("fontSize"))-this.layer.baseSize)&&(s=this.fragmentEditor.getResponsiveRatioHorizontal(),n=this.fragmentEditor.getResponsiveRatioVertical()),e.changed){var r=e.changed[o];switch(o){case"top":i[0]=Math.round(r/n);break;case"right":i[1]=Math.round(r/s);break;case"bottom":i[2]=Math.round(r/n);break;case"left":i[3]=Math.round(r/s)}}this.layer.setProperty("margin",i.join("|*|")),a("#layernormal-margin").data("field").insideChange(i.join("|*|"))},e.prototype.startUISizing=function(){var t=!1;this.layer.item&&this.layer.item.needHeight&&(t=!0),this.uiResizeNormal=new N2Classes.UIResizeNormal(this.$layer,this.layer.fragmentEditor,{height:t,syncWidth:!0,start:function(t,e){"maxwidth"===e&&this.layer.layer.attr("data-has-maxwidth","1")}.bind(this),stopMaxWidth:function(t,e){this.layer.setProperty("maxwidth",e.value)}.bind(this),stopHeight:function(t,e){var i=1;parseInt(this.$layer.css("fontSize"))!=this.layer.baseSize&&(i=this.fragmentEditor.getResponsiveRatioHorizontal());Math.round(void 0/i);this.layer.setProperty("height",e.value)}.bind(this)}),this.layer.editorUI.normalSizing=this.uiResizeNormal.$handles},e.prototype._syncheight=function(){var t,e,i=parseInt(this.layer.getProperty("height"));0<i?(t="px",0<(e=this.layer.baseSize)&&(t="em",i=parseInt(i)/e),this.layer.layer.css("height",i+t).attr("data-custom-height",1)):this.layer.layer.css("height","").removeAttr("data-custom-height"),this.layer.update()},e.prototype._syncmaxwidth=function(){var t=parseInt(this.layer.getProperty("maxwidth"));t<=0||isNaN(t)?(this.layer.layer.css("maxWidth","").attr("data-has-maxwidth","0"),this.uiResizeNormal.setMaxWidth(-1)):(this.layer.layer.css("maxWidth",t+"px").attr("data-has-maxwidth","1"),this.uiResizeNormal.setMaxWidth(t)),this.layer.update()},e.prototype._syncselfalign=function(){this.layer.layer.attr("data-cssselfalign",this.layer.getProperty("selfalign")),this.layer.update()},e.prototype.sync=function(){this._syncmargin(),this._syncheight(),this._syncmaxwidth()},e}),N2D("Placement",function(t,n){"use strict";function e(t){this.layer=t,this.fragmentEditor=t.fragmentEditor,this.modes={},this.current=n,this.updatePositionThrottled=NextendDeBounce(function(){this.layer.isDeleteStarted||(this.updatePosition(),this.layer.layer.trigger("interaction"))}.bind(this),200)}return e.prototype.allow=function(t){switch(t){case"default":this.modes.default=new N2Classes.PlacementDefault(this,this.layer,this.fragmentEditor);break;case"absolute":this.modes.absolute=new N2Classes.PlacementAbsolute(this,this.layer,this.fragmentEditor);break;case"normal":this.modes.normal=new N2Classes.PlacementNormal(this,this.layer,this.fragmentEditor)}},e.prototype.start=function(){for(var t in this.modes)this.modes[t].start()},e.prototype.setMode=function(t,e){var i,s=!1;return e=e||{},this.modes[t]!==n?this.current!==this.modes[t]&&(this.current&&(this.modes[t].preActivation(this.current),i=this.current.type,s=this.current.deActivated(this.modes[t])),this.current=this.modes[t],this.layer.layer.attr("data-pm",this.current.type),this.current.activated(e),this.layer.$.triggerHandler("placementChanged",[this.current.type,i])):console.error("Layer placement("+t+") not allowed for this component",this.layer),s},e.prototype.getType=function(){return this.current.type},e.prototype.startResize=function(){this.current.startResize()},e.prototype.onResize=function(t){"function"==typeof this.current.onResize&&this.current.onResize(t)},e.prototype.updatePosition=function(){this.current.updatePosition()},e.prototype.doLinearResize=function(t){this.current.doLinearResize(t)},e.prototype.sync=function(){this.current.sync()},e.prototype.renderModeProperties=function(t){this.layer.adjustFontSize(!1),this.current._renderModeProperties(t)},e.prototype.delete=function(){this.current.delete()},e}),N2D("PlacementAbstract",["Placement"],function(t,e){"use strict";function i(t,e,i){this.placement=t,this.layer=e,this.fragmentEditor=i,this._triggerLayerResizedThrottled=NextendThrottle(this._triggerLayerResized,30)}return i.prototype.start=function(){this.$layer=this.layer.layer},i.prototype.startResize=function(){},i.prototype.preActivation=function(t){},i.prototype.activated=function(){},i.prototype.deActivated=function(t){return!1},i.prototype.updatePosition=function(){this.layer.group.update()},i.prototype._renderModeProperties=function(t){},i.prototype._hide=function(){},i.prototype._show=function(){},i.prototype.doLinearResize=function(t){},i.prototype.sync=function(){},i.prototype.delete=function(){},i.prototype.changeStatus=function(t,e){},i.prototype.onResize=function(t){this.triggerLayerResized(t)},i.prototype.isSingleAxis=function(){if("slide"===this.layer.group.type){if(!this.parent)return!1;if("absolute"===this.parent.placement.getType())return!1}return!0},i.prototype.triggerLayerResized=function(t,e){t?this._triggerLayerResized(t,e):this._triggerLayerResizedThrottled(!0,e)},i.prototype._triggerLayerResized=function(t,e){this.layer.isDeleted||this.$layer.triggerHandler("LayerResized",[e||{slideW:this.fragmentEditor.getResponsiveRatioHorizontal(),slideH:this.isSingleAxis()?this.fragmentEditor.getResponsiveRatioHorizontal():this.fragmentEditor.getResponsiveRatioVertical()},t||!1])},i}),N2D("Item",function(s,n){"use strict";function t(t,e,i){this.type===n&&(this.type=t.data("item")),this.needWidth=this.constructor.needWidth||!1,this.needHeight=this.constructor.needHeight||!1,this.fragmentEditor=i.fragmentEditor,this.generator=this.fragmentEditor.editor.generator,(this.self=this).$item=t,this.layer=e,this.itemEditor=i,this.css=[],this.fonts=[],this.styles=[],this.needFill=[],this.values=this.$item.data("itemvalues"),"object"!=typeof this.values&&(this.values=s.parseJSON(this.values)),this.pre="div#"+this.fragmentEditor.editor.frontend.elementID+" ",this.defaultValues=i.getItemForm(this.type).values,this.added(),this.$item.data("item",this),this.$item.appendTo(this.layer.getContent()),0===(this.layer.item=this).$item.children().length&&this.reRender(),s("<div></div>").addClass("n2-ss-item-overlay").css("zIndex",89).appendTo(this.$item),this.$item.find("a").on("click",function(t){t.preventDefault()}),s(window).trigger("ItemCreated")}return t.needWidth=!1,t.needHeight=!1,N2Classes.Historical(t),t.prototype.getLabel=function(){return this.type},t.prototype.hasTextScale=function(){return!0},t.prototype.changeValue=function(t,e){this===this.itemEditor.activeItem?s("#item_"+this.type+t).data("field").insideChange(e):this.values[t]=e},t.prototype.activate=function(t,e){this.itemEditor.setActiveItem(this,t,e)&&(nextend.basicCSS.activate("ss3item"+this.type,this.values,{font:this.fonts,style:this.styles}),this.itemEditor.lastValues[this.type]=this.values)},t.prototype.deActivate=function(){nextend.basicCSS.deActivate()},t.prototype.render=function(t,e){this.layer.layer.triggerHandler("itemRender"),this.$item.html(""),this.parseAll(t),this._render(t),this.itemEditor.lastValues[this.type]=this.values=e,s("<div></div>").addClass("n2-ss-item-overlay").css("zIndex",89).appendTo(this.$item),this.layer.update(),this.$item.find("a").on("click",function(t){t.preventDefault()})},t.prototype._render=function(t){},t.prototype.reRender=function(t){this.values=s.extend({},this.getDefault(),this.values,t),this.render(s.extend({},this.values),this.values)},t.prototype.delete=function(){this.$item.remove(),this.itemEditor.activeItem==this&&(this.itemEditor.activeItem=null)},t.prototype.getHTML=function(t){return t?"["+this.type+' values="'+N2Classes.Base64.encode(JSON.stringify(this.values))+'"]':s('<div class="n2-ss-item n2-ss-item-'+this.type+'"></div>').attr("data-item",this.type).attr("data-itemvalues",JSON.stringify(this.values))},t.prototype.getData=function(){return{type:this.type,values:this.values}},t.prototype.getDefault=function(){return{}},t.prototype.added=function(){},t.prototype.addedFont=function(t,e){var i=s("#item_"+this.type+e);i.length&&this.fonts.push({mode:t,name:e,field:i.data("field"),def:this.defaultValues[e]})},t.prototype.addedStyle=function(t,e){var i=s("#item_"+this.type+e);i.length&&this.styles.push({mode:t,name:e,field:i.data("field"),def:this.defaultValues[e]})},t.prototype.parseAll=function(t){for(var e=0;e<this.css.length;e++)this.css[e].destroy();this.css=[];for(e=0;e<this.fonts.length;e++)""===t[this.fonts[e].name]?t[this.fonts[e].name+"class"]=this.fonts[e].className="":(t[this.fonts[e].name+"class"]=this.fonts[e].className=N2Classes.CSSRendererFont.getClass(),this.css.push(N2Classes.CSSRendererFont.addCSS(window.nextend.pre,this.fonts[e].className,t[this.fonts[e].name],N2Classes.CSSRendererFont.rendererModes[this.fonts[e].mode])));for(e=0;e<this.styles.length;e++)""===t[this.styles[e].name]?t[this.styles[e].name+"class"]=this.styles[e].className="":(t[this.styles[e].name+"class"]=this.styles[e].className=N2Classes.CSSRendererStyle.getClass(),this.css.push(N2Classes.CSSRendererStyle.addCSS(window.nextend.pre,this.styles[e].className,t[this.styles[e].name],N2Classes.CSSRendererStyle.rendererModes[this.styles[e].mode])));for(e=0;e<this.needFill.length;e++)t[this.needFill[e]]!==n&&(t[this.needFill[e]]=this.generator.fill(t[this.needFill[e]]+""))},t.prototype.resizeLayerToImage=function(t){var o=this.layer,r=s("<img/>").attr("src",t).on("load",function(){var t,e,i,s=r[0].width,n=r[0].height;0<s&&0<n&&((e=(t=this.fragmentEditor.editor.getMainContainerElement()).width())<s&&(n=n*e/s,s=e),(i=t.height())<n&&(s=s*i/n),N2Classes.History.get().off(),o.setProperty("width",s),o.setProperty("height","auto"),N2Classes.History.get().on())}.bind(this))},t.prototype.fitLayer=function(t){return!1},t}),N2D("ItemManager",function(d,s){"use strict";function t(t,i){var e;this.suppressChange=!1,this.activeItemOriginalData=null,this.fragmentEditor=t,this.lastValues={},this.startItems(),this.forms={},this.activeForm=!1,i.isUploadDisabled||(e=d("#n2-ss-slide-canvas-container"),new N2Classes.UIFileUpload(e,{url:i.uploadUrl,pasteZone:!1,dropZone:e,dataType:"json",paramName:"image",add:function(t,e){e.formData={path:"/"+i.uploadDir},e.submit()},done:function(t,e){var i,s=e.result;s.data&&s.data.name?((i=this.createLayerItem(this.fragmentEditor.mainContainer.getTargetGroupDefault(),{item:"image"})).item.reRender({image:s.data.url}),i.item.activate()):N2Classes.AjaxHelper.notification(s)}.bind(this),fail:function(t,e){N2Classes.AjaxHelper.notification(e.jqXHR.responseJSON)},start:function(){N2Classes.LoadingScreen.startLoading()},stop:function(){setTimeout(function(){N2Classes.LoadingScreen.stopLoading()},100)}}))}return t.prototype.setActiveItem=function(t,e,i){if(t!==this.activeItem||i){this.activeItemOriginalData=null;var s=t.type;this.activeItem&&this.activeItem.deActivate(),this.activeForm=this.getItemForm(s);var n=d.extend({},this.activeForm.values,t.values);for(var o in this.activeItem=t,this.suppressChange=!0,n){var r=d("#item_"+s+o).data("field");r&&r.insideChange(n[o])}return this.suppressChange=!1,e&&this.focusFirst(),!0}return!1},t.prototype.focusFirst=function(){var t=this.activeForm.fields.eq(0).data("field");this.fragmentEditor.editor.generator.isDynamicSlide()&&t.connectedField&&t.connectedField instanceof N2Classes.FormElementImage||t.focus(!0)},t.prototype.startItems=function(){for(var t=d(".n2_add_layer_box"),e=0;e<t.length;e++)new N2Classes.UICanvasItem(t.eq(e),{canvasUIManager:this.fragmentEditor.canvasUIManager,$layer:function(){return this.element.clone()},start:function(){this.fragmentEditor.addLayer.hide()}.bind(this)});t.on("click",function(t){var e="absolute"===(t.ctrlKey||t.metaKey?"absolute":this.fragmentEditor.addLayer.getPosition())?this.fragmentEditor.mainContainer.getTargetGroupAbsolute():this.fragmentEditor.mainContainer.getTargetGroupDefault();this.createLayerItem(e,d(t.currentTarget).data(),"click"),this.fragmentEditor.addLayer.hide()}.bind(this)),d(".n2_add_layer__bar_button[data-add-layer-shortcut]").on({click:function(t){t.preventDefault(),d('.n2_add_layer_box[data-item="'+d(t.currentTarget).data("add-layer-shortcut")+'"]').trigger(t)}.bind(this),mousedown:function(t){d('.n2_add_layer_box[data-item="'+d(t.currentTarget).data("add-layer-shortcut")+'"]').trigger(t)}.bind(this)})},t.prototype.createWithDrag=function(i,s,t,e,n,o){var r,a;"absolute"===t?(r=this.fragmentEditor.mainContainer.layer[0].getBoundingClientRect(),(a=this.createLayerItem(n.layer,e.data(),"click")).layer.one("LayerCreated",function(){var t="auto"===a.layer[0].style.width,e=i.clientX-r.left;t&&(e=Math.min(e,a.group.layer.width()-a.layer.width()-5)),a.placement.current.setPosition(e,i.clientY-r.top),s.resolve()}.bind(this))):(N2Classes.History.get().startBatch(),a=this.createLayerItem(n.layer,e.data(),"click"),N2Classes.History.get().addControl("skipForwardUndos"),n.layer.container.insertLayerAt(a,o),a.changeGroup(!1,n.layer),N2Classes.History.get().endBatch(),s.resolve())},t.prototype.createLayerItem=function(t,e,i,s){var n,o,r,a,l=e.item;return l.match(/^structure-/)?((a=new N2Classes.Row(this.fragmentEditor,t,{})).create(l),a.layer.one("LayerCreated",function(){a.highlightStructure()})):(n=this.getItemForm(l),o={},"image"===l&&("slide"===t.type?o.size="100%|*|auto":o.size="auto|*|auto"),r=d("<div></div>").attr("data-item",l).data("itemvalues",d.extend(!0,{},n.values,this.getLastValues(l),o)).addClass("n2-ss-item n2-ss-item-"+l),a=this._createLayer(r,t,d.extend(d('.n2_add_layer_box[data-item="'+l+'"]').data("layerproperties"),s)),N2Classes.History.get().addSimple(this,this.historyDelete,this.historyCreate,[t,a,e])),a.layer.one("LayerCreated",function(){"click"===i?a.activate(!0):a.activate(),this.fragmentEditor.layerWindow.tab.displayTab("content")}.bind(this)),a},t.prototype.getLastValues=function(t){return this.lastValues[t]!==s?this.lastValues[t]:{}},t.prototype.getItemClass=function(t){var e="Item"+N2Classes.StringHelper.capitalize(t);return N2Classes[e]===s?"Item":e},t.prototype._createLayer=function(t,e,i){var s=this.fragmentEditor.layerOptions.layerFeatures.layerDefault;for(var n in s)null!==s[n]&&(i[n]=s[n]);var o=new N2Classes.Layer(this.fragmentEditor,e,i);return o.create(o._createLayer().append(t)),o},t.prototype.getItemForm=function(t){var e,i;return this.forms[t]===s&&((i={form:e=d('.n2_ss_layer_window__tab_panel[data-panel="item/'+t+'"]'),values:window["itemValues/"+t],fields:e.find('[name^="item_"]'),fieldNameRegexp:new RegExp("item_"+t+"\\[(.*?)\\]","")}).fields.on({nextendChange:this.updateCurrentItem.bind(this),keydown:this.updateCurrentItemDeBounced.bind(this)}),this.forms[t]=i),this.forms[t]},t.prototype.updateCurrentItem=function(t){var s,n,e;this.suppressChange||(null===this.activeItemOriginalData&&(this.activeItemOriginalData=d.extend({},this.activeItem.values)),s={},n={},this.activeForm.fields.each(function(t,e){var i=(e=d(e)).attr("name").match(this.activeForm.fieldNameRegexp)[1];n[i]=s[i]=e.val()}.bind(this)),t&&"nextendChange"===t.type&&((e=N2Classes.History.get().addValue(this,this.historyUpdateCurrentItem,[this.activeItem]))&&e.setValues(this.activeItemOriginalData,d.extend({},n)),this.activeItemOriginalData=null),this.activeItem.render(d.extend({},this.activeItem.getDefault(),s),n))},t.prototype.historyUpdateCurrentItem=function(t,e){var i=e.getSelf();i.reRender(d.extend(!0,{},t)),i.values=t,this.activeItem===i&&i.activate(!1,!0)},t.prototype.updateCurrentItemDeBounced=NextendDeBounce(function(t){this.updateCurrentItem(t)},100),t.prototype.historyDelete=function(t,e){e.getSelf().delete()},t.prototype.historyCreate=function(t,e,i){var s=this.createLayerItem(t.getSelf(),i);e.setSelf(s)},t.prototype.getSelf=function(){return this},t}),N2D("PluginShowOn",function(t,e){"use strict";function i(t){this.component=t}return i.prototype.addProperties=function(t){this.component.createProperty("desktopPortrait",1,t,this),this.component.createProperty("desktopLandscape",1,t,this),this.component.createProperty("tabletPortrait",1,t,this),this.component.createProperty("tabletLandscape",1,t,this),this.component.createProperty("mobilePortrait",1,t,this),this.component.createProperty("mobileLandscape",1,t,this)},i.prototype._syncdesktopPortrait=function(){var t=this.component.getProperty("desktopPortrait");this.component.syncShowOnDevice("desktopPortrait",t)},i.prototype._synctabletPortrait=function(){var t=this.component.getProperty("tabletPortrait");this.component.syncShowOnDevice("tabletPortrait",t)},i.prototype._syncmobilePortrait=function(){var t=this.component.getProperty("mobilePortrait");this.component.syncShowOnDevice("mobilePortrait",t)},i}),N2D("Col",["ContentAbstract"],function(i,l){"use strict";function t(t,e,i){this.label="Column",this.type="col",this.innerContainer="> .n2-ss-layer-col",this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],N2Classes.ContentAbstract.prototype.constructor.call(this,t,e,i),this.placement.allow("default")}return((t.prototype=Object.create(N2Classes.ContentAbstract.prototype)).constructor=t).getRegistryDataToFields=function(t){var e={maxwidth:i("#layercol-maxwidth"),padding:i("#layercol-padding"),inneralign:i("#layercol-inneralign"),verticalalign:i("#layercol-verticalalign"),href:i("#layercol-href"),"href-target":i("#layercol-href-target"),bgimage:i("#layercol-background-image"),bgimagex:i("#layercol-background-focus-x"),bgimagey:i("#layercol-background-focus-y"),stylemode:i("#layerfields-col-background-mode"),bgcolor:i("#layercol-background-color"),bgcolorgradient:i("#layercol-background-gradient"),bgcolorgradientend:i("#layercol-background-color-end"),borderradius:i("#layercol-border-radius"),boxshadow:i("#layercol-boxshadow"),borderwidth:i("#layercol-border-width"),borderstyle:i("#layercol-border-style"),bordercolor:i("#layercol-border-color"),opened:i("#layercol-opened"),colwidth:i("#layercol-colwidth"),order:i("#layercol-order")};return t.initStyleMode("column",e.stylemode,["#layerfields-col-border-mode"]),t.fragmentEditor.editor.generator.registerField(e.href),t.fragmentEditor.editor.generator.registerField(e.bgimage),t.fragmentEditor.editor.generator.registerField(e.bgcolor),t.fragmentEditor.editor.generator.registerField(e.bgcolorgradientend),e},t.prototype.getIcon=function(){return"ssi_16 ssi_16--column"},t.prototype._createLayer=function(){return i('<div class="n2-ss-layer"><div class="n2-ss-layer-content n2-ss-layer-col"></div></div>').attr("data-sstype",this.type)},t.prototype.addProperties=function(t){N2Classes.ContentAbstract.prototype.addProperties.call(this,t),this.createProperty("colwidth","1",t),this.createProperty("href","",t),this.createProperty("href-target","_self",t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderradius",0,{"-hover":l},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("boxshadow","0|*|0|*|0|*|0|*|00000080",{"-hover":l},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderwidth","0|*|0|*|0|*|0",{"-hover":l},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderstyle","solid",{"-hover":l},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bordercolor","ffffffff",{"-hover":l},this,"stylemode"),t),this.createDeviceProperty("order",{desktopPortrait:0},t)},t.prototype.create=function(t){N2Classes.ContentAbstract.prototype.create.apply(this,arguments),this._syncorder(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this._onReady()},t.prototype.load=function(t,e){N2Classes.ContentAbstract.prototype.load.call(this,t,e),this._syncorder(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this._onReady();var i=t.data("rowcolumns")+"";if(i!=l&&"resolved"==this.group.readyDeferred.state()){for(var s=i.split("+"),n=0;n<s.length;n++)s[n]=new Fraction(s[n]);this.group.setColsWidth(s)}},t.prototype.createRow=function(){this.$content=this.layer.find(".n2-ss-layer-content:first"),this.container=new N2Classes.LayerContainer(this),this.container.setLayerContainerElement(this.$content),this.addClassElement(this.layer),this.addClassElement(this.$content,"-inner"),this._createLayerListRow();var t=i('<div class="n2_layer_navigation_list_layer__title_label_folder" data-action="open-close"><i class="ssi_16"></i></div>').prependTo(this.$rowLabel).on("click",this.switchOpened.bind(this));nextend.tooltip.addElement(t,n2_("Open/Close")),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(this._syncopened.bind(this))},t.prototype.getPlacement=function(){return"default"},t.prototype._start=function(t){N2Classes.ContentAbstract.prototype._start.call(this,t),t&&(this.layer.addClass("n2_layer_col_highlight"),setTimeout(function(){this.isDeleted||this.layer.removeClass("n2_layer_col_highlight")}.bind(this),2e3))},t.prototype.getRealOrder=function(){var t=this.getProperty("order");return 0==t?10:t},t.prototype._syncorder=function(){var t=this.getProperty("order");0==t?this.layer.css("order",""):this.layer.css("order",2*t),this.group.refreshUI()},t.prototype._synccolwidth=function(){this.widthPercentage=100*new Fraction(this.getProperty("colwidth")).valueOf(),this.group.refreshUI()},t.prototype.getWidthPercentage=function(){return this.widthPercentage},t.prototype._synchref=t.prototype["_synchref-target"]=function(){},t.prototype._syncborderradius=t.prototype["_syncborderradius-hover"]=function(){var t=this.getProperty("borderradius");0<=t&&this.addLocalStyle("normal","borderradius","border-radius:"+t+"px;");var e=this.getProperty("borderradius-hover");e&&e!=t&&this.addLocalStyle("hover","borderradius","border-radius:"+e+"px;")},t.prototype._syncborderwidth=t.prototype._syncbordercolor=t.prototype._syncborderstyle=t.prototype["_syncborderstyle-hover"]=t.prototype["_syncbordercolor-hover"]=t.prototype["_syncborderwidth-hover"]=function(){this._syncborder()},t.prototype._syncborder=function(){var t=this.getProperty("borderstyle"),e=this.getProperty("bordercolor"),i=this.getProperty("borderwidth");this.addLocalStyle("normal","border",this.getBorderCSS(t,e,i));var s="",n=!1,o=this.getProperty("borderstyle-hover"),r=this.getProperty("bordercolor-hover"),a=this.getProperty("borderwidth-hover");o!==l&&o!=t&&(n=!0),r!==l&&r!=e&&(n=!0),a!==l&&a!=i&&(n=!0),n&&(o===l&&(o=t),r===l&&(r=e),a===l&&(a=i),s=this.getBorderCSS(o,r,a)),this.addLocalStyle("hover","border",s),this.update()},t.prototype.getBorderCSS=function(t,e,i){var s="";return"none"!==t&&(s+="border-color:"+N2Color.hex2rgbaCSS(e)+";",s+="border-style:"+t+";",s+="border-width:"+(i=i.split("|*|")).join("px ")+"px;"),s},t.prototype._syncboxshadow=t.prototype["_syncboxshadow-hover"]=function(){var t=this.getProperty("boxshadow");this.addLocalStyle("normal","boxshadow",this.getBoxShadowCSS(t.split("|*|")));var e="",i=this.getProperty("boxshadow-hover");i!==l&&i!=t&&(e=this.getBoxShadowCSS(i.split("|*|"))),this.addLocalStyle("hover","boxshadow",e)},t.prototype.getBoxShadowCSS=function(t){return 0==t[0]&&0==t[1]&&0==t[2]&&0==t[3]||0==N2Color.hex2alpha(t[4])?"":"box-shadow:"+t[0]+"px "+t[1]+"px "+t[2]+"px "+t[3]+"px "+N2Color.hex2rgbaCSS(t[4])+";"},t.prototype.delete=function(){1<this.group.container.getLayerCount()?this._delete():this.group.delete()},t.prototype.getHTML=function(t){var e=N2Classes.ContentAbstract.prototype.getHTML.call(this,t);return e.attr("data-rowcolumns",this.group.getColumns()),e},t.prototype.renderModeProperties=function(t){this._syncorder(),N2Classes.ContentAbstract.prototype.renderModeProperties.call(this,t)},t.prototype.update=function(){this.group._syncwrapafter(),N2Classes.ContentAbstract.prototype.update.call(this)},t.prototype.setPropertystylemode=function(){N2Classes.ContentAbstract.prototype.setPropertystylemode.apply(this,arguments),this.syncAdvancedField("borderradius"),this.syncAdvancedField("boxshadow"),this.syncAdvancedField("borderwidth"),this.syncAdvancedField("borderstyle"),this.syncAdvancedField("bordercolor")},t.prototype.getOrderedIndex=function(){return this.group.getOrderedColumns().indexOf(this)},t.prototype.getContextMenuItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuItems.call(this);return t.push({priority:55,label:n2_("Duplicate"),icon:"ssi_16 ssi_16--duplicate",action:this.duplicate.bind(this)}),t.push({priority:1e3,label:n2_("Delete"),icon:"ssi_16 ssi_16--delete",action:this.delete.bind(this),color:"red"}),t},t});var dependencies=["Historical","LayerDataStorage"];N2D("ComponentAbstract",dependencies,function(a,l){"use strict";var n=0;function o(t,e,i){this.supports=this.supports||[],this.supports.push("PluginShowOn"),this.isActive=!1,this.isAnimatable=!1,this.container=l,this.plugins=[];for(var s=0;s<this.supports.length;s++)this.plugins.push(new N2Classes[this.supports[s]](this));this.isRenameAllowed=this.isRenameAllowed!==l&&this.isRenameAllowed,this.contextualBarPosition=this.contextualBarPosition||"left",this.editorUI={},this.showsOnCurrent=!0,this.counter=++n,((window.layers[this.counter]=this).self=this).originalProperties=i||{},N2Classes.LayerDataStorage.prototype.constructor.call(this),this.readyDeferred=a.Deferred(),this.isDeleteStarted=!1,this.isDeleted=!1,this.$=a(this),this.proxyRefreshBaseSize=this.refreshBaseSize.bind(this),this.proxyRefreshTextAlign=this.refreshTextAlign.bind(this),this.status=o.STATUS.UNDEFINED,this.fragmentEditor=t,this.group=e,this.classElements=[],this.localStyleSyncThrottled=NextendThrottle(this.localStyleSync,50),this.placement=new N2Classes.Placement(this)}return window.layers=[],o.STATUS={UNDEFINED:0,NORMAL:1,LOCKED:2,HIDDEN:3},o.STATUS_INV={0:"UNDEFINED",1:"NORMAL",2:"LOCKED",3:"HIDDEN"},(o.prototype=Object.create(N2Classes.LayerDataStorage.prototype)).constructor=o,N2Classes.Historical(o),o.prototype.onSelfChange=function(){},o.prototype.getUILabel=function(){return this.label},o.prototype.hasUp=function(){return!1},o.prototype.up=function(t){t.stopImmediatePropagation()},o.prototype.addProperties=function(t){this.createProperty("adaptivefont",0,t),this.createDeviceProperty("fontsize",{desktopPortrait:100},t),this.callPlugin("addProperties",t)},o.prototype.callPlugin=function(t){for(var e=Array.prototype.slice.call(arguments,1),i=0;i<this.plugins.length;i++)this.plugins[i][t]!==l&&this.plugins[i][t].apply(this.plugins[i],e)},o.prototype.getSubType=function(){return""},o.prototype._hide=function(){this.layer.css("display","none"),this.showsOnCurrent=!1,this.update()},o.prototype._show=function(){parseInt(this.property[this.fragmentEditor.getMode()])&&(this.layer.css("display",""),this.showsOnCurrent=!0),this.update()},o.prototype.getRootElement=function(){return this.layer},o.prototype.create=function(t){this.addProperties(!1),this.layer=t,this.layer.addClass("n2_layer--creation-in-progress"),this.layer.data("layerObject",this),this.layer.triggerHandler("layerStarted",[this]),this.group.container.insert(this),this.group.onChildCountChange(),this.onBeforeStart(),this.$.triggerHandler("create"),this._start(!0)},o.prototype.load=function(t,e){this.addProperties(t),this.layer=t.data("layerObject",this),this.layer.triggerHandler("layerStarted",[this]),this.onBeforeStart(),this.$.triggerHandler("load"),this._start(!1);var i=t.data("status");null!==i&&i!==l?this.changeStatus(i):this.changeStatus(o.STATUS.NORMAL),e||this.regenerateUniqueClass()},o.prototype.onBeforeStart=function(){},o.prototype._start=function(t){},o.prototype.afterStart=function(t){t?this.layer.n2imagesLoaded().always(function(){this.isDeleteStarted||(this.placement.startResize(),this.layer.css("visibility",""),this.layer.triggerHandler("LayerCreated"),this.layer.removeClass("n2_layer--creation-in-progress"),document.dispatchEvent(new CustomEvent("EditorInvalidated")))}.bind(this)):(this.placement.startResize(),this.layer.css("visibility",""))},o.prototype.updateAnimations=function(){},o.prototype.createLayerAnimations=function(t,e){var i=[];if(this.container)for(var s=this.container.getSortedLayers(),n=0;n<s.length;n++)i.push.apply(i,s[n].createLayerAnimations(t,e));return i},o.prototype._onReady=function(){this.originalProperties={},this.readyDeferred.resolve()},o.prototype.isReady=function(){return"resolved"===this.readyDeferred.state()},o.prototype.getLabel=function(){return this.label},o.prototype.getName=function(){return this.getDefaultName()},o.prototype.getIcon=function(){return"ssi_16 ssi_16--layer"},o.prototype.getDefaultName=function(){return this.label},o.prototype.setGroup=function(t){this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group.$.off("textAlignUpdated.sslayer"+this.counter),(this.group=t).container.syncLayerRow(this),this.isReady()&&this.refreshBaseSize(),this.group.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),this.group.$.on("textAlignUpdated.sslayer"+this.counter,this.proxyRefreshTextAlign)},o.prototype.changeGroup=function(t,e){var i=this.group;i.$.off("baseSizeUpdated.sslayer"+this.counter),i.$.off("textAlignUpdated.sslayer"+this.counter),(this.group=e).container.syncLayerRow(this),this.refreshBaseSize(),e.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),e.$.on("textAlignUpdated.sslayer"+this.counter,this.proxyRefreshTextAlign),this.userGroupChange(i,t,e,this.getIndex()),i.update()},o.prototype.userGroupChange=function(t,e,i,s){var n;t===i?this.userIndexChange(e,s):(n=N2Classes.History.get().addValue(this,this.historyUserGroupChange,[]))&&n.setValues({historyGroup:t,index:e},{historyGroup:i,index:s})},o.prototype.historyUserGroupChange=function(t){var e=this.group,i=t.historyGroup.getSelf(),s=t.index;i.container.insertLayerAt(this,s),this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group.$.off("refreshTextAlign.sslayer"+this.counter),(this.group=i).container.syncLayerRow(this),this.refreshBaseSize(),this.group.$.on("baseSizeUpdated.sslayer"+this.counter,this.proxyRefreshBaseSize),this.group.$.on("refreshTextAlign.sslayer"+this.counter,this.proxyRefreshBaseSize),i.onChildCountChange(),e.update()},o.prototype.userIndexChange=function(t,e){var i=N2Classes.History.get().addValue(this,this.historyUserIndexChange);i&&i.setValues(t,e),this.group.container.insertLayerAt(this,e)},o.prototype.historyUserIndexChange=function(t){this.group.container.insertLayerAt(this,t)},o.prototype.getLayerListParent=function(){return this.group.container.$ul},o.prototype._createLayerListRow=function(t){this.layerRow=a('<div class="n2_layer_navigation_list_layer"></div>').attr("data-type",this.type).data("layer",this).appendTo(this.getLayerListParent()),this.$rowLabel=a('<div class="n2_layer_navigation_list_layer__title_label"></div>'),this.layerTitleSpan=a('<div class="n2_layer_navigation_list_layer__title_label_text">'+this.getName()+"</div>").appendTo(this.$rowLabel),this.layerTitle=a('<div class="n2_layer_navigation_list_layer__title"></div>').append(this.$rowLabel).appendTo(this.layerRow),this.$layerRowActions=a('<div class="n2_layer_navigation_list_layer__title_actions"></div>').appendTo(this.layerTitle),t!==l&&this.$layerRowActions.append(t),this.$layerRowMore=a('<div class="n2_layer_navigation_list_layer__title_action"><i class="ssi_16 ssi_16--more"></i></div>').on("click",function(){N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.onContextMenu(this.$layerRowMore[0],{y:6})}.bind(this)).appendTo(this.$layerRowActions),nextend.tooltip.add(this.layerRow),new N2Classes.UILayerListItem(this.layerRow,{UIManager:this.fragmentEditor.mainContainer.layerListUIManager,layer:this,$item:this.layerRow}),this.$layerRowIcon=a('<div class="n2_layer_navigation_list_layer__title_label_icon"><i class="'+this.getIcon()+'"></i></div>').prependTo(this.$rowLabel)},o.prototype.update=function(){this.readyDeferred.done(this.placement.updatePositionThrottled.bind(this.placement))},o.prototype.updateThrottled=function(){this.placement.updatePositionThrottled()},o.prototype.getHTML=function(t){var e,i=this._createLayer();for(var s in i.attr("data-pm",this.placement.getType()),this.property)"width"!=s&&"height"!=s&&"left"!=s&&"top"!=s&&i.attr("data-"+s.toLowerCase(),this.property[s]);for(var s in this.deviceProperty)for(var n in this.deviceProperty[s])i.attr("data-"+s.toLowerCase()+n,this.deviceProperty[s][n]);for(var s in this.deviceProperty.desktop)i.css(s,this.deviceProperty.desktop[s]+"px");this.container!==l&&(e=i,this.innerContainer!==l&&(e=i.find(this.innerContainer)),e.append(this.container.getHTML(t)));var o=this.getProperty("id");return""!==o&&i.attr("id",o),this.status>N2Classes.ComponentAbstract.STATUS.NORMAL&&i.attr("data-status",this.status),i},o.prototype.duplicate=function(t){var e,i=this.getHTML(!1);"absolute"===this.placement.getType()&&((e=i.attr("id"))&&(e=a.fn.uid(),i.attr("id",e),i.attr("data-id",e)),i.attr("data-parentid")?(i.data("desktopportraittop",0),i.data("desktopportraitleft",0)):(i.data("desktopportraittop",i.data("desktopportraittop")+40),i.data("desktopportraitleft",i.data("desktopportraitleft")+40)),i.attr("data-parentid",""));var s=this.fragmentEditor.insertComponentWithNode(this.group,i,this.getIndex()+1,!1,!0);return this.layerRow.trigger("mouseleave"),t&&s.activate(),N2Classes.History.get().addSimple(this,this.historyDeleteDuplicated,this.historyDuplicate,[s,!!s.container&&s.container.getAllLayers()]),s},o.prototype.historyDeleteDuplicated=function(t){t.getSelf().delete()},o.prototype.historyDuplicate=function(t,e){var i=this.duplicate(!1);if(t.setSelf(i),e)for(var s=i.container.getAllLayers(),n=0;n<s.length;n++)e[n].setSelf(s[n])},o.prototype.historyDelete=function(){this.delete()},o.prototype.historyRestore=function(t,e,i,s){var n=this.fragmentEditor.insertComponentWithNode(this.group.getSelf(),t.clone(),i,!1,!0);if(this.setSelf(n),s)for(var o=n.container.getAllLayers(),r=0;r<o.length;r++)s[r].setSelf(o[r])},o.prototype.delete=function(){N2Classes.PositionDisplay.get().hide(),nextend.tooltip.onLeave(),this._delete()},o.prototype._delete=function(){if(this.isDeleteStarted=!0,this.fragmentEditor.getActiveLayer()===this&&(N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.fragmentEditor.mainContainer.activate()),N2Classes.History.get().startBatch(),N2Classes.History.get().addSimple(this,this.historyRestore,this.historyDelete,[this.getHTML(!1),this.group,this.getIndex(),!!this.container&&this.container.getAllLayers()]),this.deActivate(),this.container!==l){N2Classes.History.get().off();for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e]._delete();N2Classes.History.get().on()}N2Classes.History.get().endBatch(),this.item!==l&&this.item.delete(),this.placement.delete(),this.layer.trigger("mouseup"),this.isDeleted=!0,this.fragmentEditor.mainContainer.layerDeleted(this),this.layer.triggerHandler("LayerDeleted"),this.getRootElement().remove(),this.layerRow.remove(),this.group.isDeleteStarted||(this.group.update(),this.group.$.off("baseSizeUpdated.sslayer"+this.counter),this.group.$.off("refreshTextAlign.sslayer"+this.counter)),this.$.trigger("layerDeleted"),delete this.layer,delete this.itemEditor,this.group.onChildCountChange()},o.prototype.getData=function(t){var e={type:this.type,pm:this.placement.getType()};this.status>N2Classes.ComponentAbstract.STATUS.NORMAL&&(e.status=this.status);var i=a.extend({},this.property);for(var s in this.deviceProperty)for(var n in this.deviceProperty[s]){delete i[n];var o=this.deviceProperty[s][n];if(o!==l){switch(n){case"width":case"height":this.isDimensionPropertyAccepted(o)||(o=parseFloat(o));break;case"fontsize":case"left":case"top":case"gutter":case"wrap":o=parseFloat(o)}e[s.toLowerCase()+n]=o}}for(var r in i)e[r.toLowerCase()]=i[r];return e},o.prototype.onChildCountChange=function(){},o.prototype.getDataWithChildren=function(t,e){return-1===e.indexOf(this)&&(e.push(this),t.push(this.getData({layersIncluded:!0,itemsIncluded:!0})),this.layer.triggerHandler("LayerGetDataWithChildren",[t,e])),t},o.prototype.markOver=function(){this.layer.addClass("n2-ss-mouse-over"),this.group&&this.group.markEnter()},o.prototype.markOut=function(){this.layer.removeClass("n2-ss-mouse-over"),this.group&&this.group.markLeave()},o.prototype.markEnter=function(t){this.layer.addClass("n2-ss-mouse-hover"),this.group.markEnter()},o.prototype.markLeave=function(t){this.layer.removeClass("n2-ss-mouse-hover"),this.group.markLeave()},o.prototype.sync=function(){if(this._syncid(),this.container)for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e].sync();this.placement.sync()},o.prototype._syncid=function(){var t=this.getProperty("id");""===t?this.layer.removeAttr("id"):this.layer.attr("id",t)},o.prototype.requestID=function(){var t=this.getProperty("id");return""===t&&(t=a.fn.uid(),this.setProperty("id",t,"layer")),t},o.prototype.requestUniqueClass=function(){var t=this.getProperty("uniqueclass");return t||(t=a.fn.generateUniqueClass("n-uc-"),N2Classes.History.get().off(),this.setProperty("uniqueclass",t,"layer"),N2Classes.History.get().on()),t},o.prototype.regenerateUniqueClass=function(){this.getProperty("uniqueclass")&&this.setProperty("uniqueclass",a.fn.generateUniqueClass("n-uc-"),"layer")},o.prototype._syncuniqueclass=function(){for(var t=this.getProperty("uniqueclass"),e=0;e<this.classElements.length;e++)this.classElements[e].$el.removeClass(function(t,e){return(e.match(/n-uc-[a-z0-9\-]+/gi)||[]).join(" ")}).addClass(t+this.classElements[e].postfix)},o.prototype.adjustFontSize=function(t){this.refreshBaseSize(),t&&this.update()},o.prototype.getFontSize=function(){return parseInt(this.getProperty("fontsize"))},o.prototype.isAdaptiveFont=function(){return parseInt(this.getProperty("adaptivefont"))},o.prototype._syncfontsize=function(){this.adjustFontSize(!0)},o.prototype._syncadaptivefont=function(){this.adjustFontSize(!0)},o.prototype.refreshBaseSize=function(){var t=this.getFontSize();this.baseSize=this.group.baseSize*t/100,this.isAdaptiveFont()?this.layer.css("font-size",this.baseSize+"px"):this.layer.css("font-size",t+"%"),this.$.triggerHandler("baseSizeUpdated")},o.prototype.refreshTextAlign=function(){this.$.triggerHandler("textAlignUpdated")},o.prototype.setPropertydesktopPortrait=o.prototype.setPropertydesktopLandscape=o.prototype.setPropertytabletPortrait=o.prototype.setPropertytabletLandscape=o.prototype.setPropertymobilePortrait=o.prototype.setPropertymobileLandscape=function(t,e,i){this._setProperty(t,parseInt(e),i)},o.prototype.formSetdesktopPortrait=function(t,e){t.currentForm.desktopPortrait.data("field").insideChange(e)},o.prototype.formSettabletPortrait=function(t,e){t.currentForm.tabletPortrait.data("field").insideChange(e)},o.prototype.formSetmobilePortrait=function(t,e){t.currentForm.mobilePortrait.data("field").insideChange(e)},o.prototype.getContents=function(){return!1},o.prototype.renderModeProperties=function(t){N2Classes.LayerDataStorage.prototype.renderModeProperties.call(this),this.placement.renderModeProperties(t)},o.prototype.getIndex=function(){return this.group.container.getLayerIndex(this.layer)},o.prototype.toString=function(){return this.type+" #"+this.counter},o.prototype.historyStoreOnPlacement=function(){var t=Array.prototype.slice.call(arguments);t.splice(1,1),this.placement.current[arguments[1]].apply(this.placement.current,t)},o.prototype.getDroppable=function(){return!1},o.prototype.onCanvasUpdate=function(t,e,i){if(this.group===e)t!==i&&this.userIndexChange(t,i);else{var s;if(this.fragmentEditor.isCol(this.group))for(s=this;s&&(!s.placement||"absolute"!==s.placement.getType());)s=s.group;this.changeGroup(t,e),e.onChildCountChange();for(var n=this;n&&(!n.placement||"absolute"!==n.placement.getType());)n=n.group;s&&s!==n&&s.placement.updatePosition(),n&&n.placement.updatePosition()}},o.prototype.toggleHideShow=function(){N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.status===N2Classes.ComponentAbstract.STATUS.HIDDEN?this.setStatusNormal():this.changeStatus(N2Classes.ComponentAbstract.STATUS.HIDDEN)},o.prototype.setStatusNormal=function(){this.changeStatus(o.STATUS.NORMAL)},o.prototype.changeStatus=function(t){var e=this.status;t===this.status&&(t=o.STATUS.NORMAL),this.status===o.STATUS.HIDDEN&&(this.getRootElement().removeAttr("data-visibility"),this.layerTitle.removeClass("n2_layer_navigation_list_layer__title--hidden")),this.status=t,this.status===o.STATUS.HIDDEN&&(this.getRootElement().attr("data-visibility","hidden"),this.layerTitle.addClass("n2_layer_navigation_list_layer__title--hidden")),this.placement.current.changeStatus(e,this.status)},o.prototype.moveX=function(t){"absolute"===this.placement.getType()&&(this.placement.current.moveX(t),this.fragmentEditor.pointerManager.refreshPosition())},o.prototype.moveY=function(t){"absolute"===this.placement.getType()&&(this.placement.current.moveY(t),this.fragmentEditor.pointerManager.refreshPosition())},o.prototype.localStyleSync=function(){if(this.localStyle!==l){var t=[],e="";this.$localStyle!==l&&(this.$localStyle.remove(),delete this.$localStyle);for(var i=0;i<this.localStyle.length;i++){var s="@rule"+this.localStyle[i].selector,n="";if(t.push(s),1!==Object.keys(this.localStyle[i].css).length||this.localStyle[i].css.transition===l){for(var o in this.localStyle[i].css)n+=this.localStyle[i].css[o];""!==n&&(e+=s+"{"+n+"}")}}var r=this.getProperty("uniqueclass");if(r)for(i=0;i<t.length;i++)nextend.css.deleteRule(t[i].replace(/@rule/g,window.nextend.pre+"."+r));""!==e&&(r=r||this.requestUniqueClass(),this.$localStyle=a("<style>"+e.replace(/@rule/g,window.nextend.pre+"."+r)+"</style>").appendTo("head"))}},o.prototype.addLocalStyle=function(t,e,i){for(var s=0;s<this.localStyle.length;s++)if(this.localStyle[s].group===t){""===i?this.localStyle[s].css[e]!==l&&delete this.localStyle[s].css[e]:this.localStyle[s].css[e]=i,this.localStyleSyncThrottled();break}},o.prototype.addClassElement=function(t,e){arguments.length<2&&(e=""),this.classElements.push({$el:t,postfix:e})},o.prototype.setState=function(t,e){},o.prototype.activate=function(t,e){t?this.fragmentEditor.layerWindow.show(this):this.fragmentEditor.layerWindow.setTitle(this),this.fragmentEditor.getActiveLayer()!==this&&(this.layerRow.addClass("n2_layer_navigation_list_layer--active"),this.layer.addClass("n2-active"),this.layer.triggerHandler("n2-ss-activate"),this.fragmentEditor.changeActiveLayer(this),this.fragmentEditor.layerNavigation.onActivateLayer(this)),this.isActive=!0},o.prototype.deActivate=function(){this.isActive=!1,this.layer===l&&console.error(),this.layer.removeClass("n2-active"),this.layerRow.removeClass("n2_layer_navigation_list_layer--active"),this.layer.triggerHandler("n2-ss-deactivate")},o.prototype.isAbsolute=function(){return"absolute"===this.placement.getType()},o.prototype.doubleClick=function(){},o.prototype.hasResponsiveTools=function(){return!1},o.prototype.onContextMenu=function(t,e){e=e||{};var i=this.getContextMenuItems();this.isActive||this.activate(),this.fragmentEditor.pointerManager.contextualBarActive.enableActiveForced(),e.onClose===l?e.onClose=this.onContextMenuBlur.bind(this):e.onClose=function(t){t.call(),this.onContextMenuBlur()}.bind(this,e.onClose),N2Classes.ContextMenu(t,i,e)},o.prototype.onContextMenuBlur=function(){this.fragmentEditor.pointerManager.contextualBarActive.disableActiveForced()},o.prototype.getContextMenuItems=function(){var t=[],e=this.getContextMenuCopySubItems(),i=this.getContextMenuPasteSubItems();if(e.length&&t.push({priority:60,label:n2_("Copy"),icon:"ssi_16 ssi_16--copy",items:e}),i.length&&t.push({priority:70,label:n2_("Paste"),icon:"ssi_16 ssi_16--paste",items:i}),this.group){for(var s={priority:50,label:n2_("Parent"),icon:"ssi_16 ssi_16--up",action:function(){this.group.activate(!0)}.bind(this),focus:function(){this.group.layer.addClass("n2_layer_context_menu_target")}.bind(this),blur:function(){this.group.layer.removeClass("n2_layer_context_menu_target")}.bind(this)},n=[],o=this.group,r=0;r<6&&o;r++)n.push({label:o.getLabel(),icon:o.getIcon(),action:function(){this.activate(!0)}.bind(o),focus:function(t){t.layer.addClass("n2_layer_context_menu_target")}.bind(this,o),blur:function(t){t.layer.removeClass("n2_layer_context_menu_target")}.bind(this,o)}),o=o.group;n.length&&(s.items=n),t.push(s)}return t},o.prototype.getContextMenuCopySubItems=function(){return[]},o.prototype.getContextMenuPasteSubItems=function(){var t=[];return this.fragmentEditor.clipboard.componentHasClipboard()&&t.push({label:n2_("Layer(s)"),icon:"ssi_16 ssi_16--layer",action:function(){this.fragmentEditor.clipboard.componentPaste(this)}.bind(this)}),t},o.prototype.syncShowOnDevice=function(t,e){this.getMode()===t&&((e=parseInt(e))?this._show():this._hide(),this.layer.triggerHandler("LayerShowChange",[t,e]),this.placement.current.triggerLayerResized())},o.prototype.triggerLayerResized=function(){if(this.container)for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e].triggerLayerResized();this.placement.current.triggerLayerResized()},o}),N2D("ComponentCommonAbstract",["ComponentAbstract"],function(d,s){"use strict";function t(t,e,i){this.supports=this.supports||[],this.isRenameAllowed=this.isRenameAllowed===s||this.isRenameAllowed,this.wraps={},this._lastClasses=!1,N2Classes.ComponentAbstract.prototype.constructor.call(this,t,e,i)}return((t.prototype=Object.create(N2Classes.ComponentAbstract.prototype)).constructor=t).getRegistryDataToFields=function(t){var e=t.fragmentEditor.editor.getAvailableDeviceModes(),i={id:d("#layerid"),uniqueclass:d("#layeruniqueclass"),desktopPortrait:d("#layershow-desktop-portrait"),tabletPortrait:d("#layershow-tablet-portrait"),mobilePortrait:d("#layershow-mobile-portrait"),zindex:d("#layerzindex"),class:d("#layerclass"),generatorvisible:d("#layergenerator-visible"),crop:d("#layercrop"),rotation:d("#layerrotation"),parallax:d("#layerparallax"),fontsize:d("#layerfont-size"),adaptivefont:d("#layeradaptive-font"),mouseenter:d("#layeronmouseenter"),click:d("#layeronclick"),mouseleave:d("#layeronmouseleave"),play:d("#layeronplay"),pause:d("#layeronpause"),stop:d("#layeronstop")};return t.fragmentEditor.editor.generator.registerField(i.class),t.fragmentEditor.editor.generator.registerField(i.generatorvisible),e.tabletPortrait||i.tabletPortrait.closest(".n2_field_radio__option").css("display","none"),e.mobilePortrait||i.mobilePortrait.closest(".n2_field_radio__option").css("display","none"),i},t.prototype.hasUp=function(){return!0},t.prototype.up=function(t){t.stopImmediatePropagation(),this.group.activate(t)},t.prototype.addProperties=function(t){this.createProperty("id","",t,this),this.createProperty("uniqueclass",null,t,this),this.createProperty("generatorvisible","",t),this.createProperty("zindex",2,t),this.createProperty("class","",t),this.createProperty("crop","visible",t),this.createProperty("rotation",0,t),this.createProperty("parallax",0,t),N2Classes.ComponentAbstract.prototype.addProperties.call(this,t)},t.prototype.onBeforeStart=function(){this.isRenameAllowed&&(this.createProperty("name",this.getName(),this.layer),this.createProperty("nameSynced",1,this.layer))},t.prototype.hasTextScale=function(){return!0},t.prototype.hasResponsiveTools=function(){return!0},t.prototype.onContextResponsiveTools=function(t,e){this.isActive||this.activate();var l=N2Classes.ContextMenu(t,[{type:"raw",render:function(t){var e,i,s,n,o,r=d('<div class="n2_layer_contextual_responsive_tools"></div>').appendTo(t),a=d('<div class="n2_layer_contextual_responsive_tools__hide"><i class="ssi_16"></i></div>').toggleClass("n2_layer_contextual_responsive_tools__hide--hidden",!this.getRawProperty(this.getMode())).appendTo(r).on("click",function(){var t=this.getMode(),e=this.getProperty(t)?0:1;this.setProperty(t,e),a.toggleClass("n2_layer_contextual_responsive_tools__hide--hidden",!e)}.bind(this));this.hasTextScale()&&(e=d('<div class="n2_layer_contextual_responsive_tools__text_scale"></div>').appendTo(r),i=this.fragmentEditor.layerOptions.currentForm.fontsize,s=this.getFontSize(),n=d("<div></div>").width(50).appendTo(e),o=d('<input type="number" min="10" max="990" step="10"/>').on("change",function(){i.val(this.value).trigger("change")}).width(26).val(s).appendTo(e),d('<div class="n2_layer_contextual_responsive_tools__text_scale_percent">%</div>').appendTo(e),new N2Classes.UISlider(n,d.extend({start:function(){this.fragmentEditor.pointerManager.disable(),l.lock()}.bind(this),stop:function(t,e){o.val(e.value).trigger("change"),this.fragmentEditor.pointerManager.enable(),l.unlock()}.bind(this),cancel:function(){this.fragmentEditor.pointerManager.enable(),l.unlock()}.bind(this),sliding:function(t,e){o.val(e.value).trigger("change")}.bind(this)},{min:30,max:120,step:10,value:s})))}.bind(this)}],{forceLtr:!0,verticalAlign:"top",onClose:function(){e!==s&&e.call()}.bind(this)})},t.prototype.getContextMenuItems=function(){var t=N2Classes.ComponentAbstract.prototype.getContextMenuItems.call(this),e={desktopPortrait:n2_("Desktop"),desktopLandscape:n2_("Large desktop"),tabletPortrait:n2_("Tablet"),tabletLandscape:n2_("Large tablet"),mobilePortrait:n2_("Mobile"),mobileLandscape:n2_("Large mobile")},i=this.fragmentEditor.editor.getAvailableDeviceModes(),s=[],n=function(e,i){return{label:i,icon:"ssi_16 ssi_16--eye",action:function(t){return t.setData(o(e,i)),this.setProperty(e,0),!1}.bind(this)}}.bind(this),o=function(e,i){return{label:i,icon:"ssi_16 ssi_16--hide",action:function(t){return t.setData(n(e,i)),this.setProperty(e,1),!1}.bind(this)}}.bind(this);for(var r in i)i[r]&&(parseInt(this.getProperty(r))?s.push(n(r,e[r])):s.push(o(r,e[r])));return t.push({priority:57,label:n2_("Hide on"),icon:"ssi_16 ssi_16--hide",items:s}),t},t.prototype.getName=function(){return!this.property.nameSynced&&this.property.name||this.getDefaultName()},t.prototype.editName=function(){this.activate(!1),new N2Classes.InlineTextEditor(this.layerTitleSpan[0],{onSave:function(t){this.rename(t,!0)}.bind(this),onCancel:function(){this.layerTitleSpan.text(this.getName())}.bind(this),onTab:function(t){for(var e=d(".n2_layer_navigation_list_layer__title_label_rename"),i=0;i<e.length;i++)if(this.$layerRowRename.is(e[i])){t.shiftKey?i--:i++;break}i<0?i=e.length-1:i>=e.length&&(i=0),e.eq(i).trigger("click")}.bind(this)})},t.prototype.rename=function(t,e){(this.property.nameSynced||e)&&(e&&(this.property.nameSynced=0),""===t&&(e&&(this.property.nameSynced=1),t=this.getDefaultName()),t=t.trim().substr(0,35),this.property.name!==t&&(this.property.name=t,this.$.trigger("layerRenamed",t)),this.layerTitleSpan.text(t),this===this.fragmentEditor.activeLayer&&this.fragmentEditor.layerWindow.setTitle(this))},t.prototype.getPlacement=function(){var t=this.layer.data("pm");return t!==s?t:"slide"===this.group.type?"absolute":"normal"},t.prototype._start=function(t){this.createRow();var e=this.layer.find("> .n2-ss-layer-mask");e.length&&(this.wraps.mask=e),this._synccrop(),this._syncrotation(),this._synczindex(),this.placement.start(),this.placement.setMode(this.getPlacement(),this.originalProperties),this.setGroup(this.group),this.fragmentEditor.$.triggerHandler("layerCreated",this),t&&(this.refreshBaseSize(),this.$.triggerHandler("created")),this.afterStart(t)},t.prototype._createLayerListRow=function(t){N2Classes.ComponentAbstract.prototype._createLayerListRow.call(this,t),this.isRenameAllowed&&(this.$layerRowRename=d('<div class="n2_layer_navigation_list_layer__title_label_rename"><i class="ssi_16 ssi_16--rename"></i></div>').on("click",function(){N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.editName()}.bind(this)).insertAfter(this.$layerRowIcon),nextend.tooltip.addElement(this.$layerRowRename,n2_("Rename"))),this.$layerRowIcon.attr("data-action","hide-show").on("click",this.toggleHideShow.bind(this)),nextend.tooltip.addElement(this.$layerRowIcon,n2_("Show/Hide in editor"))},t.prototype.changeEditorMode=function(t){parseInt(this.property[t])?this._show():this._hide(),N2Classes.LayerDataStorage.prototype.changeEditorMode.call(this,t)},t.prototype._synccrop=function(){var t=this.getProperty("crop");"auto"===t&&(t="hidden"),"mask"===t?(t="hidden",this.addWrap("mask","<div class='n2-ss-layer-mask'></div>")):(this.removeWrap("mask"),this.layer.data("animatableselector",null)),this.layer.css("overflow",t)},t.prototype._syncrotation=function(){var t,e=parseFloat(this.getProperty("rotation"));e/360!=0?(t=this.addWrap("rotation","<div class='n2-ss-layer-rotation'></div>"),NextendTween.set(t[0],{rotationZ:e})):this.removeWrap("rotation")},t.prototype._synczindex=function(){var t=parseInt(this.getProperty("zindex"));isNaN(t)||2===t?this.layer.css("zIndex",""):this.layer.css("zIndex",t)},t.prototype._syncclass=function(){!1!==this._lastClasses&&this.layer.removeClass(this._lastClasses);var t=this.fragmentEditor.editor.generator.fill(this.getProperty("class"));t&&""!=t?(this.layer.addClass(t),this._lastClasses=t):this._lastClasses=!1},t.prototype.addWrap=function(t,e){if(this.wraps[t]===s){var i=d(e);switch(this.wraps[t]=i,t){case"mask":i.appendTo(this.layer),this.wraps.rotation!==s?i.append(this.wraps.rotation):i.append(this.getContents()),this.layer.data("animatableselector",".n2-ss-layer-mask:first");break;case"rotation":this.wraps.mask!==s?i.appendTo(this.wraps.mask):i.appendTo(this.layer),i.append(this.getContents())}}return this.wraps[t]},t.prototype.removeWrap=function(t){if(this.wraps[t]!==s){switch(t){case"mask":this.wraps.rotation!==s?this.layer.append(this.wraps.rotation):this.layer.append(this.getContents());break;case"rotation":this.wraps.mask!==s?this.wraps.mask.append(this.getContents()):this.layer.append(this.getContents())}this.wraps[t].remove(),delete this.wraps[t]}},t.prototype.getContextMenuCopySubItems=function(){var t=N2Classes.ComponentAbstract.prototype.getContextMenuCopySubItems.call(this);return this.isAnimatable&&this.animations.hasAnimation()&&t.push({label:n2_("Animation"),icon:"ssi_16 ssi_16--animation",action:function(){localStorage.setItem("layerAnimationCopied",JSON.stringify(this.animations.getData()))}.bind(this)}),t},t.prototype.getContextMenuPasteSubItems=function(){var t,e=N2Classes.ComponentAbstract.prototype.getContextMenuPasteSubItems.call(this);return!this.isAnimatable||null!==(t=localStorage.getItem("layerAnimationCopied"))&&e.push({label:n2_("Animation"),icon:"ssi_16 ssi_16--animation",action:function(){this.animations.loadData(JSON.parse(t))}.bind(this)}),e},t.prototype.convertToNormal=function(){if("layer"===this.type||"row"===this.type){for(var t,e=this.fragmentEditor.mainContainer.mainContent,i=this.group;i;){if("content"===i.type||"col"===i.type){e=i;break}i=i.group}this.layer.css({position:"relative",width:"",left:"",top:""}),e!==this.group&&(t=this.getIndex(),e.container.insertLayerAt(this,0),this.onCanvasUpdate(t,e,0));var s=this.placement.setMode("normal"),n=N2Classes.History.get().addValue(this,this.historyConvertPlacement,[]);n&&n.setValues({placement:"absolute",placementData:s},{placement:"normal"})}},t.prototype.convertToAbsolute=function(){var t,e,i,s;"layer"!==this.type&&"row"!==this.type||(this.getIndex(),this.group,t=this.layer.width(),e=this.layer.height(),N2Classes.History.get().startBatch(),i=this.placement.setMode("absolute"),(s=N2Classes.History.get().addValue(this,this.historyConvertPlacement,[]))&&s.setValues({placement:"normal",placementData:i},{placement:"absolute"}),N2Classes.History.get().addControl("skipForwardUndos"),"layer"===this.type&&this.item&&(this.item.needWidth||t++,this.item.needHeight||(e="auto")),this.placement.current._setPosition("center","middle",0,0,t,e,!1),N2Classes.History.get().endBatch())},t.prototype.historyConvertPlacement=function(t){t.placementData&&this.layer.data(t.placementData),this.placement.setMode(t.placement),t.placementData&&this.placement.sync()},t}),N2D("Content",["ContentAbstract"],function(s,t){"use strict";function e(t,e,i){this.label=n2_("Content"),this.type="content",this.isRenameAllowed=!1,this.innerContainer="> .n2-ss-layer-content",this._defaults=s.extend({verticalalign:"center",selfalign:"center"},this._defaults),this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],N2Classes.ContentAbstract.prototype.constructor.call(this,t,e,i),this.placement.allow("default"),e.setMainContent(this)}return((e.prototype=Object.create(N2Classes.ContentAbstract.prototype)).constructor=e).getRegistryDataToFields=function(t){var e={maxwidth:s("#layercontent-maxwidth"),selfalign:s("#layercontent-selfalign"),padding:s("#layercontent-padding"),inneralign:s("#layercontent-inneralign"),verticalalign:s("#layercontent-verticalalign"),stylemode:s("#layerfields-content-background-mode"),bgcolor:s("#layercontent-background-color"),bgimage:s("#layercontent-background-image"),bgimagex:s("#layercontent-background-focus-x"),bgimagey:s("#layercontent-background-focus-y"),bgcolorgradient:s("#layercontent-background-gradient"),bgcolorgradientend:s("#layercontent-background-color-end"),opened:s("#layercontent-opened")};return t.initStyleMode("content",e.stylemode,[]),t.fragmentEditor.editor.generator.registerField(e.bgimage),t.fragmentEditor.editor.generator.registerField(e.bgcolor),t.fragmentEditor.editor.generator.registerField(e.bgcolorgradientend),e},e.prototype.getIcon=function(){return"ssi_16 ssi_16--content"},e.prototype.addProperties=function(t){N2Classes.ContentAbstract.prototype.addProperties.call(this,t),this.createDeviceProperty("selfalign",{desktopPortrait:this._defaults.selfalign||"inherit"},t)},e.prototype.getRootElement=function(){return this.layer},e.prototype.getBackgroundElement=function(){return this.layer},e.prototype.getPlacement=function(){return"default"},e.prototype._createLayer=function(){return s('<div class="n2-ss-layer n2-ss-content-empty"><div class="n2-ss-section-main-content n2-ss-layer-content"></div></div>').attr("data-sstype",this.type)},e.prototype.createRow=function(){this.$content=this.layer.find(".n2-ss-layer-content:first"),this.addClassElement(this.layer),this.addClassElement(this.$content,"-inner"),this.container=new N2Classes.LayerContainer(this),this.container.setLayerContainerElement(this.$content),this._createLayerListRow();var t=s('<div class="n2_layer_navigation_list_layer__title_label_folder" data-action="open-close"><i class="ssi_16"></i></div>').on("click",this.switchOpened.bind(this)).prependTo(this.$rowLabel);nextend.tooltip.addElement(t,n2_("Open/Close")),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(this._syncopened.bind(this))},e.prototype.create=function(){this.originalProperties.adaptivefont=1,N2Classes.ContentAbstract.prototype.create.call(this),this._syncselfalign(),this._onReady()},e.prototype.load=function(t,e){N2Classes.ContentAbstract.prototype.load.call(this,t,e),this._syncselfalign(),this._onReady()},e.prototype.delete=function(){for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e].delete()},e.prototype.remove=function(){this._delete()},e.prototype.update=function(){this.group.update()},e.prototype.onChildCountChange=function(){var t=this.container.getSortedLayers();this.layer.toggleClass("n2-ss-content-empty",0===t.length)},e.prototype.renderModeProperties=function(t){N2Classes.ContentAbstract.prototype.renderModeProperties.call(this,t),this._syncselfalign()},e.prototype._syncselfalign=function(){this.layer.attr("data-cssselfalign",this.getProperty("selfalign")),this.update()},e.prototype.duplicate=function(t){},e}),N2D("ContentAbstract",["LayerContainer","ComponentCommonAbstract"],function(a,f){"use strict";function t(t,e,i){this._defaults=a.extend({verticalalign:"center"},this._defaults),this._syncbgThrottled=NextendThrottle(this._syncbgThrottled,50),this.stylemode="",N2Classes.ComponentCommonAbstract.prototype.constructor.call(this,t,e,i)}return((t.prototype=Object.create(N2Classes.ComponentCommonAbstract.prototype)).constructor=t).prototype.addProperties=function(t){this.createProperty("opened",1,t,this),N2Classes.ComponentCommonAbstract.prototype.addProperties.call(this,t),this.createProperty("bgimage","",t),this.createProperty("bgimagex",50,t),this.createProperty("bgimagey",50,t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolor","00000000",{"-hover":f},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradient","off",{"-hover":f},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradientend","00000000",{"-hover":f},this,"stylemode"),t),this.createDeviceProperty("verticalalign",{desktopPortrait:this._defaults.verticalalign},t),this.createDeviceProperty("maxwidth",{desktopPortrait:0},t),this.createDeviceProperty("inneralign",{desktopPortrait:"inherit"},t),this.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10|*|px+"},t),this.$.on("baseSizeUpdated.contentAbstract",this._syncpadding.bind(this))},t.prototype.getBackgroundElement=function(){return this.$content},t.prototype.getPaddingElement=function(){return this.$content},t.prototype.create=function(t){N2Classes.ComponentCommonAbstract.prototype.create.apply(this,arguments),this.initUI(),this._syncverticalalign(),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign(),this._syncbgThrottled()},t.prototype.load=function(t,e){N2Classes.ComponentCommonAbstract.prototype.load.call(this,t,e),this.initUI(),this._syncverticalalign(),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign(),this._syncbgThrottled(),this.container.startWithExistingNodes(e)},t.prototype.initUI=function(){this.uiSpacing=new N2Classes.UISpacingPadding(this.getPaddingElement(),this.fragmentEditor,{stop:this.onSpacingStop.bind(this)}),this.editorUI.padding=this.uiSpacing.$handles,this.uiResizeNormal=new N2Classes.UIResizeNormal(this.layer,this.fragmentEditor,{start:function(t,e){"maxwidth"===e&&this.layer.attr("data-has-maxwidth","1")}.bind(this),stopMaxWidth:function(t,e){this.setProperty("maxwidth",e.value)}.bind(this)}),this.editorUI.normalSizing=this.uiResizeNormal.$handles},t.prototype.doubleClick=function(){a('[data-tab="layer"]').trigger("click")},t.prototype.onSpacingStop=function(t,e){var i=this.getPadding().split("|*|"),s=1,n=1;for(var o in"px+"===i[i.length-1]&&1<Math.abs(parseFloat(this.layer.css("fontSize"))-this.baseSize)&&(s=this.fragmentEditor.getResponsiveRatioHorizontal(),n=this.fragmentEditor.getResponsiveRatioVertical()),e.changed){var r=e.changed[o];switch(o){case"top":i[0]=Math.round(r/n);break;case"right":i[1]=Math.round(r/s);break;case"bottom":i[2]=Math.round(r/n);break;case"left":i[3]=Math.round(r/s)}}this.setProperty("padding",i.join("|*|")),a("#layercol-padding").data("field").insideChange(i.join("|*|"))},t.prototype.switchOpened=function(t){t.preventDefault(),N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")?this.setProperty("opened",1):this.setProperty("opened",0)},t.prototype._syncopened=function(){this.getProperty("opened")?(this.layerRow.removeClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened")):(this.layerRow.addClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},t.prototype.forceOpen=function(){this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")&&(this.layerRow.removeClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened"))},t.prototype.removeForceOpen=function(){this.getProperty("opened")||this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")||(this.layerRow.addClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},t.prototype.getPadding=function(){return this.getProperty("padding")},t.prototype._syncpadding=function(){var t=this.getPadding().split("|*|"),e=t.pop(),i=this.baseSize;if("px+"===e&&0<i){e="em";for(var s=0;s<t.length;s++)t[s]=parseInt(t[s])/i}var n=t.join(e+" ")+e;this.getPaddingElement().css("padding",n),this.update(),this.uiSpacing&&this.uiSpacing.setOption("current",n)},t.prototype._syncmaxwidth=function(){var t=parseInt(this.getProperty("maxwidth"));t<=0||isNaN(t)?(this.layer.css("maxWidth","").attr("data-has-maxwidth","0"),this.uiResizeNormal.setMaxWidth(-1)):(this.layer.css("maxWidth",t+"px").attr("data-has-maxwidth","1"),this.uiResizeNormal.setMaxWidth(t)),this.update()},t.prototype.getInnerAlign=function(){return this.getProperty("inneralign")},t.prototype._syncinneralign=function(){this.layer.attr("data-csstextalign",this.getInnerAlign()),this.refreshTextAlign(),this.update()},t.prototype.getVerticalAlign=function(){return this.getProperty("verticalalign")},t.prototype._syncverticalalign=function(){this.$content.attr("data-verticalalign",this.getVerticalAlign()),this.update()},t.prototype._syncbgimage=t.prototype._syncbgimagex=t.prototype._syncbgimagey=t.prototype._syncbgcolor=t.prototype._syncbgcolorgradient=t.prototype._syncbgcolorgradientend=t.prototype["_syncbgcolor-hover"]=t.prototype["_syncbgcolorgradient-hover"]=t.prototype["_syncbgcolorgradientend-hover"]=function(){this._syncbgThrottled()},t.prototype._syncbgThrottled=function(){var t,e,i="",s=this.fragmentEditor.editor.generator.fill(this.getProperty("bgimage")),n="";""!==s&&(t=parseInt(this.getProperty("bgimagex")),isFinite(t)||(t=50),e=parseInt(this.getProperty("bgimagey")),isFinite(e)||(e=50),i+='URL("'+nextend.imageHelper.fixed(s)+'") '+t+"% "+e+"% / cover no-repeat",n=" "+t+"% "+e+"% / cover no-repeat");var o=this.fragmentEditor.editor.generator.fill(this.getProperty("bgcolor")),r=this.getProperty("bgcolorgradient"),a=this.fragmentEditor.editor.generator.fill(this.getProperty("bgcolorgradientend")),l=this.getBackgroundCSS(o,r,a,i,n);this.addLocalStyle("normal","bgcolor",l);var d="",h=!1,c=this.getProperty("bgcolor-hover"),p=this.getProperty("bgcolorgradient-hover"),u=this.getProperty("bgcolorgradientend-hover");c!==f&&c!==o&&(h=!0),p!==f&&p!==r&&(h=!0),u!==f&&u!==a&&(h=!0),h&&(c===f&&(c=o),p===f&&(p=r),u===f&&(u=a),d=this.getBackgroundCSS(c,p,u,i,n)),this.addLocalStyle("hover","bgcolor",d)},t.prototype.getBackgroundCSS=function(t,e,i,s,n){if(0!==N2Color.hex2alpha(t)||"off"!==e&&0!==N2Color.hex2alpha(i)){var o=""!==s?n+","+s:"";switch(e){case"horizontal":return"background:linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"vertical":return"background:linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal1":return"background:linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal2":return"background:linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"off":default:return""!==s?"background: linear-gradient("+N2Color.hex2rgbaCSS(t)+", "+N2Color.hex2rgbaCSS(t)+")"+o+";":"background:"+N2Color.hex2rgbaCSS(t)+";"}}else if(""!==s)return"background:"+s+";";return""},t.prototype.getData=function(t){var e=N2Classes.ComponentCommonAbstract.prototype.getData.call(this,t);return t.layersIncluded&&(e.layers=this.container.getData(t)),e},t.prototype.onChildCountChange=function(){this.layer.toggleClass("n2-ss-content-empty",0===this.container.getLayerCount()),this.update()},t.prototype.renderModeProperties=function(t){N2Classes.ComponentCommonAbstract.prototype.renderModeProperties.call(this,t),this._syncverticalalign(),this._syncmaxwidth(),this._syncpadding(),this._syncinneralign()},t.prototype.getDroppable=function(){return this.layer.is(":visible")&&this.status!==N2Classes.ComponentAbstract.STATUS.HIDDEN?{$container:this.$content,layer:this,placement:"normal",axis:"y"}:"hidden"},t.prototype.getLLDroppable=function(t){if(this.getProperty("opened")){if("absolute"===t.placement.getType())return{$container:this.container.$ul,layer:this};if("normal"===t.placement.getType())switch(t.type){case"layer":case"row":return{$container:this.container.$ul,layer:this}}}return!1},t.prototype.getContents=function(){return this.$content},t.prototype.setPropertystylemode=function(t,e,i){this.stylemode=e,this.syncAdvancedField("bgcolor"),this.syncAdvancedField("bgcolorgradient"),this.syncAdvancedField("bgcolorgradientend")},t.prototype.onSyncFields=function(){this.fragmentEditor.layerOptions.updateField("stylemode",this.stylemode)},t.prototype.getContextMenuCopySubItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuCopySubItems.call(this);return t.push({label:n2_("Child layers"),icon:"ssi_16 ssi_16--layer",action:function(){this.fragmentEditor.clipboard.componentCopy(this)}.bind(this)}),t},t}),N2D("Layer",["ComponentCommonAbstract"],function(t,e){"use strict";function i(t,e,i){this.label=n2_("Layer"),this.type="layer",this.item=null,this.parent=!1,this.itemEditor=t.itemEditor,N2Classes.ComponentCommonAbstract.prototype.constructor.call(this,t,e,i),this.placement.allow("normal"),this.placement.allow("absolute")}return((i.prototype=Object.create(N2Classes.ComponentCommonAbstract.prototype)).constructor=i).prototype.getSubType=function(){return this.item.type},i.prototype.getLabel=function(){return this.item.getLabel()},i.prototype.hasTextScale=function(){return this.item.hasTextScale()},i.prototype.create=function(){N2Classes.ComponentCommonAbstract.prototype.create.apply(this,arguments),this._onReady()},i.prototype.load=function(t,e){N2Classes.ComponentCommonAbstract.prototype.load.call(this,t,e),this._onReady()},i.prototype.onBeforeStart=function(){var t=this.layer.find(".n2-ss-item");new(N2Classes[this.itemEditor.getItemClass(t.data("item"))])(t,this,this.itemEditor),new N2Classes.UICanvasItem(this.layer,{canvasUIManager:this.fragmentEditor.canvasUIManager,layer:this,$layer:this.layer}),this.item.needWidth&&this.layer.addClass("n2-ss-layer--need-width"),this.item.needHeight&&this.layer.addClass("n2-ss-layer--need-height"),N2Classes.ComponentCommonAbstract.prototype.onBeforeStart.call(this)},i.prototype.doubleClick=function(){t('[data-related-tab="content"]').trigger("click"),this.item.itemEditor.focusFirst()},i.prototype.getDefaultName=function(){return this.item.getLabel()},i.prototype.getContent=function(){var t=this.layer,e=t.data("animatableselector");return e&&(t=t.find(e)),t},i.prototype._createLayer=function(){return t('<div class="n2-ss-layer"></div>').attr("data-sstype",this.type)},i.prototype.createRow=function(){this._createLayerListRow()},i.prototype.activate=function(t,e){N2Classes.ComponentCommonAbstract.prototype.activate.call(this,t,e),this.item?this.item.activate(e):console.error("The layer do not have item on it!")},i.prototype.getHTML=function(t){var e=N2Classes.ComponentCommonAbstract.prototype.getHTML.call(this,t),i=this.item.getHTML(t);return e.attr("style",e.attr("style")+this.getStyleText()).append(i),e},i.prototype.getData=function(t){var e=N2Classes.ComponentCommonAbstract.prototype.getData.call(this,t);return t.itemsIncluded&&(e.item=this.item.getData()),e},i.prototype.getStyleText=function(){var t="",e=this.property.crop;return"auto"!==e&&"mask"!==e||(e="hidden"),t+="overflow:"+e+";"},i.prototype.getContents=function(){return this.item.$item},i.prototype.onSelfChange=function(){N2Classes.ComponentCommonAbstract.prototype.onSelfChange.call(this),this.item.setSelf(this.self.item)},i.prototype.getContextMenuItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuItems.call(this);return t.push({priority:55,label:n2_("Duplicate"),icon:"ssi_16 ssi_16--duplicate",action:this.duplicate.bind(this)}),t.push({priority:1e3,label:n2_("Delete"),icon:"ssi_16 ssi_16--delete",action:this.delete.bind(this),color:"red"}),t},i.prototype.getContextMenuCopySubItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuCopySubItems.call(this);return t.unshift({label:n2_("Layer"),icon:"ssi_16 ssi_16--layer",action:function(){this.fragmentEditor.clipboard.componentCopy(this)}.bind(this)}),t},i}),N2D("LayerAdvancedProperty",function(t,e){"use strict";function i(t,e,i,s,n){this.basename=t,this.def=e,this.modesDef=i,this.obj=s,this.propName=n}return i.prototype.getBaseName=function(){return this.basename},i.prototype.getNames=function(){var t={};for(var e in t[this.basename]=this.def,this.modesDef)t[this.basename+e]=this.modesDef[e];return t},i.prototype.getCurrentMode=function(){return this.obj[this.propName]},i.prototype.getName=function(){var t=this.getCurrentMode();return""!==t?this.basename+t:this.basename},i.prototype.getDefault=function(){var t=this.getCurrentMode();return""!==t?this.modesDef[t]:this.def},i.prototype.resetMode=function(t){var e,i;this.propName!==t||""!==(e=this.getCurrentMode())&&(i=this.obj.property[this.basename+e],this.obj.property[this.basename+e]=this.modesDef[e],this.obj.syncAdvancedField(this.basename),this.obj.render(this.basename+e,i,"manager"))},i}),N2D("Row",["LayerContainer","ComponentCommonAbstract"],function(a,f){"use strict";function t(t,e,i){this.label=n2_("Row"),this.type="row",this._syncbgThrottled=NextendThrottle(this._syncbgThrottled,50),this.innerContainer="> .n2-ss-layer-row > .n2-ss-layer-row-inner",this.localStyle=[{group:"normal",selector:"-inner",css:{transition:"transition:all .3s;transition-property:border,background-image,background-color,border-radius,box-shadow;"}},{group:"hover",selector:"-inner:HOVER",css:{}}],this.columnsField=a("#layerrow-columns").data("field"),this.refreshUI=NextendDeBounce(this.refreshUI,100),this.stylemode="",N2Classes.ComponentCommonAbstract.prototype.constructor.call(this,t,e,i),this.placement.allow("normal"),this.placement.allow("absolute")}return((t.prototype=Object.create(N2Classes.ComponentCommonAbstract.prototype)).constructor=t).getRegistryDataToFields=function(t){var e={padding:a("#layerrow-padding"),gutter:a("#layerrow-gutter"),fullwidth:a("#layerrow-fullwidth"),stretch:a("#layerrow-stretch"),wrapafter:a("#layerrow-wrap-after"),inneralign:a("#layerrow-inneralign"),href:a("#layerrow-href"),"href-target":a("#layerrow-href-target"),bgimage:a("#layerrow-background-image"),bgimagex:a("#layerrow-background-focus-x"),bgimagey:a("#layerrow-background-focus-y"),stylemode:a("#layerfields-row-background-mode"),bgcolor:a("#layerrow-background-color"),bgcolorgradient:a("#layerrow-background-gradient"),bgcolorgradientend:a("#layerrow-background-color-end"),borderwidth:a("#layerrow-border-width"),borderstyle:a("#layerrow-border-style"),bordercolor:a("#layerrow-border-color"),borderradius:a("#layerrow-border-radius"),boxshadow:a("#layerrow-boxshadow"),opened:a("#layerrow-opened")};return t.initStyleMode("row",e.stylemode,["#layerfields-row-border-mode"]),t.fragmentEditor.editor.generator.registerField(e.href),t.fragmentEditor.editor.generator.registerField(e.bgimage),t.fragmentEditor.editor.generator.registerField(e.bgcolor),t.fragmentEditor.editor.generator.registerField(e.bgcolorgradientend),e},t.prototype.getIcon=function(){return"ssi_16 ssi_16--row"},t.prototype.addProperties=function(t){this.createProperty("opened",1,t,this),N2Classes.ComponentCommonAbstract.prototype.addProperties.call(this,t),this.createProperty("href","",t),this.createProperty("href-target","_self",t),this.createProperty("bgimage","",t),this.createProperty("bgimagex",50,t),this.createProperty("bgimagey",50,t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolor","00000000",{"-hover":f},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradient","off",{"-hover":f},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bgcolorgradientend","00000000",{"-hover":f},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderwidth","0|*|0|*|0|*|0",{"-hover":f},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderstyle","solid",{"-hover":f},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("bordercolor","ffffffff",{"-hover":f},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("borderradius",0,{"-hover":f},this,"stylemode"),t),this.createAdvancedProperty(new N2Classes.LayerAdvancedProperty("boxshadow","0|*|0|*|0|*|0|*|00000080",{"-hover":f},this,"stylemode"),t),this.createProperty("fullwidth",1,t),this.createProperty("stretch",0,t),this.createDeviceProperty("inneralign",{desktopPortrait:"inherit"},t),this.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10|*|px+"},t),this.createDeviceProperty("gutter",{desktopPortrait:20},t),this.createDeviceProperty("wrapafter",{desktopPortrait:0,mobilePortrait:1,mobileLandscape:1},t),this.$.on("baseSizeUpdated.row",this._syncpadding.bind(this))},t.prototype.historyDeleteSelf=function(){this.delete()},t.prototype.historyCreateSelf=function(t,e,i){var s=new N2Classes.Row(this.fragmentEditor,t.getSelf(),{});s.create(e),this.setSelf(s);for(var n=s.container.getSortedLayers(),o=0;o<n.length;o++)i[o].setSelf(n[o])},t.prototype.create=function(t){function e(t){return a("<div class='n2-ss-layer'></div>").append(a("<div class='n2-ss-layer-row'></div>").append(a("<div class='n2-ss-layer-row-inner'></div>").append(t))).attr("data-sstype","row")}function i(t){return a("<div class='n2-ss-layer' data-sstype='col'></div>").append(a("<div class='n2-ss-layer-col n2-ss-layer-content'></div>").append(t))}var s;switch(t){case"structure-2col":s=e([i(),i()]);break;case"structure-3col":s=e([i(),i(),i()]);break;case"structure-1col":default:s=e([i()])}"slide"===this.group.type&&(this.originalProperties=a.extend({width:"100%",align:"center",valign:"top",top:20},this.originalProperties)),N2Classes.ComponentCommonAbstract.prototype.create.call(this,s),this.initUI(),this.container.startWithExistingNodes(!1),this._syncpadding(),this._syncinneralign(),this._syncfullwidth(),this._syncstretch(),this._syncbgThrottled(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this.renderModeProperties(),this.container.renderModeProperties(),N2Classes.History.get().addSimple(this,this.historyDeleteSelf,this.historyCreateSelf,[this.group,t,this.container.getSortedLayers()]),this._onReady()},t.prototype.load=function(t,e){N2Classes.ComponentCommonAbstract.prototype.load.call(this,t,e),this.initUI(),this.container.startWithExistingNodes(e),this._syncpadding(),this._syncinneralign(),this._syncfullwidth(),this._syncstretch(),this._syncbgThrottled(),this._syncborder(),this._syncborderradius(),this._syncboxshadow(),this._onReady()},t.prototype.initUI=function(){new N2Classes.UICanvasItem(this.layer,{canvasUIManager:this.fragmentEditor.canvasUIManager,layer:this,$layer:this.layer}),this.uiSpacing=new N2Classes.UISpacingPadding(this.$row,this.fragmentEditor,{stop:this.____makeLayerResizeableStop.bind(this)}),this.editorUI.padding=this.uiSpacing.$handles,this.editorUI.columns=this.uiColumns=new N2Classes.UIColumns(this.$row,this.fragmentEditor,{columns:"1",gutter:this.getGutter(),start:function(t,e){N2Classes.PositionDisplay.get().show("Columns")}.bind(this),colwidth:function(t,e){this.updateColumnWidth(e.currentPercent),N2Classes.PositionDisplay.get().update(t,"Columns",Math.round(100*e.currentPercent[e.index])+"% &mdash; "+Math.round(100*e.currentPercent[e.index+1])+"%")}.bind(this),stop:function(t,e){N2Classes.PositionDisplay.get().hide("Columns"),this.setRealColsWidth(e.currentFractions)}.bind(this)})},t.prototype.doubleClick=function(){a('[data-tab="row"]').trigger("click")},t.prototype.____makeLayerResizeableStop=function(t,e){var i=this.getPadding().split("|*|"),s=1,n=1;for(var o in"px+"==i[i.length-1]&&1<Math.abs(parseFloat(this.layer.css("fontSize"))-this.baseSize)&&(s=this.fragmentEditor.getResponsiveRatioHorizontal(),n=this.fragmentEditor.getResponsiveRatioVertical()),e.changed){var r=e.changed[o];switch(o){case"top":i[0]=Math.round(r/n);break;case"right":i[1]=Math.round(r/s);break;case"bottom":i[2]=Math.round(r/n);break;case"left":i[3]=Math.round(r/s)}}this.setProperty("padding",i.join("|*|")),a("#layerrow-padding").data("field").insideChange(i.join("|*|"))},t.prototype._createLayer=function(){return a('<div class="n2-ss-layer"><div class="n2-ss-layer-row"><div class="n2-ss-layer-row-inner"></div></div></div>').attr("data-sstype",this.type)},t.prototype.historyDeleteCol=function(t,e){e.getSelf().delete()},t.prototype.historyCreateCol=function(t,e){var i=t.getSelf().createCol();e.setSelf(i)},t.prototype.createCol=function(){var t=new N2Classes.Col(this.fragmentEditor,this,{});return N2Classes.History.get().addSimple(this,this.historyDeleteCol,this.historyCreateCol,[this,t]),t.create(t._createLayer()),this.isReady()&&this.placement.updatePosition(),t},t.prototype.createRow=function(){this.$row=this.layer.find(".n2-ss-layer-row:first"),this.$rowInner=this.$row.find(".n2-ss-layer-row-inner:first"),0===this.$rowInner.length&&(this.$rowInner=a('<div class="n2-ss-layer-row-inner"></div>').append(this.$row.find("> *")).appendTo(this.$row)),this.container=new N2Classes.LayerContainer(this),this.container.setLayerContainerElement(this.$rowInner),this.addClassElement(this.layer),this.addClassElement(this.$row,"-inner"),this._createLayerListRow();var t=a('<div class="n2_layer_navigation_list_layer__title_label_folder" data-action="open-close"><i class="ssi_16"></i></div>').prependTo(this.$rowLabel).on("click",this.switchOpened.bind(this));nextend.tooltip.addElement(t,n2_("Open/Close")),this.container.$ul.appendTo(this.layerRow),this.readyDeferred.done(this._syncopened.bind(this))},t.prototype.activate=function(){N2Classes.ComponentCommonAbstract.prototype.activate.apply(this,arguments),this.columnsField.setRow(this),this.uiColumns.setOption("active",1)},t.prototype.deActivate=function(){this.uiColumns.setOption("active",0),N2Classes.ComponentCommonAbstract.prototype.deActivate.apply(this,arguments)},t.prototype.switchOpened=function(t){t.preventDefault(),N2Classes.WindowManager.actionPrevent("ComponentRowActivate"),this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")?this.setProperty("opened",1):this.setProperty("opened",0)},t.prototype._syncopened=function(){this.getProperty("opened")?(this.layerRow.removeClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened")):(this.layerRow.addClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},t.prototype.forceOpen=function(){this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")&&(this.layerRow.removeClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display",""),this.layer.triggerHandler("opened"))},t.prototype.removeForceOpen=function(){this.getProperty("opened")||this.layerRow.hasClass("n2_layer_navigation_list_layer--closed")||(this.layerRow.addClass("n2_layer_navigation_list_layer--closed"),this.container.$ul.css("display","none"),this.layer.triggerHandler("closed"))},t.prototype.getSortedColumns=function(){for(var t=this.container.getSortedLayers(),e=[],i=0;i<t.length;i++)t[i]instanceof N2Classes.Col&&e.push(t[i]);return e},t.prototype.getColumns=function(){for(var t=this.getSortedColumns(),e=[],i=0;i<t.length;i++)e.push(t[i].getProperty("colwidth"));return e.join("+")},t.prototype.getColumnsOrdered=function(){for(var t=this.getOrderedColumns(),e=[],i=0;i<t.length;i++)e.push(t[i].getProperty("colwidth"));return e.join("+")},t.prototype._synccolumns=function(){for(var t=this.getSortedColumns(),e=0;e<t.length;e++)t[e]._synccolwidth();this.update()},t.prototype.getPadding=function(){return this.getProperty("padding")},t.prototype._syncpadding=function(){var t=this.getPadding().split("|*|"),e=t.pop(),i=this.baseSize;if("px+"===e&&0<i){e="em";for(var s=0;s<t.length;s++)t[s]=parseInt(t[s])/i}var n=t.join(e+" ")+e;this.$row.css("padding",n),this.uiSpacing&&this.uiSpacing.setOption("current",n),this.update()},t.prototype.getGutter=function(){return this.getProperty("gutter")},t.prototype._syncgutter=function(){var t=this.getGutter(),e=t/2,i=this.getSortedColumns();if(0<i.length)for(var s=i.length-1;0<=s;s--)i[s].layer.css("margin",e+"px");this.$rowInner.css({width:"calc(100% + "+(t+1)+"px)",margin:-e+"px"}),this.uiColumns.setOption("gutter",this.getGutter()),this._syncwrapafter(),this.update()},t.prototype._syncwrapafter=function(){if(!this.isDeleted&&!this.isDeleteStarted){var t=parseInt(this.getProperty("wrapafter")),e=this.getOrderedColumns(),i=!1;for(o=e.length-1;0<=o;o--)e[o].showsOnCurrent||e.splice(o,1);var s=e.length;if(0<t&&t<s&&(i=!0),this.$row.attr("row-wrapped",i?1:0),i){for(var n=[],o=0;o<s;o++){var r=Math.floor(o/t);n[r]===f&&(n[r]=[]),n[r].push(e[o]),e[o].layer.attr("data-r",r).toggleClass("n2-ss-last-in-row",(o+1)%t==0||o===s-1)}var a=this.getGutter();for(o=0;o<n.length;o++){for(var l=n[o],d=0,h=0;h<l.length;h++)d+=l[h].getWidthPercentage();for(h=0;h<l.length;h++)l[h].layer.css("width","calc("+l[h].getWidthPercentage()/d*100+"% - "+(n2const.isIE||n2const.isEdge?a+1:a)+"px)")}}else{d=0;for(o=0;o<s;o++)d+=e[o].getWidthPercentage();for(o=0;o<s;o++)e[o].layer.css("width",e[o].getWidthPercentage()/d*100+"%").removeClass("n2-ss-last-in-row").attr("data-r",0);0<s&&e[s-1].layer.addClass("n2-ss-last-in-row")}this.update()}},t.prototype.getOrderedColumns=function(){return this.getSortedColumns().sort(function(t,e){return t.getRealOrder()-e.getRealOrder()})},t.prototype.getInnerAlign=function(){return this.getProperty("inneralign")},t.prototype._syncinneralign=function(){this.layer.attr("data-csstextalign",this.getInnerAlign()),this.refreshTextAlign()},t.prototype._syncfullwidth=function(){this.layer.attr("data-frontend-fullwidth",0==this.getProperty("fullwidth")?"0":"1"),this.update()},t.prototype._syncstretch=function(){this.layer.toggleClass("n2-ss-stretch-layer",1==this.getProperty("stretch"))},t.prototype._syncborderwidth=t.prototype._syncbordercolor=t.prototype._syncborderstyle=t.prototype["_syncborderstyle-hover"]=t.prototype["_syncbordercolor-hover"]=t.prototype["_syncborderwidth-hover"]=function(){this._syncborder()},t.prototype._syncborder=function(){var t=this.getProperty("borderstyle"),e=this.getProperty("bordercolor"),i=this.getProperty("borderwidth");this.addLocalStyle("normal","border",this.getBorderCSS(t,e,i));var s="",n=!1,o=this.getProperty("borderstyle-hover"),r=this.getProperty("bordercolor-hover"),a=this.getProperty("borderwidth-hover");o!==f&&o!=t&&(n=!0),r!==f&&r!=e&&(n=!0),a!==f&&a!=i&&(n=!0),n&&(o===f&&(o=t),r===f&&(r=e),a===f&&(a=i),s=this.getBorderCSS(o,r,a)),this.addLocalStyle("hover","border",s),this.update()},t.prototype.getBorderCSS=function(t,e,i){var s="";return"none"!==t&&(s+="border-color:"+N2Color.hex2rgbaCSS(e)+";",s+="border-style:"+t+";",s+="border-width:"+(i=i.split("|*|")).join("px ")+"px;"),s},t.prototype._syncborderradius=t.prototype["_syncborderradius-hover"]=function(){var t=this.getProperty("borderradius");0<=t&&this.addLocalStyle("normal","borderradius","border-radius:"+t+"px;");var e=this.getProperty("borderradius-hover");e&&e!=t&&this.addLocalStyle("hover","borderradius","border-radius:"+e+"px;")},t.prototype._syncboxshadow=t.prototype["_syncboxshadow-hover"]=function(){var t=this.getProperty("boxshadow");this.addLocalStyle("normal","boxshadow",this.getBoxShadowCSS(t.split("|*|")));var e="",i=this.getProperty("boxshadow-hover");i!==f&&i!=t&&(e=this.getBoxShadowCSS(i.split("|*|"))),this.addLocalStyle("hover","boxshadow",e)},t.prototype.getBoxShadowCSS=function(t){return 0==t[0]&&0==t[1]&&0==t[2]&&0==t[3]||0==N2Color.hex2alpha(t[4])?"":"box-shadow:"+t[0]+"px "+t[1]+"px "+t[2]+"px "+t[3]+"px "+N2Color.hex2rgbaCSS(t[4])+";"},t.prototype._synchref=t.prototype["_synchref-target"]=function(){},t.prototype._syncbgimage=t.prototype._syncbgimagex=t.prototype._syncbgimagey=t.prototype._syncbgcolor=t.prototype._syncbgcolorgradient=t.prototype._syncbgcolorgradientend=t.prototype["_syncbgcolor-hover"]=t.prototype["_syncbgcolorgradient-hover"]=t.prototype["_syncbgcolorgradientend-hover"]=function(){this._syncbgThrottled()},t.prototype._syncbgThrottled=function(){var t,e,i="",s=this.fragmentEditor.editor.generator.fill(this.getProperty("bgimage")),n="";""!=s&&(t=parseInt(this.getProperty("bgimagex")),isFinite(t)||(t=50),e=parseInt(this.getProperty("bgimagey")),isFinite(e)||(e=50),i+='URL("'+nextend.imageHelper.fixed(s)+'") '+t+"% "+e+"% / cover no-repeat",n=" "+t+"% "+e+"% / cover no-repeat");var o=this.fragmentEditor.editor.generator.fill(this.getProperty("bgcolor")),r=this.getProperty("bgcolorgradient"),a=this.fragmentEditor.editor.generator.fill(this.getProperty("bgcolorgradientend")),l=this.getBackgroundCSS(o,r,a,i,n);this.addLocalStyle("normal","bgcolor",l);var d="",h=!1,c=this.getProperty("bgcolor-hover"),p=this.getProperty("bgcolorgradient-hover"),u=this.getProperty("bgcolorgradientend-hover");c!==f&&c!=o&&(h=!0),p!==f&&p!=r&&(h=!0),u!==f&&u!=a&&(h=!0),h&&(c===f&&(c=o),p===f&&(p=r),u===f&&(u=a),d=this.getBackgroundCSS(c,p,u,i,n)),this.addLocalStyle("hover","bgcolor",d)},t.prototype.getBackgroundCSS=function(t,e,i,s,n){if(0!==N2Color.hex2alpha(t)||"off"!==e&&0!==N2Color.hex2alpha(i)){var o=""!==s?n+","+s:"";switch(e){case"horizontal":return"background:linear-gradient(to right, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"vertical":return"background:linear-gradient(to bottom, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal1":return"background:linear-gradient(45deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"diagonal2":return"background:linear-gradient(135deg, "+N2Color.hex2rgbaCSS(t)+" 0%,"+N2Color.hex2rgbaCSS(i)+" 100%)"+o+";";case"off":default:return""!==s?"background: linear-gradient("+N2Color.hex2rgbaCSS(t)+", "+N2Color.hex2rgbaCSS(t)+")"+o+";":"background:"+N2Color.hex2rgbaCSS(t)+";"}}else if(""!==s)return"background:"+s+";";return""},t.prototype.getData=function(t){var e=N2Classes.ComponentCommonAbstract.prototype.getData.call(this,t);return t.itemsIncluded&&(e.cols=this.container.getData(t)),e},t.prototype.moveCol=function(t,e){this._moveCol(t,e);var i=N2Classes.History.get().addValue(this,this.historyMoveCol,[]);i&&i.setValues({oldIndex:e,newIndex:t},{oldIndex:t,newIndex:e})},t.prototype.moveColOrOrder=function(t,e){for(var i,s,n=this.container.getSortedLayers(),o=this.getSortedColumns(),r=o[t],a=o[e],l=0;l<n.length;l++)if(n[l]===r){i=l;break}for(l=0;l<n.length;l++)if(n[l]===a){s=l;break}if("desktopPortrait"===this.getMode())this.moveCol(i,s);else{var d=this.getOrderedColumns(),h=d[i];for(d.splice(i,1),d.splice(s,0,h),l=0;l<d.length;l++)d[l].setProperty("order",l+1);this.refreshUI()}},t.prototype._moveCol=function(t,e){var i=this.container.getSortedLayers();this.container.insertLayerAt(i[t],e),this.refreshUI()},t.prototype.historyMoveCol=function(t){this._moveCol(t.oldIndex,t.newIndex)},t.prototype.setColsWidth=function(t){for(var e=this.getSortedColumns(),i=0;i<t.length;i++)e[i].setProperty("colwidth",t[i].toFraction());this._syncwrapafter(),this.update(),this.refreshUI()},t.prototype.setRealColsWidth=function(t){for(var e=this.getOrderedColumns(),i=0;i<t.length;i++)e[i].setProperty("colwidth",t[i].toFraction());this._syncwrapafter(),this.update(),this.refreshUI()},t.prototype.updateColumnWidth=function(t){var e=parseInt(this.getProperty("wrapafter")),i=this.getOrderedColumns();for(o=i.length-1;0<=o;o--)i[o].showsOnCurrent||(i.splice(o,1),t.splice(o,1));var s=i.length;if(0<e&&e<s){for(var n=[],o=0;o<s;o++){var r=Math.floor(o/e);n[r]===f&&(n[r]=[]),i[o]._tempWidth=t[o],n[r].push(i[o])}var a=this.getGutter();for(o=0;o<n.length;o++){for(var l=n[o],d=0,h=0;h<l.length;h++)d+=l[h]._tempWidth;for(h=0;h<l.length;h++)l[h].layer.css("width","calc("+l[h]._tempWidth/d*100+"% - "+(n2const.isIE||n2const.isEdge?a+1:a)+"px)")}}else for(o=0;o<s;o++)i[o].layer.css("width",100*t[o]+"%");this.update()},t.prototype.activateColumn=function(t,e){this.container.getSortedLayers()[t].activate(e)},t.prototype.onChildCountChange=function(){if(!this.isDeleted&&!this.isDeleteStarted){var t=this.getSortedColumns(),e=t.length;if(e){for(var i=this.getColumns().split("+"),s=0,n=0;n<i.length;n++)s=new Fraction(i[n]).add(s);if(1!=s.valueOf())for(n=0;n<e;n++)t[n].setProperty("colwidth","1/"+e);else for(n=0;n<e;n++)t[n]._synccolwidth();this.refreshUI()}this._syncgutter()}},t.prototype.renderModeProperties=function(t){N2Classes.ComponentCommonAbstract.prototype.renderModeProperties.call(this,t),this._syncpadding(),this._syncinneralign(),this._syncgutter(),this.isActive&&this.columnsField.setRow(this)},t.prototype.highlightStructure=function(t){t=t||4e3,this.isStructureHighlighted&&(clearTimeout(this.isStructureHighlighted),this.isStructureHighlighted=!1);var e=this.getSortedColumns();this.layer.addClass("n2_layer_highlight_row_structure");for(var i=0;i<e.length;i++)e[i].layer.addClass("n2_layer_highlight_row_structure");this.isStructureHighlighted=setTimeout(function(){if(!this.isDeleted){this.layer.removeClass("n2_layer_highlight_row_structure");for(var t=0;t<e.length;t++)e[t].isDeleted||e[t].layer.removeClass("n2_layer_highlight_row_structure")}}.bind(this),t)},t.prototype.refreshUI=function(){this.isDeleteStarted||(this.isActive&&this.columnsField.setRow(this),this._syncwrapafter(),this.uiColumns.setOption("columns",this.getColumnsOrdered()))},t.prototype.getLLDroppable=function(t){if(this.getProperty("opened")){if("absolute"===t.placement.getType())return{$container:this.container.$ul,layer:this};if("col"===t.type)if(t.group===this)return{$container:this.container.$ul,layer:this}}return!1},t.prototype.getContents=function(){return this.$row},t.prototype.setPropertystylemode=function(t,e,i){this.stylemode=e,this.syncAdvancedField("bgcolor"),this.syncAdvancedField("bgcolorgradient"),this.syncAdvancedField("bgcolorgradientend"),this.syncAdvancedField("borderradius"),this.syncAdvancedField("boxshadow"),this.syncAdvancedField("borderwidth"),this.syncAdvancedField("borderstyle"),this.syncAdvancedField("bordercolor")},t.prototype.onSyncFields=function(){this.fragmentEditor.layerOptions.updateField("stylemode",this.stylemode)},t.prototype.getContextMenuItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuItems.call(this);return t.push({priority:55,label:n2_("Duplicate"),icon:"ssi_16 ssi_16--duplicate",action:this.duplicate.bind(this)}),t.push({priority:1e3,label:n2_("Delete"),icon:"ssi_16 ssi_16--delete",action:this.delete.bind(this),color:"red"}),t},t.prototype.getContextMenuCopySubItems=function(){var t=N2Classes.ComponentCommonAbstract.prototype.getContextMenuCopySubItems.call(this);return t.unshift({label:this.label,icon:"ssi_16 ssi_16--layer",action:function(){this.fragmentEditor.clipboard.componentCopy(this)}.bind(this)}),t},t}),N2D("SectionSlide",["LayerContainer","ComponentAbstract"],function(r,l){"use strict";function s(t){this.label=n2_("Slide"),this.type="slide",this.contextualBarPosition="center",this.baseSize=16,this.$=t.$,this.isMainGroup=!0,N2Classes.ComponentAbstract.prototype.constructor.call(this,t,!1),this.placement.allow("default"),this.layer=this.fragmentEditor.editor.getMainContainerElement().find('.n2-ss-layer[data-sstype="slide"]'),this.layerListUIManager=new N2Classes.UILayerList(this.layer,{mainContainer:this,$scrolled:r(".n2_layer_navigation_list")})}return((s.prototype=Object.create(N2Classes.ComponentAbstract.prototype)).constructor=s).prototype.getPaddingElement=function(){return this.layer},s.prototype.lateInit=function(){this.load(this.layer,!0),this.getProperty("static-slide")||(this.slideBackground=this.fragmentEditor.editor.getSlideBackground(),this.slideBackground.setRelatedSectionSlide(this))},s.getRegistryDataToFields=function(t){t.fragmentEditor.editor.getAvailableDeviceModes();for(var e={title:r("#layerslide-title"),publish_up:r("#layerslide-publish_up"),publish_down:r("#layerslide-publish_down"),published:r("#layerslide-published"),description:r("#layerslide-description"),thumbnail:r("#layerslide-thumbnail"),"record-slides":r("#layerslide-slide-generator-slides"),thumbnailType:r("#layerslide-thumbnailType"),ligthboxImage:r("#layerslide-ligthboxImage"),"background-type":r("#layerslide-background-type"),backgroundImage:r("#layerslide-backgroundImage"),backgroundFocusX:r("#layerslide-backgroundFocusX"),backgroundFocusY:r("#layerslide-backgroundFocusY"),backgroundImageOpacity:r("#layerslide-backgroundImageOpacity"),backgroundImageBlur:r("#layerslide-backgroundImageBlur"),backgroundAlt:r("#layerslide-backgroundAlt"),backgroundTitle:r("#layerslide-backgroundTitle"),backgroundColor:r("#layerslide-backgroundColor"),backgroundGradient:r("#layerslide-backgroundGradient"),backgroundColorEnd:r("#layerslide-backgroundColorEnd"),backgroundColorOverlay:r("#layerslide-backgroundColorOverlay"),backgroundMode:r("#layerslide-backgroundMode"),href:r("#layerslide-href"),"href-target":r("#layerslide-href-target"),"slide-duration":r("#layerslide-slide-duration"),padding:r("#layerslide-padding")},i=0;i<s.externalDataToField.length;i++)e[s.externalDataToField[i].name]=r("#"+s.externalDataToField[i].id);return t.fragmentEditor.editor.generator.registerField(e.title),t.fragmentEditor.editor.generator.registerField(e.description),t.fragmentEditor.editor.generator.registerField(e.thumbnail),t.fragmentEditor.editor.generator.registerField(e.backgroundImage),t.fragmentEditor.editor.generator.registerField(e.backgroundFocusX),t.fragmentEditor.editor.generator.registerField(e.backgroundFocusY),t.fragmentEditor.editor.generator.registerField(e.backgroundAlt),t.fragmentEditor.editor.generator.registerField(e.backgroundTitle),t.fragmentEditor.editor.generator.registerField(e.backgroundColor),t.fragmentEditor.editor.generator.registerField(e.backgroundColorEnd),t.fragmentEditor.editor.generator.registerField(e.href),t.fragmentEditor.editor.generator.registerField(e.backgroundVideoMp4),e},s.externalDataToField=[],s.addExternalDataToField=function(t){s.externalDataToField.push.apply(s.externalDataToField,t)},s.prototype.getIcon=function(){return"ssi_16 ssi_16--image"},s.prototype.addProperties=function(t){this.createProperty("title",n2_("Slide"),t),this.createProperty("publish_up","0000-00-00 00:00:00",t),this.createProperty("publish_down","0000-00-00 00:00:00",t),this.createProperty("published",1,t),this.createProperty("description","",t),this.createProperty("record-slides",5,t),this.createProperty("thumbnail","",t),this.createProperty("thumbnailType","default",t),this.createProperty("static-slide",0,t),this.createProperty("slide-duration",0,t),this.createProperty("ligthboxImage","",t);for(var e=0;e<s.externalDataToField.length;e++)this.createProperty(s.externalDataToField[e].name,s.externalDataToField[e].def,t);N2Classes.ComponentAbstract.prototype.addProperties.call(this,t),this.createProperty("href","",t),this.createProperty("href-target","",t),this.createProperty("background-type","color",t),this.createProperty("backgroundColor","ffffff00",t),this.createProperty("backgroundGradient","off",t),this.createProperty("backgroundColorEnd","ffffff00",t),this.createProperty("backgroundColorOverlay",0,t),this.createProperty("backgroundImage","",t),this.createProperty("backgroundFocusX",50,t),this.createProperty("backgroundFocusY",50,t),this.createProperty("backgroundImageOpacity",100,t),this.createProperty("backgroundImageBlur",0,t),this.createProperty("backgroundAlt","",t),this.createProperty("backgroundTitle","",t),this.createProperty("backgroundMode","default",t),this.createDeviceProperty("padding",{desktopPortrait:"10|*|10|*|10|*|10"},t),this.$.on("baseSizeUpdated.contentAbstract",this._syncpadding.bind(this))},s.prototype.load=function(t,e){N2Classes.ComponentAbstract.prototype.load.call(this,t,e),this.initUI(),this._syncpadding(),this.container.startWithExistingNodes(e),this._onReady()},s.prototype.onSpacingStop=function(t,e){var i=this.getPadding().split("|*|");for(var s in e.changed){var n=e.changed[s];switch(s){case"top":i[0]=Math.round(n);break;case"right":i[1]=Math.round(n);break;case"bottom":i[2]=Math.round(n);break;case"left":i[3]=Math.round(n)}}this.setProperty("padding",i.join("|*|")),r("#layerslide-padding").data("field").insideChange(i.join("|*|"))},s.prototype.initUI=function(){this.uiSpacing=new N2Classes.UISpacingPadding(this.getPaddingElement(),this.fragmentEditor,{stop:this.onSpacingStop.bind(this)}),this.editorUI.padding=this.uiSpacing.$handles},s.prototype.createRow=function(){this.container=new N2Classes.LayerContainer(this),this._createLayerListRow(),this.container.$ul.appendTo(this.layerRow)},s.prototype._start=function(t){this.createRow(),this.placement.start(),this.placement.setMode("default",this.originalProperties),this.setGroup(this.group),this.fragmentEditor.$.triggerHandler("layerCreated",this),t&&this.$.triggerHandler("created"),this.afterStart(t)},s.prototype.changeEditorMode=function(t){N2Classes.LayerDataStorage.prototype.changeEditorMode.call(this,t),this.container.changeEditorModes(t)},s.prototype.getLayerListParent=function(){return r(".n2_layer_navigation_list_layers")},s.prototype.setGroup=function(t){},s.prototype["_syncbackground-type"]=function(){this.slideBackground.setType(this.getProperty("background-type"))},s.prototype._syncbackgroundColor=s.prototype.syncBackgroundColor=function(){var t,e=nextend.currentEditor.generator.fill(this.getProperty("backgroundColor")),i=this.getProperty("backgroundGradient");"off"!==i&&(t=this.getProperty("backgroundColorEnd")),this.slideBackground.updateColor(e,i,t,this.getProperty("backgroundColorOverlay"))},s.prototype._syncbackgroundGradient=s.prototype.syncBackgroundColor,s.prototype._syncbackgroundColorEnd=s.prototype.syncBackgroundColor,s.prototype._syncbackgroundColorOverlay=s.prototype.syncBackgroundColor,s.prototype._syncbackgroundImage=function(t,e){var i=this.getProperty("backgroundImage");this.slideBackground.setImage(nextend.currentEditor.generator.fill(i)),this.slideBackground.setThumbnail(i,t)},s.prototype._syncbackgroundFocusX=s.prototype.syncBackgroundFocus=function(){this.slideBackground.setFocus(nextend.currentEditor.generator.fill(this.getProperty("backgroundFocusX")),nextend.currentEditor.generator.fill(this.getProperty("backgroundFocusY")))},s.prototype._syncbackgroundFocusY=s.prototype.syncBackgroundFocus,s.prototype._syncbackgroundImageOpacity=function(){this.slideBackground.setImageOpacity(this.getProperty("backgroundImageOpacity"))},s.prototype._syncbackgroundImageBlur=function(){this.slideBackground.setBlur(this.getProperty("backgroundImageBlur"))},s.prototype._syncbackgroundMode=function(){this.slideBackground.setMode(this.getProperty("backgroundMode"))},s.prototype.getPadding=function(){return this.getProperty("padding")},s.prototype._syncpadding=function(){var t=this.getPadding().split("|*|").join("px ")+"px";this.getPaddingElement().css("padding",t),this.update(),this.uiSpacing&&this.uiSpacing.setOption("current",t)},s.prototype.syncShowOnDevice=function(t,e){},s.prototype.renderModeProperties=function(t){N2Classes.ComponentCommonAbstract.prototype.renderModeProperties.call(this,t),this._syncpadding()},s.prototype.getData=function(t){var e,i={type:this.type},s=r.extend({},this.property);for(var n in this.deviceProperty)for(e in this.deviceProperty[n]){delete s[e];var o=this.deviceProperty[n][e];o!==l&&(i[n.toLowerCase()+e]=o)}for(e in s)switch(e){case"desktopPortrait":case"desktopLandscape":case"tabletPortrait":case"tabletLandscape":case"mobilePortrait":case"mobileLandscape":i[e.toLowerCase()]=s[e];break;default:i[e]=s[e]}return i.layers=this.container.getData(t),i},s.prototype.getSectionData=function(t){var e,i,s,n={type:this.type},o=["background-type","backgroundAlt","backgroundColor","backgroundColorEnd","backgroundColorOverlay","backgroundFocusX","backgroundFocusY","backgroundGradient","backgroundImage","backgroundImageBlur","backgroundImageOpacity","backgroundMode","backgroundTitle","backgroundVideoLoop","backgroundVideoMode","backgroundVideoMp4","backgroundVideoMuted","backgroundVideoReset","backgroundVideoOpacity","href","href-target"],r=["padding"];for(var a in this.deviceProperty)for(e=0;e<r.length;e++)i=r[e],(s=this.deviceProperty[a][i])!==l&&(n[a.toLowerCase()+i]=s);for(e=0;e<o.length;e++)i=o[e],(s=this.property[i])!==l&&(n[i]=s);return n.layers=this.container.getData(t),n},s.prototype.getLLDroppable=function(t){if("absolute"===t.placement.getType()||"content"===t.type)switch(t.type){case"layer":case"row":case"content":return{$container:this.container.$ul,layer:this}}return!1},s.prototype.update=function(){},s.prototype.onChildCountChange=function(){},s.prototype.markEnter=function(t){},s.prototype.markLeave=function(t){},s.prototype.getSelf=function(){return this},s.prototype.getLLDroppables=function(t){return this.container.getLLDroppables(t)},s.prototype.getDroppables=function(t,e){return"absolute"===t?[this.getDroppable()]:this.container.getDroppables(e)},s.prototype.getDroppable=function(){return{$container:this.layer,layer:this,placement:"absolute"}},s.prototype.refreshBaseSize=function(){this.baseSize=16,this.layer.css("font-size","100%"),this.$.triggerHandler("baseSizeUpdated")},s.prototype.onResize=function(t){for(var e=this.getEverySortedLayers(),i=0;i<e.length;i++)e[i].placement.doLinearResize(t)},s.prototype.getEverySortedLayers=function(){for(var t=this.container.getChildLayersRecursive(!1),e={},i=t.length-1;0<=i;i--)t[i].property.parentid!==l&&t[i].property.parentid&&(e[t[i].property.parentid]===l&&(e[t[i].property.parentid]=[]),e[t[i].property.parentid].push(t[i]),t.splice(i,1));for(i=0;i<t.length;i++)t[i].property.id!==l&&t[i].property.id&&e[t[i].property.id]!==l&&(e[t[i].property.id].unshift(0),e[t[i].property.id].unshift(i+1),t.splice.apply(t,e[t[i].property.id]),delete e[t[i].property.id]);return t},s.prototype.getTargetGroupDefault=function(){var t=this.mainContent,e=this.fragmentEditor.getActiveLayer();return this.fragmentEditor.isCol(e)||this.fragmentEditor.isContent(e)?t=e:this.fragmentEditor.isRow(e)?t=e.container.getSortedLayers()[0]:"normal"===e.placement.getType()&&(t=e.group),t},s.prototype.getTargetGroupAbsolute=function(){return this},s.prototype.setMainContent=function(t){this.mainContent=t},s.prototype.layerDeleted=function(t){this._afterLayerDeletedDeBounced(t)},s.prototype._afterLayerDeletedDeBounced=NextendDeBounce(function(t){var e=this.fragmentEditor.getActiveLayer();e&&!e.isDeleted||this.fragmentEditor.resetActiveLayer()},50),s.prototype.delete=function(){for(var t=this.container.getSortedLayers(),e=0;e<t.length;e++)t[e].delete()},s.prototype.duplicate=function(){},s.prototype.isAbsolute=function(){return!1},s.prototype.getContextMenuCopySubItems=function(){var t=N2Classes.ComponentAbstract.prototype.getContextMenuCopySubItems.call(this);return t.push({label:n2_("Slide"),icon:"ssi_16 ssi_16--image",action:function(){this.fragmentEditor.clipboard.sectionCopy()}.bind(this)}),t},s.prototype.getContextMenuPasteSubItems=function(){var t=N2Classes.ComponentAbstract.prototype.getContextMenuPasteSubItems.call(this);return this.fragmentEditor.clipboard.sectionHasClipboard()&&t.unshift({label:n2_("Slide"),icon:"ssi_16 ssi_16--image",action:function(){this.fragmentEditor.clipboard.sectionPaste()}.bind(this)}),t},s.prototype.update=function(){this.fragmentEditor.editor.getMainContainerElement().triggerHandler("updateSize")},s}),N2D("ComponentSettings",function(a,s){"use strict";function t(t){this.fragmentEditor=t,this.componentType=s,this.placementType=s,a("html").attr("data-component","").attr("data-placement",""),this.currentForm={},this.forms={undefined:null,placement:{absolute:N2Classes.PlacementAbsolute.getRegistryDataToFields(this),normal:N2Classes.PlacementNormal.getRegistryDataToFields(this),default:{}},component:{slide:N2Classes.SectionSlide.getRegistryDataToFields(this),content:N2Classes.Content.getRegistryDataToFields(this),row:N2Classes.Row.getRegistryDataToFields(this),col:N2Classes.Col.getRegistryDataToFields(this),layer:{}},global:N2Classes.ComponentCommonAbstract.getRegistryDataToFields(this)};var e=a("#layerposition-default").data("field");e.element.on("outsideChange",function(){e.insideChange("default"),this.currentLayer.convertToAbsolute()}.bind(this));var i=a("#layerposition-absolute").data("field");i.element.on("outsideChange",function(){i.insideChange("absolute"),this.currentLayer.convertToNormal()}.bind(this))}return t.prototype.initStyleMode=function(t,i,e){for(var s=[],n=a('.n2_ss_layer_window__tab_panel[data-panel="'+t+'"] .n2_fields_layer_window[data-fieldset-type="style-mode"]').attr("data-state",""),o=0;o<e.length;o++)s.push(a(e[o]).data("field"));for(var r=0;r<s.length;r++)s[r].element.on("outsideChange",function(t){i.data("field").select.val(t.val()).trigger("change")}.bind(this,s[r].element));i.on("nextendChange",function(){var t=i.val();n.attr("data-state",t);for(var e=0;e<s.length;e++)t!==s[e].element.val()&&s[e].insideChange(t)}.bind(this)),n.find('.n2_form__table_label_field[data-style-mode-feature="reset-to-normal"] a').on("click",function(t){t.preventDefault(),this.resetStyleMode("stylemode")}.bind(this))},t.prototype.changeActiveComponent=function(t,e,i,s,n){var o=this.fragmentEditor.layerWindow.tab;switch(this.currentLayer&&"slide"===this.currentLayer.type&&o.displayTab("content"),this.currentLayer=t,a("html").attr("data-component",e).attr("data-component-sub",i),e){case"slide":o.setPanel(["slide"],["content","style"]),o.displayTab("style");break;case"content":o.setPanel(["content","common"],["content","style","animations"]);break;case"row":o.setPanel(["row","common"],["content","style","animations"]);break;case"col":o.setPanel(["column","common"],["content","style","animations"]);break;case"layer":o.setPanel(["item/"+t.item.type,"item","common"],["content","style","animations"])}this.componentType=e,this.changeActiveComponentPlacement(s),this.syncFields(n)},t.prototype.changeActiveComponentPlacement=function(t,e){a("html").attr("data-placement",t),this.placementType=t,this.syncFields(e)},t.prototype.syncFields=function(t){if("object"==typeof t){for(var e in this.currentForm=a.extend({},this.forms.global,this.forms.component[this.componentType],this.forms.placement[this.placementType]),t)t[e]!==s&&this.updateField(e,t[e]);for(var i in this.currentLayer.onSyncFields(),this.currentForm)this.currentForm[i].off(".layeroptions").on("outsideChange.layeroptions",this.activeComponentPropertyChanged.bind(this,i))}},t.prototype.onUpdateField=function(t,e,i){t.target===this.currentLayer&&this.updateField(e,i)},t.prototype.updateField=function(t,e){var i;"function"==typeof this.currentLayer["formSet"+t]?this.currentLayer["formSet"+t](this,e):this.currentForm[t]===s||(i=this.currentForm[t].data("field"))!==s&&i.insideChange(e)},t.prototype.activeComponentPropertyChanged=function(t,e){var i;this.currentLayer&&!this.currentLayer.isDeleted?this.updateLayerProperty(t):(i=this.currentForm[t].data("field"))!==s&&null!==i&&i.insideChange("")},t.prototype.updateLayerProperty=function(t){var e=this.currentForm[t].val();this.currentLayer.setProperty(t,e,"manager")},t.prototype.startFeatures=function(){this.layerFeatures=new N2Classes.LayerFeatures(this.forms.placement.absolute,this.fragmentEditor)},t.prototype.resetStyleMode=function(t,e){this.currentLayer.resetStyleMode(t)},t}),N2D("ItemButton",["Item"],function(s,t){"use strict";function e(){this.type="button",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Button")},e.prototype.added=function(){this.needFill=["content","class"],this.addedFont("link","font"),this.addedStyle("button","style"),this.generator.registerFields(["#item_buttoncontent","#item_buttonhref","#item_buttonclass"])},e.prototype.parseAll=function(t){t.classes="",parseInt(t.fullwidth)&&(t.classes+=" n2-ss-fullwidth"),parseInt(t.nowrap)&&(t.classes+=" n2-ss-nowrap"),N2Classes.Item.prototype.parseAll.apply(this,arguments)},e.prototype._render=function(t){var e=s('<div class="n2-ss-button-container n2-ow '+t.fontclass+" "+t.classes+'"></div>'),i=s('<a href="#" onclick="return false;" class="'+t.styleclass+" "+t.class+' n2-ow"></a>').appendTo(e);s("<div><div>"+t.content+"</div></div>").appendTo(i);this.$item.append(e)},e}),N2D("ItemHeading",["Item"],function(s,t){"use strict";function e(){this.type="heading",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Heading")},e.prototype.getDefault=function(){return{href:"",font:"",style:""}},e.prototype.added=function(){this.needFill=["heading","class"],this.addedFont("hover","font"),this.addedStyle("heading","style"),this.generator.registerFields(["#item_headingheading","#item_headinghref","#item_headingclass"])},e.prototype.parseAll=function(t){t.uid=s.fn.uid(),parseInt(t.fullwidth)?t.display="block":t.display="inline-block",t.extrastyle=parseInt(t.nowrap)?"white-space: nowrap;":"",t.heading=s("<div>"+t.heading+"</div>").text().replace(/\n/g,"<br />"),t.priority=2,t.class="",N2Classes.Item.prototype.parseAll.apply(this,arguments),"#"==t.href||""==t.href?(t.afontclass="",t.astyleclass=""):(t.afontclass=t.fontclass,t.fontclass="",t.astyleclass=t.styleclass,t.styleclass="")},e.prototype._render=function(t){var e=s('<div class="n2-ow"></div>'),i=s('<div id="'+t.uid+'" style="'+t.extrastyle+'"></div>').addClass("n2-ow "+t.fontclass+" "+t.styleclass+" "+t.class).css({display:t.display}).appendTo(e);"#"==t.href||""==t.href?i.html(t.heading):i.append(s('<a style="display:'+t.display+';" href="#" class="'+t.afontclass+" "+t.astyleclass+' n2-ow" onclick="return false;">'+t.heading+"</a>")),this.$item.append(e)},e}),N2D("ItemImage",["Item"],function(s,t){"use strict";function e(){this.type="image",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Image")},e.prototype.hasTextScale=function(){return!1},e.prototype.getDefault=function(){return{size:"auto|*|auto",href:"",style:""}},e.prototype.added=function(){this.needFill=["image","cssclass"],this.generator.registerFields(["#item_imageimage","#item_imagealt","#item_imagetitle","#item_imagehref","#item_imagecssclass"])},e.prototype.parseAll=function(t){var e=t.size.split("|*|");t.width=e[0],t.height=e[1],delete t.size,N2Classes.Item.prototype.parseAll.apply(this,arguments),t.image!==this.fragmentEditor.editor.generator.fill(this.values.image)?(t.image=nextend.imageHelper.fixed(t.image),"absolute"===this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(t.image))):t.image=nextend.imageHelper.fixed(t.image)},e.prototype.fitLayer=function(){return"absolute"===this.layer.placement.getType()&&this.resizeLayerToImage(nextend.imageHelper.fixed(this.values.image)),!0},e.prototype._render=function(t){t.styleclass="";var e=s('<div class="'+t.styleclass+' n2-ss-img-wrapper n2-ss-img-crop n2-ow"></div>'),i=e;"#"!==t.href&&""!==t.href&&(i=s('<a href="#" class="n2-ow" onclick="return false;" style="display: block;background: none !important;"></a>').appendTo(e)),s('<img class="n2-ow '+t.cssclass+'" src="'+t.image+'"/>').css({display:"inline-block",maxWidth:"100%",width:t.width,height:t.height}).appendTo(i),this.$item.append(e)},e}),N2D("ItemText",["Item"],function(n,t){"use strict";function e(){this.type="text",N2Classes.Item.prototype.constructor.apply(this,arguments)}function i(t){var e=!1,i=!1,s="table|thead|tfoot|caption|col|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|form|map|area|blockquote|address|math|style|p|h[1-6]|hr|fieldset|legend|section|article|aside|hgroup|header|footer|nav|figure|figcaption|details|menu|summary";return-1===(t=t.replace(/\r\n|\r/g,"\n")+"\n").indexOf("\n")||(-1!==t.indexOf("<object")&&(t=t.replace(/<object[\s\S]+?<\/object>/g,function(t){return t.replace(/\n+/g,"")})),-1===(t=t.replace(/<[^<>]+>/g,function(t){return t.replace(/[\n\t ]+/g," ")})).indexOf("<pre")&&-1===t.indexOf("<script")||(e=!0,t=t.replace(/<(pre|script)[^>]*>[\s\S]*?<\/\1>/g,function(t){return t.replace(/\n/g,"<wp-line-break>")})),-1!==t.indexOf("<figcaption")&&(t=(t=t.replace(/\s*(<figcaption[^>]*>)/g,"$1")).replace(/<\/figcaption>\s*/g,"</figcaption>")),-1!==t.indexOf("[caption")&&(i=!0,t=t.replace(/\[caption[\s\S]+?\[\/caption\]/g,function(t){return(t=(t=t.replace(/<br([^>]*)>/g,"<wp-temp-br$1>")).replace(/<[^<>]+>/g,function(t){return t.replace(/[\n\t ]+/," ")})).replace(/\s*\n\s*/g,"<wp-temp-br />")})),t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t+="\n\n").replace(/<br \/>\s*<br \/>/gi,"\n\n")).replace(new RegExp("(<(?:"+s+")(?: [^>]*)?>)","gi"),"\n\n$1")).replace(new RegExp("(</(?:"+s+")>)","gi"),"$1\n\n")).replace(/<hr( [^>]*)?>/gi,"<hr$1>\n\n")).replace(/\s*<option/gi,"<option")).replace(/<\/option>\s*/gi,"</option>")).replace(/\n\s*\n+/g,"\n\n")).replace(/([\s\S]+?)\n\n/g,"<p>$1</p>\n")).replace(/<p>\s*?<\/p>/gi,"")).replace(new RegExp("<p>\\s*(</?(?:"+s+")(?: [^>]*)?>)\\s*</p>","gi"),"$1")).replace(/<p>(<li.+?)<\/p>/gi,"$1")).replace(/<p>\s*<blockquote([^>]*)>/gi,"<blockquote$1><p>")).replace(/<\/blockquote>\s*<\/p>/gi,"</p></blockquote>")).replace(new RegExp("<p>\\s*(</?(?:"+s+")(?: [^>]*)?>)","gi"),"$1")).replace(new RegExp("(</?(?:"+s+")(?: [^>]*)?>)\\s*</p>","gi"),"$1")).replace(/(<br[^>]*>)\s*\n/gi,"$1")).replace(/\s*\n/g,"<br />\n")).replace(new RegExp("(</?(?:"+s+")[^>]*>)\\s*<br />","gi"),"$1")).replace(/<br \/>(\s*<\/?(?:p|li|div|dl|dd|dt|th|pre|td|ul|ol)>)/gi,"$1")).replace(/(?:<p>|<br ?\/?>)*\s*\[caption([^\[]+)\[\/caption\]\s*(?:<\/p>|<br ?\/?>)*/gi,"[caption$1[/caption]")).replace(/(<(?:div|th|td|form|fieldset|dd)[^>]*>)(.*?)<\/p>/g,function(t,e,i){return i.match(/<p( [^>]*)?>/)?t:e+"<p>"+i+"</p>"}),e&&(t=t.replace(/<wp-line-break>/g,"\n")),i&&(t=t.replace(/<wp-temp-br([^>]*)>/g,"<br$1>"))),t}return((e.prototype=Object.create(N2Classes.Item.prototype)).constructor=e).prototype.getLabel=function(){return n2_("Text")},e.prototype.getDefault=function(){return{content:"","content-mobile-enabled":0,contentmobile:"","content-tablet-enabled":0,contenttablet:"",font:"",style:""}},e.prototype.added=function(){this.needFill=["content","contenttablet","contentmobile"],this.addedFont("paragraph","font"),this.addedStyle("heading","style"),this.generator.registerFields(["#item_textcontent","#item_textcontenttablet","#item_textcontentmobile"])},e.prototype.parseAll=function(t){N2Classes.Item.prototype.parseAll.apply(this,arguments),t.p=i(t.content),t.ptablet=i(t.contenttablet),t.pmobile=i(t.contentmobile)},e.prototype._render=function(t){var e,i=!1,s=!1;1===parseInt(t["content-mobile-enabled"])&&(i=!0,n('<div class="n2-ss-hide-desktopportrait n2-ss-hide-desktoplandscape n2-ss-hide-tabletportrait n2-ss-hide-tabletlandscape n2-ow n2-ow-all">'+t.pmobile+"</div>").appendTo(this.$item)),1===parseInt(t["content-tablet-enabled"])&&(s=!0,e=["n2-ss-hide-desktopportrait","n2-ss-hide-desktoplandscape"],i?(e.push("n2-ss-hide-mobileportrait"),e.push("n2-ss-hide-mobilelandscape")):i=!0,n('<div class="'+e.join(" ")+' n2-ow n2-ow-all">'+t.ptablet+"</div>").appendTo(this.$item)),e=[],i&&(e.push("n2-ss-hide-mobileportrait"),e.push("n2-ss-hide-mobilelandscape")),s&&(e.push("n2-ss-hide-tabletportrait"),e.push("n2-ss-hide-tabletlandscape")),n('<div class="'+e.join(" ")+' n2-ow n2-ow-all">'+t.p+"</div>").appendTo(this.$item),this.$item.find("p").addClass(t.fontclass+" "+t.styleclass)},e}),N2D("ItemVimeo",["Item"],function(n,s){"use strict";function t(){this.type="vimeo",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.Item.prototype)).constructor=t).needWidth=!0,t.prototype.getLabel=function(){return"Vimeo"},t.prototype.hasTextScale=function(){return!1},t.prototype.added=function(){this.needFill=["vimeourl"],this.generator.registerField("#item_vimeovimeourl")},t.prototype.parseAll=function(e){var t,i,s=this.values.vimeourl!=e.vimeourl;N2Classes.Item.prototype.parseAll.apply(this,arguments),""==e.image&&(e.image="$ss3-frontend$/images/placeholder/video.png"),e.image=nextend.imageHelper.fixed(e.image),s&&""!=e.vimeourl&&(i=!/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,(t=e.vimeourl.match(/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/))?i=t[3]:e.vimeourl.match(/^[0-9]+$/)&&(i=e.vimeourl),i?N2Classes.AjaxHelper.getJSON("https://vimeo.com/api/v2/video/"+encodeURI(i)+".json").done(function(t){n("#item_vimeoimage").val(t[0].thumbnail_large).trigger("change")}.bind(this)).fail(function(t){0==e.privateurl&&N2Classes.Notification.error("Video not found or private.")}):N2Classes.Notification.error("The provided URL does not match any known Vimeo url or code."))},t.prototype._render=function(t){var e="";"custom"===t["aspect-ratio"]&&(e="padding-top:"+t["aspect-ratio-height"]/t["aspect-ratio-width"]*100+"%");var i=n('<div class="n2_ss_video_player n2-ow-all"><div class="n2_ss_video_player__placeholder" style="'+e+'"></div></div>').attr("data-aspect-ratio",t["aspect-ratio"]).css({background:"url("+t.image+") no-repeat 50% 50%",backgroundSize:"cover"});!parseInt(t.playbutton)&&t.playbutton!==s||n('<div class="n2_ss_video_player__cover"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48Y2lyY2xlIGN4PSIyNCIgY3k9IjI0IiByPSIyNCIgZmlsbD0iIzAwMCIgb3BhY2l0eT0iLjYiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMTkuOCAzMmMtLjEyNCAwLS4yNDctLjAyOC0uMzYtLjA4LS4yNjQtLjExNi0uNDM2LS4zNzUtLjQ0LS42NjRWMTYuNzQ0Yy4wMDUtLjI5LjE3Ni0uNTUuNDQtLjY2Ni4yNzMtLjEyNi41OTItLjEuODQuMDdsMTAuNCA3LjI1N2MuMi4xMzIuMzIuMzU1LjMyLjU5NXMtLjEyLjQ2My0uMzIuNTk1bC0xMC40IDcuMjU2Yy0uMTQuMS0uMzEuMTUtLjQ4LjE1eiIvPjwvZz48L3N2Zz4=" /></div>').appendTo(i),this.$item.append(i)},t.prototype.fitLayer=function(){return!0},t}),N2D("ItemYoutube",["Item"],function(n,s){"use strict";function t(){this.type="youtube",N2Classes.Item.prototype.constructor.apply(this,arguments)}return((t.prototype=Object.create(N2Classes.Item.prototype)).constructor=t).needWidth=!0,t.prototype.getLabel=function(){return"YouTube"},t.prototype.hasTextScale=function(){return!1},t.prototype.added=function(){this.needFill=["youtubeurl","image","start"],this.generator.registerFields(["#item_youtubeyoutubeurl","#item_youtubeimage","#item_youtubestart"])},t.prototype.parseAll=function(t){var e,i,s=this.values.youtubeurl!==t.youtubeurl;N2Classes.Item.prototype.parseAll.apply(this,arguments),""===t.image&&(t.image="$ss3-frontend$/images/placeholder/video.png"),t.image=nextend.imageHelper.fixed(t.image),!s||(e=t.youtubeurl.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/))&&(i="https://i.ytimg.com/vi/"+e[2]+"/hqdefault.jpg","{video_url}"===this.values.youtubeurl&&(i="https://i.ytimg.com/vi/{video_id}/hqdefault.jpg"),setTimeout(function(){n("#item_youtubeimage").val(i).trigger("change")},100))},t.prototype.fitLayer=function(){return!0},t.prototype._render=function(t){var e="";"custom"===t["aspect-ratio"]&&(e="padding-top:"+t["aspect-ratio-height"]/t["aspect-ratio-width"]*100+"%");var i=n('<div class="n2_ss_video_player n2-ow-all"><div class="n2_ss_video_player__placeholder" style="'+e+'"></div></div>').attr("data-aspect-ratio",t["aspect-ratio"]).css({background:"url("+t.image+") no-repeat 50% 50%",backgroundSize:"cover"});!parseInt(t.playbutton)&&t.playbutton!==s||n('<div class="n2_ss_video_player__cover"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OCA0OCI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48Y2lyY2xlIGN4PSIyNCIgY3k9IjI0IiByPSIyNCIgZmlsbD0iIzAwMCIgb3BhY2l0eT0iLjYiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMTkuOCAzMmMtLjEyNCAwLS4yNDctLjAyOC0uMzYtLjA4LS4yNjQtLjExNi0uNDM2LS4zNzUtLjQ0LS42NjRWMTYuNzQ0Yy4wMDUtLjI5LjE3Ni0uNTUuNDQtLjY2Ni4yNzMtLjEyNi41OTItLjEuODQuMDdsMTAuNCA3LjI1N2MuMi4xMzIuMzIuMzU1LjMyLjU5NXMtLjEyLjQ2My0uMzIuNTk1bC0xMC40IDcuMjU2Yy0uMTQuMS0uMzEuMTUtLjQ4LjE1eiIvPjwvZz48L3N2Zz4=" /></div>').appendTo(i),this.$item.append(i)},t}),N2D("BgAnimationEditor",["NextendFragmentEditorControllerWithEditor"],function(i,e){function t(){this.parameters={shiftedBackgroundAnimation:0},this.$css=i("<style></style>").appendTo("head"),this.preview=i('<div class="n2_form__table_preview n2_ss_background_animation_preview"></div>').appendTo('.n2_form__table[data-field="table-background-animation-preview"]');var t=i('<div class="n2_ss_background_animation_preview__slider"></div>').appendTo(this.preview);this.bgAnimationElement=i('<div class="n2_ss_background_animation_preview__animation_container"></div>').appendTo(t);i('<div class="n2_ss_background_animation_preview__slide"></div>').append(i('<div class="n2_ss_background_animation_preview__slide_background"></div>').append(i('<div class="n2_ss_background_animation_preview__slide_background_image"></div>'))).appendTo(t).clone().appendTo(t);this.backgroundAnimations={color:"eeeeeeff"},N2Classes.NextendFragmentEditorControllerWithEditor.prototype.constructor.call(this,!1),this.slides=t.find(".n2_ss_background_animation_preview__slide"),this.slides.eq(1).css("opactiy",0),this.bgImages=t.find(".n2_ss_background_animation_preview__slide_background");var e=[nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png"),nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")];t.find(".n2_ss_background_animation_preview__slide_background_image").each(function(t){i(this).css("backgroundImage","url("+e[t]+")")}),NextendTween.set(this.bgImages,{rotationZ:1e-4}),(n2const.isIE||n2const.isEdge)&&N2Classes.Notification.error("Background animations are not available in your browser. It works if the <i>transform-style: preserve-3d</i> feature available. "),this.$colorField=i("#n2-background-animationcolor").on("nextendChange",this.changeColor.bind(this))}return((t.prototype=Object.create(N2Classes.NextendFragmentEditorControllerWithEditor.prototype)).constructor=t).prototype.loadDefaults=function(){N2Classes.NextendFragmentEditorControllerWithEditor.prototype.loadDefaults.call(this),this.type="backgroundanimation",this.current=0,this.animationProperties=!1},t.prototype.get=function(){return null},t.prototype.load=function(t,e,i,s){},t.prototype.setTabs=function(t){},t.prototype.start=function(t){t.color!==e?(this.$colorField.data("field").insideChange(t.color),this.backgroundAnimations.color=t.color):(i("#n2-tab-background-animation-form").remove(),this.$css.html(".n2-3d-side,.tile-colored-overlay{background: "+nextend.currentEditor.frontend.parameters.bgAnimationsColor+";}")),this.animationProperties&&(this.timeline?this.timeline.play():this.next())},t.prototype.changeColor=function(){this.backgroundAnimations.color=this.$colorField.val(),this.$css.html(".n2-3d-side,.tile-colored-overlay{background: "+N2Color.hex2rgbaCSS(this.backgroundAnimations.color)+";}")},t.prototype.pause=function(){this.timeline&&this.timeline.pause()},t.prototype.next=function(){this.timeline=new NextendTimeline({paused:!0,onComplete:this.ended.bind(this)});var t=this.bgImages.eq(this.current),e=this.bgImages.eq(1-this.current);n2const.isIE||n2const.isEdge?(this.timeline.to(this.slides.eq(this.current),1.5,{opacity:0},0),this.timeline.to(this.slides.eq(1-this.current),1.5,{opacity:1},0)):(this.currentAnimation=new N2Classes["SmartSliderBackgroundAnimation"+this.animationProperties.type](this,t,e,this.animationProperties,1,0),this.slides.eq(this.current).css("zIndex",2),this.slides.eq(1-this.current).css("zIndex",3),this.timeline.to(this.slides.eq(this.current),.5,{opacity:0},this.currentAnimation.getExtraDelay()),this.timeline.to(this.slides.eq(1-this.current),.5,{opacity:1},this.currentAnimation.getExtraDelay()),this.currentAnimation.postSetup()),this.current=1-this.current,this.timeline.play()},t.prototype.ended=function(){this.currentAnimation&&this.currentAnimation.ended(),this.next()},t.prototype.setAnimationProperties=function(t){var e=this.animationProperties;this.animationProperties=t,e||this.next()},t}),N2D("BgAnimationManager",["NextendVisualManagerMultipleSelection"],function(n,t){function e(){this.type="backgroundanimation",N2Classes.NextendVisualManagerMultipleSelection.prototype.constructor.apply(this,arguments)}return((e.prototype=Object.create(N2Classes.NextendVisualManagerMultipleSelection.prototype)).constructor=e).prototype.loadDefaults=function(){N2Classes.NextendVisualManagerMultipleSelection.prototype.loadDefaults.apply(this,arguments),this.type="backgroundanimation",this.labels={visual:"Background animation",visuals:"Background animations"}},e.prototype.initController=function(){return new N2Classes.BgAnimationEditor},e.prototype.createVisual=function(t,e){return new N2Classes.NextendVisualWithSetRowMultipleSelection(t,e,this)},e.prototype.show=function(t,e){var i={},s=n("#sliderbackground-animation-color");s.length&&(i.color=s.val()),N2Classes.NextendVisualManagerMultipleSelection.prototype.show.call(this,t,e,i)},e.prototype.getAsString=function(){var t=n("#sliderbackground-animation-color");return t.length&&t.val(n("#n2-background-animationcolor").val()),N2Classes.NextendVisualManagerMultipleSelection.prototype.getAsString.call(this)},e}),N2D("SmartSliderAdminWidgetArrowImage",function(r,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-arrow-style"===t){var i=r("<div></div>"),s=r("<div></div>").css("display","inline-block").addClass(e.styleClassName).appendTo(i),n=r('<img style="display: block;" />').appendTo(s),o=r("#sliderwidget-arrow-previous-image").val();return o?n.attr("src",nextend.imageHelper.fixed(o)):r("#sliderwidget-arrow-previous").data("field").getCurrentImage(r("#sliderwidget-arrow-previous-color").val()).done(function(t){n.attr("src",t)}),i}},e}),N2D("SmartSliderAdminWidgetAutoplayImage",function(o,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-autoplay-style"===t){var i=o("<div></div>").css("display","inline-block").addClass(e.styleClassName),s=o('<img style="display: block;" />').appendTo(i),n=o("#sliderwidget-autoplay-play-image").val();return n?s.attr("src",nextend.imageHelper.fixed(n)):o("#sliderwidget-autoplay-play").data("field").getCurrentImage(o("#sliderwidget-autoplay-play-color").val()).done(function(t){s.attr("src",t)}),i}},e}),N2D("SmartSliderAdminWidgetBarHorizontal",function(n,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-bar-style"===t){var i=n("#sliderwidget-bar-separator").val(),s=n("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName);return n("<span>Slide title</span>").addClass(e.fontClassName).attr("href","#").appendTo(s),n("<span>"+i+"Slide description which is longer than the title</span>").addClass(e.fontClassName2).appendTo(s),s}},e.renderFont=function(t,e){var i;return"sliderwidget-bar-font-title"===t?(i=n("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName),n("<span>Slide title</span>").addClass(e.fontClassName).attr("href","#").appendTo(i),i):"sliderwidget-bar-font-description"===t?(i=n("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName),n("<span>Slide description which is longer than the title</span>").addClass(e.fontClassName).attr("href","#").appendTo(i),i):void 0},e}),N2D("SmartSliderAdminWidgetBulletTransition",function(s,t){function e(){}return e.renderStyle=function(t,e){var i;return"sliderwidget-bullet-style"===t?(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName2),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName).appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName+" n2-active").appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName).appendTo(i)):"sliderwidget-bullet-bar"===t&&(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2).appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2+" n2-active").appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2).appendTo(i)),i},e}),N2D("SmartSliderAdminWidgetBulletThumbnail",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-bullet-thumbnail-style"===t){var i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName);return s("<div></div>").css({width:s("#sliderwidget-bullet-thumbnail-width").val()+"px",height:s("#sliderwidget-bullet-thumbnail-height").val()+"px",overflow:"hidden",background:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")',"background-size":"cover"}).appendTo(i),i}},e}),N2D("SmartSliderAdminWidgetThumbnailBasic",function(r,t){function e(){}return e.renderStyle=function(t,e){var i,s,n=r("#sliderwidget-thumbnail-width").val(),o=r("#sliderwidget-thumbnail-height").val();return"sliderwidget-thumbnail-style-bar"===t?(i=r("<div></div>").css({overflow:"hidden",width:2.5*n+"px"}).addClass(e.styleClassName),s=r("<div></div>").css("width","200%").appendTo(i),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName2).appendTo(s),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")+'")'}).addClass(e.styleClassName2+" n2-active").appendTo(s),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName2).appendTo(s),i):"sliderwidget-thumbnail-style-slides"===t?(i=r("<div></div>").css({overflow:"hidden",width:"480px"}).addClass(e.styleClassName2),s=r("<div></div>").css("width","200%").appendTo(i),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName).appendTo(s),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")+'")'}).addClass(e.styleClassName+" n2-active").appendTo(s),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName).appendTo(s),i):"sliderwidget-thumbnail-title-style"===t?r("<span>Slide title</span>").addClass(e.styleClassName+" "+e.fontClassName):void 0},e.renderFont=function(t,e){return"sliderwidget-thumbnail-title-font"===t?r("<span>Slide title</span>").addClass(e.styleClassName+" "+e.fontClassName):"sliderwidget-thumbnail-description-font"===t?r("<span>Slide description with long long text...</span>").addClass(e.styleClassName+" "+e.fontClassName):void 0},e}),N2D("SmartSliderAdminWidgetArrowImage",function(r,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-arrow-style"===t){var i=r("<div></div>"),s=r("<div></div>").css("display","inline-block").addClass(e.styleClassName).appendTo(i),n=r('<img style="display: block;" />').appendTo(s),o=r("#sliderwidget-arrow-previous-image").val();return o?n.attr("src",nextend.imageHelper.fixed(o)):r("#sliderwidget-arrow-previous").data("field").getCurrentImage(r("#sliderwidget-arrow-previous-color").val()).done(function(t){n.attr("src",t)}),i}},e}),N2D("SmartSliderAdminWidgetAutoplayImage",function(o,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-autoplay-style"===t){var i=o("<div></div>").css("display","inline-block").addClass(e.styleClassName),s=o('<img style="display: block;" />').appendTo(i),n=o("#sliderwidget-autoplay-play-image").val();return n?s.attr("src",nextend.imageHelper.fixed(n)):o("#sliderwidget-autoplay-play").data("field").getCurrentImage(o("#sliderwidget-autoplay-play-color").val()).done(function(t){s.attr("src",t)}),i}},e}),N2D("SmartSliderAdminWidgetBarHorizontal",function(n,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-bar-style"===t){var i=n("#sliderwidget-bar-separator").val(),s=n("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName);return n("<span>Slide title</span>").addClass(e.fontClassName).attr("href","#").appendTo(s),n("<span>"+i+"Slide description which is longer than the title</span>").addClass(e.fontClassName2).appendTo(s),s}},e.renderFont=function(t,e){var i;return"sliderwidget-bar-font-title"===t?(i=n("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName),n("<span>Slide title</span>").addClass(e.fontClassName).attr("href","#").appendTo(i),i):"sliderwidget-bar-font-description"===t?(i=n("<div></div>").css({width:"100%",boxSizing:"border-box"}).addClass(e.styleClassName),n("<span>Slide description which is longer than the title</span>").addClass(e.fontClassName).attr("href","#").appendTo(i),i):void 0},e}),N2D("SmartSliderAdminWidgetBulletTransition",function(s,t){function e(){}return e.renderStyle=function(t,e){var i;return"sliderwidget-bullet-style"===t?(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName2),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName).appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName+" n2-active").appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName).appendTo(i)):"sliderwidget-bullet-bar"===t&&(i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2).appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2+" n2-active").appendTo(i),s("<div></div>").css({display:"inline-block","vertical-align":"top"}).addClass(e.styleClassName2).appendTo(i)),i},e}),N2D("SmartSliderAdminWidgetBulletThumbnail",function(s,t){function e(){}return e.renderStyle=function(t,e){if("sliderwidget-bullet-thumbnail-style"===t){var i=s("<div></div>").css("display","inline-block").addClass(e.styleClassName);return s("<div></div>").css({width:s("#sliderwidget-bullet-thumbnail-width").val()+"px",height:s("#sliderwidget-bullet-thumbnail-height").val()+"px",overflow:"hidden",background:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")',"background-size":"cover"}).appendTo(i),i}},e}),N2D("SmartSliderAdminWidgetThumbnailBasic",function(r,t){function e(){}return e.renderStyle=function(t,e){var i,s,n=r("#sliderwidget-thumbnail-width").val(),o=r("#sliderwidget-thumbnail-height").val();return"sliderwidget-thumbnail-style-bar"===t?(i=r("<div></div>").css({overflow:"hidden",width:2.5*n+"px"}).addClass(e.styleClassName),s=r("<div></div>").css("width","200%").appendTo(i),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName2).appendTo(s),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")+'")'}).addClass(e.styleClassName2+" n2-active").appendTo(s),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName2).appendTo(s),i):"sliderwidget-thumbnail-style-slides"===t?(i=r("<div></div>").css({overflow:"hidden",width:"480px"}).addClass(e.styleClassName2),s=r("<div></div>").css("width","200%").appendTo(i),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName).appendTo(s),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/video.png")+'")'}).addClass(e.styleClassName+" n2-active").appendTo(s),r("<div></div>").css({display:"inline-block",verticalAlign:"top",width:n+"px",height:o+"px",backgroundImage:'url("'+nextend.imageHelper.fixed("$ss3-frontend$/images/placeholder/image.png")+'")'}).addClass(e.styleClassName).appendTo(s),i):"sliderwidget-thumbnail-title-style"===t?r("<span>Slide title</span>").addClass(e.styleClassName+" "+e.fontClassName):void 0},e.renderFont=function(t,e){return"sliderwidget-thumbnail-title-font"===t?r("<span>Slide title</span>").addClass(e.styleClassName+" "+e.fontClassName):"sliderwidget-thumbnail-description-font"===t?r("<span>Slide description with long long text...</span>").addClass(e.styleClassName+" "+e.fontClassName):void 0},e}),N2D("smartslider-backend");